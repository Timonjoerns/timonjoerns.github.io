/*! For license information please see main.42646a15.js.LICENSE.txt */
(()=>{var t={579:(t,e,n)=>{"use strict";t.exports=n(2799)},2284:(t,e,n)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}n.d(e,{A:()=>i})},2799:(t,e)=>{"use strict";var n=Symbol.for("react.transitional.element");function i(t,e,i){var r=null;if(void 0!==i&&(r=""+i),void 0!==e.key&&(r=""+e.key),"key"in e)for(var a in i={},e)"key"!==a&&(i[a]=e[a]);else i=e;return e=i.ref,{$$typeof:n,type:t,key:r,ref:void 0!==e?e:null,props:i}}Symbol.for("react.fragment"),e.jsx=i,e.jsxs=i},2897:(t,e,n)=>{var i=n(3693);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t},t.exports.__esModule=!0,t.exports.default=t.exports},3693:(t,e,n)=>{var i=n(7736);t.exports=function(t,e,n){return(e=i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},3738:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},4066:function(t,e,n){var i=n(2897).default;t.exports=function(){"use strict";var t={},e={};function n(n,i,r){if(e[n]=r,"index"===n){var a="var sharedModule = {}; ("+e.shared+")(sharedModule); ("+e.worker+")(sharedModule);",s={};return e.shared(s),e.index(t,s),"undefined"!==typeof window&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),t}}return n("shared",["exports"],function(t){function e(t,e,n,i){return new(n||(n=Promise))(function(r,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,o)}l((i=i.apply(t,e||[])).next())})}function n(t,e){this.x=t,this.y=e}function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a,s;"function"==typeof SuppressedError&&SuppressedError,n.prototype={clone(){return new n(this.x,this.y)},add(t){return this.clone()._add(t)},sub(t){return this.clone()._sub(t)},multByPoint(t){return this.clone()._multByPoint(t)},divByPoint(t){return this.clone()._divByPoint(t)},mult(t){return this.clone()._mult(t)},div(t){return this.clone()._div(t)},rotate(t){return this.clone()._rotate(t)},rotateAround(t,e){return this.clone()._rotateAround(t,e)},matMult(t){return this.clone()._matMult(t)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(t){return this.x===t.x&&this.y===t.y},dist(t){return Math.sqrt(this.distSqr(t))},distSqr(t){const e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith(t){return this.angleWithSep(t.x,t.y)},angleWithSep(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult(t){const e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add(t){return this.x+=t.x,this.y+=t.y,this},_sub(t){return this.x-=t.x,this.y-=t.y,this},_mult(t){return this.x*=t,this.y*=t,this},_div(t){return this.x/=t,this.y/=t,this},_multByPoint(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint(t){return this.x/=t.x,this.y/=t.y,this},_unit(){return this._div(this.mag()),this},_perp(){const t=this.y;return this.y=this.x,this.x=-t,this},_rotate(t){const e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround(t,e){const n=Math.cos(t),i=Math.sin(t),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=r,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:n},n.convert=function(t){if(t instanceof n)return t;if(Array.isArray(t))return new n(+t[0],+t[1]);if(void 0!==t.x&&void 0!==t.y)return new n(+t.x,+t.y);throw new Error("Expected [x, y] or {x, y} point format")};var o=function(){if(s)return a;function t(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=i}return s=1,a=t,t.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,i=0;i<8;i++){var r=this.sampleCurveX(n)-t;if(Math.abs(r)<e)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=r/a}var s=0,o=1;for(n=t,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-t)<e));i++)t>r?s=n:o=n,n=.5*(o-s)+s;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},a}(),l=r(o);let c,u;function h(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function d(){if(null==u&&(u=!1,h())){const t=5,e=new OffscreenCanvas(t,t).getContext("2d",{willReadFrequently:!0});if(e){for(let i=0;i<t*t;i++){const n=4*i;e.fillStyle="rgb(".concat(n,",").concat(n+1,",").concat(n+2,")"),e.fillRect(i%t,Math.floor(i/t),1,1)}const n=e.getImageData(0,0,t,t).data;for(let e=0;e<t*t*4;e++)if(e%4!=3&&n[e]!==e){u=!0;break}}}return u||!1}var f=1e-6,p="undefined"!=typeof Float32Array?Float32Array:Array;function m(){var t=new p(9);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function g(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(){var t=new p(3);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function y(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}function v(t,e,n){var i=new p(3);return i[0]=t,i[1]=e,i[2]=n,i}function b(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function x(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function w(t,e,n){var i=e[0],r=e[1],a=e[2],s=n[0],o=n[1],l=n[2];return t[0]=r*l-a*o,t[1]=a*s-i*l,t[2]=i*o-r*s,t}var S,P=y;function M(t,e,n){var i=e[0],r=e[1],a=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*a+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*a+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*a+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*a+n[15]*s,t}function A(){var t=new p(4);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function k(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"zyx",a=Math.PI/360;e*=a,i*=a,n*=a;var s=Math.sin(e),o=Math.cos(e),l=Math.sin(n),c=Math.cos(n),u=Math.sin(i),h=Math.cos(i);switch(r){case"xyz":t[0]=s*c*h+o*l*u,t[1]=o*l*h-s*c*u,t[2]=o*c*u+s*l*h,t[3]=o*c*h-s*l*u;break;case"xzy":t[0]=s*c*h-o*l*u,t[1]=o*l*h-s*c*u,t[2]=o*c*u+s*l*h,t[3]=o*c*h+s*l*u;break;case"yxz":t[0]=s*c*h+o*l*u,t[1]=o*l*h-s*c*u,t[2]=o*c*u-s*l*h,t[3]=o*c*h+s*l*u;break;case"yzx":t[0]=s*c*h+o*l*u,t[1]=o*l*h+s*c*u,t[2]=o*c*u-s*l*h,t[3]=o*c*h-s*l*u;break;case"zxy":t[0]=s*c*h-o*l*u,t[1]=o*l*h+s*c*u,t[2]=o*c*u+s*l*h,t[3]=o*c*h-s*l*u;break;case"zyx":t[0]=s*c*h-o*l*u,t[1]=o*l*h+s*c*u,t[2]=o*c*u-s*l*h,t[3]=o*c*h+s*l*u;break;default:throw new Error("Unknown angle order "+r)}return t}function E(){var t=new p(2);return p!=Float32Array&&(t[0]=0,t[1]=0),t}function T(t,e){var n=new p(2);return n[0]=t,n[1]=e,n}_(),S=new p(4),p!=Float32Array&&(S[0]=0,S[1]=0,S[2]=0,S[3]=0),_(),v(1,0,0),v(0,1,0),A(),A(),m(),E();const C=8192;function I(t,e,n){return e*(C/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}function L(t,e){return(t%e+e)%e}function z(t,e,n){return t*(1-n)+e*n}function N(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function D(t,e,n,i){const r=new l(t,e,n,i);return t=>r.solve(t)}const R=D(.25,.1,.25,1);function F(t,e,n){return Math.min(n,Math.max(e,t))}function O(t,e,n){const i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r}function B(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(const r of n)for(const e in r)t[e]=r[e];return t}let j=1;function U(t,e,n){const i={};for(const r in t)i[r]=e.call(this,t[r],r,t);return i}function G(t,e,n){const i={};for(const r in t)e.call(this,t[r],r,t)&&(i[r]=t[r]);return i}function q(t){return Array.isArray(t)?t.map(q):"object"==typeof t&&t?U(t,q):t}const V={};function Z(t){V[t]||("undefined"!=typeof console&&console.warn(t),V[t]=!0)}function W(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function H(t){return"undefined"!=typeof WorkerGlobalScope&&void 0!==t&&t instanceof WorkerGlobalScope}let X=null;function Y(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}const K="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function J(t,n,i,r,a){return e(this,void 0,void 0,function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const e=new VideoFrame(t,{timestamp:0});try{const s=null==e?void 0:e.format;if(!s||!s.startsWith("BGR")&&!s.startsWith("RGB"))throw new Error("Unrecognized format ".concat(s));const o=s.startsWith("BGR"),l=new Uint8ClampedArray(r*a*4);if(yield e.copyTo(l,function(t,e,n,i,r){const a=4*Math.max(-e,0),s=(Math.max(0,n)-n)*i*4+a,o=4*i,l=Math.max(0,e),c=Math.max(0,n);return{rect:{x:l,y:c,width:Math.min(t.width,e+i)-l,height:Math.min(t.height,n+r)-c},layout:[{offset:s,stride:o}]}}(t,n,i,r,a)),o)for(let t=0;t<l.length;t+=4){const e=l[t];l[t]=l[t+2],l[t+2]=e}return l}finally{e.close()}})}let $,Q;function tt(t,e,n,i){return t.addEventListener(e,n,i),{unsubscribe:()=>{t.removeEventListener(e,n,i)}}}function et(t){return t*Math.PI/180}function nt(t){return t/Math.PI*180}const it={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},rt={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},at="AbortError";function st(){return new Error(at)}const ot={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function lt(t){return ot.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}const ct="global-dispatcher";class ut extends Error{constructor(t,e,n,i){super("AJAXError: ".concat(e," (").concat(t,"): ").concat(n)),this.status=t,this.statusText=e,this.url=n,this.body=i}}const ht=()=>H(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,dt=function(t,n){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){const e=lt(t.url);if(e)return e(t,n);if(H(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:ct},n)}if(!(/^file:/.test(i=t.url)||/^file:/.test(ht())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(t,n){return e(this,void 0,void 0,function*(){const e=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:ht(),signal:n.signal});let i,r;"json"!==t.type||e.headers.has("Accept")||e.headers.set("Accept","application/json");try{i=yield fetch(e)}catch(e){throw new ut(0,e.message,t.url,new Blob)}if(!i.ok){const e=yield i.blob();throw new ut(i.status,i.statusText,t.url,e)}r="arrayBuffer"===t.type||"image"===t.type?i.arrayBuffer():"json"===t.type?i.json():i.text();const a=yield r;if(n.signal.aborted)throw st();return{data:a,cacheControl:i.headers.get("Cache-Control"),expires:i.headers.get("Expires")}})}(t,n);if(H(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:ct},n)}var i;return function(t,e){return new Promise((n,i)=>{var r;const a=new XMLHttpRequest;a.open(t.method||"GET",t.url,!0),"arrayBuffer"!==t.type&&"image"!==t.type||(a.responseType="arraybuffer");for(const e in t.headers)a.setRequestHeader(e,t.headers[e]);"json"===t.type&&(a.responseType="text",(null===(r=t.headers)||void 0===r?void 0:r.Accept)||a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===t.credentials,a.onerror=()=>{i(new Error(a.statusText))},a.onload=()=>{if(!e.signal.aborted)if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){let e=a.response;if("json"===t.type)try{e=JSON.parse(a.response)}catch(t){return void i(t)}n({data:e,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{const e=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});i(new ut(a.status,a.statusText,t.url,e))}},e.signal.addEventListener("abort",()=>{a.abort(),i(st())}),a.send(t.body)})}(t,n)};function ft(t){if(!t||t.indexOf("://")<=0||0===t.indexOf("data:image/")||0===t.indexOf("blob:"))return!0;const e=new URL(t),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function pt(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function mt(t,e,n){if(n&&n[t]){const i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}class gt{constructor(t){B(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=t}}class _t extends gt{constructor(t){super("error",B({error:t},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class yt{on(t,e){return this._listeners=this._listeners||{},pt(t,e,this._listeners),{unsubscribe:()=>{this.off(t,e)}}}off(t,e){return mt(t,e,this._listeners),mt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},pt(t,e,this._oneTimeListeners),this):new Promise(e=>this.once(t,e))}fire(t,e){"string"==typeof t&&(t=new gt(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const i=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const a of i)mt(n,a,this._oneTimeListeners),a.call(this,t);const r=this._eventedParent;r&&(B(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(t))}else t instanceof _t&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var vt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const bt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function xt(t,e){const n={};for(const i in t)"ref"!==i&&(n[i]=t[i]);return bt.forEach(t=>{t in e&&(n[t]=e[t])}),n}function wt(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!wt(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!wt(t[n],e[n]))return!1;return!0}return t===e}function St(t,e){t.push(e)}function Pt(t,e,n){St(n,{command:"addSource",args:[t,e[t]]})}function Mt(t,e,n){St(e,{command:"removeSource",args:[t]}),n[t]=!0}function At(t,e,n,i){Mt(t,n,i),Pt(t,e,n)}function kt(t,e,n){let i;for(i in t[n])if(Object.prototype.hasOwnProperty.call(t[n],i)&&"data"!==i&&!wt(t[n][i],e[n][i]))return!1;for(i in e[n])if(Object.prototype.hasOwnProperty.call(e[n],i)&&"data"!==i&&!wt(t[n][i],e[n][i]))return!1;return!0}function Et(t,e,n,i,r,a){t=t||{},e=e||{};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(wt(t[s],e[s])||n.push({command:a,args:[i,s,e[s],r]}));for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&!Object.prototype.hasOwnProperty.call(t,s)&&(wt(t[s],e[s])||n.push({command:a,args:[i,s,e[s],r]}))}function Tt(t){return t.id}function Ct(t,e){return t[e.id]=e,t}class It{constructor(t,e,n,i){this.message=(t?"".concat(t,": "):"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)}}function Lt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(const r of n)for(const e in r)t[e]=r[e];return t}class zt extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class Nt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=t,this.bindings={};for(const[n,i]of e)this.bindings[n]=i}concat(t){return new Nt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error("".concat(t," not found in scope."))}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Dt={kind:"null"},Rt={kind:"number"},Ft={kind:"string"},Ot={kind:"boolean"},Bt={kind:"color"},jt={kind:"projectionDefinition"},Ut={kind:"object"},Gt={kind:"value"},qt={kind:"collator"},Vt={kind:"formatted"},Zt={kind:"padding"},Wt={kind:"colorArray"},Ht={kind:"numberArray"},Xt={kind:"resolvedImage"},Yt={kind:"variableAnchorOffsetCollection"};function Kt(t,e){return{kind:"array",itemType:t,N:e}}function Jt(t){if("array"===t.kind){const e=Jt(t.itemType);return"number"==typeof t.N?"array<".concat(e,", ").concat(t.N,">"):"value"===t.itemType.kind?"array":"array<".concat(e,">")}return t.kind}const $t=[Dt,Rt,Ft,Ot,Bt,jt,Vt,Ut,Kt(Gt),Zt,Ht,Wt,Xt,Yt];function Qt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Qt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of $t)if(!Qt(t,e))return null}return"Expected ".concat(Jt(t)," but found ").concat(Jt(e)," instead.")}function te(t,e){return e.some(e=>e.kind===t.kind)}function ee(t,e){return e.some(e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t)}function ne(t,e){return"array"===t.kind&&"array"===e.kind?t.itemType.kind===e.itemType.kind&&"number"==typeof t.N:t.kind===e.kind}const ie=.96422,re=.82521,ae=4/29,se=6/29,oe=3*se*se,le=se*se*se,ce=Math.PI/180,ue=180/Math.PI;function he(t){return(t%=360)<0&&(t+=360),t}function de(t){let e,n,[i,r,a,s]=t;const o=pe((.2225045*(i=fe(i))+.7168786*(r=fe(r))+.0606169*(a=fe(a)))/1);i===r&&r===a?e=n=o:(e=pe((.4360747*i+.3850649*r+.1430804*a)/ie),n=pe((.0139322*i+.0971045*r+.7141733*a)/re));const l=116*o-16;return[l<0?0:l,500*(e-o),200*(o-n),s]}function fe(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function pe(t){return t>le?Math.pow(t,1/3):t/oe+ae}function me(t){let[e,n,i,r]=t,a=(e+16)/116,s=isNaN(n)?a:a+n/500,o=isNaN(i)?a:a-i/200;return a=1*_e(a),s=ie*_e(s),o=re*_e(o),[ge(3.1338561*s-1.6168667*a-.4906146*o),ge(-.9787684*s+1.9161415*a+.033454*o),ge(.0719453*s-.2289914*a+1.4052427*o),r]}function ge(t){return(t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055)<0?0:t>1?1:t}function _e(t){return t>se?t*t*t:oe*(t-ae)}const ye=Object.hasOwn||function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};function ve(t,e){return ye(t,e)?t[e]:void 0}function be(t){return parseInt(t.padEnd(2,t),16)/255}function xe(t,e){return we(e?t/100:t,0,1)}function we(t,e,n){return Math.min(Math.max(e,t),n)}function Se(t){return!t.some(Number.isNaN)}const Pe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Me(t,e,n){return t+n*(e-t)}function Ae(t,e,n){return t.map((t,i)=>Me(t,e[i],n))}class ke{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.r=t,this.g=e,this.b=n,this.a=i,r||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[t,e,n,i]))}static parse(t){if(t instanceof ke)return t;if("string"!=typeof t)return;const e=function(t){if("transparent"===(t=t.toLowerCase().trim()))return[0,0,0,0];const e=ve(Pe,t);if(e){const[t,n,i]=e;return[t/255,n/255,i/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){const e=t.length<6?1:2;let n=1;return[be(t.slice(n,n+=e)),be(t.slice(n,n+=e)),be(t.slice(n,n+=e)),be(t.slice(n,n+e)||"ff")]}if(t.startsWith("rgb")){const e=t.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(e){const[t,n,i,r,a,s,o,l,c,u,h,d]=e,f=[r||" ",o||" ",u].join("");if("  "===f||"  /"===f||",,"===f||",,,"===f){const t=[i,s,c].join(""),e="%%%"===t?100:""===t?255:0;if(e){const t=[we(+n/e,0,1),we(+a/e,0,1),we(+l/e,0,1),h?xe(+h,d):1];if(Se(t))return t}}return}}const n=t.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(n){const[t,e,i,r,a,s,o,l,c]=n,u=[i||" ",a||" ",o].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const t=[+e,we(+r,0,100),we(+s,0,100),l?xe(+l,c):1];if(Se(t))return function(t){let[e,n,i,r]=t;function a(t){const r=(t+e/30)%12,a=n*Math.min(i,1-i);return i-a*Math.max(-1,Math.min(r-3,9-r,1))}return e=he(e),n/=100,i/=100,[a(0),a(8),a(4),r]}(t)}}}(t);return e?new ke(...e,!1):void 0}get rgb(){const{r:t,g:e,b:n,a:i}=this,r=i||1/0;return this.overwriteGetter("rgb",[t/r,e/r,n/r,i])}get hcl(){return this.overwriteGetter("hcl",function(t){const[e,n,i,r]=de(t),a=Math.sqrt(n*n+i*i);return[Math.round(1e4*a)?he(Math.atan2(i,n)*ue):NaN,a,e,r]}(this.rgb))}get lab(){return this.overwriteGetter("lab",de(this.rgb))}overwriteGetter(t,e){return Object.defineProperty(this,t,{value:e}),e}toString(){const[t,e,n,i]=this.rgb;return"rgba(".concat([t,e,n].map(t=>Math.round(255*t)).join(","),",").concat(i,")")}static interpolate(t,e,n){switch(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb"){case"rgb":{const[i,r,a,s]=Ae(t.rgb,e.rgb,n);return new ke(i,r,a,s,!1)}case"hcl":{const[i,r,a,s]=t.hcl,[o,l,c,u]=e.hcl;let h,d;if(isNaN(i)||isNaN(o))isNaN(i)?isNaN(o)?h=NaN:(h=o,1!==a&&0!==a||(d=l)):(h=i,1!==c&&0!==c||(d=r));else{let t=o-i;o>i&&t>180?t-=360:o<i&&i-o>180&&(t+=360),h=i+n*t}const[f,p,m,g]=function(t){let[e,n,i,r]=t;return e=isNaN(e)?0:e*ce,me([i,Math.cos(e)*n,Math.sin(e)*n,r])}([h,null!=d?d:Me(r,l,n),Me(a,c,n),Me(s,u,n)]);return new ke(f,p,m,g,!1)}case"lab":{const[i,r,a,s]=me(Ae(t.lab,e.lab,n));return new ke(i,r,a,s,!1)}}}}ke.black=new ke(0,0,0,1),ke.white=new ke(1,1,1,1),ke.transparent=new ke(0,0,0,0),ke.red=new ke(1,0,0,1);class Ee{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Te=["bottom","center","top"];class Ce{constructor(t,e,n,i,r,a){this.text=t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r,this.verticalAlign=a}}class Ie{constructor(t){this.sections=t}static fromString(t){return new Ie([new Ce(t,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof Ie?t:Ie.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}}class Le{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Le)return t;if("number"==typeof t)return new Le([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Le(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,e,n){return new Le(Ae(t.values,e.values,n))}}class ze{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ze)return t;if("number"==typeof t)return new ze([t]);if(Array.isArray(t)){for(const e of t)if("number"!=typeof e)return;return new ze(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,e,n){return new ze(Ae(t.values,e.values,n))}}class Ne{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ne)return t;if("string"==typeof t){const e=ke.parse(t);if(!e)return;return new Ne([e])}if(!Array.isArray(t))return;const e=[];for(const n of t){if("string"!=typeof n)return;const t=ke.parse(n);if(!t)return;e.push(t)}return new Ne(e)}toString(){return JSON.stringify(this.values)}static interpolate(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb";const r=[];if(t.values.length!=e.values.length)throw new Error("colorArray: Arrays have mismatched length (".concat(t.values.length," vs. ").concat(e.values.length,"), cannot interpolate."));for(let a=0;a<t.values.length;a++)r.push(ke.interpolate(t.values[a],e.values[a],n,i));return new Ne(r)}}class De extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Re=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Fe{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Fe)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let e=0;e<t.length;e+=2){const n=t[e],i=t[e+1];if("string"!=typeof n||!Re.has(n))return;if(!Array.isArray(i)||2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])return}return new Fe(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,e,n){const i=t.values,r=e.values;if(i.length!==r.length)throw new De("Cannot interpolate values of different length. from: ".concat(t.toString(),", to: ").concat(e.toString()));const a=[];for(let s=0;s<i.length;s+=2){if(i[s]!==r[s])throw new De("Cannot interpolate values containing mismatched anchors. from[".concat(s,"]: ").concat(i[s],", to[").concat(s,"]: ").concat(r[s]));a.push(i[s]);const[t,e]=i[s+1],[o,l]=r[s+1];a.push([Me(t,o,n),Me(e,l,n)])}return new Fe(a)}}class Oe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Oe({name:t,available:!1}):null}}class Be{constructor(t,e,n){this.from=t,this.to=e,this.transition=n}static interpolate(t,e,n){return new Be(t,e,n)}static parse(t){return t instanceof Be?t:Array.isArray(t)&&3===t.length&&"string"==typeof t[0]&&"string"==typeof t[1]&&"number"==typeof t[2]?new Be(t[0],t[1],t[2]):"object"==typeof t&&"string"==typeof t.from&&"string"==typeof t.to&&"number"==typeof t.transition?new Be(t.from,t.to,t.transition):"string"==typeof t?new Be(t,t,1):void 0}}function je(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:"Invalid rgba value [".concat([t,e,n,i].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function Ue(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Be||t instanceof ke||t instanceof Ee||t instanceof Ie||t instanceof Le||t instanceof ze||t instanceof Ne||t instanceof Fe||t instanceof Oe)return!0;if(Array.isArray(t)){for(const e of t)if(!Ue(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!Ue(t[e]))return!1;return!0}return!1}function Ge(t){if(null===t)return Dt;if("string"==typeof t)return Ft;if("boolean"==typeof t)return Ot;if("number"==typeof t)return Rt;if(t instanceof ke)return Bt;if(t instanceof Be)return jt;if(t instanceof Ee)return qt;if(t instanceof Ie)return Vt;if(t instanceof Le)return Zt;if(t instanceof ze)return Ht;if(t instanceof Ne)return Wt;if(t instanceof Fe)return Yt;if(t instanceof Oe)return Xt;if(Array.isArray(t)){const e=t.length;let n;for(const i of t){const t=Ge(i);if(n){if(n===t)continue;n=Gt;break}n=t}return Kt(n||Gt,e)}return Ut}function qe(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ke||t instanceof Be||t instanceof Ie||t instanceof Le||t instanceof ze||t instanceof Ne||t instanceof Fe||t instanceof Oe?t.toString():JSON.stringify(t)}class Ve{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(!Ue(t[1]))return e.error("invalid value");const n=t[1];let i=Ge(n);const r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new Ve(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ze={string:Ft,number:Rt,boolean:Ot,object:Ut};class We{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,i=1;const r=t[0];if("array"===r){let r,a;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in Ze)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=Ze[n],i++}else r=Gt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],i++}n=Kt(r,a)}else{if(!Ze[r])throw new Error("Types doesn't contain name = ".concat(r));n=Ze[r]}const a=[];for(;i<t.length;i++){const n=e.parse(t[i],i,Gt);if(!n)return null;a.push(n)}return new We(n,a)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!Qt(this.type,Ge(n)))return n;if(e===this.args.length-1)throw new De("Expected value to be of type ".concat(Jt(this.type),", but found ").concat(Jt(Ge(n))," instead."))}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const He={"to-boolean":Ot,"to-color":Bt,"to-number":Rt,"to-string":Ft};class Xe{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(!He[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const i=He[n],r=[];for(let a=1;a<t.length;a++){const n=e.parse(t[a],a,Gt);if(!n)return null;r.push(n)}return new Xe(i,r)}evaluate(t){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(t));case"color":{let e,n;for(const i of this.args){if(e=i.evaluate(t),n=null,e instanceof ke)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?"Invalid rgba value ".concat(JSON.stringify(e),": expected an array containing either three or four numeric values."):je(e[0],e[1],e[2],e[3]),!n))return new ke(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new De(n||"Could not parse color from value '".concat("string"==typeof e?e:JSON.stringify(e),"'"))}case"padding":{let e;for(const n of this.args){e=n.evaluate(t);const i=Le.parse(e);if(i)return i}throw new De("Could not parse padding from value '".concat("string"==typeof e?e:JSON.stringify(e),"'"))}case"numberArray":{let e;for(const n of this.args){e=n.evaluate(t);const i=ze.parse(e);if(i)return i}throw new De("Could not parse numberArray from value '".concat("string"==typeof e?e:JSON.stringify(e),"'"))}case"colorArray":{let e;for(const n of this.args){e=n.evaluate(t);const i=Ne.parse(e);if(i)return i}throw new De("Could not parse colorArray from value '".concat("string"==typeof e?e:JSON.stringify(e),"'"))}case"variableAnchorOffsetCollection":{let e;for(const n of this.args){e=n.evaluate(t);const i=Fe.parse(e);if(i)return i}throw new De("Could not parse variableAnchorOffsetCollection from value '".concat("string"==typeof e?e:JSON.stringify(e),"'"))}case"number":{let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new De("Could not convert ".concat(JSON.stringify(e)," to number."))}case"formatted":return Ie.fromString(qe(this.args[0].evaluate(t)));case"resolvedImage":return Oe.fromString(qe(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return qe(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Ye=["Unknown","Point","LineString","Polygon"];class Ke{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ye[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache.get(t);return e||(e=ke.parse(t),this._parseColorCache.set(t,e)),e}}class Je{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Nt,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];this.registry=t,this.path=n,this.key=n.map(t=>"[".concat(t,"]")).join(""),this.scope=r,this.errors=a,this.expectedType=i,this._isConstant=e}parse(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)}_parse(t,e){function n(t,e,n){return"assert"===n?new We(e,[t]):"coerce"===n?new Xe(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=t[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found ".concat(typeof i,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;const r=this.registry[i];if(r){let i=r.parse(t,this);if(!i)return null;if(this.expectedType){const t=this.expectedType,r=i.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind){if("projectionDefinition"===t.kind&&["string","array"].includes(r.kind)||["color","formatted","resolvedImage"].includes(t.kind)&&["value","string"].includes(r.kind)||["padding","numberArray"].includes(t.kind)&&["value","number","array"].includes(r.kind)||"colorArray"===t.kind&&["value","string","array"].includes(r.kind)||"variableAnchorOffsetCollection"===t.kind&&["value","array"].includes(r.kind))i=n(i,t,e.typeAnnotation||"coerce");else if(this.checkSubtype(t,r))return null}else i=n(i,t,e.typeAnnotation||"assert")}if(!(i instanceof Ve)&&"resolvedImage"!==i.type.kind&&this._isConstant(i)){const e=new Ke;try{i=new Ve(i.type,i.evaluate(e))}catch(t){return this.error(t.message),null}}return i}return this.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof t," instead."))}concat(t,e,n){const i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new Je(this.registry,this._isConstant,i,e||null,r,this.errors)}error(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r="".concat(this.key).concat(n.map(t=>"[".concat(t,"]")).join(""));this.errors.push(new zt(r,t))}checkSubtype(t,e){const n=Qt(t,e);return n&&this.error(n),n}}class $e{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found ".concat(t.length-1," instead."));const n=[];for(let r=1;r<t.length-1;r+=2){const i=t[r];if("string"!=typeof i)return e.error("Expected string, but found ".concat(typeof i," instead."),r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const a=e.parse(t[r+1],r+1);if(!a)return null;n.push([i,a])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return i?new $e(n,i):null}outputDefined(){return this.result.outputDefined()}}class Qe{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new Qe(n,e.scope.get(n)):e.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class tn{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,Rt),i=e.parse(t[2],2,Kt(e.expectedType||Gt));return n&&i?new tn(i.type.itemType,n,i):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new De("Array index out of bounds: ".concat(e," < 0."));if(e>=n.length)throw new De("Array index out of bounds: ".concat(e," > ").concat(n.length-1,"."));if(e!==Math.floor(e))throw new De("Array index must be an integer, but found ".concat(e," instead."));return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class en{constructor(t,e){this.type=Ot,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,Gt),i=e.parse(t[2],2,Gt);return n&&i?te(n.type,[Ot,Ft,Rt,Dt,Gt])?new en(n,i):e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(Jt(n.type)," instead")):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!ee(e,["boolean","string","number","null"]))throw new De("Expected first argument to be of type boolean, string, number or null, but found ".concat(Jt(Ge(e))," instead."));if(!ee(n,["string","array"]))throw new De("Expected second argument to be of type array or string, but found ".concat(Jt(Ge(n))," instead."));return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class nn{constructor(t,e,n){this.type=Rt,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 2 or 3 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,Gt),i=e.parse(t[2],2,Gt);if(!n||!i)return null;if(!te(n.type,[Ot,Ft,Rt,Dt,Gt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(Jt(n.type)," instead"));if(4===t.length){const r=e.parse(t[3],3,Rt);return r?new nn(n,i,r):null}return new nn(n,i)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!ee(e,["boolean","string","number","null"]))throw new De("Expected first argument to be of type boolean, string, number or null, but found ".concat(Jt(Ge(e))," instead."));let i;if(this.fromIndex&&(i=this.fromIndex.evaluate(t)),ee(n,["string"])){const t=n.indexOf(e,i);return-1===t?-1:[...n.slice(0,t)].length}if(ee(n,["array"]))return n.indexOf(e,i);throw new De("Expected second argument to be of type array or string, but found ".concat(Jt(Ge(n))," instead."))}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class rn{constructor(t,e,n,i,r,a){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=a}static parse(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r={},a=[];for(let l=2;l<t.length-1;l+=2){let s=t[l];const o=t[l+1];Array.isArray(s)||(s=[s]);const c=e.concat(l);if(0===s.length)return c.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,Ge(t)))return null}else n=Ge(t);if(void 0!==r[String(t)])return c.error("Branch labels must be unique.");r[String(t)]=a.length}const u=e.parse(o,l,i);if(!u)return null;i=i||u.type,a.push(u)}const s=e.parse(t[1],1,Gt);if(!s)return null;const o=e.parse(t[t.length-1],t.length-1,i);return o?"value"!==s.type.kind&&e.concat(1).checkSubtype(n,s.type)?null:new rn(n,i,s,r,a,o):null}evaluate(t){const e=this.input.evaluate(t);return(Ge(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class an{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i=[];for(let a=1;a<t.length-1;a+=2){const r=e.parse(t[a],a,Ot);if(!r)return null;const s=e.parse(t[a+1],a+1,n);if(!s)return null;i.push([r,s]),n=n||s.type}const r=e.parse(t[t.length-1],t.length-1,n);if(!r)return null;if(!n)throw new Error("Can't infer output type");return new an(n,i,r)}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every(t=>{let[e,n]=t;return n.outputDefined()})&&this.otherwise.outputDefined()}}class sn{constructor(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 2 or 3 arguments, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1,Gt),i=e.parse(t[2],2,Rt);if(!n||!i)return null;if(!te(n.type,[Kt(Gt),Ft,Gt]))return e.error("Expected first argument to be of type array or string, but found ".concat(Jt(n.type)," instead"));if(4===t.length){const r=e.parse(t[3],3,Rt);return r?new sn(n.type,n,i,r):null}return new sn(n.type,n,i)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);let i;if(this.endIndex&&(i=this.endIndex.evaluate(t)),ee(e,["string"]))return[...e].slice(n,i).join("");if(ee(e,["array"]))return e.slice(n,i);throw new De("Expected first argument to be of type array or string, but found ".concat(Jt(Ge(e))," instead."))}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function on(t,e){const n=t.length-1;let i,r,a=0,s=n,o=0;for(;a<=s;)if(o=Math.floor((a+s)/2),i=t[o],r=t[o+1],i<=e){if(o===n||e<r)return o;a=o+1}else{if(!(i>e))throw new De("Input is not a number.");s=o-1}return 0}class ln{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[i,r]of n)this.labels.push(i),this.outputs.push(r)}static parse(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,Rt);if(!n)return null;const i=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let a=1;a<t.length;a+=2){const n=1===a?-1/0:t[a],s=t[a+1],o=a,l=a+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(i.length&&i[i.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);const c=e.parse(s,l,r);if(!c)return null;r=r||c.type,i.push([n,c])}return new ln(r,n,i)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[on(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function cn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var un,hn,dn=function(){if(hn)return un;function t(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=i}return hn=1,un=t,t.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,i=0;i<8;i++){var r=this.sampleCurveX(n)-t;if(Math.abs(r)<e)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=r/a}var s=0,o=1;for(n=t,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-t)<e));i++)t>r?s=n:o=n,n=.5*(o-s)+s;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}},un}(),fn=cn(dn);class pn{constructor(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[a,s]of r)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(t,e,n,i){let r=0;if("exponential"===t.name)r=mn(e,t.base,n,i);else if("linear"===t.name)r=mn(e,1,n,i);else if("cubic-bezier"===t.name){const a=t.controlPoints;r=new fn(a[0],a[1],a[2],a[3]).solve(mn(e,1,n,i))}return r}static parse(t,e){let[n,i,r,...a]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type ".concat(String(i[0])),1,0);{const t=i.slice(1);if(4!==t.length||t.some(t=>"number"!=typeof t||t<0||t>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,Rt),!r)return null;const s=[];let o=null;"interpolate-hcl"!==n&&"interpolate-lab"!==n||e.expectedType==Wt?e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType):o=Bt;for(let l=0;l<a.length;l+=2){const t=a[l],n=a[l+1],i=l+3,r=l+4;if("number"!=typeof t)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(s.length&&s[s.length-1][0]>=t)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const c=e.parse(n,r,o);if(!c)return null;o=o||c.type,s.push([t,c])}return ne(o,Rt)||ne(o,jt)||ne(o,Bt)||ne(o,Zt)||ne(o,Ht)||ne(o,Wt)||ne(o,Yt)||ne(o,Kt(Rt))?new pn(o,n,i,r,s):e.error("Type ".concat(Jt(o)," is not interpolatable."))}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);const a=on(e,i),s=pn.interpolationFactor(this.interpolation,i,e[a],e[a+1]),o=n[a].evaluate(t),l=n[a+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Me(o,l,s);case"color":return ke.interpolate(o,l,s);case"padding":return Le.interpolate(o,l,s);case"colorArray":return Ne.interpolate(o,l,s);case"numberArray":return ze.interpolate(o,l,s);case"variableAnchorOffsetCollection":return Fe.interpolate(o,l,s);case"array":return Ae(o,l,s);case"projectionDefinition":return Be.interpolate(o,l,s)}case"interpolate-hcl":switch(this.type.kind){case"color":return ke.interpolate(o,l,s,"hcl");case"colorArray":return Ne.interpolate(o,l,s,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ke.interpolate(o,l,s,"lab");case"colorArray":return Ne.interpolate(o,l,s,"lab")}}}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function mn(t,e,n,i){const r=i-n,a=t-n;return 0===r?0:1===e?a/r:(Math.pow(e,a)-1)/(Math.pow(e,r)-1)}const gn={color:ke.interpolate,number:Me,padding:Le.interpolate,numberArray:ze.interpolate,colorArray:Ne.interpolate,variableAnchorOffsetCollection:Fe.interpolate,array:Ae};class _n{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n=null;const i=e.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const s of t.slice(1)){const t=e.parse(s,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,r.push(t)}if(!n)throw new Error("No output type");const a=i&&r.some(t=>Qt(i,t.type));return new _n(a?Gt:n,r)}evaluate(t){let e,n=null,i=0;for(const r of this.args)if(i++,n=r.evaluate(t),n&&n instanceof Oe&&!n.available&&(e||(e=n.name),n=null,i===this.args.length&&(n=e)),null!==n)break;return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function yn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function vn(t,e,n,i){return 0===i.compare(e,n)}function bn(t,e,n){const i="=="!==t&&"!="!==t;return class r{constructor(t,e,n){this.type=Ot,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let a=e.parse(t[1],1,Gt);if(!a)return null;if(!yn(n,a.type))return e.concat(1).error('"'.concat(n,"\" comparisons are not supported for type '").concat(Jt(a.type),"'."));let s=e.parse(t[2],2,Gt);if(!s)return null;if(!yn(n,s.type))return e.concat(2).error('"'.concat(n,"\" comparisons are not supported for type '").concat(Jt(s.type),"'."));if(a.type.kind!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return e.error("Cannot compare types '".concat(Jt(a.type),"' and '").concat(Jt(s.type),"'."));i&&("value"===a.type.kind&&"value"!==s.type.kind?a=new We(s.type,[a]):"value"!==a.type.kind&&"value"===s.type.kind&&(s=new We(a.type,[s])));let o=null;if(4===t.length){if("string"!==a.type.kind&&"string"!==s.type.kind&&"value"!==a.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(o=e.parse(t[3],3,qt),!o)return null}return new r(a,s,o)}evaluate(r){const a=this.lhs.evaluate(r),s=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const e=Ge(a),n=Ge(s);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new De('Expected arguments for "'.concat(t,'" to be (string, string) or (number, number), but found (').concat(e.kind,", ").concat(n.kind,") instead."))}if(this.collator&&!i&&this.hasUntypedArgument){const t=Ge(a),n=Ge(s);if("string"!==t.kind||"string"!==n.kind)return e(r,a,s)}return this.collator?n(r,a,s,this.collator.evaluate(r)):e(r,a,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}}}const xn=bn("==",function(t,e,n){return e===n},vn),wn=bn("!=",function(t,e,n){return e!==n},function(t,e,n,i){return!vn(0,e,n,i)}),Sn=bn("<",function(t,e,n){return e<n},function(t,e,n,i){return i.compare(e,n)<0}),Pn=bn(">",function(t,e,n){return e>n},function(t,e,n,i){return i.compare(e,n)>0}),Mn=bn("<=",function(t,e,n){return e<=n},function(t,e,n,i){return i.compare(e,n)<=0}),An=bn(">=",function(t,e,n){return e>=n},function(t,e,n,i){return i.compare(e,n)>=0});class kn{constructor(t,e,n){this.type=qt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Ot);if(!i)return null;const r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Ot);if(!r)return null;let a=null;return n.locale&&(a=e.parse(n.locale,1,Ft),!a)?null:new kn(i,r,a)}evaluate(t){return new Ee(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class En{constructor(t,e,n,i,r){this.type=Ft,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Rt);if(!n)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=e.parse(i.locale,1,Ft),!r))return null;let a=null;if(i.currency&&(a=e.parse(i.currency,1,Ft),!a))return null;let s=null;if(i["min-fraction-digits"]&&(s=e.parse(i["min-fraction-digits"],1,Rt),!s))return null;let o=null;return i["max-fraction-digits"]&&(o=e.parse(i["max-fraction-digits"],1,Rt),!o)?null:new En(n,r,a,s,o)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Tn{constructor(t){this.type=Vt,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const i=[];let r=!1;for(let a=1;a<=t.length-1;++a){const n=t[a];if(r&&"object"==typeof n&&!Array.isArray(n)){r=!1;let t=null;if(n["font-scale"]&&(t=e.parse(n["font-scale"],1,Rt),!t))return null;let a=null;if(n["text-font"]&&(a=e.parse(n["text-font"],1,Kt(Ft)),!a))return null;let s=null;if(n["text-color"]&&(s=e.parse(n["text-color"],1,Bt),!s))return null;let o=null;if(n["vertical-align"]){if("string"==typeof n["vertical-align"]&&!Te.includes(n["vertical-align"]))return e.error("'vertical-align' must be one of: 'bottom', 'center', 'top' but found '".concat(n["vertical-align"],"' instead."));if(o=e.parse(n["vertical-align"],1,Ft),!o)return null}const l=i[i.length-1];l.scale=t,l.font=a,l.textColor=s,l.verticalAlign=o}else{const n=e.parse(t[a],1,Gt);if(!n)return null;const s=n.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:n,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Tn(i)}evaluate(t){return new Ie(this.sections.map(e=>{const n=e.content.evaluate(t);return Ge(n)===Xt?new Ce("",n,null,null,null,e.verticalAlign?e.verticalAlign.evaluate(t):null):new Ce(qe(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null,e.verticalAlign?e.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor),e.verticalAlign&&t(e.verticalAlign)}outputDefined(){return!1}}class Cn{constructor(t){this.type=Xt,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,Ft);return n?new Cn(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=Oe.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}}class In{constructor(t){this.type=Rt,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found ".concat(t.length-1," instead."));const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found ".concat(Jt(n.type)," instead.")):new In(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return[...e].length;if(Array.isArray(e))return e.length;throw new De("Expected value to be of type string or array, but found ".concat(Jt(Ge(e))," instead."))}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ln=8192;function zn(t,e){const n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(n*r*Ln),Math.round(i*r*Ln)]}function Nn(t,e){const n=Math.pow(2,e.z);return[(r=(t[0]/Ln+e.x)/n,360*r-180),(i=(t[1]/Ln+e.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90)];var i,r}function Dn(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Rn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Fn(t,e,n){const i=t[0]-e[0],r=t[1]-e[1],a=t[0]-n[0],s=t[1]-n[1];return i*s-a*r==0&&i*a<=0&&r*s<=0}function On(t,e,n,i){return 0!=(r=[i[0]-n[0],i[1]-n[1]])[0]*(a=[e[0]-t[0],e[1]-t[1]])[1]-r[1]*a[0]&&!(!Vn(t,e,n,i)||!Vn(n,i,t,e));var r,a}function Bn(t,e,n){for(const i of n)for(let n=0;n<i.length-1;++n)if(On(t,e,i[n],i[n+1]))return!0;return!1}function jn(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1;for(const o of e)for(let e=0;e<o.length-1;e++){if(Fn(t,o[e],o[e+1]))return n;(a=o[e])[1]>(r=t)[1]!=(s=o[e+1])[1]>r[1]&&r[0]<(s[0]-a[0])*(r[1]-a[1])/(s[1]-a[1])+a[0]&&(i=!i)}var r,a,s;return i}function Un(t,e){for(const n of e)if(jn(t,n))return!0;return!1}function Gn(t,e){for(const n of t)if(!jn(n,e))return!1;for(let n=0;n<t.length-1;++n)if(Bn(t[n],t[n+1],e))return!1;return!0}function qn(t,e){for(const n of e)if(Gn(t,n))return!0;return!1}function Vn(t,e,n,i){const r=i[0]-n[0],a=i[1]-n[1],s=(t[0]-n[0])*a-r*(t[1]-n[1]),o=(e[0]-n[0])*a-r*(e[1]-n[1]);return s>0&&o<0||s<0&&o>0}function Zn(t,e,n){const i=[];for(let r=0;r<t.length;r++){const a=[];for(let i=0;i<t[r].length;i++){const s=zn(t[r][i],n);Dn(e,s),a.push(s)}i.push(a)}return i}function Wn(t,e,n){const i=[];for(let r=0;r<t.length;r++){const a=Zn(t[r],e,n);i.push(a)}return i}function Hn(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const e=.5*i;let r=t[0]-n[0]>e?-i:n[0]-t[0]>e?i:0;0===r&&(r=t[0]-n[2]>e?-i:n[2]-t[0]>e?i:0),t[0]+=r}Dn(e,t)}function Xn(t,e,n,i){const r=Math.pow(2,i.z)*Ln,a=[i.x*Ln,i.y*Ln],s=[];for(const o of t)for(const t of o){const i=[t.x+a[0],t.y+a[1]];Hn(i,e,n,r),s.push(i)}return s}function Yn(t,e,n,i){const r=Math.pow(2,i.z)*Ln,a=[i.x*Ln,i.y*Ln],s=[];for(const l of t){const t=[];for(const n of l){const i=[n.x+a[0],n.y+a[1]];Dn(e,i),t.push(i)}s.push(t)}if(e[2]-e[0]<=r/2){(o=e)[0]=o[1]=1/0,o[2]=o[3]=-1/0;for(const t of s)for(const i of t)Hn(i,e,n,r)}var o;return s}class Kn{constructor(t,e){this.type=Ot,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(Ue(t[1])){const e=t[1];if("FeatureCollection"===e.type){const t=[];for(const n of e.features){const{type:e,coordinates:i}=n.geometry;"Polygon"===e&&t.push(i),"MultiPolygon"===e&&t.push(...i)}if(t.length)return new Kn(e,{type:"MultiPolygon",coordinates:t})}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new Kn(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new Kn(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const a=Zn(e.coordinates,i,r),s=Xn(t.geometry(),n,i,r);if(!Rn(n,i))return!1;for(const t of s)if(!jn(t,a))return!1}if("MultiPolygon"===e.type){const a=Wn(e.coordinates,i,r),s=Xn(t.geometry(),n,i,r);if(!Rn(n,i))return!1;for(const t of s)if(!Un(t,a))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const a=Zn(e.coordinates,i,r),s=Yn(t.geometry(),n,i,r);if(!Rn(n,i))return!1;for(const t of s)if(!Gn(t,a))return!1}if("MultiPolygon"===e.type){const a=Wn(e.coordinates,i,r),s=Yn(t.geometry(),n,i,r);if(!Rn(n,i))return!1;for(const t of s)if(!qn(t,a))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Jn=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e)=>t<e?-1:t>e?1:0;if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,a=e[r];if(n(i,a)>=0)break;e[t]=a,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1);const a=i+1;if(a<this.length&&n(e[a],e[i])<0&&(i=a),n(e[i],r)>=0)break;e[t]=e[i],t=i}e[t]=r}};function $n(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ti;for(;i>n;){if(i-n>600){const a=i-n+1,s=e-n+1,o=Math.log(a),l=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*l*(a-l)/a)*(s-a/2<0?-1:1);$n(t,e,Math.max(n,Math.floor(e-s*l/a+c)),Math.min(i,Math.floor(e+(a-s)*l/a+c)),r)}const a=t[e];let s=n,o=i;for(Qn(t,n,e),r(t[i],a)>0&&Qn(t,n,i);s<o;){for(Qn(t,s,o),s++,o--;r(t[s],a)<0;)s++;for(;r(t[o],a)>0;)o--}0===r(t[n],a)?Qn(t,n,o):(o++,Qn(t,o,i)),o<=e&&(n=o+1),e<=o&&(i=o-1)}}function Qn(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function ti(t,e){return t<e?-1:t>e?1:0}function ei(t,e){if(t.length<=1)return[t];const n=[];let i,r;for(const a of t){const t=ii(a);0!==t&&(a.area=Math.abs(t),void 0===r&&(r=t<0),r===t<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),e>1)for(let a=0;a<n.length;a++)n[a].length<=e||($n(n[a],e,1,n[a].length-1,ni),n[a]=n[a].slice(0,e));return n}function ni(t,e){return e.area-t.area}function ii(t){let e=0;for(let n,i,r=0,a=t.length,s=a-1;r<a;s=r++)n=t[r],i=t[s],e+=(i.x-n.x)*(n.y+i.y);return e}const ri=1/298.257223563,ai=ri*(2-ri),si=Math.PI/180;class oi{constructor(t){const e=6378.137*si*1e3,n=Math.cos(t*si),i=1/(1-ai*(1-n*n)),r=Math.sqrt(i);this.kx=e*r*n,this.ky=e*r*i*(1-ai)}distance(t,e){const n=this.wrap(t[0]-e[0])*this.kx,i=(t[1]-e[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(t,e){let n,i,r,a,s=1/0;for(let o=0;o<t.length-1;o++){let l=t[o][0],c=t[o][1],u=this.wrap(t[o+1][0]-l)*this.kx,h=(t[o+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(this.wrap(e[0]-l)*this.kx*u+(e[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=t[o+1][0],c=t[o+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=this.wrap(e[0]-l)*this.kx,h=(e[1]-c)*this.ky;const f=u*u+h*h;f<s&&(s=f,n=l,i=c,r=o,a=d)}return{point:[n,i],index:r,t:Math.max(0,Math.min(1,a))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function li(t,e){return e[0]-t[0]}function ci(t){return t[1]-t[0]+1}function ui(t,e){return t[1]>=t[0]&&t[1]<e}function hi(t,e){if(t[0]>t[1])return[null,null];const n=ci(t);if(e){if(2===n)return[t,null];const e=Math.floor(n/2);return[[t[0],t[0]+e],[t[0]+e,t[1]]]}if(1===n)return[t,null];const i=Math.floor(n/2)-1;return[[t[0],t[0]+i],[t[0]+i+1,t[1]]]}function di(t,e){if(!ui(e,t.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let i=e[0];i<=e[1];++i)Dn(n,t[i]);return n}function fi(t){const e=[1/0,1/0,-1/0,-1/0];for(const n of t)for(const t of n)Dn(e,t);return e}function pi(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function mi(t,e,n){if(!pi(t)||!pi(e))return NaN;let i=0,r=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(r=t[1]-e[3]),t[3]<e[1]&&(r=e[1]-t[3]),n.distance([0,0],[i,r])}function gi(t,e,n){const i=n.pointOnLine(e,t);return n.distance(t,i.point)}function _i(t,e,n,i,r){const a=Math.min(gi(t,[n,i],r),gi(e,[n,i],r)),s=Math.min(gi(n,[t,e],r),gi(i,[t,e],r));return Math.min(a,s)}function yi(t,e,n,i,r){if(!ui(e,t.length)||!ui(i,n.length))return 1/0;let a=1/0;for(let s=e[0];s<e[1];++s){const e=t[s],o=t[s+1];for(let t=i[0];t<i[1];++t){const i=n[t],s=n[t+1];if(On(e,o,i,s))return 0;a=Math.min(a,_i(e,o,i,s,r))}}return a}function vi(t,e,n,i,r){if(!ui(e,t.length)||!ui(i,n.length))return NaN;let a=1/0;for(let s=e[0];s<=e[1];++s)for(let e=i[0];e<=i[1];++e)if(a=Math.min(a,r.distance(t[s],n[e])),0===a)return a;return a}function bi(t,e,n){if(jn(t,e,!0))return 0;let i=1/0;for(const r of e){const e=r[0],a=r[r.length-1];if(e!==a&&(i=Math.min(i,gi(t,[a,e],n)),0===i))return i;const s=n.pointOnLine(r,t);if(i=Math.min(i,n.distance(t,s.point)),0===i)return i}return i}function xi(t,e,n,i){if(!ui(e,t.length))return NaN;for(let a=e[0];a<=e[1];++a)if(jn(t[a],n,!0))return 0;let r=1/0;for(let a=e[0];a<e[1];++a){const e=t[a],s=t[a+1];for(const t of n)for(let n=0,a=t.length,o=a-1;n<a;o=n++){const a=t[o],l=t[n];if(On(e,s,a,l))return 0;r=Math.min(r,_i(e,s,a,l,i))}}return r}function wi(t,e){for(const n of t)for(const t of n)if(jn(t,e,!0))return!0;return!1}function Si(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;const r=fi(t),a=fi(e);if(i!==1/0&&mi(r,a,n)>=i)return i;if(Rn(r,a)){if(wi(t,e))return 0}else if(wi(e,t))return 0;let s=1/0;for(const o of t)for(let t=0,i=o.length,r=i-1;t<i;r=t++){const i=o[r],a=o[t];for(const t of e)for(let e=0,r=t.length,o=r-1;e<r;o=e++){const r=t[o],l=t[e];if(On(i,a,r,l))return 0;s=Math.min(s,_i(i,a,r,l,n))}}return s}function Pi(t,e,n,i,r,a){if(!a)return;const s=mi(di(i,a),r,n);s<e&&t.push([s,a,[0,0]])}function Mi(t,e,n,i,r,a,s){if(!a||!s)return;const o=mi(di(i,a),di(r,s),n);o<e&&t.push([o,a,s])}function Ai(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=Math.min(i.distance(t[0],n[0][0]),r);if(0===a)return a;const s=new Jn([[0,[0,t.length-1],[0,0]]],li),o=fi(n);for(;s.length>0;){const r=s.pop();if(r[0]>=a)continue;const l=r[1],c=e?50:100;if(ci(l)<=c){if(!ui(l,t.length))return NaN;if(e){const e=xi(t,l,n,i);if(isNaN(e)||0===e)return e;a=Math.min(a,e)}else for(let e=l[0];e<=l[1];++e){const r=bi(t[e],n,i);if(a=Math.min(a,r),0===a)return 0}}else{const n=hi(l,e);Pi(s,a,i,t,o,n[0]),Pi(s,a,i,t,o,n[1])}}return a}function ki(t,e,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,s=Math.min(a,r.distance(t[0],n[0]));if(0===s)return s;const o=new Jn([[0,[0,t.length-1],[0,n.length-1]]],li);for(;o.length>0;){const a=o.pop();if(a[0]>=s)continue;const l=a[1],c=a[2],u=e?50:100,h=i?50:100;if(ci(l)<=u&&ci(c)<=h){if(!ui(l,t.length)&&ui(c,n.length))return NaN;let a;if(e&&i)a=yi(t,l,n,c,r),s=Math.min(s,a);else if(e&&!i){const e=t.slice(l[0],l[1]+1);for(let t=c[0];t<=c[1];++t)if(a=gi(n[t],e,r),s=Math.min(s,a),0===s)return s}else if(!e&&i){const e=n.slice(c[0],c[1]+1);for(let n=l[0];n<=l[1];++n)if(a=gi(t[n],e,r),s=Math.min(s,a),0===s)return s}else a=vi(t,l,n,c,r),s=Math.min(s,a)}else{const a=hi(l,e),u=hi(c,i);Mi(o,s,r,t,n,a[0],u[0]),Mi(o,s,r,t,n,a[0],u[1]),Mi(o,s,r,t,n,a[1],u[0]),Mi(o,s,r,t,n,a[1],u[1])}}return s}function Ei(t){return"MultiPolygon"===t.type?t.coordinates.map(t=>({type:"Polygon",coordinates:t})):"MultiLineString"===t.type?t.coordinates.map(t=>({type:"LineString",coordinates:t})):"MultiPoint"===t.type?t.coordinates.map(t=>({type:"Point",coordinates:t})):[t]}class Ti{constructor(t,e){this.type=Rt,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error("'distance' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(Ue(t[1])){const e=t[1];if("FeatureCollection"===e.type)return new Ti(e,e.features.map(t=>Ei(t.geometry)).flat());if("Feature"===e.type)return new Ti(e,Ei(e.geometry));if("type"in e&&"coordinates"in e)return new Ti(e,Ei(e))}return e.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=t.geometry(),i=n.flat().map(e=>Nn([e.x,e.y],t.canonical));if(0===n.length)return NaN;const r=new oi(i[0][1]);let a=1/0;for(const s of e){switch(s.type){case"Point":a=Math.min(a,ki(i,!1,[s.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,ki(i,!1,s.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,Ai(i,!1,s.coordinates,r,a))}if(0===a)return a}return a}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=t.geometry(),i=n.flat().map(e=>Nn([e.x,e.y],t.canonical));if(0===n.length)return NaN;const r=new oi(i[0][1]);let a=1/0;for(const s of e){switch(s.type){case"Point":a=Math.min(a,ki(i,!0,[s.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,ki(i,!0,s.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,Ai(i,!0,s.coordinates,r,a))}if(0===a)return a}return a}(t,this.geometries);if("Polygon"===t.geometryType())return function(t,e){const n=t.geometry();if(0===n.length||0===n[0].length)return NaN;const i=ei(n,0).map(e=>e.map(e=>e.map(e=>Nn([e.x,e.y],t.canonical)))),r=new oi(i[0][0][0][1]);let a=1/0;for(const s of e)for(const t of i){switch(s.type){case"Point":a=Math.min(a,Ai([s.coordinates],!1,t,r,a));break;case"LineString":a=Math.min(a,Ai(s.coordinates,!0,t,r,a));break;case"Polygon":a=Math.min(a,Si(t,s.coordinates,r,a))}if(0===a)return a}return a}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Ci{constructor(t){this.type=Gt,this.key=t}static parse(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found ".concat(t.length-1," instead."));const n=t[1];return null==n?e.error("Global state property must be defined."):"string"!=typeof n?e.error("Global state property must be string, but found ".concat(typeof t[1]," instead.")):new Ci(n)}evaluate(t){var e;const n=null===(e=t.globals)||void 0===e?void 0:e.globalState;return n&&0!==Object.keys(n).length?ve(n,this.key):null}eachChild(){}outputDefined(){return!1}}const Ii={"==":xn,"!=":wn,">":Pn,"<":Sn,">=":An,"<=":Mn,array:We,at:tn,boolean:We,case:an,coalesce:_n,collator:kn,format:Tn,image:Cn,in:en,"index-of":nn,interpolate:pn,"interpolate-hcl":pn,"interpolate-lab":pn,length:In,let:$e,literal:Ve,match:rn,number:We,"number-format":En,object:We,slice:sn,step:ln,string:We,"to-boolean":Xe,"to-color":Xe,"to-number":Xe,"to-string":Xe,var:Qe,within:Kn,distance:Ti,"global-state":Ci};class Li{constructor(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const n=t[0],i=Li.definitions[n];if(!i)return e.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);const r=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(e=>{let[n]=e;return!Array.isArray(n)||n.length===t.length-1});let o=null;for(const[l,c]of s){o=new Je(e.registry,Fi,e.path,null,e.scope);const i=[];let a=!1;for(let e=1;e<t.length;e++){const n=t[e],r=Array.isArray(l)?l[e-1]:l.type,s=o.parse(n,1+i.length,r);if(!s){a=!0;break}i.push(s)}if(!a)if(Array.isArray(l)&&l.length!==i.length)o.error("Expected ".concat(l.length," arguments, but found ").concat(i.length," instead."));else{for(let t=0;t<i.length;t++){const e=Array.isArray(l)?l[t]:l.type,n=i[t];o.concat(t+1).checkSubtype(e,n.type)}if(0===o.errors.length)return new Li(n,r,c,i)}}if(1===s.length)e.errors.push(...o.errors);else{const n=(s.length?s:a).map(t=>{let[e]=t;return n=e,Array.isArray(n)?"(".concat(n.map(Jt).join(", "),")"):"(".concat(Jt(n.type),"...)");var n}).join(" | "),i=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],1+i.length);if(!n)return null;i.push(Jt(n.type))}e.error("Expected arguments of type ".concat(n,", but found (").concat(i.join(", "),") instead."))}return null}static register(t,e){Li.definitions=e;for(const n in e)t[n]=Li}}function zi(t,e){let[n,i,r,a]=e;n=n.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);const s=a?a.evaluate(t):1,o=je(n,i,r,s);if(o)throw new De(o);return new ke(n/255,i/255,r/255,s,!1)}function Ni(t,e){return t in e}function Di(t,e){const n=e[t];return void 0===n?null:n}function Ri(t){return{type:t}}function Fi(t){if(t instanceof Qe)return Fi(t.boundExpression);if(t instanceof Li&&"error"===t.name)return!1;if(t instanceof kn)return!1;if(t instanceof Kn)return!1;if(t instanceof Ti)return!1;if(t instanceof Ci)return!1;const e=t instanceof Xe||t instanceof We;let n=!0;return t.eachChild(t=>{n=e?n&&Fi(t):n&&t instanceof Ve}),!!n&&Oi(t)&&ji(t,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Oi(t){if(t instanceof Li){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Kn)return!1;if(t instanceof Ti)return!1;let e=!0;return t.eachChild(t=>{e&&!Oi(t)&&(e=!1)}),e}function Bi(t){if(t instanceof Li&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(t=>{e&&!Bi(t)&&(e=!1)}),e}function ji(t,e){if(t instanceof Li&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(t=>{n&&!ji(t,e)&&(n=!1)}),n}function Ui(t){return{result:"success",value:t}}function Gi(t){return{result:"error",value:t}}function qi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Vi(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Zi(t){return!!t.expression&&t.expression.interpolated}function Wi(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Hi(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)&&Ge(t)===Ut}function Xi(t){return t}function Yi(t,e){const n=t.stops&&"object"==typeof t.stops[0][0],i=n||!(n||void 0!==t.property),r=t.type||(Zi(e)?"exponential":"interval"),a=function(t){switch(t.type){case"color":return ke.parse;case"padding":return Le.parse;case"numberArray":return ze.parse;case"colorArray":return Ne.parse;default:return null}}(e);if(a&&((t=Lt({},t)).stops&&(t.stops=t.stops.map(t=>[t[0],a(t[1])])),t.default=a(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==(s=t.colorSpace)&&"hcl"!==s&&"lab"!==s)throw new Error('Unknown color space: "'.concat(t.colorSpace,'"'));var s;const o=function(t){switch(t){case"exponential":return Qi;case"interval":return $i;case"categorical":return Ji;case"identity":return tr;default:throw new Error('Unknown function type "'.concat(t,'"'))}}(r);let l,c;if("categorical"===r){l=Object.create(null);for(const e of t.stops)l[e[0]]=e[1];c=typeof t.stops[0][0]}if(n){const n={},i=[];for(let e=0;e<t.stops.length;e++){const r=t.stops[e],a=r[0].zoom;void 0===n[a]&&(n[a]={zoom:a,type:t.type,property:t.property,default:t.default,stops:[]},i.push(a)),n[a].stops.push([r[0].value,r[1]])}const r=[];for(const t of i)r.push([n[t].zoom,Yi(n[t],e)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:pn.interpolationFactor.bind(void 0,a),zoomStops:r.map(t=>t[0]),evaluate:(n,i)=>{let{zoom:a}=n;return Qi({stops:r,base:t.base},e,a).evaluate(a,i)}}}if(i){const n="exponential"===r?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:pn.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map(t=>t[0]),evaluate:n=>{let{zoom:i}=n;return o(t,e,i,l,c)}}}return{kind:"source",evaluate(n,i){const r=i&&i.properties?i.properties[t.property]:void 0;return void 0===r?Ki(t.default,e.default):o(t,e,r,l,c)}}}function Ki(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function Ji(t,e,n,i,r){return Ki(typeof n===r?i[n]:void 0,t.default,e.default)}function $i(t,e,n){if("number"!==Wi(n))return Ki(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const r=on(t.stops.map(t=>t[0]),n);return t.stops[r][1]}function Qi(t,e,n){const i=void 0!==t.base?t.base:1;if("number"!==Wi(n))return Ki(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const a=on(t.stops.map(t=>t[0]),n),s=function(t,e,n,i){const r=i-n,a=t-n;return 0===r?0:1===e?a/r:(Math.pow(e,a)-1)/(Math.pow(e,r)-1)}(n,i,t.stops[a][0],t.stops[a+1][0]),o=t.stops[a][1],l=t.stops[a+1][1],c=gn[e.type]||Xi;return"function"==typeof o.evaluate?{evaluate(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=o.evaluate.apply(void 0,n),a=l.evaluate.apply(void 0,n);if(void 0!==r&&void 0!==a)return c(r,a,s,t.colorSpace)}}:c(o,l,s,t.colorSpace)}function tr(t,e,n){switch(e.type){case"color":n=ke.parse(n);break;case"formatted":n=Ie.fromString(n.toString());break;case"resolvedImage":n=Oe.fromString(n.toString());break;case"padding":n=Le.parse(n);break;case"colorArray":n=Ne.parse(n);break;case"numberArray":n=ze.parse(n);break;default:Wi(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0)}return Ki(n,t.default,e.default)}Li.register(Ii,{error:[{kind:"error"},[Ft],(t,e)=>{let[n]=e;throw new De(n.evaluate(t))}],typeof:[Ft,[Gt],(t,e)=>{let[n]=e;return Jt(Ge(n.evaluate(t)))}],"to-rgba":[Kt(Rt,4),[Bt],(t,e)=>{let[n]=e;const[i,r,a,s]=n.evaluate(t).rgb;return[255*i,255*r,255*a,s]}],rgb:[Bt,[Rt,Rt,Rt],zi],rgba:[Bt,[Rt,Rt,Rt,Rt],zi],has:{type:Ot,overloads:[[[Ft],(t,e)=>{let[n]=e;return Ni(n.evaluate(t),t.properties())}],[[Ft,Ut],(t,e)=>{let[n,i]=e;return Ni(n.evaluate(t),i.evaluate(t))}]]},get:{type:Gt,overloads:[[[Ft],(t,e)=>{let[n]=e;return Di(n.evaluate(t),t.properties())}],[[Ft,Ut],(t,e)=>{let[n,i]=e;return Di(n.evaluate(t),i.evaluate(t))}]]},"feature-state":[Gt,[Ft],(t,e)=>{let[n]=e;return Di(n.evaluate(t),t.featureState||{})}],properties:[Ut,[],t=>t.properties()],"geometry-type":[Ft,[],t=>t.geometryType()],id:[Gt,[],t=>t.id()],zoom:[Rt,[],t=>t.globals.zoom],"heatmap-density":[Rt,[],t=>t.globals.heatmapDensity||0],elevation:[Rt,[],t=>t.globals.elevation||0],"line-progress":[Rt,[],t=>t.globals.lineProgress||0],accumulated:[Gt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Rt,Ri(Rt),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[Rt,Ri(Rt),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:Rt,overloads:[[[Rt,Rt],(t,e)=>{let[n,i]=e;return n.evaluate(t)-i.evaluate(t)}],[[Rt],(t,e)=>{let[n]=e;return-n.evaluate(t)}]]},"/":[Rt,[Rt,Rt],(t,e)=>{let[n,i]=e;return n.evaluate(t)/i.evaluate(t)}],"%":[Rt,[Rt,Rt],(t,e)=>{let[n,i]=e;return n.evaluate(t)%i.evaluate(t)}],ln2:[Rt,[],()=>Math.LN2],pi:[Rt,[],()=>Math.PI],e:[Rt,[],()=>Math.E],"^":[Rt,[Rt,Rt],(t,e)=>{let[n,i]=e;return Math.pow(n.evaluate(t),i.evaluate(t))}],sqrt:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.sqrt(n.evaluate(t))}],log10:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))/Math.LN10}],ln:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))}],log2:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.log(n.evaluate(t))/Math.LN2}],sin:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.sin(n.evaluate(t))}],cos:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.cos(n.evaluate(t))}],tan:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.tan(n.evaluate(t))}],asin:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.asin(n.evaluate(t))}],acos:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.acos(n.evaluate(t))}],atan:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.atan(n.evaluate(t))}],min:[Rt,Ri(Rt),(t,e)=>Math.min(...e.map(e=>e.evaluate(t)))],max:[Rt,Ri(Rt),(t,e)=>Math.max(...e.map(e=>e.evaluate(t)))],abs:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.abs(n.evaluate(t))}],round:[Rt,[Rt],(t,e)=>{let[n]=e;const i=n.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.floor(n.evaluate(t))}],ceil:[Rt,[Rt],(t,e)=>{let[n]=e;return Math.ceil(n.evaluate(t))}],"filter-==":[Ot,[Ft,Gt],(t,e)=>{let[n,i]=e;return t.properties()[n.value]===i.value}],"filter-id-==":[Ot,[Gt],(t,e)=>{let[n]=e;return t.id()===n.value}],"filter-type-==":[Ot,[Ft],(t,e)=>{let[n]=e;return t.geometryType()===n.value}],"filter-<":[Ot,[Ft,Gt],(t,e)=>{let[n,i]=e;const r=t.properties()[n.value],a=i.value;return typeof r==typeof a&&r<a}],"filter-id-<":[Ot,[Gt],(t,e)=>{let[n]=e;const i=t.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[Ot,[Ft,Gt],(t,e)=>{let[n,i]=e;const r=t.properties()[n.value],a=i.value;return typeof r==typeof a&&r>a}],"filter-id->":[Ot,[Gt],(t,e)=>{let[n]=e;const i=t.id(),r=n.value;return typeof i==typeof r&&i>r}],"filter-<=":[Ot,[Ft,Gt],(t,e)=>{let[n,i]=e;const r=t.properties()[n.value],a=i.value;return typeof r==typeof a&&r<=a}],"filter-id-<=":[Ot,[Gt],(t,e)=>{let[n]=e;const i=t.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[Ot,[Ft,Gt],(t,e)=>{let[n,i]=e;const r=t.properties()[n.value],a=i.value;return typeof r==typeof a&&r>=a}],"filter-id->=":[Ot,[Gt],(t,e)=>{let[n]=e;const i=t.id(),r=n.value;return typeof i==typeof r&&i>=r}],"filter-has":[Ot,[Gt],(t,e)=>{let[n]=e;return n.value in t.properties()}],"filter-has-id":[Ot,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Ot,[Kt(Ft)],(t,e)=>{let[n]=e;return n.value.indexOf(t.geometryType())>=0}],"filter-id-in":[Ot,[Kt(Gt)],(t,e)=>{let[n]=e;return n.value.indexOf(t.id())>=0}],"filter-in-small":[Ot,[Ft,Kt(Gt)],(t,e)=>{let[n,i]=e;return i.value.indexOf(t.properties()[n.value])>=0}],"filter-in-large":[Ot,[Ft,Kt(Gt)],(t,e)=>{let[n,i]=e;return function(t,e,n,i){for(;n<=i;){const r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[n.value],i.value,0,i.value.length-1)}],all:{type:Ot,overloads:[[[Ot,Ot],(t,e)=>{let[n,i]=e;return n.evaluate(t)&&i.evaluate(t)}],[Ri(Ot),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Ot,overloads:[[[Ot,Ot],(t,e)=>{let[n,i]=e;return n.evaluate(t)||i.evaluate(t)}],[Ri(Ot),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Ot,[Ot],(t,e)=>{let[n]=e;return!n.evaluate(t)}],"is-supported-script":[Ot,[Ft],(t,e)=>{let[n]=e;const i=t.globals&&t.globals.isSupportedScript;return!i||i(n.evaluate(t))}],upcase:[Ft,[Ft],(t,e)=>{let[n]=e;return n.evaluate(t).toUpperCase()}],downcase:[Ft,[Ft],(t,e)=>{let[n]=e;return n.evaluate(t).toLowerCase()}],concat:[Ft,Ri(Gt),(t,e)=>e.map(e=>qe(e.evaluate(t))).join("")],"resolved-locale":[Ft,[qt],(t,e)=>{let[n]=e;return n.evaluate(t).resolvedLocale()}]});class er{constructor(t,e,n){this.expression=t,this._warningHistory={},this._evaluator=new Ke,this._defaultValue=e?function(t){if("color"===t.type&&Hi(t.default))return new ke(0,0,0,0);switch(t.type){case"color":return ke.parse(t.default)||null;case"padding":return Le.parse(t.default)||null;case"numberArray":return ze.parse(t.default)||null;case"colorArray":return Ne.parse(t.default)||null;case"variableAnchorOffsetCollection":return Fe.parse(t.default)||null;case"projectionDefinition":return Be.parse(t.default)||null;default:return void 0===t.default?null:t.default}}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null,this._globalState=n}evaluateWithoutErrorHandling(t,e,n,i,r,a){return this._globalState&&(t=ur(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,i,r,a){this._globalState&&(t=ur(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new De("Expected value to be one of ".concat(Object.keys(this._enumValues).map(t=>JSON.stringify(t)).join(", "),", but found ").concat(JSON.stringify(t)," instead."));return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function nr(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Ii}function ir(t,e,n){const i=new Je(Ii,Fi,[],e?function(t){const e={color:Bt,string:Ft,number:Rt,enum:Ft,boolean:Ot,formatted:Vt,padding:Zt,numberArray:Ht,colorArray:Wt,projectionDefinition:jt,resolvedImage:Xt,variableAnchorOffsetCollection:Yt};return"array"===t.type?Kt(e[t.value]||Gt,t.length):e[t.type]}(e):void 0),r=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?Ui(new er(r,e,n)):Gi(i.errors)}class rr{constructor(t,e,n){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Bi(e.expression),this.globalStateRefs=cr(e.expression),this._globalState=n}evaluateWithoutErrorHandling(t,e,n,i,r,a){return this._globalState&&(t=ur(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,a)}evaluate(t,e,n,i,r,a){return this._globalState&&(t=ur(t,this._globalState)),this._styleExpression.evaluate(t,e,n,i,r,a)}}class ar{constructor(t,e,n,i,r){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Bi(e.expression),this.globalStateRefs=cr(e.expression),this.interpolationType=i,this._globalState=r}evaluateWithoutErrorHandling(t,e,n,i,r,a){return this._globalState&&(t=ur(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,a)}evaluate(t,e,n,i,r,a){return this._globalState&&(t=ur(t,this._globalState)),this._styleExpression.evaluate(t,e,n,i,r,a)}interpolationFactor(t,e,n){return this.interpolationType?pn.interpolationFactor(this.interpolationType,t,e,n):0}}function sr(t,e,n){const i=ir(t,e,n);if("error"===i.result)return i;const r=i.value.expression,a=Oi(r);if(!a&&!qi(e))return Gi([new zt("","data expressions not supported")]);const s=ji(r,["zoom"]);if(!s&&!Vi(e))return Gi([new zt("","zoom expressions not supported")]);const o=lr(r);return o||s?o instanceof zt?Gi([o]):o instanceof pn&&!Zi(e)?Gi([new zt("",'"interpolate" expressions cannot be used with this property')]):Ui(o?new ar(a?"camera":"composite",i.value,o.labels,o instanceof pn?o.interpolation:void 0,n):new rr(a?"constant":"source",i.value,n)):Gi([new zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class or{constructor(t,e){this._parameters=t,this._specification=e,Lt(this,Yi(this._parameters,this._specification))}static deserialize(t){return new or(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function lr(t){let e=null;if(t instanceof $e)e=lr(t.result);else if(t instanceof _n){for(const n of t.args)if(e=lr(n),e)break}else(t instanceof ln||t instanceof pn)&&t.input instanceof Li&&"zoom"===t.input.name&&(e=t);return e instanceof zt||t.eachChild(t=>{const n=lr(t);n instanceof zt?e=n:!e&&n?e=new zt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new zt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function cr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;return t instanceof Ci&&e.add(t.key),t.eachChild(t=>{cr(t,e)}),e}function ur(t,e){const{zoom:n,heatmapDensity:i,elevation:r,lineProgress:a,isSupportedScript:s,accumulated:o}=null!=t?t:{};return{zoom:n,heatmapDensity:i,elevation:r,lineProgress:a,isSupportedScript:s,accumulated:o,globalState:e}}function hr(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!hr(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const dr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function fr(t,e){if(null==t)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};hr(t)||(t=gr(t));const n=ir(t,dr,e);if("error"===n.result)throw new Error(n.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));return{filter:(t,e,i)=>n.value.evaluate(t,e,{},i),needGeometry:mr(t),getGlobalStateRefs:()=>cr(n.value.expression)}}function pr(t,e){return t<e?-1:t>e?1:0}function mr(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let e=1;e<t.length;e++)if(mr(t[e]))return!0;return!1}function gr(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?_r(t[1],t[2],"=="):"!="===e?br(_r(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?_r(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(gr))):"all"===e?["all"].concat(t.slice(1).map(gr)):"none"===e?["all"].concat(t.slice(1).map(gr).map(br)):"in"===e?yr(t[1],t.slice(2)):"!in"===e?br(yr(t[1],t.slice(2))):"has"===e?vr(t[1]):"!has"!==e||br(vr(t[1]));var n}function _r(t,e,n){switch(t){case"$type":return["filter-type-".concat(n),e];case"$id":return["filter-id-".concat(n),e];default:return["filter-".concat(n),t,e]}}function yr(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",t,["literal",e.sort(pr)]]:["filter-in-small",t,["literal",e]]}}function vr(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function br(t){return["!",t]}function xr(t){const e=typeof t;if("number"===e||"boolean"===e||"string"===e||null==t)return JSON.stringify(t);if(Array.isArray(t)){let e="[";for(const n of t)e+="".concat(xr(n),",");return"".concat(e,"]")}const n=Object.keys(t).sort();let i="{";for(let r=0;r<n.length;r++)i+="".concat(JSON.stringify(n[r]),":").concat(xr(t[n[r]]),",");return"".concat(i,"}")}function wr(t){let e="";for(const n of bt)e+="/".concat(xr(t[n]));return e}function Sr(t){const e=t.value;return e?[new It(t.key,e,"constants have been deprecated as of v8")]:[]}function Pr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Mr(t){if(Array.isArray(t))return t.map(Mr);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Mr(t[n]);return e}return Pr(t)}function Ar(t){const e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},a=t.style,s=t.styleSpec,o=t.validateSpec;let l=[];const c=Wi(n);if("object"!==c)return[new It(e,n,"object expected, ".concat(c," found"))];for(const u in n){const t=u.split(".")[0],c=ve(i,t)||i["*"];let h;if(ve(r,t))h=r[t];else if(ve(i,t))h=o;else if(r["*"])h=r["*"];else{if(!i["*"]){l.push(new It(e,n[u],'unknown property "'.concat(u,'"')));continue}h=o}l=l.concat(h({key:(e?"".concat(e,"."):e)+u,value:n[u],valueSpec:c,style:a,styleSpec:s,object:n,objectKey:u,validateSpec:o},n))}for(const u in i)r[u]||i[u].required&&void 0===i[u].default&&void 0===n[u]&&l.push(new It(e,n,'missing required property "'.concat(u,'"')));return l}function kr(t){const e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,a=t.key,s=t.arrayElementValidator||t.validateSpec;if("array"!==Wi(e))return[new It(a,e,"array expected, ".concat(Wi(e)," found"))];if(n.length&&e.length!==n.length)return[new It(a,e,"array length ".concat(n.length," expected, length ").concat(e.length," found"))];if(n["min-length"]&&e.length<n["min-length"])return[new It(a,e,"array length at least ".concat(n["min-length"]," expected, length ").concat(e.length," found"))];let o={type:n.value,values:n.values};r.$version<7&&(o.function=n.function),"object"===Wi(n.value)&&(o=n.value);let l=[];for(let c=0;c<e.length;c++)l=l.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:o,validateSpec:t.validateSpec,style:i,styleSpec:r,key:"".concat(a,"[").concat(c,"]")}));return l}function Er(t){const e=t.key,n=t.value,i=t.valueSpec;let r=Wi(n);return"number"===r&&n!=n&&(r="NaN"),"number"!==r?[new It(e,n,"number expected, ".concat(r," found"))]:"minimum"in i&&n<i.minimum?[new It(e,n,"".concat(n," is less than the minimum value ").concat(i.minimum))]:"maximum"in i&&n>i.maximum?[new It(e,n,"".concat(n," is greater than the maximum value ").concat(i.maximum))]:[]}function Tr(t){const e=t.valueSpec,n=Pr(t.value.type);let i,r,a,s={};const o="categorical"!==n&&void 0===t.value.property,l=!o,c="array"===Wi(t.value.stops)&&"array"===Wi(t.value.stops[0])&&"object"===Wi(t.value.stops[0][0]),u=Ar({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new It(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const i=t.value;return e=e.concat(kr({key:t.key,value:i,valueSpec:t.valueSpec,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Wi(i)&&0===i.length&&e.push(new It(t.key,i,"array must have at least one stop")),e},default:function(t){return t.validateSpec({key:t.key,value:t.value,valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&o&&u.push(new It(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||u.push(new It(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Zi(t.valueSpec)&&u.push(new It(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!qi(t.valueSpec)?u.push(new It(t.key,t.value,"property functions not supported")):o&&!Vi(t.valueSpec)&&u.push(new It(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!c||void 0!==t.value.property||u.push(new It(t.key,t.value,'"property" property is required')),u;function h(t){let n=[];const i=t.value,o=t.key;if("array"!==Wi(i))return[new It(o,i,"array expected, ".concat(Wi(i)," found"))];if(2!==i.length)return[new It(o,i,"array length 2 expected, length ".concat(i.length," found"))];if(c){if("object"!==Wi(i[0]))return[new It(o,i,"object expected, ".concat(Wi(i[0])," found"))];if(void 0===i[0].zoom)return[new It(o,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new It(o,i,"object stop key must have value")];if(a&&a>Pr(i[0].zoom))return[new It(o,i[0].zoom,"stop zoom values must appear in ascending order")];Pr(i[0].zoom)!==a&&(a=Pr(i[0].zoom),r=void 0,s={}),n=n.concat(Ar({key:"".concat(o,"[0]"),value:i[0],valueSpec:{zoom:{}},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Er,value:d}}))}else n=n.concat(d({key:"".concat(o,"[0]"),value:i[0],validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec},i));return nr(Mr(i[1]))?n.concat([new It("".concat(o,"[1]"),i[1],"expressions are not allowed in function stops.")]):n.concat(t.validateSpec({key:"".concat(o,"[1]"),value:i[1],valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec}))}function d(t,a){const o=Wi(t.value),l=Pr(t.value),c=null!==t.value?t.value:a;if(i){if(o!==i)return[new It(t.key,c,"".concat(o," stop domain type must match previous stop domain type ").concat(i))]}else i=o;if("number"!==o&&"string"!==o&&"boolean"!==o)return[new It(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==o&&"categorical"!==n){let i="number expected, ".concat(o," found");return qi(e)&&void 0===n&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(t.key,c,i)]}return"categorical"!==n||"number"!==o||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===o&&void 0!==r&&l<r?[new It(t.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===n&&l in s?[new It(t.key,c,"stop domain values must be unique")]:(s[l]=!0,[])):[new It(t.key,c,"integer expected, found ".concat(l))]}}function Cr(t){const e=("property"===t.expressionContext?sr:ir)(Mr(t.value),t.valueSpec);if("error"===e.result)return e.value.map(e=>new It("".concat(t.key).concat(e.key),t.value,e.message));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new It(t.key,t.value,'Invalid data expression for "'.concat(t.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Bi(n))return[new It(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Bi(n))return[new It(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ji(n,["zoom","feature-state"]))return[new It(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Oi(n))return[new It(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ir(t){const e=t.key,n=t.value,i=Wi(n);return"string"!==i?[new It(e,n,"color expected, ".concat(i," found"))]:ke.parse(String(n))?[]:[new It(e,n,'color expected, "'.concat(n,'" found'))]}function Lr(t){const e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(Pr(n))&&r.push(new It(e,n,"expected one of [".concat(i.values.join(", "),"], ").concat(JSON.stringify(n)," found"))):-1===Object.keys(i.values).indexOf(Pr(n))&&r.push(new It(e,n,"expected one of [".concat(Object.keys(i.values).join(", "),"], ").concat(JSON.stringify(n)," found"))),r}function zr(t){return hr(Mr(t.value))?Cr(Lt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Nr(t)}function Nr(t){const e=t.value,n=t.key;if("array"!==Wi(e))return[new It(n,e,"array expected, ".concat(Wi(e)," found"))];const i=t.styleSpec;let r,a=[];if(e.length<1)return[new It(n,e,"filter array must have at least 1 element")];switch(a=a.concat(Lr({key:"".concat(n,"[0]"),value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),Pr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Pr(e[1])&&a.push(new It(n,e,'"$type" cannot be use with operator "'.concat(e[0],'"')));case"==":case"!=":3!==e.length&&a.push(new It(n,e,'filter array for operator "'.concat(e[0],'" must have 3 elements')));case"in":case"!in":e.length>=2&&(r=Wi(e[1]),"string"!==r&&a.push(new It("".concat(n,"[1]"),e[1],"string expected, ".concat(r," found"))));for(let s=2;s<e.length;s++)r=Wi(e[s]),"$type"===Pr(e[1])?a=a.concat(Lr({key:"".concat(n,"[").concat(s,"]"),value:e[s],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new It("".concat(n,"[").concat(s,"]"),e[s],"string, number, or boolean expected, ".concat(r," found")));break;case"any":case"all":case"none":for(let i=1;i<e.length;i++)a=a.concat(Nr({key:"".concat(n,"[").concat(i,"]"),value:e[i],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=Wi(e[1]),2!==e.length?a.push(new It(n,e,'filter array for "'.concat(e[0],'" operator must have 2 elements'))):"string"!==r&&a.push(new It("".concat(n,"[1]"),e[1],"string expected, ".concat(r," found")))}return a}function Dr(t,e){const n=t.key,i=t.validateSpec,r=t.style,a=t.styleSpec,s=t.value,o=t.objectKey,l=a["".concat(e,"_").concat(t.layerType)];if(!l)return[];const c=o.match(/^(.*)-transition$/);if("paint"===e&&c&&l[c[1]]&&l[c[1]].transition)return i({key:n,value:s,valueSpec:a.transition,style:r,styleSpec:a});const u=t.valueSpec||l[o];if(!u)return[new It(n,s,'unknown property "'.concat(o,'"'))];let h;if("string"===Wi(s)&&qi(u)&&!u.tokens&&(h=/^{([^}]+)}$/.exec(s)))return[new It(n,s,'"'.concat(o,'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ').concat(JSON.stringify(h[1])," }`."))];const d=[];return"symbol"===t.layerType&&("text-field"===o&&r&&!r.glyphs&&d.push(new It(n,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&Hi(Mr(s))&&"identity"===Pr(s.type)&&d.push(new It(n,s,'"text-font" does not support identity functions'))),d.concat(i({key:t.key,value:s,valueSpec:u,style:r,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:o}))}function Rr(t){return Dr(t,"paint")}function Fr(t){return Dr(t,"layout")}function Or(t){let e=[];const n=t.value,i=t.key,r=t.style,a=t.styleSpec;if("object"!==Wi(n))return[new It(i,n,"object expected, ".concat(Wi(n)," found"))];n.type||n.ref||e.push(new It(i,n,'either "type" or "ref" is required'));let s=Pr(n.type);const o=Pr(n.ref);if(n.id){const a=Pr(n.id);for(let s=0;s<t.arrayIndex;s++){const t=r.layers[s];Pr(t.id)===a&&e.push(new It(i,n.id,'duplicate layer id "'.concat(n.id,'", previously used at line ').concat(t.id.__line__)))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach(t=>{t in n&&e.push(new It(i,n[t],'"'.concat(t,'" is prohibited for ref layers')))}),r.layers.forEach(e=>{Pr(e.id)===o&&(t=e)}),t?t.ref?e.push(new It(i,n.ref,"ref cannot reference another ref layer")):s=Pr(t.type):e.push(new It(i,n.ref,'ref layer "'.concat(o,'" not found')))}else if("background"!==s)if(n.source){const t=r.sources&&r.sources[n.source],a=t&&Pr(t.type);t?"vector"===a&&"raster"===s?e.push(new It(i,n.source,'layer "'.concat(n.id,'" requires a raster source'))):"raster-dem"!==a&&"hillshade"===s||"raster-dem"!==a&&"color-relief"===s?e.push(new It(i,n.source,'layer "'.concat(n.id,'" requires a raster-dem source'))):"raster"===a&&"raster"!==s?e.push(new It(i,n.source,'layer "'.concat(n.id,'" requires a vector source'))):"vector"!==a||n["source-layer"]?"raster-dem"===a&&"hillshade"!==s&&"color-relief"!==s?e.push(new It(i,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===a&&t.lineMetrics||e.push(new It(i,n,'layer "'.concat(n.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):e.push(new It(i,n,'layer "'.concat(n.id,'" must specify a "source-layer"'))):e.push(new It(i,n.source,'source "'.concat(n.source,'" not found')))}else e.push(new It(i,n,'missing required property "source"'));return e=e.concat(Ar({key:i,value:n,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":()=>[],type:()=>t.validateSpec({key:"".concat(i,".type"),value:n.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:n,objectKey:"type"}),filter:zr,layout:t=>Ar({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Fr(Lt({layerType:s},t))}}),paint:t=>Ar({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Rr(Lt({layerType:s},t))}})}})),e}function Br(t){const e=t.value,n=t.key,i=Wi(e);return"string"!==i?[new It(n,e,"string expected, ".concat(i," found"))]:[]}const jr={promoteId:function(t){let{key:e,value:n}=t;if("string"===Wi(n))return Br({key:e,value:n});{const t=[];for(const i in n)t.push(...Br({key:"".concat(e,".").concat(i),value:n[i]}));return t}}};function Ur(t){const e=t.value,n=t.key,i=t.styleSpec,r=t.style,a=t.validateSpec;if(!e.type)return[new It(n,e,'"type" is required')];const s=Pr(e.type);let o;switch(s){case"vector":case"raster":return o=Ar({key:n,value:e,valueSpec:i["source_".concat(s.replace("-","_"))],style:t.style,styleSpec:i,objectElementValidators:jr,validateSpec:a}),o;case"raster-dem":return o=function(t){var e;const n=null!==(e=t.sourceName)&&void 0!==e?e:"",i=t.value,r=t.styleSpec,a=r.source_raster_dem,s=t.style;let o=[];const l=Wi(i);if(void 0===i)return o;if("object"!==l)return o.push(new It("source_raster_dem",i,"object expected, ".concat(l," found"))),o;const c="custom"===Pr(i.encoding),u=["redFactor","greenFactor","blueFactor","baseShift"],h=t.value.encoding?'"'.concat(t.value.encoding,'"'):"Default";for(const d in i)!c&&u.includes(d)?o.push(new It(d,i[d],'In "'.concat(n,'": "').concat(d,'" is only valid when "encoding" is set to "custom". ').concat(h," encoding found"))):a[d]?o=o.concat(t.validateSpec({key:d,value:i[d],valueSpec:a[d],validateSpec:t.validateSpec,style:s,styleSpec:r})):o.push(new It(d,i[d],'unknown property "'.concat(d,'"')));return o}({sourceName:n,value:e,style:t.style,styleSpec:i,validateSpec:a}),o;case"geojson":if(o=Ar({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i,validateSpec:a,objectElementValidators:jr}),e.cluster)for(const t in e.clusterProperties){const[i,r]=e.clusterProperties[t],a="string"==typeof i?[i,["accumulated"],["get",t]]:i;o.push(...Cr({key:"".concat(n,".").concat(t,".map"),value:r,expressionContext:"cluster-map"})),o.push(...Cr({key:"".concat(n,".").concat(t,".reduce"),value:a,expressionContext:"cluster-reduce"}))}return o;case"video":return Ar({key:n,value:e,valueSpec:i.source_video,style:r,validateSpec:a,styleSpec:i});case"image":return Ar({key:n,value:e,valueSpec:i.source_image,style:r,validateSpec:a,styleSpec:i});case"canvas":return[new It(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lr({key:"".concat(n,".type"),value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Gr(t){const e=t.value,n=t.styleSpec,i=n.light,r=t.style;let a=[];const s=Wi(e);if(void 0===e)return a;if("object"!==s)return a=a.concat([new It("light",e,"object expected, ".concat(s," found"))]),a;for(const o in e){const s=o.match(/^(.*)-transition$/);a=a.concat(s&&i[s[1]]&&i[s[1]].transition?t.validateSpec({key:o,value:e[o],valueSpec:n.transition,validateSpec:t.validateSpec,style:r,styleSpec:n}):i[o]?t.validateSpec({key:o,value:e[o],valueSpec:i[o],validateSpec:t.validateSpec,style:r,styleSpec:n}):[new It(o,e[o],'unknown property "'.concat(o,'"'))])}return a}function qr(t){const e=t.value,n=t.styleSpec,i=n.sky,r=t.style,a=Wi(e);if(void 0===e)return[];if("object"!==a)return[new It("sky",e,"object expected, ".concat(a," found"))];let s=[];for(const o in e)s=s.concat(i[o]?t.validateSpec({key:o,value:e[o],valueSpec:i[o],style:r,styleSpec:n}):[new It(o,e[o],'unknown property "'.concat(o,'"'))]);return s}function Vr(t){const e=t.value,n=t.styleSpec,i=n.terrain,r=t.style;let a=[];const s=Wi(e);if(void 0===e)return a;if("object"!==s)return a=a.concat([new It("terrain",e,"object expected, ".concat(s," found"))]),a;for(const o in e)a=a.concat(i[o]?t.validateSpec({key:o,value:e[o],valueSpec:i[o],validateSpec:t.validateSpec,style:r,styleSpec:n}):[new It(o,e[o],'unknown property "'.concat(o,'"'))]);return a}function Zr(t){let e=[];const n=t.value,i=t.key;if(Array.isArray(n)){const r=[],a=[];for(const s in n)n[s].id&&r.includes(n[s].id)&&e.push(new It(i,n,"all the sprites' ids must be unique, but ".concat(n[s].id," is duplicated"))),r.push(n[s].id),n[s].url&&a.includes(n[s].url)&&e.push(new It(i,n,"all the sprites' URLs must be unique, but ".concat(n[s].url," is duplicated"))),a.push(n[s].url),e=e.concat(Ar({key:"".concat(i,"[").concat(s,"]"),value:n[s],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:t.validateSpec}));return e}return Br({key:i,value:n})}function Wr(t){return e=t.value,Boolean(e)&&e.constructor===Object?[]:[new It(t.key,t.value,"object expected, ".concat(Wi(t.value)," found"))];var e}const Hr={"*":()=>[],array:kr,boolean:function(t){const e=t.value,n=t.key,i=Wi(e);return"boolean"!==i?[new It(n,e,"boolean expected, ".concat(i," found"))]:[]},number:Er,color:Ir,constants:Sr,enum:Lr,filter:zr,function:Tr,layer:Or,object:Ar,source:Ur,light:Gr,sky:qr,terrain:Vr,projection:function(t){const e=t.value,n=t.styleSpec,i=n.projection,r=t.style,a=Wi(e);if(void 0===e)return[];if("object"!==a)return[new It("projection",e,"object expected, ".concat(a," found"))];let s=[];for(const o in e)s=s.concat(i[o]?t.validateSpec({key:o,value:e[o],valueSpec:i[o],style:r,styleSpec:n}):[new It(o,e[o],'unknown property "'.concat(o,'"'))]);return s},projectionDefinition:function(t){const e=t.key;let n=t.value;n=n instanceof String?n.valueOf():n;const i=Wi(n);return"array"!==i||function(t){return Array.isArray(t)&&3===t.length&&"string"==typeof t[0]&&"string"==typeof t[1]&&"number"==typeof t[2]}(n)||function(t){return!!["interpolate","step","literal"].includes(t[0])}(n)?["array","string"].includes(i)?[]:[new It(e,n,'projection expected, invalid type "'.concat(i,'" found'))]:[new It(e,n,"projection expected, invalid array ".concat(JSON.stringify(n)," found"))]},string:Br,formatted:function(t){return 0===Br(t).length?[]:Cr(t)},resolvedImage:function(t){return 0===Br(t).length?[]:Cr(t)},padding:function(t){const e=t.key,n=t.value;if("array"===Wi(n)){if(n.length<1||n.length>4)return[new It(e,n,"padding requires 1 to 4 values; ".concat(n.length," values found"))];const i={type:"number"};let r=[];for(let a=0;a<n.length;a++)r=r.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:n[a],validateSpec:t.validateSpec,valueSpec:i}));return r}return Er({key:e,value:n,valueSpec:{}})},numberArray:function(t){const e=t.key,n=t.value;if("array"===Wi(n)){const i={type:"number"};if(n.length<1)return[new It(e,n,"array length at least 1 expected, length 0 found")];let r=[];for(let a=0;a<n.length;a++)r=r.concat(t.validateSpec({key:"".concat(e,"[").concat(a,"]"),value:n[a],validateSpec:t.validateSpec,valueSpec:i}));return r}return Er({key:e,value:n,valueSpec:{}})},colorArray:function(t){const e=t.key,n=t.value;if("array"===Wi(n)){if(n.length<1)return[new It(e,n,"array length at least 1 expected, length 0 found")];let t=[];for(let i=0;i<n.length;i++)t=t.concat(Ir({key:"".concat(e,"[").concat(i,"]"),value:n[i]}));return t}return Ir({key:e,value:n})},variableAnchorOffsetCollection:function(t){const e=t.key,n=t.value,i=Wi(n),r=t.styleSpec;if("array"!==i||n.length<1||n.length%2!=0)return[new It(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let s=0;s<n.length;s+=2)a=a.concat(Lr({key:"".concat(e,"[").concat(s,"]"),value:n[s],valueSpec:r.layout_symbol["text-anchor"]})),a=a.concat(kr({key:"".concat(e,"[").concat(s+1,"]"),value:n[s+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:r}));return a},sprite:Zr,state:Wr};function Xr(t){const e=t.value,n=t.valueSpec,i=t.styleSpec;return t.validateSpec=Xr,n.expression&&Hi(Pr(e))?Tr(t):n.expression&&nr(Mr(e))?Cr(t):n.type&&Hr[n.type]?Hr[n.type](t):Ar(Lt({},t,{valueSpec:n.type?i[n.type]:n}))}function Yr(t){const e=t.value,n=t.key,i=Br(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new It(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new It(n,e,'"glyphs" url must include a "{range}" token'))),i}function Kr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vt,n=[];return n=n.concat(Xr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:Xr,objectElementValidators:{glyphs:Yr,"*":()=>[]}})),t.constants&&(n=n.concat(Sr({key:"constants",value:t.constants}))),$r(n)}function Jr(t){return function(e){return t(i(i({},e),{},{validateSpec:Xr}))}}function $r(t){return[].concat(t).sort((t,e)=>t.line-e.line)}function Qr(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return $r(t.apply(this,n))}}Kr.source=Qr(Jr(Ur)),Kr.sprite=Qr(Jr(Zr)),Kr.glyphs=Qr(Jr(Yr)),Kr.light=Qr(Jr(Gr)),Kr.sky=Qr(Jr(qr)),Kr.terrain=Qr(Jr(Vr)),Kr.state=Qr(Jr(Wr)),Kr.layer=Qr(Jr(Or)),Kr.filter=Qr(Jr(zr)),Kr.paintProperty=Qr(Jr(Rr)),Kr.layoutProperty=Qr(Jr(Fr));const ta=Kr,ea=ta.light,na=ta.sky,ia=ta.paintProperty,ra=ta.layoutProperty;function aa(t,e){let n=!1;if(e&&e.length)for(const i of e)t.fire(new _t(new Error(i.message))),n=!0;return n}class sa{constructor(t,e,n){const i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(n=r[2]);for(let t=0;t<this.d*this.d;t++){const e=r[3+t],n=r[3+t+1];i.push(e===n?null:r.subarray(e,n))}const a=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],a),this.bboxes=r.subarray(a),this.insert=this._insertReadonly}else{this.d=e+2*n;for(let t=0;t<this.d*this.d;t++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;const r=n/e*t;this.min=-r,this.max=t+r}insert(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,e,n,i,r,a){this.cells[r].push(a)}query(t,e,n,i,r){const a=this.min,s=this.max;if(t<=a&&e<=a&&s<=n&&s<=i&&!r)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(t,e,n,i,this._queryCell,a,{},r),a}}_queryCell(t,e,n,i,r,a,s,o){const l=this.cells[r];if(null!==l){const r=this.keys,c=this.bboxes;for(let u=0;u<l.length;u++){const h=l[u];if(void 0===s[h]){const l=4*h;(o?o(c[l+0],c[l+1],c[l+2],c[l+3]):t<=c[l+2]&&e<=c[l+3]&&n>=c[l+0]&&i>=c[l+1])?(s[h]=!0,a.push(r[h])):s[h]=!1}}}}_forEachCell(t,e,n,i,r,a,s,o){const l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(n),h=this._convertToCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++){const c=this.d*l+d;if((!o||o(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&r.call(this,t,e,n,i,c,a,s,o))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,e=3+this.cells.length+1+1;let n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;const i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let r=e;for(let a=0;a<t.length;a++){const e=t[a];i[3+a]=r,i.set(e,r),r+=e.length}return i[3+t.length]=r,i.set(this.keys,r),r+=this.keys.length,i[3+t.length+1]=r,i.set(this.bboxes,r),r+=this.bboxes.length,i.buffer}static serialize(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}}static deserialize(t){return new sa(t.buffer)}}const oa={};function la(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(oa[t])throw new Error("".concat(t," is already registered."));Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),oa[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}la("Object",Object),la("Set",Set),la("TransferableGridIndex",sa),la("Color",ke),la("Error",Error),la("AJAXError",ut),la("ResolvedImage",Oe),la("StylePropertyFunction",or),la("StyleExpression",er,{omit:["_evaluator"]}),la("ZoomDependentExpression",ar),la("ZoomConstantExpression",rr),la("CompoundExpression",Li,{omit:["_evaluate"]});for(const i in Ii)Ii[i]._classRegistryKey||la("Expression_".concat(i),Ii[i]);function ca(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function ua(t){return t.$name||t.constructor._classRegistryKey}function ha(t){return!function(t){if(null===t||"object"!=typeof t)return!1;const e=ua(t);return!(!e||"Object"===e)}(t)&&(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||ca(t)||Y(t)||ArrayBuffer.isView(t)||t instanceof ImageData)}function da(t,e){if(ha(t))return(ca(t)||Y(t))&&e&&e.push(t),ArrayBuffer.isView(t)&&e&&e.push(t.buffer),t instanceof ImageData&&e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const i of t)n.push(da(i,e));return n}if("object"!=typeof t)throw new Error("can't serialize object of type "+typeof t);const n=ua(t);if(!n)throw new Error("can't serialize object of unregistered class ".concat(t.constructor.name));if(!oa[n])throw new Error("".concat(n," is not registered."));const{klass:i}=oa[n],r=i.serialize?i.serialize(t,e):{};if(i.serialize){if(e&&r===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const i in t){if(!t.hasOwnProperty(i))continue;if(oa[n].omit.indexOf(i)>=0)continue;const a=t[i];r[i]=oa[n].shallow.indexOf(i)>=0?a:da(a,e)}t instanceof Error&&(r.message=t.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(r.$name=n),r}function fa(t){if(ha(t))return t;if(Array.isArray(t))return t.map(fa);if("object"!=typeof t)throw new Error("can't deserialize object of type "+typeof t);const e=ua(t)||"Object";if(!oa[e])throw new Error("can't deserialize unregistered class ".concat(e));const{klass:n}=oa[e];if(!n)throw new Error("can't deserialize unregistered class ".concat(e));if(n.deserialize)return n.deserialize(t);const i=Object.create(n.prototype);for(const r of Object.keys(t)){if("$name"===r)continue;const n=t[r];i[r]=oa[e].shallow.indexOf(r)>=0?n:fa(n)}return i}class pa{constructor(){this.first=!0}update(t,e){const n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))}}const ma={"Latin-1 Supplement":t=>t>=128&&t<=255,"Hangul Jamo":t=>t>=4352&&t<=4607,Khmer:t=>t>=6016&&t<=6143,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Kanbun:t=>t>=12688&&t<=12703,"CJK Strokes":t=>t>=12736&&t<=12783,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Hangul Syllables":t=>t>=44032&&t<=55215,"Private Use Area":t=>t>=57344&&t<=63743,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function ga(t){for(const e of t)if(wa(e.charCodeAt(0)))return!0;return!1}function _a(t){for(const e of t)if(!ba(e.charCodeAt(0)))return!1;return!0}function ya(t){const e=t.map(t=>{try{return new RegExp("\\p{sc=".concat(t,"}"),"u").source}catch(t){return null}}).filter(t=>t);return new RegExp(e.join("|"),"u")}const va=ya(["Arab","Dupl","Mong","Ougr","Syrc"]);function ba(t){return!va.test(String.fromCodePoint(t))}const xa=ya(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function wa(t){return!(746!==t&&747!==t&&(t<4352||!(ma["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||ma["CJK Compatibility"](t)||ma["CJK Strokes"](t)||!(!ma["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||ma["Enclosed CJK Letters and Months"](t)||ma["Ideographic Description Characters"](t)||ma.Kanbun(t)||ma.Katakana(t)&&12540!==t||!(!ma["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!ma["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||ma["Vertical Forms"](t)||ma["Yijing Hexagram Symbols"](t)||/(?:[\u1400-\u167F\u18B0-\u18F5]|\uD806[\uDEB0-\uDEBF])/.test(String.fromCodePoint(t))||/[\u1100-\u11FF\u302E\u302F\u3131-\u318E\u3200-\u321E\u3260-\u327E\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/.test(String.fromCodePoint(t))||xa.test(String.fromCodePoint(t)))))}function Sa(t){return!(wa(t)||function(t){return!!(ma["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||ma["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||ma["Letterlike Symbols"](t)||ma["Number Forms"](t)||ma["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||ma["Control Pictures"](t)&&9251!==t||ma["Optical Character Recognition"](t)||ma["Enclosed Alphanumerics"](t)||ma["Geometric Shapes"](t)||ma["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ma["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ma["CJK Symbols and Punctuation"](t)||ma.Katakana(t)||ma["Private Use Area"](t)||ma["CJK Compatibility Forms"](t)||ma["Small Form Variants"](t)||ma["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}const Pa=ya(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Ma(t){return Pa.test(String.fromCodePoint(t))}function Aa(t,e){return!(!e&&Ma(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||ma.Khmer(t))}function ka(t){for(const e of t)if(Ma(e.charCodeAt(0)))return!0;return!1}const Ea=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(t){this.pluginStatus=t.pluginStatus,this.pluginURL=t.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(t){if(Ea.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=t.applyArabicShaping,this.processBidirectionalText=t.processBidirectionalText,this.processStyledBidirectionalText=t.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getRTLTextPluginStatus(){return this.pluginStatus}syncState(t,n){return e(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if("loading"!==t.pluginStatus)return this.setState(t),t;const e=t.pluginURL,i=new Promise(t=>{this.loadScriptResolve=t});n(e);const r=new Promise(t=>setTimeout(()=>t(),this.TIMEOUT));if(yield Promise.race([i,r]),this.isParsed()){const t={pluginStatus:"loaded",pluginURL:e};return this.setState(t),t}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from ".concat(e))})}};class Ta{constructor(t,e){this.isSupportedScript=Ca,this.zoom=t,e?(this.now=e.now||0,this.fadeDuration=e.fadeDuration||0,this.zoomHistory=e.zoomHistory||new pa,this.transition=e.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pa,this.transition={})}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}}}function Ca(t){return function(t,e){for(const n of t)if(!Aa(n.charCodeAt(0),e))return!1;return!0}(t,"loaded"===Ea.getRTLTextPluginStatus())}class Ia{constructor(t,e,n){this.property=t,this.value=e,this.expression=function(t,e,n){if(Hi(t))return new or(t,e);if(nr(t)){const i=sr(t,e,n);if("error"===i.result)throw new Error(i.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));return i.value}{let n=t;return"color"===e.type&&"string"==typeof t?n=ke.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)?"numberArray"!==e.type||"number"!=typeof t&&!Array.isArray(t)?"colorArray"!==e.type||"string"!=typeof t&&!Array.isArray(t)?"variableAnchorOffsetCollection"===e.type&&Array.isArray(t)?n=Fe.parse(t):"projectionDefinition"===e.type&&"string"==typeof t&&(n=Be.parse(t)):n=Ne.parse(t):n=ze.parse(t):n=Le.parse(t),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification,n)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class La{constructor(t,e){this.property=t,this.value=new Ia(t,void 0,e)}transitioned(t,e){return new Na(this.property,this.value,e,B({},t.transition,this.transition),t.now)}untransitioned(){return new Na(this.property,this.value,null,{},0)}}class za{constructor(t,e){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=e}getValue(t){return q(this._values[t].value.value)}setValue(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new La(this._values[t].property,this._globalState)),this._values[t].value=new Ia(this._values[t].property,null===e?void 0:q(e),this._globalState)}getTransition(t){return q(this._values[t].transition)}setTransition(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new La(this._values[t].property,this._globalState)),this._values[t].transition=q(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const i=this.getTransition(e);void 0!==i&&(t["".concat(e,"-transition")]=i)}return t}transitioned(t,e){const n=new Da(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(t,e._values[i]);return n}untransitioned(){const t=new Da(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class Na{constructor(t,e,n,i,r){this.property=t,this.value=e,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const i=t.now||0,r=this.value.possiblyEvaluate(t,e,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return a.possiblyEvaluate(t,e,n);{const s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,n),r,N(s))}}return r}}class Da{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const i=new Oa(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ra{constructor(t,e){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=e}hasValue(t){return void 0!==this._values[t].value}getValue(t){return q(this._values[t].value)}setValue(t,e){this._values[t]=new Ia(this._values[t].property,null===e?void 0:q(e),this._globalState)}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const i=new Oa(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}}class Fa{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,i){return this.property.evaluate(this.value,this.parameters,t,e,n,i)}}class Oa{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ba{constructor(t){this.specification=t}possiblyEvaluate(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}interpolate(t,e,n){const i=gn[this.specification.type];return i?i(t,e,n):t}}class ja{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,i){return new Fa(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,i)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Fa(this,{kind:"constant",value:void 0},t.parameters);const i=gn[this.specification.type];if(i){const r=i(t.value.value,e.value.value,n);return new Fa(this,{kind:"constant",value:r},t.parameters)}return t}evaluate(t,e,n,i,r,a){return"constant"===t.kind?t.value:t.evaluate(e,n,i,r,a)}}class Ua extends ja{possiblyEvaluate(t,e,n,i){if(void 0===t.value)return new Fa(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i),a="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,s=this._calculate(a,a,a,e);return new Fa(this,{kind:"constant",value:s},e)}if("camera"===t.expression.kind){const n=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new Fa(this,{kind:"constant",value:n},e)}return new Fa(this,t.expression,e)}evaluate(t,e,n,i,r,a){if("source"===t.kind){const s=t.evaluate(e,n,i,r,a);return this._calculate(s,s,s,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,i),t.evaluate({zoom:Math.floor(e.zoom)},n,i),t.evaluate({zoom:Math.floor(e.zoom)+1},n,i),e):t.value}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class Ga{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){if(void 0!==t.value){if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new Ta(Math.floor(e.zoom-1),e)),t.expression.evaluate(new Ta(Math.floor(e.zoom),e)),t.expression.evaluate(new Ta(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class qa{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){return!!t.expression.evaluate(e,null,{},n,i)}interpolate(){return!1}}class Va{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const n=t[e];n.specification.overridable&&this.overridableProperties.push(e);const i=this.defaultPropertyValues[e]=new Ia(n,void 0,void 0),r=this.defaultTransitionablePropertyValues[e]=new La(n,void 0);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}}}la("DataDrivenProperty",ja),la("DataConstantProperty",Ba),la("CrossFadedDataDrivenProperty",Ua),la("CrossFadedProperty",Ga),la("ColorRampProperty",qa);const Za="-transition";class Wa extends yt{constructor(t,e,n){if(super(),this.id=t.id,this.type=t.type,this._globalState=n,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=fr(t.filter,n)),e.layout&&(this._unevaluatedLayout=new Ra(e.layout,n)),e.paint)){this._transitionablePaint=new za(e.paint,n);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Oa(e.paint)}}setFilter(t){this.filter=t,this._featureFilter=fr(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const e in this._unevaluatedLayout._values){const n=this._unevaluatedLayout._values[e];for(const e of n.getGlobalStateRefs())t.add(e)}for(const e of this._featureFilter.getGlobalStateRefs())t.add(e);return t}getPaintAffectingGlobalStateRefs(){var t;const e=new globalThis.Map;if(this._transitionablePaint)for(const n in this._transitionablePaint._values){const i=this._transitionablePaint._values[n].value;for(const r of i.getGlobalStateRefs()){const a=null!==(t=e.get(r))&&void 0!==t?t:[];a.push({name:n,value:i.value}),e.set(r,a)}}return e}setLayoutProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=e&&this._validate(ra,"layers.".concat(this.id,".layout.").concat(t),t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return t.endsWith(Za)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&this._validate(ia,"layers.".concat(this.id,".paint.").concat(t),t,e,n))return!1;if(t.endsWith(Za))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const n=this._transitionablePaint._values[t],i="cross-faded-data-driven"===n.property.specification["property-type"],r=n.value.isDataDriven(),a=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const s=this._transitionablePaint._values[t].value;return s.isDataDriven()||r||i||this._handleOverridablePaintPropertyUpdate(t,a,s)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),G(t,(t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length))}_validate(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!r||!1!==r.validate)&&aa(this,t.call(ta,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:vt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof Fa&&qi(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Ha={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Xa{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ya{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ka(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,i=0;return{members:t.map(t=>{const r=Ha[t.type].BYTES_PER_ELEMENT,a=n=Ja(n,Math.max(e,r)),s=t.components||1;return i=Math.max(i,r),n+=r*s,{name:t.name,type:t.type,components:s,offset:a}}),size:Ja(n,Math.max(i,e)),alignment:e}}function Ja(t,e){return Math.ceil(t/e)*e}class $a extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t}}$a.prototype.bytesPerElement=4,la("StructArrayLayout2i4",$a);class Qa extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,t}}Qa.prototype.bytesPerElement=6,la("StructArrayLayout3i6",Qa);class ts extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const a=4*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=r,t}}ts.prototype.bytesPerElement=8,la("StructArrayLayout4i8",ts);class es extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,s){const o=6*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=r,this.int16[o+4]=a,this.int16[o+5]=s,t}}es.prototype.bytesPerElement=12,la("StructArrayLayout2i4i12",es);class ns extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,s){const o=4*t,l=8*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.uint8[l+4]=i,this.uint8[l+5]=r,this.uint8[l+6]=a,this.uint8[l+7]=s,t}}ns.prototype.bytesPerElement=8,la("StructArrayLayout2i4ub8",ns);class is extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t}}is.prototype.bytesPerElement=8,la("StructArrayLayout2f8",is);class rs extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,s,o,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,a,s,o,l,c)}emplace(t,e,n,i,r,a,s,o,l,c,u){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=i,this.uint16[h+3]=r,this.uint16[h+4]=a,this.uint16[h+5]=s,this.uint16[h+6]=o,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,t}}rs.prototype.bytesPerElement=20,la("StructArrayLayout10ui20",rs);class as extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,s,o,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,i,r,a,s,o,l,c,u,h)}emplace(t,e,n,i,r,a,s,o,l,c,u,h,d){const f=12*t;return this.int16[f+0]=e,this.int16[f+1]=n,this.int16[f+2]=i,this.int16[f+3]=r,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=o,this.uint16[f+7]=l,this.int16[f+8]=c,this.int16[f+9]=u,this.int16[f+10]=h,this.int16[f+11]=d,t}}as.prototype.bytesPerElement=24,la("StructArrayLayout4i4ui4i24",as);class ss extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t}}ss.prototype.bytesPerElement=12,la("StructArrayLayout3f12",ss);class os extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}os.prototype.bytesPerElement=4,la("StructArrayLayout1ul4",os);class ls extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,s,o,l){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,i,r,a,s,o,l)}emplace(t,e,n,i,r,a,s,o,l,c){const u=10*t,h=5*t;return this.int16[u+0]=e,this.int16[u+1]=n,this.int16[u+2]=i,this.int16[u+3]=r,this.int16[u+4]=a,this.int16[u+5]=s,this.uint32[h+3]=o,this.uint16[u+8]=l,this.uint16[u+9]=c,t}}ls.prototype.bytesPerElement=20,la("StructArrayLayout6i1ul2ui20",ls);class cs extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,s){const o=6*t;return this.int16[o+0]=e,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=r,this.int16[o+4]=a,this.int16[o+5]=s,t}}cs.prototype.bytesPerElement=12,la("StructArrayLayout2i2i2i12",cs);class us extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r)}emplace(t,e,n,i,r,a){const s=4*t,o=8*t;return this.float32[s+0]=e,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[o+6]=r,this.int16[o+7]=a,t}}us.prototype.bytesPerElement=16,la("StructArrayLayout2f1f2i16",us);class hs extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,s){const o=16*t,l=4*t,c=8*t;return this.uint8[o+0]=e,this.uint8[o+1]=n,this.float32[l+1]=i,this.float32[l+2]=r,this.int16[c+6]=a,this.int16[c+7]=s,t}}hs.prototype.bytesPerElement=16,la("StructArrayLayout2ub2f2i16",hs);class ds extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,t}}ds.prototype.bytesPerElement=6,la("StructArrayLayout3ui6",ds);class fs extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g)}emplace(t,e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_){const y=24*t,v=12*t,b=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=i,this.uint16[y+3]=r,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=o,this.uint16[y+10]=l,this.uint16[y+11]=c,this.uint16[y+12]=u,this.float32[v+7]=h,this.float32[v+8]=d,this.uint8[b+36]=f,this.uint8[b+37]=p,this.uint8[b+38]=m,this.uint32[v+10]=g,this.int16[y+22]=_,t}}fs.prototype.bytesPerElement=48,la("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",fs);class ps extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b,x,w,S,P,M,A,k){const E=this.length;return this.resize(E+1),this.emplace(E,t,e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b,x,w,S,P,M,A,k)}emplace(t,e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b,x,w,S,P,M,A,k,E){const T=32*t,C=16*t;return this.int16[T+0]=e,this.int16[T+1]=n,this.int16[T+2]=i,this.int16[T+3]=r,this.int16[T+4]=a,this.int16[T+5]=s,this.int16[T+6]=o,this.int16[T+7]=l,this.uint16[T+8]=c,this.uint16[T+9]=u,this.uint16[T+10]=h,this.uint16[T+11]=d,this.uint16[T+12]=f,this.uint16[T+13]=p,this.uint16[T+14]=m,this.uint16[T+15]=g,this.uint16[T+16]=_,this.uint16[T+17]=y,this.uint16[T+18]=v,this.uint16[T+19]=b,this.uint16[T+20]=x,this.uint16[T+21]=w,this.uint16[T+22]=S,this.uint32[C+12]=P,this.float32[C+13]=M,this.float32[C+14]=A,this.uint16[T+30]=k,this.uint16[T+31]=E,t}}ps.prototype.bytesPerElement=64,la("StructArrayLayout8i15ui1ul2f2ui64",ps);class ms extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}ms.prototype.bytesPerElement=4,la("StructArrayLayout1f4",ms);class gs extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.uint16[6*t+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t}}gs.prototype.bytesPerElement=12,la("StructArrayLayout1ui2f12",gs);class _s extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=4*t;return this.uint32[2*t+0]=e,this.uint16[r+2]=n,this.uint16[r+3]=i,t}}_s.prototype.bytesPerElement=8,la("StructArrayLayout1ul2ui8",_s);class ys extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t}}ys.prototype.bytesPerElement=4,la("StructArrayLayout2ui4",ys);class vs extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}vs.prototype.bytesPerElement=2,la("StructArrayLayout1ui2",vs);class bs extends Ya{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const a=4*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=r,t}}bs.prototype.bytesPerElement=16,la("StructArrayLayout4f16",bs);class xs extends Xa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new n(this.anchorPointX,this.anchorPointY)}}xs.prototype.size=20;class ws extends ls{get(t){return new xs(this,t)}}la("CollisionBoxArray",ws);class Ss extends Xa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ss.prototype.size=48;class Ps extends fs{get(t){return new Ss(this,t)}}la("PlacedSymbolArray",Ps);class Ms extends Xa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ms.prototype.size=64;class As extends ps{get(t){return new Ms(this,t)}}la("SymbolInstanceArray",As);class ks extends ms{getoffsetX(t){return this.float32[1*t+0]}}la("GlyphOffsetArray",ks);class Es extends Qa{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}la("SymbolLineVertexArray",Es);class Ts extends Xa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ts.prototype.size=12;class Cs extends gs{get(t){return new Ts(this,t)}}la("TextAnchorOffsetArray",Cs);class Is extends Xa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Is.prototype.size=8;class Ls extends _s{get(t){return new Is(this,t)}}la("FeatureIndexArray",Ls);class zs extends $a{}class Ns extends $a{}class Ds extends $a{}class Rs extends es{}class Fs extends ns{}class Os extends is{}class Bs extends rs{}class js extends as{}class Us extends ss{}class Gs extends os{}class qs extends cs{}class Vs extends hs{}class Zs extends ds{}class Ws extends ys{}const Hs=Ka([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xs}=Hs;class Ys{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,e,n,i){const r=this.segments[this.segments.length-1];return t>Ys.MAX_VERTEX_ARRAY_LENGTH&&Z("Max vertices per segment is ".concat(Ys.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(t,". Consider using the `fillLargeMeshArrays` function if you require meshes with more than ").concat(Ys.MAX_VERTEX_ARRAY_LENGTH," vertices.")),this._forceNewSegmentOnNextPrepare||!r||r.vertexLength+t>Ys.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i?this.createNewSegment(e,n,i):r}createNewSegment(t,e,n){const i={vertexOffset:t.length,primitiveOffset:e.length,vertexLength:0,primitiveLength:0,vaos:{}};return void 0!==n&&(i.sortKey=n),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(i),i}getOrCreateLatestSegment(t,e,n){return this.prepareSegment(0,t,e,n)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,i){return new Ys([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}function Ks(t,e){return 256*(t=F(Math.floor(t),0,255))+F(Math.floor(e),0,255)}Ys.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,la("SegmentVector",Ys);const Js=Ka([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var $s,Qs,to,eo={exports:{}},no={exports:{}},io={exports:{}},ro=function(){if(to)return eo.exports;to=1;var t=($s||($s=1,no.exports=function(t,e){var n,i,r,a,s,o,l,c;for(i=t.length-(n=3&t.length),r=e,s=3432918353,o=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,r=27492+(65535&(a=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*o+(((l>>>16)*o&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}),no.exports),e=(Qs||(Qs=1,io.exports=function(t,e){for(var n,i=t.length,r=e^i,a=0;i>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++a;switch(i){case 3:r^=(255&t.charCodeAt(a+2))<<16;case 2:r^=(255&t.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}),io.exports);return eo.exports=t,eo.exports.murmur3=t,eo.exports.murmur2=e,eo.exports}(),ao=r(ro);class so{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,i){this.ids.push(oo(t)),this.positions.push(e,n,i)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const e=oo(t);let n=0,i=this.ids.length-1;for(;n<i;){const t=n+i>>1;this.ids[t]>=e?i=t:n=t+1}const r=[];for(;this.ids[n]===e;)r.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return r}static serialize(t,e){const n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return lo(n,i,0,n.length-1),e&&e.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(t){const e=new so;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function oo(t){const e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:ao(String(t))}function lo(t,e,n,i){for(;n<i;){const r=t[n+i>>1];let a=n-1,s=i+1;for(;;){do{a++}while(t[a]<r);do{s--}while(t[s]>r);if(a>=s)break;co(t,a,s),co(e,3*a,3*s),co(e,3*a+1,3*s+1),co(e,3*a+2,3*s+2)}s-n<i-s?(lo(t,e,n,s),n=s+1):(lo(t,e,s+1,i),i=s)}}function co(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}la("FeaturePositionMap",so);class uo{constructor(t,e){this.gl=t.gl,this.location=e}}class ho extends uo{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class fo extends uo{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class po extends uo{constructor(t,e){super(t,e),this.current=ke.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const mo=new Float32Array(16);function go(t){return[Ks(255*t.r,255*t.g),Ks(255*t.b,255*t.a)]}class _o{constructor(t,e,n){this.value=t,this.uniformNames=e.map(t=>"u_".concat(t)),this.type=n}setUniform(t,e,n){t.set(n.constantOr(this.value))}getBinding(t,e,n){return"color"===this.type?new po(t,e):new ho(t,e)}}class yo{constructor(t,e){this.uniformNames=e.map(t=>"u_".concat(t)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,n,i){const r="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;r&&t.set(r)}getBinding(t,e,n){return"u_pattern"===n.substr(0,9)?new fo(t,e):new ho(t,e)}}class vo{constructor(t,e,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:"a_".concat(t),type:"Float32",components:"color"===n?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(t,e,n){const i=this.paintVertexArray.length,r=this.expression.evaluate(new Ta(0,n),e,{},n.canonical,[],n.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(i,t,r)}updatePaintArray(t,e,n,i,r){const a=this.expression.evaluate(new Ta(0,r),n,i);this._setPaintValue(t,e,a)}_setPaintValue(t,e,n){if("color"===this.type){const i=go(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bo{constructor(t,e,n,i,r,a){this.expression=t,this.uniformNames=e.map(t=>"u_".concat(t,"_t")),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:"a_".concat(t),type:"Float32",components:"color"===n?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(t,e,n){const i=this.expression.evaluate(new Ta(this.zoom,n),e,{},n.canonical,[],n.formattedSection),r=this.expression.evaluate(new Ta(this.zoom+1,n),e,{},n.canonical,[],n.formattedSection),a=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(a,t,i,r)}updatePaintArray(t,e,n,i,r){const a=this.expression.evaluate(new Ta(this.zoom,r),n,i),s=this.expression.evaluate(new Ta(this.zoom+1,r),n,i);this._setPaintValue(t,e,a,s)}_setPaintValue(t,e,n,i){if("color"===this.type){const r=go(n),a=go(i);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1],a[0],a[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,i=F(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)}getBinding(t,e,n){return new ho(t,e)}}class xo{constructor(t,e,n,i,r,a){this.expression=t,this.type=e,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new r,this.zoomOutPaintVertexArray=new r}populatePaintArray(t,e,n){const i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,e.patterns&&e.patterns[this.layerId],n.imagePositions)}updatePaintArray(t,e,n,i,r){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],r.imagePositions)}_setPaintValues(t,e,n,i){if(!i||!n)return;const{min:r,mid:a,max:s}=n,o=i[r],l=i[a],c=i[s];if(o&&l&&c)for(let u=t;u<e;u++)this.zoomInPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],o.tl[0],o.tl[1],o.br[0],o.br[1],l.pixelRatio,o.pixelRatio),this.zoomOutPaintVertexArray.emplace(u,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Js.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Js.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class wo{constructor(t,e,n){this.binders={},this._buffers=[];const i=[];for(const r in t.paint._values){if(!n(r))continue;const a=t.paint.get(r);if(!(a instanceof Fa&&qi(a.property.specification)))continue;const s=Po(r,t.type),o=a.value,l=a.property.specification.type,c=a.property.useIntegerZoom,u=a.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===o.kind)this.binders[r]=h?new yo(o.value,s):new _o(o.value,s,l),i.push("/u_".concat(r));else if("source"===o.kind||h){const n=Mo(r,l,"source");this.binders[r]=h?new xo(o,l,c,e,n,t.id):new vo(o,s,l,n),i.push("/a_".concat(r))}else{const t=Mo(r,l,"composite");this.binders[r]=new bo(o,s,l,c,e,t),i.push("/z_".concat(r))}}this.cacheKey=i.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof vo||e instanceof bo?e.maxValue:0}populatePaintArrays(t,e,n){for(const i in this.binders){const r=this.binders[i];(r instanceof vo||r instanceof bo||r instanceof xo)&&r.populatePaintArray(t,e,n)}}setConstantPatternPositions(t,e){for(const n in this.binders){const i=this.binders[n];i instanceof yo&&i.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,n,i,r){let a=!1;for(const s in t){const o=e.getPositions(s);for(const e of o){const o=n.feature(e.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof vo||l instanceof bo||l instanceof xo)&&!0===l.expression.isStateDependent){const c=i.paint.get(n);l.expression=c.value,l.updatePaintArray(e.start,e.end,o,t[s],r),a=!0}}}}return a}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof _o||n instanceof yo)&&t.push(...n.uniformNames.map(t=>"#define HAS_UNIFORM_".concat(t)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof vo||n instanceof bo)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name);else if(n instanceof xo)for(let e=0;e<Js.members.length;e++)t.push(Js.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof _o||n instanceof yo||n instanceof bo)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const n=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof _o||r instanceof yo||r instanceof bo)for(const a of r.uniformNames)if(e[a]){const s=r.getBinding(t,e[a],a);n.push({name:a,property:i,binding:s})}}return n}setUniforms(t,e,n,i){for(const{name:r,property:a,binding:s}of e)this.binders[a].setUniform(s,i,n.get(a),r)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const n=this.binders[e];if(t&&n instanceof xo){const e=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(n instanceof vo||n instanceof bo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof vo||n instanceof bo||n instanceof xo)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof vo||e instanceof bo||e instanceof xo)&&e.destroy()}}}class So{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const i of t)this.programConfigurations[i.id]=new wo(i,e,n);this.needsUpload=!1,this._featureMap=new so,this._bufferOffset=0}populatePaintArrays(t,e,n,i){for(const r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(t,e,i);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,i){for(const r of n)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(t,this._featureMap,e,r,i)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Po(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace("".concat(e,"-"),"").replace(/-/g,"_")]}function Mo(t,e,n){const i={color:{source:is,composite:bs},number:{source:ms,composite:is}},r=function(t){return{"line-pattern":{source:Bs,composite:Bs},"fill-pattern":{source:Bs,composite:Bs},"fill-extrusion-pattern":{source:Bs,composite:Bs}}[t]}(t);return r&&r[n]||i[e][n]}la("ConstantBinder",_o),la("CrossFadedConstantBinder",yo),la("SourceExpressionBinder",vo),la("CrossFadedCompositeBinder",xo),la("CompositeExpressionBinder",bo),la("ProgramConfiguration",wo,{omit:["_buffers"]}),la("ProgramConfigurationSet",So);const Ao=Math.pow(2,14)-1,ko=-Ao-1;function Eo(t){const e=C/t.extent,n=t.loadGeometry();for(let i=0;i<n.length;i++){const t=n[i];for(let n=0;n<t.length;n++){const i=t[n],r=Math.round(i.x*e),a=Math.round(i.y*e);i.x=F(r,ko,Ao),i.y=F(a,ko,Ao),(r<i.x||r>i.x+1||a<i.y||a>i.y+1)&&Z("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function To(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Eo(t):[]}}const Co=-32768;function Io(t,e,n,i,r){t.emplaceBack(Co+8*e+i,Co+8*n+r)}class Lo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ns,this.indexArray=new Zs,this.segments=new Ys,this.programConfigurations=new So(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){const i=this.layers[0],r=[];let a=null,s=!1,o="heatmap"===i.type;if("circle"===i.type){const t=i;a=t.layout.get("circle-sort-key"),s=!a.isConstant(),o=o||"map"===t.paint.get("circle-pitch-alignment")}const l=o?e.subdivisionGranularity.circle:1;for(const{feature:c,id:u,index:h,sourceLayerIndex:d}of t){const t=this.layers[0]._featureFilter.needGeometry,e=To(c,t);if(!this.layers[0]._featureFilter.filter(new Ta(this.zoom),e,n))continue;const i=s?a.evaluate(e,{},n):void 0,o={id:u,properties:c.properties,type:c.type,sourceLayerIndex:d,index:h,geometry:t?e.geometry:Eo(c),patterns:{},sortKey:i};r.push(o)}s&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const c of r){const{geometry:i,index:r,sourceLayerIndex:a}=c,s=t[r].feature;this.addFeature(c,i,r,n,l),e.featureIndex.insert(s,i,r,a,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,{imagePositions:n})}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xs),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,i){let r,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;switch(a){case 1:r=[0,7];break;case 3:r=[0,2,5,7];break;case 5:r=[0,1,3,4,6,7];break;case 7:r=[0,1,2,3,4,5,6,7];break;default:throw new Error("Invalid circle bucket granularity: ".concat(a,"; valid values are 1, 3, 5, 7."))}const s=r.length;for(const o of e)for(const e of o){const n=e.x,i=e.y;if(n<0||n>=C||i<0||i>=C)continue;const a=this.segments.prepareSegment(s*s,this.layoutVertexArray,this.indexArray,t.sortKey),o=a.vertexLength;for(let t=0;t<s;t++)for(let e=0;e<s;e++)Io(this.layoutVertexArray,n,i,r[e],r[t]);for(let t=0;t<s-1;t++)for(let e=0;e<s-1;e++){const n=o+t*s+e,i=o+(t+1)*s+e;this.indexArray.emplaceBack(n,i+1,n+1),this.indexArray.emplaceBack(n,i,i+1)}a.vertexLength+=s*s,a.primitiveLength+=(s-1)*(s-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{imagePositions:{},canonical:i})}}function zo(t,e){for(let n=0;n<t.length;n++)if(Go(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Go(t,e[n]))return!0;return!!Fo(t,e)}function No(t,e,n){return!!Go(t,e)||!!Bo(e,t,n)}function Do(t,e){if(1===t.length)return Uo(e,t[0]);for(let n=0;n<e.length;n++){const i=e[n];for(let e=0;e<i.length;e++)if(Go(t,i[e]))return!0}for(let n=0;n<t.length;n++)if(Uo(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Fo(t,e[n]))return!0;return!1}function Ro(t,e,n){if(t.length>1){if(Fo(t,e))return!0;for(let i=0;i<e.length;i++)if(Bo(e[i],t,n))return!0}for(let i=0;i<t.length;i++)if(Bo(t[i],e,n))return!0;return!1}function Fo(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)if(Oo(i,r,e[t],e[t+1]))return!0}return!1}function Oo(t,e,n,i){return W(t,n,i)!==W(e,n,i)&&W(t,e,n)!==W(t,e,i)}function Bo(t,e,n){const i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(let r=1;r<e.length;r++)if(jo(t,e[r-1],e[r])<i)return!0;return!1}function jo(t,e,n){const i=e.distSqr(n);if(0===i)return t.distSqr(e);const r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(r<0?e:r>1?n:n.sub(e)._mult(r)._add(e))}function Uo(t,e){let n,i,r,a=!1;for(let s=0;s<t.length;s++){n=t[s];for(let t=0,s=n.length-1;t<n.length;s=t++)i=n[t],r=n[s],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(a=!a)}return a}function Go(t,e){let n=!1;for(let i=0,r=t.length-1;i<t.length;r=i++){const a=t[i],s=t[r];a.y>e.y!=s.y>e.y&&e.x<(s.x-a.x)*(e.y-a.y)/(s.y-a.y)+a.x&&(n=!n)}return n}function qo(t,e,n){const i=n[0],r=n[2];if(t.x<i.x&&e.x<i.x||t.x>r.x&&e.x>r.x||t.y<i.y&&e.y<i.y||t.y>r.y&&e.y>r.y)return!1;const a=W(t,e,n[0]);return a!==W(t,e,n[1])||a!==W(t,e,n[2])||a!==W(t,e,n[3])}function Vo(t,e,n){const i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function Zo(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Wo(t,e,i,r,a){if(!e[0]&&!e[1])return t;const s=n.convert(e)._mult(a);"viewport"===i&&s._rotate(-r);const o=[];for(let n=0;n<t.length;n++)o.push(t[n].sub(s));return o}function Ho(t,e){let{queryGeometry:n,size:i}=t;return No(n,e,i)}function Xo(t,e){let{queryGeometry:n,size:i,transform:r,unwrappedTileID:a,getElevation:s}=t;return No(n,e,i*(r.projectTileCoordinates(e.x,e.y,a,s).signedDistanceFromCamera/r.cameraToCenterDistance))}function Yo(t,e){let{queryGeometry:n,size:i,transform:r,unwrappedTileID:a,getElevation:s}=t;const o=r.projectTileCoordinates(e.x,e.y,a,s).signedDistanceFromCamera,l=i*(r.cameraToCenterDistance/o);return No(n,$o(e,r,a,s),l)}function Ko(t,e){let{queryGeometry:n,size:i,transform:r,unwrappedTileID:a,getElevation:s}=t;return No(n,$o(e,r,a,s),i)}function Jo(t,e){let{queryGeometry:n,size:i,transform:r,unwrappedTileID:a,getElevation:s,pitchAlignment:o="map",pitchScale:l="map"}=t;const c="map"===o?"map"===l?Ho:Xo:"map"===l?Yo:Ko,u={queryGeometry:n,size:i,transform:r,unwrappedTileID:a,getElevation:s};for(const h of e)for(const t of h)if(c(u,t))return!0;return!1}function $o(t,e,i,r){const a=e.projectTileCoordinates(t.x,t.y,i,r).point;return new n((.5*a.x+.5)*e.width,(.5*-a.y+.5)*e.height)}let Qo,tl;la("CircleBucket",Lo,{omit:["layers"]});var el={get paint(){return tl=tl||new Va({"circle-radius":new ja(vt.paint_circle["circle-radius"]),"circle-color":new ja(vt.paint_circle["circle-color"]),"circle-blur":new ja(vt.paint_circle["circle-blur"]),"circle-opacity":new ja(vt.paint_circle["circle-opacity"]),"circle-translate":new Ba(vt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ba(vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ba(vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ba(vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ja(vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ja(vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ja(vt.paint_circle["circle-stroke-opacity"])})},get layout(){return Qo=Qo||new Va({"circle-sort-key":new ja(vt.layout_circle["circle-sort-key"])})}};class nl extends Wa{constructor(t,e){super(t,el,e)}createBucket(t){return new Lo(t)}queryRadius(t){const e=t;return Vo("circle-radius",this,e)+Vo("circle-stroke-width",this,e)+Zo(this.paint.get("circle-translate"))}queryIntersectsFeature(t){let{queryGeometry:e,feature:n,featureState:i,geometry:r,transform:a,pixelsToTileUnits:s,unwrappedTileID:o,getElevation:l}=t;const c=Wo(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-a.bearingInRadians,s),u=this.paint.get("circle-radius").evaluate(n,i)+this.paint.get("circle-stroke-width").evaluate(n,i),h=this.paint.get("circle-pitch-scale"),d=this.paint.get("circle-pitch-alignment");let f,p;return"map"===d?(f=c,p=u*s):(f=function(t,e,n,i){return t.map(t=>$o(t,e,n,i))}(c,a,o,l),p=u),Jo({queryGeometry:f,size:p,transform:a,unwrappedTileID:o,getElevation:l,pitchAlignment:d,pitchScale:h},r)}}class il extends Lo{}let rl;la("HeatmapBucket",il,{omit:["layers"]});var al={get paint(){return rl=rl||new Va({"heatmap-radius":new ja(vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ja(vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ba(vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qa(vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ba(vt.paint_heatmap["heatmap-opacity"])})}};function sl(t,e,n,i){let{width:r,height:a}=e;if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==r*a*n)throw new RangeError("mismatched image size. expected: ".concat(i.length," but got: ").concat(r*a*n))}else i=new Uint8Array(r*a*n);return t.width=r,t.height=a,t.data=i,t}function ol(t,e,n){let{width:i,height:r}=e;if(i===t.width&&r===t.height)return;const a=sl({},{width:i,height:r},n);ll(t,a,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,r)},n),t.width=i,t.height=r,t.data=a.data}function ll(t,e,n,i,r,a){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const s=t.data,o=e.data;if(s===o)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<r.height;l++){const c=((n.y+l)*t.width+n.x)*a,u=((i.y+l)*e.width+i.x)*a;for(let t=0;t<r.width*a;t++)o[u+t]=s[c+t]}return e}class cl{constructor(t,e){sl(this,t,1,e)}resize(t){ol(this,t,1)}clone(){return new cl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){ll(t,e,n,i,r,1)}}class ul{constructor(t,e){sl(this,t,4,e)}resize(t){ol(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ul({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){ll(t,e,n,i,r,4)}setPixel(t,e,n){const i=4*(t*this.width+e);this.data[i+0]=Math.round(255*n.r/n.a),this.data[i+1]=Math.round(255*n.g/n.a),this.data[i+2]=Math.round(255*n.b/n.a),this.data[i+3]=Math.round(255*n.a)}}function hl(t){const e={},n=t.resolution||256,i=t.clips?t.clips.length:1,r=t.image||new ul({width:n,height:i});if(Math.log(n)/Math.LN2%1!=0)throw new Error("width is not a power of 2 - ".concat(n));const a=(i,a,s)=>{e[t.evaluationKey]=s;const o=t.expression.evaluate(e);r.setPixel(i/4/n,a/4,o)};if(t.clips)for(let s=0,o=0;s<i;++s,o+=4*n)for(let e=0,i=0;e<n;e++,i+=4){const r=e/(n-1),{start:l,end:c}=t.clips[s];a(o,i,l*(1-r)+c*r)}else for(let s=0,o=0;s<n;s++,o+=4)a(0,o,s/(n-1));return r}la("AlphaImage",cl),la("RGBAImage",ul);const dl="big-fb";class fl extends Wa{createBucket(t){return new il(t)}constructor(t,e){super(t,al,e),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=hl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(dl)&&this.heatmapFbos.delete(dl)}queryRadius(t){return Vo("heatmap-radius",this,t)}queryIntersectsFeature(t){let{queryGeometry:e,feature:n,featureState:i,geometry:r,transform:a,pixelsToTileUnits:s,unwrappedTileID:o,getElevation:l}=t;return Jo({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(n,i)*s,transform:a,unwrappedTileID:o,getElevation:l},r)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let pl;var ml={get paint(){return pl=pl||new Va({"hillshade-illumination-direction":new Ba(vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Ba(vt.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Ba(vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ba(vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ba(vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ba(vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ba(vt.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Ba(vt.paint_hillshade["hillshade-method"])})}};class gl extends Wa{constructor(t,e){super(t,ml,e),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,e=this.paint.get("hillshade-illumination-altitude").values,n=this.paint.get("hillshade-highlight-color").values,i=this.paint.get("hillshade-shadow-color").values;const r=Math.max(t.length,e.length,n.length,i.length);t=t.concat(Array(r-t.length).fill(t.at(-1))),e=e.concat(Array(r-e.length).fill(e.at(-1))),n=n.concat(Array(r-n.length).fill(n.at(-1))),i=i.concat(Array(r-i.length).fill(i.at(-1)));const a=e.map(et);return{directionRadians:t.map(et),altitudeRadians:a,shadowColor:i,highlightColor:n}}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}let _l;var yl={get paint(){return _l=_l||new Va({"color-relief-opacity":new Ba(vt["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new qa(vt["paint_color-relief"]["color-relief-color"])})}};class vl{constructor(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)}update(t,e,n){const{width:i,height:r}=t,a=!(this.size&&this.size[0]===i&&this.size[1]===r||n),{context:s}=this,{gl:o}=s;if(this.useMipmap=Boolean(e&&e.useMipmap),o.bindTexture(o.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===o.RGBA&&(!e||!1!==e.premultiply)),a)this.size=[i,r],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Y(t)?o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,o.UNSIGNED_BYTE,t):o.texImage2D(o.TEXTURE_2D,0,this.format,i,r,0,this.format,o.UNSIGNED_BYTE,t.data);else{const{x:e,y:a}=n||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Y(t)?o.texSubImage2D(o.TEXTURE_2D,0,e,a,o.RGBA,o.UNSIGNED_BYTE,t):o.texSubImage2D(o.TEXTURE_2D,0,e,a,i,r,o.RGBA,o.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&o.generateMipmap(o.TEXTURE_2D),s.pixelStoreUnpackFlipY.setDefault(),s.pixelStoreUnpack.setDefault(),s.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,e,n){const{context:i}=this,{gl:r}=i;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class bl{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n))return void Z('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));this.stride=e.height;const o=this.dim=e.height-2;switch(this.data=new Uint32Array(e.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=r,this.blueFactor=a,this.baseShift=s;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let l=0;l<o;l++)this.data[this._idx(-1,l)]=this.data[this._idx(0,l)],this.data[this._idx(o,l)]=this.data[this._idx(o-1,l)],this.data[this._idx(l,-1)]=this.data[this._idx(l,0)],this.data[this._idx(l,o)]=this.data[this._idx(l,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let l=0;l<o;l++)for(let t=0;t<o;t++){const e=this.get(l,t);e>this.max&&(this.max=e),e<this.min&&(this.min=e)}}get(t,e){const n=new Uint8Array(this.data.buffer),i=4*this._idx(t,e);return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}unpack(t,e,n){return t*this.redFactor+e*this.greenFactor+n*this.blueFactor-this.baseShift}pack(t){return xl(t,this.getUnpackVector())}getPixels(){return new ul({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=e*this.dim,r=e*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(e){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:a=s-1;break;case 1:s=a+1}const o=-e*this.dim,l=-n*this.dim;for(let c=a;c<s;c++)for(let e=i;e<r;e++)this.data[this._idx(e,c)]=t.data[this._idx(e+o,c+l)]}}function xl(t,e){const n=e[0],i=e[1],r=e[2],a=e[3],s=Math.min(n,i,r),o=Math.round((t+a)/s);return{r:Math.floor(o*s/n)%256,g:Math.floor(o*s/i)%256,b:Math.floor(o*s/r)%256}}la("DEMData",bl);class wl extends Wa{constructor(t,e){super(t,yl,e)}_createColorRamp(t){const e={elevationStops:[],colorStops:[]},n=this._transitionablePaint._values["color-relief-color"].value.expression;if(n instanceof rr&&n._styleExpression.expression instanceof pn){this.colorRampExpression=n;const t=n._styleExpression.expression;e.elevationStops=t.labels,e.colorStops=[];for(const n of e.elevationStops)e.colorStops.push(t.evaluate({globals:{elevation:n}}))}if(e.elevationStops.length<1&&(e.elevationStops=[0],e.colorStops=[ke.transparent]),e.elevationStops.length<2&&(e.elevationStops.push(e.elevationStops[0]+1),e.colorStops.push(e.colorStops[0])),e.elevationStops.length<=t)return e;const i={elevationStops:[],colorStops:[]},r=(e.elevationStops.length-1)/(t-1);for(let a=0;a<e.elevationStops.length-.5;a+=r)i.elevationStops.push(e.elevationStops[Math.round(a)]),i.colorStops.push(e.colorStops[Math.round(a)]);return Z("Too many colors in specification of ".concat(this.id," color-relief layer, may not render properly.")),i}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,e,n){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const i=this._createColorRamp(e),r=new ul({width:i.colorStops.length,height:1}),a=new ul({width:i.colorStops.length,height:1});for(let s=0;s<i.elevationStops.length;s++){const t=xl(i.elevationStops[s],n);a.setPixel(0,s,new ke(t.r/255,t.g/255,t.b/255,1)),r.setPixel(0,s,i.colorStops[s])}return this.colorRampTextures={elevationTexture:new vl(t,a,t.gl.RGBA),colorTexture:new vl(t,r,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return"none"!==this.visibility&&!!this.colorRampTextures}}const Sl=Ka([{name:"a_pos",components:2,type:"Int16"}],4),{members:Pl}=Sl;function Ml(t,e,n){const i=n.patternDependencies;let r=!1;for(const a of e){const e=a.paint.get("".concat(t,"-pattern"));e.isConstant()||(r=!0);const n=e.constantOr(null);n&&(r=!0,i[n.to]=!0,i[n.from]=!0)}return r}function Al(t,e,n,i,r){const{zoom:a}=i,s=r.patternDependencies;for(const o of e){const e=o.paint.get("".concat(t,"-pattern")).value;if("constant"!==e.kind){let t=e.evaluate({zoom:a-1},n,{},r.availableImages),i=e.evaluate({zoom:a},n,{},r.availableImages),l=e.evaluate({zoom:a+1},n,{},r.availableImages);t=t&&t.name?t.name:t,i=i&&i.name?i.name:i,l=l&&l.name?l.name:l,s[t]=!0,s[i]=!0,s[l]=!0,n.patterns[o.id]={min:t,mid:i,max:l}}}return n}function kl(t,e,n,i,r){let a;if(r===function(t,e,n,i){let r=0;for(let a=e,s=n-i;a<n;a+=i)r+=(t[s]-t[a])*(t[a+1]+t[s+1]),s=a;return r}(t,e,n,i)>0)for(let s=e;s<n;s+=i)a=Yl(s/i|0,t[s],t[s+1],a);else for(let s=n-i;s>=e;s-=i)a=Yl(s/i|0,t[s],t[s+1],a);return a&&ql(a,a.next)&&(Kl(a),a=a.next),a}function El(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!ql(i,i.next)&&0!==Gl(i.prev,i,i.next))i=i.next;else{if(Kl(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function Tl(t,e,n,i,r,a,s){if(!t)return;!s&&a&&function(t,e,n,i){let r=t;do{0===r.z&&(r.z=Fl(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n=1;do{let i,r=t;t=null;let a=null;for(e=0;r;){e++;let s=r,o=0;for(let t=0;t<n&&(o++,s=s.nextZ,s);t++);let l=n;for(;o>0||l>0&&s;)0!==o&&(0===l||!s||r.z<=s.z)?(i=r,r=r.nextZ,o--):(i=s,s=s.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;r=s}a.nextZ=null,n*=2}while(e>1)}(r)}(t,i,r,a);let o=t;for(;t.prev!==t.next;){const l=t.prev,c=t.next;if(a?Il(t,i,r,a):Cl(t))e.push(l.i,t.i,c.i),Kl(t),t=c.next,o=c.next;else if((t=c)===o){s?1===s?Tl(t=Ll(El(t),e),e,n,i,r,a,2):2===s&&zl(t,e,n,i,r,a):Tl(El(t),e,n,i,r,a,1);break}}}function Cl(t){const e=t.prev,n=t,i=t.next;if(Gl(e,n,i)>=0)return!1;const r=e.x,a=n.x,s=i.x,o=e.y,l=n.y,c=i.y,u=Math.min(r,a,s),h=Math.min(o,l,c),d=Math.max(r,a,s),f=Math.max(o,l,c);let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&jl(r,o,a,l,s,c,p.x,p.y)&&Gl(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Il(t,e,n,i){const r=t.prev,a=t,s=t.next;if(Gl(r,a,s)>=0)return!1;const o=r.x,l=a.x,c=s.x,u=r.y,h=a.y,d=s.y,f=Math.min(o,l,c),p=Math.min(u,h,d),m=Math.max(o,l,c),g=Math.max(u,h,d),_=Fl(f,p,e,n,i),y=Fl(m,g,e,n,i);let v=t.prevZ,b=t.nextZ;for(;v&&v.z>=_&&b&&b.z<=y;){if(v.x>=f&&v.x<=m&&v.y>=p&&v.y<=g&&v!==r&&v!==s&&jl(o,u,l,h,c,d,v.x,v.y)&&Gl(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==s&&jl(o,u,l,h,c,d,b.x,b.y)&&Gl(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=_;){if(v.x>=f&&v.x<=m&&v.y>=p&&v.y<=g&&v!==r&&v!==s&&jl(o,u,l,h,c,d,v.x,v.y)&&Gl(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==s&&jl(o,u,l,h,c,d,b.x,b.y)&&Gl(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Ll(t,e){let n=t;do{const i=n.prev,r=n.next.next;!ql(i,r)&&Vl(i,n,n.next,r)&&Hl(i,r)&&Hl(r,i)&&(e.push(i.i,n.i,r.i),Kl(n),Kl(n.next),n=t=r),n=n.next}while(n!==t);return El(n)}function zl(t,e,n,i,r,a){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&Ul(s,t)){let o=Xl(s,t);return s=El(s,s.next),o=El(o,o.next),Tl(s,e,n,i,r,a,0),void Tl(o,e,n,i,r,a,0)}t=t.next}s=s.next}while(s!==t)}function Nl(t,e){let n=t.x-e.x;return 0===n&&(n=t.y-e.y,0===n)&&(n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)),n}function Dl(t,e){const n=function(t,e){let n=e;const i=t.x,r=t.y;let a,s=-1/0;if(ql(t,n))return n;do{if(ql(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>s&&(s=t,a=n.x<n.next.x?n:n.next,t===i))return a}n=n.next}while(n!==e);if(!a)return null;const o=a,l=a.x,c=a.y;let u=1/0;n=a;do{if(i>=n.x&&n.x>=l&&i!==n.x&&Bl(r<c?i:s,r,l,c,r<c?s:i,r,n.x,n.y)){const e=Math.abs(r-n.y)/(i-n.x);Hl(n,t)&&(e<u||e===u&&(n.x>a.x||n.x===a.x&&Rl(a,n)))&&(a=n,u=e)}n=n.next}while(n!==o);return a}(t,e);if(!n)return e;const i=Xl(n,t);return El(i,i.next),El(n,n.next)}function Rl(t,e){return Gl(t.prev,t,e.prev)<0&&Gl(e.next,t,t.next)<0}function Fl(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ol(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Bl(t,e,n,i,r,a,s,o){return(r-s)*(e-o)>=(t-s)*(a-o)&&(t-s)*(i-o)>=(n-s)*(e-o)&&(n-s)*(a-o)>=(r-s)*(i-o)}function jl(t,e,n,i,r,a,s,o){return!(t===s&&e===o)&&Bl(t,e,n,i,r,a,s,o)}function Ul(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Vl(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Hl(t,e)&&Hl(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Gl(t.prev,t,e.prev)||Gl(t,e.prev,e))||ql(t,e)&&Gl(t.prev,t,t.next)>0&&Gl(e.prev,e,e.next)>0)}function Gl(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ql(t,e){return t.x===e.x&&t.y===e.y}function Vl(t,e,n,i){const r=Wl(Gl(t,e,n)),a=Wl(Gl(t,e,i)),s=Wl(Gl(n,i,t)),o=Wl(Gl(n,i,e));return r!==a&&s!==o||!(0!==r||!Zl(t,n,e))||!(0!==a||!Zl(t,i,e))||!(0!==s||!Zl(n,t,i))||!(0!==o||!Zl(n,e,i))}function Zl(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Wl(t){return t>0?1:t<0?-1:0}function Hl(t,e){return Gl(t.prev,t,t.next)<0?Gl(t,e,t.next)>=0&&Gl(t,t.prev,e)>=0:Gl(t,e,t.prev)<0||Gl(t,t.next,e)<0}function Xl(t,e){const n=Jl(t.i,t.x,t.y),i=Jl(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function Yl(t,e,n,i){const r=Jl(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Kl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Jl(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class $l{constructor(t,e){if(e>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=e}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Ql{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Ql.noSubdivision=new Ql({fill:new $l(0,0),line:new $l(0,0),tile:new $l(0,0),stencil:new $l(0,0),circle:1}),la("SubdivisionGranularityExpression",$l),la("SubdivisionGranularitySetting",Ql);const tc=-32768,ec=32767;class nc{constructor(t,e){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=C/t,this._canonical=e}_getKey(t,e){return(t+=32768)<<16|e+32768}_vertexToIndex(t,e){if(t<-32768||e<-32768||t>32767||e>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const n=0|Math.round(t),i=0|Math.round(e),r=this._getKey(n,i);if(this._vertexDictionary.has(r))return this._vertexDictionary.get(r);const a=this._vertexBuffer.length/2;return this._vertexDictionary.set(r,a),this._vertexBuffer.push(n,i),a}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(t,e){const n=[];for(let i=0;i<e.length;i+=3){const r=e[i],a=e[i+1],s=e[i+2],o=t[2*r],l=t[2*r+1];(t[2*a]-o)*(t[2*s+1]-l)-(t[2*a+1]-l)*(t[2*s]-o)>0?(n.push(r),n.push(s),n.push(a)):(n.push(r),n.push(a),n.push(s))}return n}(this._vertexBuffer,t);const e=[],n=t.length;for(let i=0;i<n;i+=3){const n=[t[i+0],t[i+1],t[i+2]],r=[this._vertexBuffer[2*t[i+0]+0],this._vertexBuffer[2*t[i+0]+1],this._vertexBuffer[2*t[i+1]+0],this._vertexBuffer[2*t[i+1]+1],this._vertexBuffer[2*t[i+2]+0],this._vertexBuffer[2*t[i+2]+1]];let a=1/0,s=1/0,o=-1/0,l=-1/0;for(let t=0;t<3;t++){const e=r[2*t],n=r[2*t+1];a=Math.min(a,e),o=Math.max(o,e),s=Math.min(s,n),l=Math.max(l,n)}if(a===o||s===l)continue;const c=Math.floor(a/this._granularityCellSize),u=Math.ceil(o/this._granularityCellSize),h=Math.floor(s/this._granularityCellSize),d=Math.ceil(l/this._granularityCellSize);if(c!==u||h!==d)for(let t=h;t<d;t++){const i=this._scanlineGenerateVertexRingForCellRow(t,r,n);ac(this._vertexBuffer,i,e)}else e.push(...n)}return e}_scanlineGenerateVertexRingForCellRow(t,e,n){const i=t*this._granularityCellSize,r=i+this._granularityCellSize,a=[];for(let s=0;s<3;s++){const t=e[2*s],o=e[2*s+1],l=e[2*(s+1)%6],c=e[(2*(s+1)+1)%6],u=e[2*(s+2)%6],h=e[(2*(s+2)+1)%6],d=l-t,f=c-o,p=0===d,m=0===f,g=(i-o)/f,_=(r-o)/f,y=Math.min(g,_),v=Math.max(g,_);if(!m&&(y>=1||v<=0)||m&&(o<i||o>r)){c>=i&&c<=r&&a.push(n[(s+1)%3]);continue}!m&&y>0&&a.push(this._vertexToIndex(t+d*y,o+f*y));const b=t+d*Math.max(y,0),x=t+d*Math.min(v,1);p||this._generateIntraEdgeVertices(a,t,o,l,c,b,x),!m&&v<1&&a.push(this._vertexToIndex(t+d*v,o+f*v)),(m||c>=i&&c<=r)&&a.push(n[(s+1)%3]),!m&&(c<=i||c>=r)&&this._generateInterEdgeVertices(a,t,o,l,c,u,h,x,i,r)}return a}_generateIntraEdgeVertices(t,e,n,i,r,a,s){const o=i-e,l=r-n,c=0===l,u=c?Math.min(e,i):Math.min(a,s),h=c?Math.max(e,i):Math.max(a,s),d=Math.floor(u/this._granularityCellSize)+1,f=Math.ceil(h/this._granularityCellSize)-1;if(c?e<i:a<s)for(let p=d;p<=f;p++){const i=p*this._granularityCellSize;t.push(this._vertexToIndex(i,n+l*(i-e)/o))}else for(let p=f;p>=d;p--){const i=p*this._granularityCellSize;t.push(this._vertexToIndex(i,n+l*(i-e)/o))}}_generateInterEdgeVertices(t,e,n,i,r,a,s,o,l,c){const u=r-n,h=a-i,d=s-r,f=(l-r)/d,p=(c-r)/d,m=Math.min(f,p),g=Math.max(f,p),_=i+h*m;let y=Math.floor(Math.min(_,o)/this._granularityCellSize)+1,v=Math.ceil(Math.max(_,o)/this._granularityCellSize)-1,b=o<_;const x=0===d;if(x&&(s===l||s===c))return;if(x||m>=1||g<=0){const t=n-s,i=a+(e-a)*Math.min((l-s)/t,(c-s)/t);y=Math.floor(Math.min(i,o)/this._granularityCellSize)+1,v=Math.ceil(Math.max(i,o)/this._granularityCellSize)-1,b=o<i}const w=u>0?c:l;if(b)for(let S=y;S<=v;S++)t.push(this._vertexToIndex(S*this._granularityCellSize,w));else for(let S=v;S>=y;S--)t.push(this._vertexToIndex(S*this._granularityCellSize,w))}_generateOutline(t){const e=[];for(const n of t){const t=rc(n,this._granularity,!0),i=this._pointArrayToIndices(t),r=[];for(let e=1;e<i.length;e++)r.push(i[e-1]),r.push(i[e]);e.push(r)}return e}_handlePoles(t){let e=!1,n=!1;this._canonical&&(0===this._canonical.y&&(e=!0),this._canonical.y===(1<<this._canonical.z)-1&&(n=!0)),(e||n)&&this._fillPoles(t,e,n)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let e=0;e<t.length;e+=2){const n=t[e+1];n===tc&&(t[e+1]=-32767),n===ec&&(t[e+1]=32766)}}_generatePoleQuad(t,e,n,i,r,a){i>r!=(a===tc)?(t.push(e),t.push(n),t.push(this._vertexToIndex(i,a)),t.push(n),t.push(this._vertexToIndex(r,a)),t.push(this._vertexToIndex(i,a))):(t.push(n),t.push(e),t.push(this._vertexToIndex(i,a)),t.push(this._vertexToIndex(r,a)),t.push(n),t.push(this._vertexToIndex(i,a)))}_fillPoles(t,e,n){const i=this._vertexBuffer,r=C,a=t.length;for(let s=2;s<a;s+=3){const a=t[s-2],o=t[s-1],l=t[s],c=i[2*a],u=i[2*a+1],h=i[2*o],d=i[2*o+1],f=i[2*l],p=i[2*l+1];e&&(0===u&&0===d&&this._generatePoleQuad(t,a,o,c,h,tc),0===d&&0===p&&this._generatePoleQuad(t,o,l,h,f,tc),0===p&&0===u&&this._generatePoleQuad(t,l,a,f,c,tc)),n&&(u===r&&d===r&&this._generatePoleQuad(t,a,o,c,h,ec),d===r&&p===r&&this._generatePoleQuad(t,o,l,h,f,ec),p===r&&u===r&&this._generatePoleQuad(t,l,a,f,c,ec))}}_initializeVertices(t){for(let e=0;e<t.length;e+=2)this._vertexToIndex(t[e],t[e+1])}subdividePolygonInternal(t,e){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:n,holeIndices:i}=function(t){const e=[],n=[];for(const i of t)if(0!==i.length){i!==t[0]&&e.push(n.length/2);for(let t=0;t<i.length;t++)n.push(i[t].x),n.push(i[t].y)}return{flattened:n,holeIndices:e}}(t);let r;this._initializeVertices(n);try{const t=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const i=e&&e.length,r=i?e[0]*n:t.length;let a=kl(t,0,r,n,!0);const s=[];if(!a||a.next===a.prev)return s;let o,l,c;if(i&&(a=function(t,e,n,i){const r=[];for(let a=0,s=e.length;a<s;a++){const n=kl(t,e[a]*i,a<s-1?e[a+1]*i:t.length,i,!1);n===n.next&&(n.steiner=!0),r.push(Ol(n))}r.sort(Nl);for(let a=0;a<r.length;a++)n=Dl(r[a],n);return n}(t,e,a,n)),t.length>80*n){o=t[0],l=t[1];let e=o,i=l;for(let a=n;a<r;a+=n){const n=t[a],r=t[a+1];n<o&&(o=n),r<l&&(l=r),n>e&&(e=n),r>i&&(i=r)}c=Math.max(e-o,i-l),c=0!==c?32767/c:0}return Tl(a,s,n,o,l,c,0),s}(n,i),e=this._convertIndices(n,t);r=this._subdivideTrianglesScanline(e)}catch(t){console.error(t)}let a=[];return e&&(a=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(r),{verticesFlattened:this._vertexBuffer,indicesTriangles:r,indicesLineList:a}}_convertIndices(t,e){const n=[];for(let i=0;i<e.length;i++)n.push(this._vertexToIndex(t[2*e[i]],t[2*e[i]+1]));return n}_pointArrayToIndices(t){const e=[];for(let n=0;n<t.length;n++){const i=t[n];e.push(this._vertexToIndex(i.x,i.y))}return e}}function ic(t,e,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new nc(n,e).subdividePolygonInternal(t,i)}function rc(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t||t.length<1)return[];if(t.length<2)return[];const r=t[0],a=t[t.length-1],s=i&&(r.x!==a.x||r.y!==a.y);if(e<2)return s?[...t,t[0]]:[...t];const o=Math.floor(C/e),l=[];l.push(new n(t[0].x,t[0].y));const c=t.length,u=s?c:c-1;for(let h=0;h<u;h++){const e=t[h],i=h<c-1?t[h+1]:t[0],r=e.x,a=e.y,s=i.x,u=i.y,d=r!==s,f=a!==u;if(!d&&!f)continue;const p=s-r,m=u-a,g=Math.abs(p),_=Math.abs(m);let y=r,v=a;for(;;){const t=p>0?(Math.floor(y/o)+1)*o:(Math.ceil(y/o)-1)*o,e=m>0?(Math.floor(v/o)+1)*o:(Math.ceil(v/o)-1)*o,i=Math.abs(y-t),r=Math.abs(v-e),a=Math.abs(y-s),c=Math.abs(v-u),h=d?i/g:Number.POSITIVE_INFINITY,b=f?r/_:Number.POSITIVE_INFINITY;if((a<=i||!d)&&(c<=r||!f))break;if(h<b&&d||!f){y=t,v+=m*h;const e=new n(y,Math.round(v));l[l.length-1].x===e.x&&l[l.length-1].y===e.y||l.push(e)}else{y+=p*b,v=e;const t=new n(Math.round(y),v);l[l.length-1].x===t.x&&l[l.length-1].y===t.y||l.push(t)}}const b=new n(s,u);l[l.length-1].x===b.x&&l[l.length-1].y===b.y||l.push(b)}return l}function ac(t,e,n){if(0===e.length)throw new Error("Subdivision vertex ring is empty.");let i=0,r=t[2*e[0]];for(let l=1;l<e.length;l++){const n=t[2*e[l]];n<r&&(r=n,i=l)}const a=e.length;let s=i,o=(s+1)%a;for(;;){const i=s-1>=0?s-1:a-1,r=(o+1)%a,l=t[2*e[i]],c=t[2*e[r]],u=t[2*e[s]],h=t[2*e[s]+1],d=t[2*e[o]+1];let f=!1;if(l<c)f=!0;else if(l>c)f=!1;else{const n=d-h,a=-(t[2*e[o]]-u),s=h<d?1:-1;((l-u)*n+(t[2*e[i]+1]-h)*a)*s>((c-u)*n+(t[2*e[r]+1]-h)*a)*s&&(f=!0)}if(f){const t=e[i],r=e[s],l=e[o];t!==r&&t!==l&&r!==l&&n.push(l,r,t),s--,s<0&&(s=a-1)}else{const t=e[r],i=e[s],l=e[o];t!==i&&t!==l&&i!==l&&n.push(l,i,t),o++,o>=a&&(o=0)}if(i===r)break}}function sc(t,e,n,i,r,a,s,o,l){const c=r.length/2,u=s&&o&&l;if(c<Ys.MAX_VERTEX_ARRAY_LENGTH){const h=e.prepareSegment(c,n,i),d=h.vertexLength;for(let t=0;t<a.length;t+=3)i.emplaceBack(d+a[t],d+a[t+1],d+a[t+2]);let f,p;h.vertexLength+=c,h.primitiveLength+=a.length/3,u&&(p=s.prepareSegment(c,n,o),f=p.vertexLength,p.vertexLength+=c);for(let e=0;e<r.length;e+=2)t(r[e],r[e+1]);if(u)for(let t=0;t<l.length;t++){const e=l[t];for(let t=1;t<e.length;t+=2)o.emplaceBack(f+e[t-1],f+e[t]);p.primitiveLength+=e.length/2}}else!function(t,e,n,i,r,a){const s=[];for(let h=0;h<i.length/2;h++)s.push(-1);const o={count:0};let l=0,c=t.getOrCreateLatestSegment(e,n),u=c.vertexLength;for(let h=2;h<r.length;h+=3){const d=r[h-2],f=r[h-1],p=r[h];let m=s[d]<l,g=s[f]<l,_=s[p]<l;c.vertexLength+((m?1:0)+(g?1:0)+(_?1:0))>Ys.MAX_VERTEX_ARRAY_LENGTH&&(c=t.createNewSegment(e,n),l=o.count,m=!0,g=!0,_=!0,u=0);const y=oc(s,i,a,o,d,m,c),v=oc(s,i,a,o,f,g,c),b=oc(s,i,a,o,p,_,c);n.emplaceBack(u+y-l,u+v-l,u+b-l),c.primitiveLength++}}(e,n,i,r,a,t),u&&function(t,e,n,i,r,a){const s=[];for(let h=0;h<i.length/2;h++)s.push(-1);const o={count:0};let l=0,c=t.getOrCreateLatestSegment(e,n),u=c.vertexLength;for(let h=0;h<r.length;h++){const d=r[h];for(let f=1;f<r[h].length;f+=2){const r=d[f-1],h=d[f];let p=s[r]<l,m=s[h]<l;c.vertexLength+((p?1:0)+(m?1:0))>Ys.MAX_VERTEX_ARRAY_LENGTH&&(c=t.createNewSegment(e,n),l=o.count,p=!0,m=!0,u=0);const g=oc(s,i,a,o,r,p,c),_=oc(s,i,a,o,h,m,c);n.emplaceBack(u+g-l,u+_-l),c.primitiveLength++}}}(s,n,o,r,l,t),e.forceNewSegmentOnNextPrepare(),null==s||s.forceNewSegmentOnNextPrepare()}function oc(t,e,n,i,r,a,s){if(a){const a=i.count;return n(e[2*r],e[2*r+1]),t[r]=i.count,i.count++,s.vertexLength++,a}return t[r]}class lc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ds,this.indexArray=new Zs,this.indexArray2=new Ws,this.programConfigurations=new So(t.layers,t.zoom),this.segments=new Ys,this.segments2=new Ys,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){this.hasPattern=Ml("fill",this.layers,e);const i=this.layers[0].layout.get("fill-sort-key"),r=!i.isConstant(),a=[];for(const{feature:s,id:o,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,u=To(s,t);if(!this.layers[0]._featureFilter.filter(new Ta(this.zoom),u,n))continue;const h=r?i.evaluate(u,{},n,e.availableImages):void 0,d={id:o,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:t?u.geometry:Eo(s),patterns:{},sortKey:h};a.push(d)}r&&a.sort((t,e)=>t.sortKey-e.sortKey);for(const s of a){const{geometry:i,index:r,sourceLayerIndex:a}=s;if(this.hasPattern){const t=Al("fill",this.layers,s,{zoom:this.zoom},e);this.patternFeatures.push(t)}else this.addFeature(s,i,r,n,{},e.subdivisionGranularity);e.featureIndex.insert(t[r].feature,i,r,a,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,{imagePositions:n})}addFeatures(t,e,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n,t.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pl),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,i,r,a){for(const s of ei(e,500)){const t=ic(s,i,a.fill.getGranularityForZoomLevel(i.z)),e=this.layoutVertexArray;sc((t,n)=>{e.emplaceBack(t,n)},this.segments,this.layoutVertexArray,this.indexArray,t.verticesFlattened,t.indicesTriangles,this.segments2,this.indexArray2,t.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{imagePositions:r,canonical:i})}}let cc,uc;la("FillBucket",lc,{omit:["layers","patternFeatures"]});var hc={get paint(){return uc=uc||new Va({"fill-antialias":new Ba(vt.paint_fill["fill-antialias"]),"fill-opacity":new ja(vt.paint_fill["fill-opacity"]),"fill-color":new ja(vt.paint_fill["fill-color"]),"fill-outline-color":new ja(vt.paint_fill["fill-outline-color"]),"fill-translate":new Ba(vt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ba(vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ua(vt.paint_fill["fill-pattern"])})},get layout(){return cc=cc||new Va({"fill-sort-key":new ja(vt.layout_fill["fill-sort-key"])})}};class dc extends Wa{constructor(t,e){super(t,hc,e)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new lc(t)}queryRadius(){return Zo(this.paint.get("fill-translate"))}queryIntersectsFeature(t){let{queryGeometry:e,geometry:n,transform:i,pixelsToTileUnits:r}=t;return Do(Wo(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-i.bearingInRadians,r),n)}isTileClipped(){return!0}}const fc=Ka([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),pc=Ka([{name:"a_centroid",components:2,type:"Int16"}],4),{members:mc}=fc;class gc{constructor(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(_c,this,e)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos,i=[];let r,a=1,s=0,o=0,l=0;for(;t.pos<e;){if(s<=0){const e=t.readVarint();a=7&e,s=e>>3}if(s--,1===a||2===a)o+=t.readSVarint(),l+=t.readSVarint(),1===a&&(r&&i.push(r),r=[]),r&&r.push(new n(o,l));else{if(7!==a)throw new Error("unknown command ".concat(a));r&&r.push(r[0].clone())}}return r&&i.push(r),i}bbox(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n=1,i=0,r=0,a=0,s=1/0,o=-1/0,l=1/0,c=-1/0;for(;t.pos<e;){if(i<=0){const e=t.readVarint();n=7&e,i=e>>3}if(i--,1===n||2===n)r+=t.readSVarint(),a+=t.readSVarint(),r<s&&(s=r),r>o&&(o=r),a<l&&(l=a),a>c&&(c=a);else if(7!==n)throw new Error("unknown command ".concat(n))}return[s,l,o,c]}toGeoJSON(t,e,n){const i=this.extent*Math.pow(2,n),r=this.extent*t,a=this.extent*e,s=this.loadGeometry();function o(t){return[360*(t.x+r)/i-180,360/Math.PI*Math.atan(Math.exp((1-2*(t.y+a)/i)*Math.PI))-90]}function l(t){return t.map(o)}let c;if(1===this.type){const t=[];for(const n of s)t.push(n[0]);const e=l(t);c=1===t.length?{type:"Point",coordinates:e[0]}:{type:"MultiPoint",coordinates:e}}else if(2===this.type){const t=s.map(l);c=1===t.length?{type:"LineString",coordinates:t[0]}:{type:"MultiLineString",coordinates:t}}else{if(3!==this.type)throw new Error("unknown feature type");{const t=function(t){const e=t.length;if(e<=1)return[t];const n=[];let i,r;for(let a=0;a<e;a++){const e=yc(t[a]);0!==e&&(void 0===r&&(r=e<0),r===e<0?(i&&n.push(i),i=[t[a]]):i&&i.push(t[a]))}return i&&n.push(i),n}(s),e=[];for(const n of t)e.push(n.map(l));c=1===e.length?{type:"Polygon",coordinates:e[0]}:{type:"MultiPolygon",coordinates:e}}}const u={type:"Feature",geometry:c,properties:this.properties};return null!=this.id&&(u.id=this.id),u}}function _c(t,e,n){1===t?e.id=n.readVarint():2===t?function(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos)}function yc(t){let e=0;for(let n,i,r=0,a=t.length,s=a-1;r<a;s=r++)n=t[r],i=t[s],e+=(i.x-n.x)*(n.y+i.y);return e}gc.types=["Unknown","Point","LineString","Polygon"];class vc{constructor(t,e){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(bc,this,e),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const e=this._pbf.readVarint()+this._pbf.pos;return new gc(this._pbf,e,this.extent,this._keys,this._values)}}function bc(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}if(null==e)throw new Error("unknown feature value");return e}(n))}class xc{constructor(t,e){this.layers=t.readFields(wc,{},e)}}function wc(t,e,n){if(3===t){const t=new vc(n,n.readVarint()+n.pos);t.length&&(e[t.name]=t)}}const Sc=Math.pow(2,13);function Pc(t,e,n,i,r,a,s,o){t.emplaceBack(e,n,2*Math.floor(i*Sc)+s,r*Sc*2,a*Sc*2,Math.round(o))}class Mc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Rs,this.centroidVertexArray=new zs,this.indexArray=new Zs,this.programConfigurations=new So(t.layers,t.zoom),this.segments=new Ys,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){this.features=[],this.hasPattern=Ml("fill-extrusion",this.layers,e);for(const{feature:i,id:r,index:a,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,o=To(i,t);if(!this.layers[0]._featureFilter.filter(new Ta(this.zoom),o,n))continue;const l={id:r,sourceLayerIndex:s,index:a,geometry:t?o.geometry:Eo(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(Al("fill-extrusion",this.layers,l,{zoom:this.zoom},e)):this.addFeature(l,l.geometry,a,n,{},e.subdivisionGranularity),e.featureIndex.insert(i,l.geometry,a,s,this.index,!0)}}addFeatures(t,e,n){for(const i of this.features){const{geometry:r}=i;this.addFeature(i,r,i.index,e,n,t.subdivisionGranularity)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,{imagePositions:n})}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mc),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,pc.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,e,n,i,r,a){for(const s of ei(e,500)){const e={x:0,y:0,sampleCount:0},n=this.layoutVertexArray.length;this.processPolygon(e,i,t,s,a);const r=this.layoutVertexArray.length-n,o=Math.floor(e.x/e.sampleCount),l=Math.floor(e.y/e.sampleCount);for(let t=0;t<r;t++)this.centroidVertexArray.emplaceBack(o,l)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{imagePositions:r,canonical:i})}processPolygon(t,e,n,i,r){if(i.length<1)return;if(Ec(i[0]))return;for(const u of i)0!==u.length&&Ac(t,u);const a={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},s=r.fill.getGranularityForZoomLevel(e.z),o="Polygon"===gc.types[n.type];for(const u of i){if(0===u.length)continue;if(Ec(u))continue;const t=rc(u,s,o);this._generateSideFaces(t,a)}if(!o)return;const l=ic(i,e,s,!1),c=this.layoutVertexArray;sc((t,e)=>{Pc(c,t,e,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,l.verticesFlattened,l.indicesTriangles)}_generateSideFaces(t,e){let n=0;for(let i=1;i<t.length;i++){const r=t[i],a=t[i-1];if(kc(r,a))continue;e.segment.vertexLength+4>Ys.MAX_VERTEX_ARRAY_LENGTH&&(e.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const s=r.sub(a)._perp()._unit(),o=a.dist(r);n+o>32768&&(n=0),Pc(this.layoutVertexArray,r.x,r.y,s.x,s.y,0,0,n),Pc(this.layoutVertexArray,r.x,r.y,s.x,s.y,0,1,n),n+=o,Pc(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,0,n),Pc(this.layoutVertexArray,a.x,a.y,s.x,s.y,0,1,n);const l=e.segment.vertexLength;this.indexArray.emplaceBack(l,l+2,l+1),this.indexArray.emplaceBack(l+1,l+2,l+3),e.segment.vertexLength+=4,e.segment.primitiveLength+=2}}}function Ac(t,e){for(let n=0;n<e.length;n++){const i=e[n];n===e.length-1&&e[0].x===i.x&&e[0].y===i.y||(t.x+=i.x,t.y+=i.y,t.sampleCount++)}}function kc(t,e){return t.x===e.x&&(t.x<0||t.x>C)||t.y===e.y&&(t.y<0||t.y>C)}function Ec(t){return t.every(t=>t.x<0)||t.every(t=>t.x>C)||t.every(t=>t.y<0)||t.every(t=>t.y>C)}let Tc;la("FillExtrusionBucket",Mc,{omit:["layers","features"]});var Cc={get paint(){return Tc=Tc||new Va({"fill-extrusion-opacity":new Ba(vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ja(vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ba(vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ba(vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ua(vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ja(vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ja(vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ba(vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Ic extends Wa{constructor(t,e){super(t,Cc,e)}createBucket(t){return new Mc(t)}queryRadius(){return Zo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t){let{queryGeometry:e,feature:i,featureState:r,geometry:a,transform:s,pixelsToTileUnits:o,pixelPosMatrix:l}=t;const c=Wo(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-s.bearingInRadians,o),u=this.paint.get("fill-extrusion-height").evaluate(i,r),h=this.paint.get("fill-extrusion-base").evaluate(i,r),d=function(t,e){const i=[];for(const r of t){const t=[r.x,r.y,0,1];M(t,t,e),i.push(new n(t[0]/t[3],t[1]/t[3]))}return i}(c,l),f=function(t,e,i,r){const a=[],s=[],o=r[8]*e,l=r[9]*e,c=r[10]*e,u=r[11]*e,h=r[8]*i,d=r[9]*i,f=r[10]*i,p=r[11]*i;for(const m of t){const t=[],e=[];for(const i of m){const a=i.x,s=i.y,m=r[0]*a+r[4]*s+r[12],g=r[1]*a+r[5]*s+r[13],_=r[2]*a+r[6]*s+r[14],y=r[3]*a+r[7]*s+r[15],v=_+c,b=y+u,x=m+h,w=g+d,S=_+f,P=y+p,M=new n((m+o)/b,(g+l)/b);M.z=v/b,t.push(M);const A=new n(x/P,w/P);A.z=S/P,e.push(A)}a.push(t),s.push(e)}return[a,s]}(a,h,u,l);return function(t,e,n){let i=1/0;Do(n,e)&&(i=zc(n,e[0]));for(let r=0;r<e.length;r++){const a=e[r],s=t[r];for(let t=0;t<a.length-1;t++){const e=a[t],r=[e,a[t+1],s[t+1],s[t],e];zo(n,r)&&(i=Math.min(i,zc(n,r)))}}return i!==1/0&&i}(f[0],f[1],d)}}function Lc(t,e){return t.x*e.x+t.y*e.y}function zc(t,e){if(1===t.length){let n=0;const i=e[n++];let r;for(;!r||i.equals(r);)if(r=e[n++],!r)return 1/0;for(;n<e.length;n++){const a=e[n],s=t[0],o=r.sub(i),l=a.sub(i),c=s.sub(i),u=Lc(o,o),h=Lc(o,l),d=Lc(l,l),f=Lc(c,o),p=Lc(c,l),m=u*d-h*h,g=(d*f-h*p)/m,_=(u*p-h*f)/m,y=i.z*(1-g-_)+r.z*g+a.z*_;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}const Nc=Ka([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Dc}=Nc,Rc=Ka([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Fc}=Rc,Oc=Math.cos(Math.PI/180*37.5),Bc=Math.pow(2,14)/.5;class jc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new Fs,this.layoutVertexArray2=new Os,this.indexArray=new Zs,this.programConfigurations=new So(t.layers,t.zoom),this.segments=new Ys,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,n){this.hasPattern=Ml("line",this.layers,e);const i=this.layers[0].layout.get("line-sort-key"),r=!i.isConstant(),a=[];for(const{feature:s,id:o,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,e=To(s,t);if(!this.layers[0]._featureFilter.filter(new Ta(this.zoom),e,n))continue;const u=r?i.evaluate(e,{},n):void 0,h={id:o,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:t?e.geometry:Eo(s),patterns:{},sortKey:u};a.push(h)}r&&a.sort((t,e)=>t.sortKey-e.sortKey);for(const s of a){const{geometry:i,index:r,sourceLayerIndex:a}=s;if(this.hasPattern){const t=Al("line",this.layers,s,{zoom:this.zoom},e);this.patternFeatures.push(t)}else this.addFeature(s,i,r,n,{},e.subdivisionGranularity);e.featureIndex.insert(t[r].feature,i,r,a,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,{imagePositions:n})}addFeatures(t,e,n){for(const i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,e,n,t.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Fc)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Dc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,i,r,a){const s=this.layers[0].layout,o=s.get("line-join").evaluate(t,{}),l=s.get("line-cap"),c=s.get("line-miter-limit"),u=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const h of e)this.addLine(h,t,o,l,c,u,i,a);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{imagePositions:r,canonical:i})}addLine(t,e,n,i,r,a,s,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=rc(t,s?o.line.getGranularityForZoomLevel(s.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const l="Polygon"===gc.types[e.type];let c=t.length;for(;c>=2&&t[c-1].equals(t[c-2]);)c--;let u=0;for(;u<c-1&&t[u].equals(t[u+1]);)u++;if(c<(l?3:2))return;"bevel"===n&&(r=1.05);const h=this.overscaling<=16?122880/(512*this.overscaling):0,d=this.segments.prepareSegment(10*c,this.layoutVertexArray,this.indexArray);let f,p,m,g,_;this.e1=this.e2=-1,l&&(f=t[c-2],_=t[u].sub(f)._unit()._perp());for(let y=u;y<c;y++){if(m=y===c-1?l?t[u+1]:void 0:t[y+1],m&&t[y].equals(m))continue;_&&(g=_),f&&(p=f),f=t[y],_=m?m.sub(f)._unit()._perp():g,g=g||_;let e=g.add(_);0===e.x&&0===e.y||e._unit();const s=g.x*_.x+g.y*_.y,o=e.x*_.x+e.y*_.y,v=0!==o?1/o:1/0,b=2*Math.sqrt(2-2*o),x=o<Oc&&p&&m,w=g.x*_.y-g.y*_.x>0;if(x&&y>u){const t=f.dist(p);if(t>2*h){const e=f.sub(f.sub(p)._mult(h/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,g,0,0,d),p=e}}const S=p&&m;let P=S?n:l?"butt":i;if(S&&"round"===P&&(v<a?P="miter":v<=2&&(P="fakeround")),"miter"===P&&v>r&&(P="bevel"),"bevel"===P&&(v>2&&(P="flipbevel"),v<r&&(P="miter")),p&&this.updateDistance(p,f),"miter"===P)e._mult(v),this.addCurrentVertex(f,e,0,0,d);else if("flipbevel"===P){if(v>100)e=_.mult(-1);else{const t=v*g.add(_).mag()/g.sub(_).mag();e._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(f,e,0,0,d),this.addCurrentVertex(f,e.mult(-1),0,0,d)}else if("bevel"===P||"fakeround"===P){const t=-Math.sqrt(v*v-1),e=w?t:0,n=w?0:t;if(p&&this.addCurrentVertex(f,g,e,n,d),"fakeround"===P){const t=Math.round(180*b/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+s*(s*(3.55645-1.43519*s)-3.2452))*t*t+(.848013+s*(.215638*s-1.06021)))}const i=_.sub(g)._mult(n)._add(g)._unit()._mult(w?-1:1);this.addHalfVertex(f,i.x,i.y,!1,w,0,d)}}m&&this.addCurrentVertex(f,_,-e,-n,d)}else if("butt"===P)this.addCurrentVertex(f,e,0,0,d);else if("square"===P){const t=p?1:-1;this.addCurrentVertex(f,e,t,t,d)}else"round"===P&&(p&&(this.addCurrentVertex(f,g,0,0,d),this.addCurrentVertex(f,g,1,1,d,!0)),m&&(this.addCurrentVertex(f,_,-1,-1,d,!0),this.addCurrentVertex(f,_,0,0,d)));if(x&&y<c-1){const t=f.dist(m);if(t>2*h){const e=f.add(m.sub(f)._mult(h/t)._round());this.updateDistance(f,e),this.addCurrentVertex(e,_,0,0,d),f=e}}}}addCurrentVertex(t,e,n,i,r){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const s=e.y*i-e.x,o=-e.y-e.x*i;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,a,!1,n,r),this.addHalfVertex(t,s,o,a,!0,-i,r),this.distance>Bc/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,e,n,i,r,a))}addHalfVertex(t,e,n,i,r,a,s){let{x:o,y:l}=t;const c=.5*(this.lineClips?this.scaledDistance*(Bc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(i?1:0),(l<<1)+(r?1:0),Math.round(63*e)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1)|(63&c)<<2,c>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,u,this.e2),s.primitiveLength++),r?this.e2=u:this.e1=u}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}let Uc,Gc;la("LineBucket",jc,{omit:["layers","patternFeatures"]});var qc={get paint(){return Gc=Gc||new Va({"line-opacity":new ja(vt.paint_line["line-opacity"]),"line-color":new ja(vt.paint_line["line-color"]),"line-translate":new Ba(vt.paint_line["line-translate"]),"line-translate-anchor":new Ba(vt.paint_line["line-translate-anchor"]),"line-width":new ja(vt.paint_line["line-width"]),"line-gap-width":new ja(vt.paint_line["line-gap-width"]),"line-offset":new ja(vt.paint_line["line-offset"]),"line-blur":new ja(vt.paint_line["line-blur"]),"line-dasharray":new Ga(vt.paint_line["line-dasharray"]),"line-pattern":new Ua(vt.paint_line["line-pattern"]),"line-gradient":new qa(vt.paint_line["line-gradient"])})},get layout(){return Uc=Uc||new Va({"line-cap":new Ba(vt.layout_line["line-cap"]),"line-join":new ja(vt.layout_line["line-join"]),"line-miter-limit":new Ba(vt.layout_line["line-miter-limit"]),"line-round-limit":new Ba(vt.layout_line["line-round-limit"]),"line-sort-key":new ja(vt.layout_line["line-sort-key"])})}};class Vc extends ja{possiblyEvaluate(t,e){return e=new Ta(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,i){return e=B({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,i)}}let Zc;class Wc extends Wa{constructor(t,e){super(t,qc,e),this.gradientVersion=0,Zc||(Zc=new Vc(qc.paint.properties["line-width"].specification),Zc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this.gradientExpression();this.stepInterpolant=!!function(t){return void 0!==t._styleExpression}(t)&&t._styleExpression.expression instanceof ln,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Zc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new jc(t)}queryRadius(t){const e=t,n=Hc(Vo("line-width",this,e),Vo("line-gap-width",this,e)),i=Vo("line-offset",this,e);return n/2+Math.abs(i)+Zo(this.paint.get("line-translate"))}queryIntersectsFeature(t){let{queryGeometry:e,feature:i,featureState:r,geometry:a,transform:s,pixelsToTileUnits:o}=t;const l=Wo(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-s.bearingInRadians,o),c=o/2*Hc(this.paint.get("line-width").evaluate(i,r),this.paint.get("line-gap-width").evaluate(i,r)),u=this.paint.get("line-offset").evaluate(i,r);return u&&(a=function(t,e){const i=[];for(let r=0;r<t.length;r++){const a=t[r],s=[];for(let t=0;t<a.length;t++){const i=a[t-1],r=a[t],o=a[t+1],l=0===t?new n(0,0):r.sub(i)._unit()._perp(),c=t===a.length-1?new n(0,0):o.sub(r)._unit()._perp(),u=l._add(c)._unit(),h=u.x*c.x+u.y*c.y;0!==h&&u._mult(1/h),s.push(u._mult(e)._add(r))}i.push(s)}return i}(a,u*o)),function(t,e,n){for(let i=0;i<e.length;i++){const r=e[i];if(t.length>=3)for(let e=0;e<r.length;e++)if(Go(t,r[e]))return!0;if(Ro(t,r,n))return!0}return!1}(l,a,c)}isTileClipped(){return!0}}function Hc(t,e){return e>0?e+2*t:t}const Xc=Ka([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yc=Ka([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ka([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Kc=Ka([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ka([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Jc=Ka([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$c=Ka([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Qc(t,e,n){return t.sections.forEach(t=>{t.text=function(t,e,n){const i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),Ea.applyArabicShaping&&(t=Ea.applyArabicShaping(t)),t}(t.text,e,n)}),t}Ka([{name:"triangle",components:3,type:"Uint16"}]),Ka([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ka([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ka([{type:"Float32",name:"offsetX"}]),Ka([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ka([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const tu={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var eu=24;const nu=4294967296,iu=1/nu,ru="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");class au{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array(16);this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.length;for(;this.pos<n;){const n=this.readVarint(),i=n>>3,r=this.pos;this.type=7&n,t(i,e,this),this.pos===r&&this.skip(n)}return e}readMessage(t,e){return this.readFields(t,e,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*nu;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*nu;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const e=this.buf;let n,i;return i=e[this.pos++],n=127&i,i<128?n:(i=e[this.pos++],n|=(127&i)<<7,i<128?n:(i=e[this.pos++],n|=(127&i)<<14,i<128?n:(i=e[this.pos++],n|=(127&i)<<21,i<128?n:(i=e[this.pos],n|=(15&i)<<28,function(t,e,n){const i=n.buf;let r,a;if(a=i[n.pos++],r=(112&a)>>4,a<128)return su(t,r,e);if(a=i[n.pos++],r|=(127&a)<<3,a<128)return su(t,r,e);if(a=i[n.pos++],r|=(127&a)<<10,a<128)return su(t,r,e);if(a=i[n.pos++],r|=(127&a)<<17,a<128)return su(t,r,e);if(a=i[n.pos++],r|=(127&a)<<24,a<128)return su(t,r,e);if(a=i[n.pos++],r|=(1&a)<<31,a<128)return su(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(n,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return Boolean(this.readVarint())}readString(){const t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&ru?ru.decode(this.buf.subarray(e,t)):function(t,e,n){let i="",r=e;for(;r<n;){const e=t[r];let a,s,o,l=null,c=e>239?4:e>223?3:e>191?2:1;if(r+c>n)break;1===c?e<128&&(l=e):2===c?(a=t[r+1],128==(192&a)&&(l=(31&e)<<6|63&a,l<=127&&(l=null))):3===c?(a=t[r+1],s=t[r+2],128==(192&a)&&128==(192&s)&&(l=(15&e)<<12|(63&a)<<6|63&s,(l<=2047||l>=55296&&l<=57343)&&(l=null))):4===c&&(a=t[r+1],s=t[r+2],o=t[r+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(l=(15&e)<<18|(63&a)<<12|(63&s)<<6|63&o,(l<=65535||l>=1114112)&&(l=null))),null===l?(l=65533,c=1):l>65535&&(l-=65536,i+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),i+=String.fromCharCode(l),r+=c}return i}(this.buf,e,t)}readBytes(){const t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e}readPackedVarint(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;const n=this.readPackedEnd();for(;this.pos<n;)t.push(this.readVarint(e));return t}readPackedSVarint(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSVarint());return t}readPackedBoolean(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readBoolean());return t}readPackedFloat(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFloat());return t}readPackedDouble(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readDouble());return t}readPackedFixed32(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed32());return t}readPackedSFixed32(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed32());return t}readPackedFixed64(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed64());return t}readPackedSFixed64(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed64());return t}readPackedEnd(){return 2===this.type?this.readVarint()+this.pos:this.pos+1}skip(t){const e=7&t;if(0===e)for(;this.buf[this.pos++]>127;);else if(2===e)this.pos=this.readVarint()+this.pos;else if(5===e)this.pos+=4;else{if(1!==e)throw new Error("Unimplemented type: ".concat(e));this.pos+=8}}writeTag(t,e){this.writeVarint(t<<3|e)}realloc(t){let e=this.length||16;for(;e<this.pos+t;)e*=2;if(e!==this.length){const t=new Uint8Array(e);t.set(this.buf),this.buf=t,this.dataView=new DataView(t.buffer),this.length=e}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*iu),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*iu),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?function(t,e){let n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(n=~(-t%4294967296),i=~(-t/4294967296),4294967295^n?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){const n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const e=this.pos;this.pos=function(t,e,n){for(let i,r,a=0;a<e.length;a++){if(i=e.charCodeAt(a),i>55295&&i<57344){if(!r){i>56319||a+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);const n=this.pos-e;n>=128&&ou(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const e=t.length;this.writeVarint(e),this.realloc(e);for(let n=0;n<e;n++)this.buf[this.pos++]=t[n]}writeRawMessage(t,e){this.pos++;const n=this.pos;t(e,this);const i=this.pos-n;i>=128&&ou(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i}writeMessage(t,e,n){this.writeTag(t,2),this.writeRawMessage(e,n)}writePackedVarint(t,e){e.length&&this.writeMessage(t,lu,e)}writePackedSVarint(t,e){e.length&&this.writeMessage(t,cu,e)}writePackedBoolean(t,e){e.length&&this.writeMessage(t,du,e)}writePackedFloat(t,e){e.length&&this.writeMessage(t,uu,e)}writePackedDouble(t,e){e.length&&this.writeMessage(t,hu,e)}writePackedFixed32(t,e){e.length&&this.writeMessage(t,fu,e)}writePackedSFixed32(t,e){e.length&&this.writeMessage(t,pu,e)}writePackedFixed64(t,e){e.length&&this.writeMessage(t,mu,e)}writePackedSFixed64(t,e){e.length&&this.writeMessage(t,gu,e)}writeBytesField(t,e){this.writeTag(t,2),this.writeBytes(e)}writeFixed32Field(t,e){this.writeTag(t,5),this.writeFixed32(e)}writeSFixed32Field(t,e){this.writeTag(t,5),this.writeSFixed32(e)}writeFixed64Field(t,e){this.writeTag(t,1),this.writeFixed64(e)}writeSFixed64Field(t,e){this.writeTag(t,1),this.writeSFixed64(e)}writeVarintField(t,e){this.writeTag(t,0),this.writeVarint(e)}writeSVarintField(t,e){this.writeTag(t,0),this.writeSVarint(e)}writeStringField(t,e){this.writeTag(t,2),this.writeString(e)}writeFloatField(t,e){this.writeTag(t,5),this.writeFloat(e)}writeDoubleField(t,e){this.writeTag(t,1),this.writeDouble(e)}writeBooleanField(t,e){this.writeVarintField(t,+e)}}function su(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function ou(t,e,n){const i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(let r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function lu(t,e){for(let n=0;n<t.length;n++)e.writeVarint(t[n])}function cu(t,e){for(let n=0;n<t.length;n++)e.writeSVarint(t[n])}function uu(t,e){for(let n=0;n<t.length;n++)e.writeFloat(t[n])}function hu(t,e){for(let n=0;n<t.length;n++)e.writeDouble(t[n])}function du(t,e){for(let n=0;n<t.length;n++)e.writeBoolean(t[n])}function fu(t,e){for(let n=0;n<t.length;n++)e.writeFixed32(t[n])}function pu(t,e){for(let n=0;n<t.length;n++)e.writeSFixed32(t[n])}function mu(t,e){for(let n=0;n<t.length;n++)e.writeFixed64(t[n])}function gu(t,e){for(let n=0;n<t.length;n++)e.writeSFixed64(t[n])}function _u(t,e,n){1===t&&n.readMessage(yu,e)}function yu(t,e,n){if(3===t){const{id:t,bitmap:i,width:r,height:a,left:s,top:o,advance:l}=n.readMessage(vu,{});e.push({id:t,bitmap:new cl({width:r+6,height:a+6},i),metrics:{width:r,height:a,left:s,top:o,advance:l}})}}function vu(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function bu(t){let e=0,n=0;for(const s of t)e+=s.w*s.h,n=Math.max(n,s.w);t.sort((t,e)=>e.h-t.h);const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let r=0,a=0;for(const s of t)for(let t=i.length-1;t>=0;t--){const e=i[t];if(!(s.w>e.w||s.h>e.h)){if(s.x=e.x,s.y=e.y,a=Math.max(a,s.y+s.h),r=Math.max(r,s.x+s.w),s.w===e.w&&s.h===e.h){const e=i.pop();e&&t<i.length&&(i[t]=e)}else s.h===e.h?(e.x+=s.w,e.w-=s.w):s.w===e.w?(e.y+=s.h,e.h-=s.h):(i.push({x:e.x+s.w,y:e.y,w:e.w-s.w,h:s.h}),e.y+=s.h,e.h-=s.h);break}}return{w:r,h:a,fill:e/(r*a)||0}}class xu{constructor(t,e){let{pixelRatio:n,version:i,stretchX:r,stretchY:a,content:s,textFitWidth:o,textFitHeight:l}=e;this.paddedRect=t,this.pixelRatio=n,this.stretchX=r,this.stretchY=a,this.content=s,this.version=i,this.textFitWidth=o,this.textFitHeight=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class wu{constructor(t,e){const n={},i={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,n,r),this.addImages(e,i,r);const{w:a,h:s}=bu(r),o=new ul({width:a||1,height:s||1});for(const l in t){const e=t[l],i=n[l].paddedRect;ul.copy(e.data,o,{x:0,y:0},{x:i.x+1,y:i.y+1},e.data)}for(const l in e){const t=e[l],n=i[l].paddedRect,r=n.x+1,a=n.y+1,s=t.data.width,c=t.data.height;ul.copy(t.data,o,{x:0,y:0},{x:r,y:a},t.data),ul.copy(t.data,o,{x:0,y:c-1},{x:r,y:a-1},{width:s,height:1}),ul.copy(t.data,o,{x:0,y:0},{x:r,y:a+c},{width:s,height:1}),ul.copy(t.data,o,{x:s-1,y:0},{x:r-1,y:a},{width:1,height:c}),ul.copy(t.data,o,{x:0,y:0},{x:r+s,y:a},{width:1,height:c})}this.image=o,this.iconPositions=n,this.patternPositions=i}addImages(t,e,n){for(const i in t){const r=t[i],a={x:0,y:0,w:r.data.width+2,h:r.data.height+2};n.push(a),e[i]=new xu(a,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[i,r]=t.tl;n.update(e.data,void 0,{x:i,y:r})}}var Su;la("ImagePosition",xu),la("ImageAtlas",wu),t.ao=void 0,(Su=t.ao||(t.ao={}))[Su.none=0]="none",Su[Su.horizontal=1]="horizontal",Su[Su.vertical=2]="vertical",Su[Su.horizontalOnly=3]="horizontalOnly";class Pu{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,e,n){const i=new Pu;return i.scale=t||1,i.fontStack=e,i.verticalAlign=n||"bottom",i}static forImage(t,e){const n=new Pu;return n.imageName=t,n.verticalAlign=e||"bottom",n}}class Mu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new Mu;for(let i=0;i<t.sections.length;i++){const r=t.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let n=0;n<t.length;n++){const i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;e+=i&&Sa(i)&&!tu[t[n+1]]||r&&Sa(r)&&!tu[t[n-1]]||!tu[t[n]]?t[n]:tu[t[n]]}return e}(this.text)}trim(){let t=0;for(let n=0;n<this.text.length&&ku[this.text.charCodeAt(n)];n++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&ku[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new Mu;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,e)=>Math.max(t,this.sections[e].scale),0)}getMaxImageSize(t){let e=0,n=0;for(let i=0;i<this.length();i++){const r=this.getSection(i);if(r.imageName){const i=t[r.imageName];if(!i)continue;const a=i.displaySize;e=Math.max(e,a[0]),n=Math.max(n,a[1])}}return{maxImageWidth:e,maxImageHeight:n}}addTextSection(t,e){this.text+=t.text,this.sections.push(Pu.forText(t.scale,t.fontStack||e,t.verticalAlign));const n=this.sections.length-1;for(let i=0;i<t.text.length;++i)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void Z("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Pu.forImage(e,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Z("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Au(e,n,i,r,a,s,o,l,c,u,h,d,f,p,m){const g=Mu.fromFeature(e,a);let _;d===t.ao.vertical&&g.verticalizePunctuation();const{processBidirectionalText:y,processStyledBidirectionalText:v}=Ea;if(y&&1===g.sections.length){_=[];const t=y(g.toString(),Du(g,u,s,n,r,p));for(const e of t){const t=new Mu;t.text=e,t.sections=g.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);_.push(t)}}else if(v){_=[];const t=v(g.text,g.sectionIndex,Du(g,u,s,n,r,p));for(const e of t){const t=new Mu;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,_.push(t)}}else _=function(t,e){const n=[],i=t.text;let r=0;for(const a of e)n.push(t.substring(r,a)),r=a;return r<i.length&&n.push(t.substring(r,i.length)),n}(g,Du(g,u,s,n,r,p));const b=[],x={positionedLines:b,text:g.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(t,e,n,i,r,a,s,o,l,c,u,h){let d=0,f=0,p=0,m=0;const g="right"===o?1:"left"===o?0:.5,_=eu/h;let y=0;for(const x of r){x.trim();const r=x.getMaxScale(),s={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=s;const o=s.positionedGlyphs;let h=0;if(!x.length()){f+=a,++y;continue}const v=Fu(i,x,_);for(let a=0;a<x.length();a++){const s=x.getSection(a),p=x.getSectionIndex(a),m=x.getCharCode(a),g=Bu(l,u,m);let y;if(s.imageName){if(t.iconsInText=!0,s.scale=s.scale*_,y=Uu(s,g,r,v,i),!y)continue;h=Math.max(h,y.imageOffset)}else if(y=ju(s,m,g,v,e,n),!y)continue;const{rect:b,metrics:w,baselineOffset:S}=y;o.push({glyph:m,imageName:s.imageName,x:d,y:f+S+-17,vertical:g,scale:s.scale,fontStack:s.fontStack,sectionIndex:p,metrics:w,rect:b}),g?(t.verticalizable=!0,d+=(s.imageName?w.advance:eu)*s.scale+c):d+=w.advance*s.scale+c}0!==o.length&&(p=Math.max(d-c,p),Gu(o,0,o.length-1,g)),d=0,s.lineOffset=Math.max(h,(r-1)*eu);const b=a*r+h;f+=b,m=Math.max(b,m),++y}const{horizontalAlign:v,verticalAlign:b}=Ru(s);(function(t,e,n,i,r,a,s,o,l){const c=(e-n)*r;let u=0;u=a!==s?-o*i- -17:-i*l*s+.5*s;for(const h of t)for(const t of h.positionedGlyphs)t.x+=c,t.y+=u})(t.positionedLines,g,v,b,p,m,a,f,r.length),t.top+=-b*f,t.bottom=t.top+f,t.left+=-v*p,t.right=t.left+p}(x,n,i,r,_,o,l,c,d,u,f,m),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(b)&&x}const ku={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Eu={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Tu={40:!0};function Cu(t,e,n,i,r,a){if(e.imageName){const t=i[e.imageName];return t?t.displaySize[0]*e.scale*eu/a+r:0}{const i=n[e.fontStack],a=i&&i[t];return a?a.metrics.advance*e.scale+r:0}}function Iu(t,e,n,i){const r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function Lu(t,e,n){let i=0;return 10===t&&(i-=1e4),n&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function zu(t,e,n,i,r,a){let s=null,o=Iu(e,n,r,a);for(const l of i){const t=Iu(e-l.x,n,r,a)+l.badness;t<=o&&(s=l,o=t)}return{index:t,x:e,priorBreak:s,badness:o}}function Nu(t){return t?Nu(t.priorBreak).concat(t.index):[]}function Du(t,e,n,i,r,a){if(!t)return[];const s=[],o=function(t,e,n,i,r,a){let s=0;for(let o=0;o<t.length();o++){const n=t.getSection(o);s+=Cu(t.getCharCode(o),n,i,r,e,a)}return s/Math.max(1,Math.ceil(s/n))}(t,e,n,i,r,a),l=t.text.indexOf("\u200b")>=0;let c=0;for(let h=0;h<t.length();h++){const n=t.getSection(h),d=t.getCharCode(h);if(ku[d]||(c+=Cu(d,n,i,r,e,a)),h<t.length()-1){const e=!((u=d)<11904)&&(!!ma["CJK Compatibility Forms"](u)||!!ma["CJK Compatibility"](u)||!!ma["CJK Strokes"](u)||!!ma["CJK Symbols and Punctuation"](u)||!!ma["Enclosed CJK Letters and Months"](u)||!!ma["Halfwidth and Fullwidth Forms"](u)||!!ma["Ideographic Description Characters"](u)||!!ma["Vertical Forms"](u)||xa.test(String.fromCodePoint(u)));(Eu[d]||e||n.imageName||h!==t.length()-2&&Tu[t.getCharCode(h+1)])&&s.push(zu(h+1,c,o,s,Lu(d,t.getCharCode(h+1),e&&l),!1))}}var u;return Nu(zu(t.length(),c,o,s,0,!0))}function Ru(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Fu(t,e,n){const i=e.getMaxScale()*eu,{maxImageWidth:r,maxImageHeight:a}=e.getMaxImageSize(t),s=Math.max(i,a*n);return{verticalLineContentWidth:Math.max(i,r*n),horizontalLineContentHeight:s}}function Ou(t){switch(t){case"top":return 0;case"center":return.5;default:return 1}}function Bu(e,n,i){return!(e===t.ao.horizontal||!n&&!wa(i)||n&&(ku[i]||(r=i,/(?:[\u0600-\u0604\u0606-\u060B\u060D-\u061A\u061C-\u061E\u0620-\u063F\u0641-\u064A\u0656-\u066F\u0671-\u06DC\u06DE-\u06FF\u0750-\u077F\u0870-\u0891\u0897-\u08E1\u08E3-\u08FF\uFB50-\uFD3D\uFD40-\uFDCF\uFDF0-\uFDFF\uFE70-\uFE74\uFE76-\uFEFC]|\uD803[\uDE60-\uDE7E\uDEC2-\uDEC7\uDED0-\uDED8\uDEFA-\uDEFF]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB\uDEF0\uDEF1])/.test(String.fromCodePoint(r)))));var r}function ju(t,e,n,i,r,a){const s=a[t.fontStack],o=function(t,e,n,i){if(t&&t.rect)return t;const r=e[n.fontStack],a=r&&r[i];return a?{rect:null,metrics:a.metrics}:null}(s&&s[e],r,t,e);if(null===o)return null;let l;if(n)l=i.verticalLineContentWidth-t.scale*eu;else{const e=Ou(t.verticalAlign);l=(i.horizontalLineContentHeight-t.scale*eu)*e}return{rect:o.rect,metrics:o.metrics,baselineOffset:l}}function Uu(t,e,n,i,r){const a=r[t.imageName];if(!a)return null;const s=a.paddedRect,o=a.displaySize,l={width:o[0],height:o[1],left:1,top:-3,advance:e?o[1]:o[0]};let c;if(e)c=i.verticalLineContentWidth-o[1]*t.scale;else{const e=Ou(t.verticalAlign);c=(i.horizontalLineContentHeight-o[1]*t.scale)*e}return{rect:s,metrics:l,baselineOffset:c,imageOffset:(e?o[0]:o[1])*t.scale-eu*n}}function Gu(t,e,n,i){if(0===i)return;const r=t[n],a=(t[n].x+r.metrics.advance*r.scale)*i;for(let s=e;s<=n;s++)t[s].x-=a}function qu(t,e,n){const{horizontalAlign:i,verticalAlign:r}=Ru(n),a=e[0]-t.displaySize[0]*i,s=e[1]-t.displaySize[1]*r;return{image:t,top:s,bottom:s+t.displaySize[1],left:a,right:a+t.displaySize[0]}}function Vu(t){var e,n;let i=t.left,r=t.top,a=t.right-i,s=t.bottom-r;const o=null!==(e=t.image.textFitWidth)&&void 0!==e?e:"stretchOrShrink",l=null!==(n=t.image.textFitHeight)&&void 0!==n?n:"stretchOrShrink",c=(t.image.content[2]-t.image.content[0])/(t.image.content[3]-t.image.content[1]);if("proportional"===l){if("stretchOnly"===o&&a/s<c||"proportional"===o){const t=Math.ceil(s*c);i*=t/a,a=t}}else if("proportional"===o&&"stretchOnly"===l&&0!==c&&a/s>c){const t=Math.ceil(a/c);r*=t/s,s=t}return{x1:i,y1:r,x2:i+a,y2:r+s}}function Zu(t,e,n,i,r,a){const s=t.image;let o;if(s.content){const t=s.content,e=s.pixelRatio||1;o=[t[0]/e,t[1]/e,s.displaySize[0]-t[2]/e,s.displaySize[1]-t[3]/e]}const l=e.left*a,c=e.right*a;let u,h,d,f;"width"===n||"both"===n?(f=r[0]+l-i[3],h=r[0]+c+i[1]):(f=r[0]+(l+c-s.displaySize[0])/2,h=f+s.displaySize[0]);const p=e.top*a,m=e.bottom*a;return"height"===n||"both"===n?(u=r[1]+p-i[0],d=r[1]+m+i[2]):(u=r[1]+(p+m-s.displaySize[1])/2,d=u+s.displaySize[1]),{image:s,top:u,right:h,bottom:d,left:f,collisionPadding:o}}const Wu=128,Hu=32640;function Xu(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new Ta(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:i}=n;let r=0;for(;r<e.length&&e[r]<=t;)r++;r=Math.max(0,r-1);let a=r;for(;a<e.length&&e[a]<t+1;)a++;a=Math.min(e.length-1,a);const s=e[r],o=e[a];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:o,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:o,minSize:n.evaluate(new Ta(s)),maxSize:n.evaluate(new Ta(o)),interpolationType:i}}}function Yu(t,e,n){let i="never";const r=t.get(e);return r?i=r:t.get(n)&&(i="always"),i}const Ku=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ju(t,e,n,i,r,a,s,o,l,c,u,h,d){const f=o?Math.min(Hu,Math.round(o[0])):0,p=o?Math.min(Hu,Math.round(o[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),a,s,(f<<1)+(l?1:0),p,16*c,16*u,256*h,256*d)}function $u(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function Qu(t){for(const e of t.sections)if(ka(e.text))return!0;return!1}class th{constructor(t){this.layoutVertexArray=new js,this.indexArray=new Zs,this.programConfigurations=t,this.segments=new Ys,this.dynamicLayoutVertexArray=new Us,this.opacityVertexArray=new Gs,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ps}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Yc.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Ku,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}la("SymbolBuffers",th);class eh{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new Ys,this.collisionVertexArray=new Vs}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Kc.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}la("CollisionBuffers",eh);class nh{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Xu(this.zoom,n["text-size"]),this.iconSizeData=Xu(this.zoom,n["icon-size"]);const i=this.layers[0].layout,r=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap="never"!==Yu(i,"text-overlap","text-allow-overlap")||"never"!==Yu(i,"icon-overlap","icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!r.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(e=>t.ao[e])),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.sourceID=e.sourceID}createArrays(){this.text=new th(new So(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new th(new So(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ks,this.lineVertexArray=new Es,this.symbolInstances=new As,this.textAnchorOffsets=new Cs}calculateGlyphDependencies(t,e,n,i,r){for(let a=0;a<t.length;a++)if(e[t.charCodeAt(a)]=!0,(n||i)&&r){const n=tu[t.charAt(a)];n&&(e[n.charCodeAt(0)]=!0)}}populate(e,n,i){const r=this.layers[0],a=r.layout,s=a.get("text-font"),o=a.get("text-field"),l=a.get("icon-image"),c=("constant"!==o.value.kind||o.value.value instanceof Ie&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!c&&!u)return;const d=n.iconDependencies,f=n.glyphDependencies,p=n.availableImages,m=new Ta(this.zoom);for(const{feature:g,id:_,index:y,sourceLayerIndex:v}of e){const e=r._featureFilter.needGeometry,n=To(g,e);if(!r._featureFilter.filter(m,n,i))continue;let o,l;if(e||(n.geometry=Eo(g)),c){const t=r.getValueAndResolveTokens("text-field",n,i,p),e=Ie.factory(t),a=this.hasRTLText=this.hasRTLText||Qu(e);(!a||"unavailable"===Ea.getRTLTextPluginStatus()||a&&Ea.isParsed())&&(o=Qc(e,r,n))}if(u){const t=r.getValueAndResolveTokens("icon-image",n,i,p);l=t instanceof Oe?t:Oe.fromString(t)}if(!o&&!l)continue;const b=this.sortFeaturesByKey?h.evaluate(n,{},i):void 0;if(this.features.push({id:_,text:o,icon:l,index:y,sourceLayerIndex:v,geometry:n.geometry,properties:g.properties,type:gc.types[g.type],sortKey:b}),l&&(d[l.name]=!0),o){const e=s.evaluate(n,{},i).join(","),r="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(t.ao.vertical)>=0;for(const t of o.sections)if(t.image)d[t.image.name]=!0;else{const n=ga(o.toString()),i=t.fontStack||e,a=f[i]=f[i]||{};this.calculateGlyphDependencies(t.text,a,r,this.allowVerticalPlacement,n)}}}"line"===a.get("symbol-placement")&&(this.features=function(t){const e={},n={},i=[];let r=0;function a(e){i.push(t[e]),r++}function s(t,e,r){const a=n[t];return delete n[t],n[e]=a,i[a].geometry[0].pop(),i[a].geometry[0]=i[a].geometry[0].concat(r[0]),a}function o(t,n,r){const a=e[n];return delete e[n],e[t]=a,i[a].geometry[0].shift(),i[a].geometry[0]=r[0].concat(i[a].geometry[0]),a}function l(t,e,n){const i=n?e[0][e[0].length-1]:e[0][0];return"".concat(t,":").concat(i.x,":").concat(i.y)}for(let c=0;c<t.length;c++){const u=t[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){a(c);continue}const f=l(d,h),p=l(d,h,!0);if(f in n&&p in e&&n[f]!==e[p]){const t=o(f,p,h),r=s(f,p,i[t].geometry);delete e[f],delete n[p],n[l(d,i[r].geometry,!0)]=r,i[t].geometry=null}else f in n?s(f,p,h):p in e?o(f,p,h):(a(c),e[f]=r-1,n[p]=r-1)}return i.filter(t=>t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((t,e)=>t.sortKey-e.sortKey)}update(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,{imagePositions:n}),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,{imagePositions:n}))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment){let n=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]);const r={};for(let a=t.segment+1;a<e.length;a++)r[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:n},a<e.length-1&&(n+=e[a+1].dist(e[a]));for(let a=t.segment||0;a>=0;a--)r[a]={x:e[a].x,y:e[a].y,tileUnitDistanceFromAnchor:i},a>0&&(i+=e[a-1].dist(e[a]));for(let t=0;t<e.length;t++){const e=r[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,n,i,r,a,s,o,l,c,u,h,d){const f=e.indexArray,p=e.layoutVertexArray,m=e.segments.prepareSegment(4*n.length,p,f,this.canOverlap?s.sortKey:void 0),g=this.glyphOffsetArray.length,_=m.vertexLength,y=this.allowVerticalPlacement&&o===t.ao.vertical?Math.PI/2:0,v=s.text&&s.text.sections;for(let t=0;t<n.length;t++){const{tl:r,tr:a,bl:o,br:c,tex:u,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:_,minFontScaleY:b,glyphOffset:x,isSDF:w,sectionIndex:S}=n[t],P=m.vertexLength,M=x[1];Ju(p,l.x,l.y,r.x,M+r.y,u.x,u.y,i,w,h.x,h.y,_,b),Ju(p,l.x,l.y,a.x,M+a.y,u.x+u.w,u.y,i,w,g.x,h.y,_,b),Ju(p,l.x,l.y,o.x,M+o.y,u.x,u.y+u.h,i,w,h.x,g.y,_,b),Ju(p,l.x,l.y,c.x,M+c.y,u.x+u.w,u.y+u.h,i,w,g.x,g.y,_,b),$u(e.dynamicLayoutVertexArray,l,y),f.emplaceBack(P,P+2,P+1),f.emplaceBack(P+1,P+2,P+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(x[0]),t!==n.length-1&&S===n[t+1].sectionIndex||e.programConfigurations.populatePaintArrays(p.length,s,s.index,{imagePositions:{},canonical:d,formattedSection:v&&v[S]})}e.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,_,c,u,l.segment,i?i[0]:0,i?i[1]:0,r[0],r[1],o,0,!1,0,h)}_addCollisionDebugVertex(t,e,n,i,r,a){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i,r,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(t,e,i,r,a,s,o){const l=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),c=l.vertexLength,u=a.layoutVertexArray,h=a.collisionVertexArray,d=o.anchorX,f=o.anchorY;this._addCollisionDebugVertex(u,h,s,d,f,new n(t,e)),this._addCollisionDebugVertex(u,h,s,d,f,new n(i,e)),this._addCollisionDebugVertex(u,h,s,d,f,new n(i,r)),this._addCollisionDebugVertex(u,h,s,d,f,new n(t,r)),l.vertexLength+=4;const p=a.indexArray;p.emplaceBack(c,c+1),p.emplaceBack(c+1,c+2),p.emplaceBack(c+2,c+3),p.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(t,e,n,i){for(let r=t;r<e;r++){const t=this.collisionBoxArray.get(r);this.addCollisionDebugVertices(t.x1,t.y1,t.x2,t.y2,i?this.textCollisionBox:this.iconCollisionBox,t.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new eh(qs,Jc.members,Ws),this.iconCollisionBox=new eh(qs,Jc.members,Ws);for(let t=0;t<this.symbolInstances.length;t++){const e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(t,e,n,i,r,a,s,o,l){const c={};for(let u=e;u<n;u++){const e=t.get(u);c.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.textFeatureIndex=e.featureIndex;break}for(let u=i;u<r;u++){const e=t.get(u);c.verticalTextBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.verticalTextFeatureIndex=e.featureIndex;break}for(let u=a;u<s;u++){const e=t.get(u);c.iconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.iconFeatureIndex=e.featureIndex;break}for(let u=o;u<l;u++){const e=t.get(u);c.verticalIconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.verticalIconFeatureIndex=e.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),i=n.vertexStartIndex+4*n.numGlyphs;for(let r=n.vertexStartIndex;r<i;r+=4)t.indexArray.emplaceBack(r,r+2,r+1),t.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),i=[],r=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);const t=this.symbolInstances.get(s);i.push(0|Math.round(e*t.anchorX+n*t.anchorY)),r.push(t.featureIndex)}return a.sort((t,e)=>i[t]-i[e]||r[e]-r[t]),a}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach((t,e,n)=>{t>=0&&n.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)}),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ih,rh;la("SymbolBucket",nh,{omit:["layers","collisionBoxArray","features","compareText"]}),nh.MAX_GLYPHS=65535,nh.addDynamicAttributes=$u;var ah={get paint(){return rh=rh||new Va({"icon-opacity":new ja(vt.paint_symbol["icon-opacity"]),"icon-color":new ja(vt.paint_symbol["icon-color"]),"icon-halo-color":new ja(vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ja(vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ja(vt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ba(vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ba(vt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ja(vt.paint_symbol["text-opacity"]),"text-color":new ja(vt.paint_symbol["text-color"],{runtimeType:Bt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new ja(vt.paint_symbol["text-halo-color"]),"text-halo-width":new ja(vt.paint_symbol["text-halo-width"]),"text-halo-blur":new ja(vt.paint_symbol["text-halo-blur"]),"text-translate":new Ba(vt.paint_symbol["text-translate"]),"text-translate-anchor":new Ba(vt.paint_symbol["text-translate-anchor"])})},get layout(){return ih=ih||new Va({"symbol-placement":new Ba(vt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ba(vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ba(vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ja(vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ba(vt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ba(vt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ba(vt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ba(vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ba(vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ba(vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ja(vt.layout_symbol["icon-size"]),"icon-text-fit":new Ba(vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ba(vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ja(vt.layout_symbol["icon-image"]),"icon-rotate":new ja(vt.layout_symbol["icon-rotate"]),"icon-padding":new ja(vt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ba(vt.layout_symbol["icon-keep-upright"]),"icon-offset":new ja(vt.layout_symbol["icon-offset"]),"icon-anchor":new ja(vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ba(vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ba(vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ba(vt.layout_symbol["text-rotation-alignment"]),"text-field":new ja(vt.layout_symbol["text-field"]),"text-font":new ja(vt.layout_symbol["text-font"]),"text-size":new ja(vt.layout_symbol["text-size"]),"text-max-width":new ja(vt.layout_symbol["text-max-width"]),"text-line-height":new Ba(vt.layout_symbol["text-line-height"]),"text-letter-spacing":new ja(vt.layout_symbol["text-letter-spacing"]),"text-justify":new ja(vt.layout_symbol["text-justify"]),"text-radial-offset":new ja(vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ba(vt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ja(vt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ja(vt.layout_symbol["text-anchor"]),"text-max-angle":new Ba(vt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ba(vt.layout_symbol["text-writing-mode"]),"text-rotate":new ja(vt.layout_symbol["text-rotate"]),"text-padding":new Ba(vt.layout_symbol["text-padding"]),"text-keep-upright":new Ba(vt.layout_symbol["text-keep-upright"]),"text-transform":new ja(vt.layout_symbol["text-transform"]),"text-offset":new ja(vt.layout_symbol["text-offset"]),"text-allow-overlap":new Ba(vt.layout_symbol["text-allow-overlap"]),"text-overlap":new Ba(vt.layout_symbol["text-overlap"]),"text-ignore-placement":new Ba(vt.layout_symbol["text-ignore-placement"]),"text-optional":new Ba(vt.layout_symbol["text-optional"])})}};class sh{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Dt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}la("FormatSectionOverride",sh,{omit:["defaultValue"]});class oh extends Wa{constructor(t,e){super(t,ah,e)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const n of t)e.indexOf(n)<0&&e.push(n);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,i){const r=this.layout.get(t).evaluate(e,{},n,i),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||nr(a.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,(e,n)=>t&&n in t?String(t[n]):"")}(e.properties,r)}createBucket(t){return new nh(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of ah.paint.overridableProperties){if(!oh.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new sh(e),i=new er(n,e.property.specification);let r=null;r="constant"===e.value.kind||"source"===e.value.kind?new rr("source",i):new ar("composite",i,e.value.zoomStops),this.paint._values[t]=new Fa(e.property,r,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&oh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),i=ah.paint.properties[e];let r=!1;const a=t=>{for(const e of t)if(i.overrides&&i.overrides.hasOverride(e))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof Ie)a(n.value.value.sections);else if("source"===n.value.kind||"composite"===n.value.kind){const t=e=>{r||(e instanceof Ve&&Ge(e.value)===Vt?a(e.value.sections):e instanceof Tn?a(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return r}}let lh;var ch={get paint(){return lh=lh||new Va({"background-color":new Ba(vt.paint_background["background-color"]),"background-pattern":new Ga(vt.paint_background["background-pattern"]),"background-opacity":new Ba(vt.paint_background["background-opacity"])})}};class uh extends Wa{constructor(t,e){super(t,ch,e)}}let hh;var dh={get paint(){return hh=hh||new Va({"raster-opacity":new Ba(vt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ba(vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ba(vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ba(vt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ba(vt.paint_raster["raster-saturation"]),"raster-contrast":new Ba(vt.paint_raster["raster-contrast"]),"raster-resampling":new Ba(vt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ba(vt.paint_raster["raster-fade-duration"])})}};class fh extends Wa{constructor(t,e){super(t,dh,e)}}class ph extends Wa{constructor(t,e){super(t,{},e),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class mh{constructor(t){this._methodToThrottle=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const gh={once:!0},_h=6371008.8;class yh{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(e,")"));if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new yh(O(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(t){const e=Math.PI/180,n=this.lat*e,i=t.lat*e,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return _h*Math.acos(Math.min(r,1))}static convert(t){if(t instanceof yh)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new yh(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new yh(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const vh=2*Math.PI*_h;function bh(t){return vh*Math.cos(t*Math.PI/180)}function xh(t){return(180+t)/360}function wh(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Sh(t,e){return t/bh(e)}function Ph(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Mh(t,e){return t*bh(Ph(e))}class Ah{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=yh.convert(t);return new Ah(xh(n.lng),wh(n.lat),Sh(e,n.lat))}toLngLat(){return new yh(360*this.x-180,Ph(this.y))}toAltitude(){return Mh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/vh*(t=Ph(this.y),1/Math.cos(t*Math.PI/180));var t}}function kh(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}class Eh{constructor(t,e,n){if(!function(t,e,n){return!(t<0||t>25||n<0||n>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))}(t,e,n))throw new Error("x=".concat(e,", y=").concat(n,", z=").concat(t," outside of bounds. 0<=x<").concat(Math.pow(2,t),", 0<=y<").concat(Math.pow(2,t)," 0<=z<=25 "));this.z=t,this.x=e,this.y=n,this.key=Ih(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e,n){const i=(a=this.y,s=this.z,o=kh(256*(r=this.x),256*(a=Math.pow(2,s)-a-1),s),l=kh(256*(r+1),256*(a+1),s),o[0]+","+o[1]+","+l[0]+","+l[1]);var r,a,s,o,l;const c=function(t,e,n){let i,r="";for(let a=t;a>0;a--)i=1<<a-1,r+=(e&i?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,i)}isChildOf(t){const e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}getTilePoint(t){const e=Math.pow(2,this.z);return new n((t.x*e-this.x)*C,(t.y*e-this.y)*C)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}class Th{constructor(t,e){this.wrap=t,this.canonical=e,this.key=Ih(t,e.z,e.z,e.x,e.y)}}class Ch{constructor(t,e,n,i,r){if(this.terrainRttPosMatrix32f=null,t<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(t,"; z = ").concat(n));this.overscaledZ=t,this.wrap=e,this.canonical=new Eh(n,+i,+r),this.key=Ih(e,t,n,i,r)}clone(){return new Ch(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(t,"; overscaledZ = ").concat(this.overscaledZ));const e=this.canonical.z-t;return t>this.canonical.z?new Ch(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ch(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e){if(t>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(t,"; overscaledZ = ").concat(this.overscaledZ));const n=this.canonical.z-t;return t>this.canonical.z?Ih(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Ih(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(t){if(t.wrap!==this.wrap)return!1;if(this.overscaledZ-t.overscaledZ<=0)return!1;if(0===t.overscaledZ)return this.overscaledZ>0;const e=this.canonical.z-t.canonical.z;return!(e<0)&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new Ch(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new Ch(e,this.wrap,e,n,i),new Ch(e,this.wrap,e,n+1,i),new Ch(e,this.wrap,e,n,i+1),new Ch(e,this.wrap,e,n+1,i+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ch(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ch(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Th(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(t){return this.canonical.getTilePoint(new Ah(t.x-this.wrap,t.y))}}function Ih(t,e,n,i,r){(t*=2)<0&&(t=-1*t-1);const a=1<<n;return(a*a*t+a*r+i).toString(36)+n.toString(36)+e.toString(36)}function Lh(t,e){return e?t.properties[e]:t.id}la("CanonicalTileID",Eh),la("OverscaledTileID",Ch,{omit:["terrainRttPosMatrix32f"]});class zh{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const e=new zh;return e.extend(t(new n(this.minX,this.minY))),e.extend(t(new n(this.maxX,this.minY))),e.extend(t(new n(this.minX,this.maxY))),e.extend(t(new n(this.maxX,this.maxY))),e}static fromPoints(t){const e=new zh;for(const n of t)e.extend(n);return e}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class Nh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(t," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[t]}}class Dh{constructor(t,e,n,i,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}class Rh{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new sa(C,16,0),this.grid3D=new sa(C,16,0),this.featureIndexArray=new Ls,this.promoteId=e}insert(t,e,n,i,r,a){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);const o=a?this.grid3D:this.grid;for(let l=0;l<e.length;l++){const t=e[l],n=[1/0,1/0,-1/0,-1/0];for(let e=0;e<t.length;e++){const i=t[e];n[0]=Math.min(n[0],i.x),n[1]=Math.min(n[1],i.y),n[2]=Math.max(n[2],i.x),n[3]=Math.max(n[3],i.y)}n[0]<C&&n[1]<C&&n[2]>=0&&n[3]>=0&&o.insert(s,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new xc(new au(this.rawTileData)).layers,this.sourceLayerCoder=new Nh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,i,r){this.loadVTLayers();const a=t.params,s=C/t.tileSize/t.scale,o=fr(a.filter,a.globalState),l=t.queryGeometry,c=t.queryPadding*s,u=zh.fromPoints(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c),d=zh.fromPoints(t.cameraQueryGeometry).expandBy(c),f=this.grid3D.query(d.minX,d.minY,d.maxX,d.maxY,(e,i,r,a)=>function(t,e,i,r,a){for(const n of t)if(e<=n.x&&i<=n.y&&r>=n.x&&a>=n.y)return!0;const s=[new n(e,i),new n(e,a),new n(r,a),new n(r,i)];if(t.length>2)for(const n of s)if(Go(t,n))return!0;for(let n=0;n<t.length-1;n++)if(qo(t[n],t[n+1],s))return!0;return!1}(t.cameraQueryGeometry,e-c,i-c,r+c,a+c));for(const n of f)h.push(n);h.sort(Oh);const p={};let m;for(let n=0;n<h.length;n++){const c=h[n];if(c===m)continue;m=c;const u=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(p,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,o,a.layers,a.availableImages,e,i,r,(e,n,i)=>(d||(d=Eo(e)),n.queryIntersectsFeature({queryGeometry:l,feature:e,featureState:i,geometry:d,zoom:this.z,transform:t.transform,pixelsToTileUnits:s,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation})))}return p}loadMatchingFeature(t,e,n,i,r,a,s,o,l,c,u){const h=this.bucketLayerIDs[e];if(a&&!h.some(t=>a.has(t)))return;const d=this.sourceLayerCoder.decode(n),f=this.vtLayers[d].feature(i);if(r.needGeometry){const t=To(f,!0);if(!r.filter(new Ta(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!r.filter(new Ta(this.tileID.overscaledZ),f))return;const p=this.getId(f,d);for(let m=0;m<h.length;m++){const e=h[m];if(a&&!a.has(e))continue;const n=o[e];if(!n)continue;let r={};p&&c&&(r=c.getState(n.sourceLayer||"_geojsonTileLayer",p));const d=B({},l[e]);d.paint=Fh(d.paint,n.paint,f,r,s),d.layout=Fh(d.layout,n.layout,f,r,s);const g=!u||u(f,n,r);if(!g)continue;const _=new Dh(f,this.z,this.x,this.y,p);_.layer=d;let y=t[e];void 0===y&&(y=t[e]=[]),y.push({featureIndex:i,feature:_,intersectionZ:g})}}lookupSymbolFeatures(t,e,n,i,r,a,s,o){const l={};this.loadVTLayers();const c=fr(r.filterSpec,r.globalState);for(const u of t)this.loadMatchingFeature(l,n,i,u,c,a,s,o,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){var n;let i=t.id;return this.promoteId&&(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof i&&(i=Number(i)),void 0===i&&(null===(n=t.properties)||void 0===n?void 0:n.cluster)&&this.promoteId&&(i=Number(t.properties.cluster_id))),i}}function Fh(t,e,n,i,r){return U(t,(t,a)=>{const s=e instanceof Oa?e.get(a):null;return s&&s.evaluate?s.evaluate(n,i,r):s})}function Oh(t,e){return e-t}function Bh(t,e,i,r,a){const s=[];for(let o=0;o<t.length;o++){const l=t[o];let c;for(let t=0;t<l.length-1;t++){let o=l[t],u=l[t+1];o.x<e&&u.x<e||(o.x<e?o=new n(e,o.y+(e-o.x)/(u.x-o.x)*(u.y-o.y))._round():u.x<e&&(u=new n(e,o.y+(e-o.x)/(u.x-o.x)*(u.y-o.y))._round()),o.y<i&&u.y<i||(o.y<i?o=new n(o.x+(i-o.y)/(u.y-o.y)*(u.x-o.x),i)._round():u.y<i&&(u=new n(o.x+(i-o.y)/(u.y-o.y)*(u.x-o.x),i)._round()),o.x>=r&&u.x>=r||(o.x>=r?o=new n(r,o.y+(r-o.x)/(u.x-o.x)*(u.y-o.y))._round():u.x>=r&&(u=new n(r,o.y+(r-o.x)/(u.x-o.x)*(u.y-o.y))._round()),o.y>=a&&u.y>=a||(o.y>=a?o=new n(o.x+(a-o.y)/(u.y-o.y)*(u.x-o.x),a)._round():u.y>=a&&(u=new n(o.x+(a-o.y)/(u.y-o.y)*(u.x-o.x),a)._round()),c&&o.equals(c[c.length-1])||(c=[o],s.push(c)),c.push(u)))))}}return s}la("FeatureIndex",Rh,{omit:["rawTileData","sourceLayerCoder"]});class jh extends n{constructor(t,e,n,i){super(t,e),this.angle=n,void 0!==i&&(this.segment=i)}clone(){return new jh(this.x,this.y,this.angle,this.segment)}}function Uh(t,e,n,i,r){if(void 0===e.segment||0===n)return!0;let a=e,s=e.segment+1,o=0;for(;o>-n/2;){if(s--,s<0)return!1;o-=t[s].dist(a),a=t[s]}o+=t[s].dist(t[s+1]),s++;const l=[];let c=0;for(;o<n/2;){const e=t[s],n=t[s+1];if(!n)return!1;let a=t[s-1].angleTo(e)-e.angleTo(n);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:o,angleDelta:a}),c+=a;o-l[0].distance>i;)c-=l.shift().angleDelta;if(c>r)return!1;s++,o+=e.dist(n)}return!0}function Gh(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function qh(t,e,n){return t?.6*e*n:0}function Vh(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Zh(t,e,n,i,r,a){const s=qh(n,r,a),o=Vh(n,i)*a;let l=0;const c=Gh(t)/2;for(let u=0;u<t.length-1;u++){const n=t[u],i=t[u+1],r=n.dist(i);if(l+r>c){const a=(c-l)/r,h=gn.number(n.x,i.x,a),d=gn.number(n.y,i.y,a),f=new jh(h,d,i.angleTo(n),u);return f._round(),!s||Uh(t,f,o,s,e)?f:void 0}l+=r}}function Wh(t,e,n,i,r,a,s,o,l){const c=qh(i,a,s),u=Vh(i,r),h=u*s,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),Hh(t,d?e/2*o%e:(u/2+2*a)*s*o%e,e,c,n,h,d,!1,l)}function Hh(t,e,n,i,r,a,s,o,l){const c=a/2,u=Gh(t);let h=0,d=e-n,f=[];for(let p=0;p<t.length-1;p++){const e=t[p],s=t[p+1],o=e.dist(s),m=s.angleTo(e);for(;d+n<h+o;){d+=n;const g=(d-h)/o,_=gn.number(e.x,s.x,g),y=gn.number(e.y,s.y,g);if(_>=0&&_<l&&y>=0&&y<l&&d-c>=0&&d+c<=u){const e=new jh(_,y,m,p);e._round(),i&&!Uh(t,e,a,i,r)||f.push(e)}}h+=o}return o||f.length||s||(f=Hh(t,h/2,n,i,r,a,s,!0,l)),f}function Xh(t,e,i,r){const a=[],s=t.image,o=s.pixelRatio,l=s.paddedRect.w-2,c=s.paddedRect.h-2;let u={x1:t.left,y1:t.top,x2:t.right,y2:t.bottom};const h=s.stretchX||[[0,l]],d=s.stretchY||[[0,c]],f=(t,e)=>t+e[1]-e[0],p=h.reduce(f,0),m=d.reduce(f,0),g=l-p,_=c-m;let y=0,v=p,b=0,x=m,w=0,S=g,P=0,M=_;if(s.content&&r){const e=s.content,n=e[2]-e[0],i=e[3]-e[1];(s.textFitWidth||s.textFitHeight)&&(u=Vu(t)),y=Yh(h,0,e[0]),b=Yh(d,0,e[1]),v=Yh(h,e[0],e[2]),x=Yh(d,e[1],e[3]),w=e[0]-y,P=e[1]-b,S=n-v,M=i-x}const A=u.x1,k=u.y1,E=u.x2-A,T=u.y2-k,C=(t,r,a,l)=>{const c=Jh(t.stretch-y,v,E,A),u=$h(t.fixed-w,S,t.stretch,p),h=Jh(r.stretch-b,x,T,k),d=$h(r.fixed-P,M,r.stretch,m),f=Jh(a.stretch-y,v,E,A),g=$h(a.fixed-w,S,a.stretch,p),_=Jh(l.stretch-b,x,T,k),C=$h(l.fixed-P,M,l.stretch,m),I=new n(c,h),L=new n(f,h),z=new n(f,_),N=new n(c,_),D=new n(u/o,d/o),R=new n(g/o,C/o),F=e*Math.PI/180;if(F){const t=Math.sin(F),e=Math.cos(F),n=[e,-t,t,e];I._matMult(n),L._matMult(n),N._matMult(n),z._matMult(n)}const O=t.stretch+t.fixed,B=r.stretch+r.fixed;return{tl:I,tr:L,bl:N,br:z,tex:{x:s.paddedRect.x+1+O,y:s.paddedRect.y+1+B,w:a.stretch+a.fixed-O,h:l.stretch+l.fixed-B},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:R,minFontScaleX:S/o/E,minFontScaleY:M/o/T,isSDF:i}};if(r&&(s.stretchX||s.stretchY)){const t=Kh(h,g,p),e=Kh(d,_,m);for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)a.push(C(i,e[t],r,e[t+1]))}}else a.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return a}function Yh(t,e,n){let i=0;for(const r of t)i+=Math.max(e,Math.min(n,r[1]))-Math.max(e,Math.min(n,r[0]));return i}function Kh(t,e,n){const i=[{fixed:-1,stretch:0}];for(const[r,a]of t){const t=i[i.length-1];i.push({fixed:r-t.stretch,stretch:t.stretch}),i.push({fixed:r-t.stretch,stretch:t.stretch+(a-r)})}return i.push({fixed:e+1,stretch:n}),i}function Jh(t,e,n,i){return t/e*n+i}function $h(t,e,n,i){return t-e*n/i}la("Anchor",jh);class Qh{constructor(t,e,i,r,a,s,o,l,c,u){var h;if(this.boxStartIndex=t.length,c){let t=s.top,e=s.bottom;const n=s.collisionPadding;n&&(t-=n[1],e+=n[3]);let i=e-t;i>0&&(i=Math.max(10,i),this.circleDiameter=i)}else{const c=(null===(h=s.image)||void 0===h?void 0:h.content)&&(s.image.textFitWidth||s.image.textFitHeight)?Vu(s):{x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};c.y1=c.y1*o-l[0],c.y2=c.y2*o+l[2],c.x1=c.x1*o-l[3],c.x2=c.x2*o+l[1];const d=s.collisionPadding;if(d&&(c.x1-=d[0]*o,c.y1-=d[1]*o,c.x2+=d[2]*o,c.y2+=d[3]*o),u){const t=new n(c.x1,c.y1),e=new n(c.x2,c.y1),i=new n(c.x1,c.y2),r=new n(c.x2,c.y2),a=u*Math.PI/180;t._rotate(a),e._rotate(a),i._rotate(a),r._rotate(a),c.x1=Math.min(t.x,e.x,i.x,r.x),c.x2=Math.max(t.x,e.x,i.x,r.x),c.y1=Math.min(t.y,e.y,i.y,r.y),c.y2=Math.max(t.y,e.y,i.y,r.y)}t.emplaceBack(e.x,e.y,c.x1,c.y1,c.x2,c.y2,i,r,a)}this.boxEndIndex=t.length}}class td{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e)=>t<e?-1:t>e?1:0;if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,a=e[r];if(n(i,a)>=0)break;e[t]=a,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1);const a=i+1;if(a<this.length&&n(e[a],e[i])<0&&(i=a),n(e[i],r)>=0)break;e[t]=e[i],t=i}e[t]=r}}function ed(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=zh.fromPoints(t[0]),a=Math.min(r.width(),r.height());let s=a/2;const o=new td([],nd),{minX:l,minY:c,maxX:u,maxY:h}=r;if(0===a)return new n(l,c);for(let n=l;n<u;n+=a)for(let e=c;e<h;e+=a)o.push(new id(n+s,e+s,s,t));let d=function(t){let e=0,n=0,i=0;const r=t[0];for(let a=0,s=r.length,o=s-1;a<s;o=a++){const t=r[a],s=r[o],l=t.x*s.y-s.x*t.y;n+=(t.x+s.x)*l,i+=(t.y+s.y)*l,e+=3*l}return new id(n/e,i/e,0,t)}(t),f=o.length;for(;o.length;){const n=o.pop();(n.d>d.d||!d.d)&&(d=n,i&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,f)),n.max-d.d<=e||(s=n.h/2,o.push(new id(n.p.x-s,n.p.y-s,s,t)),o.push(new id(n.p.x+s,n.p.y-s,s,t)),o.push(new id(n.p.x-s,n.p.y+s,s,t)),o.push(new id(n.p.x+s,n.p.y+s,s,t)),f+=4)}return i&&(console.log("num probes: ".concat(f)),console.log("best distance: ".concat(d.d))),d.p}function nd(t,e){return e.max-t.max}function id(t,e,i,r){this.p=new n(t,e),this.h=i,this.d=function(t,e){let n=!1,i=1/0;for(let r=0;r<e.length;r++){const a=e[r];for(let e=0,r=a.length,s=r-1;e<r;s=e++){const r=a[e],o=a[s];r.y>t.y!=o.y>t.y&&t.x<(o.x-r.x)*(t.y-r.y)/(o.y-r.y)+r.x&&(n=!n),i=Math.min(i,jo(t,r,o))}}return(n?1:-1)*Math.sqrt(i)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}var rd;t.aE=void 0,(rd=t.aE||(t.aE={}))[rd.center=1]="center",rd[rd.left=2]="left",rd[rd.right=3]="right",rd[rd.top=4]="top",rd[rd.bottom=5]="bottom",rd[rd["top-left"]=6]="top-left",rd[rd["top-right"]=7]="top-right",rd[rd["bottom-left"]=8]="bottom-left",rd[rd["bottom-right"]=9]="bottom-right";const ad=Number.POSITIVE_INFINITY;function sd(t,e){return e[1]!==ad?function(t,e,n){let i=0,r=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":r=n-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-n}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,r]}(t,e[0],e[1]):function(t,e){let n=0,i=0;e<0&&(e=0);const r=e/Math.SQRT2;switch(t){case"top-right":case"top-left":i=r-7;break;case"bottom-right":case"bottom-left":i=7-r;break;case"bottom":i=7-e;break;case"top":i=e-7}switch(t){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=e;break;case"right":n=-e}return[n,i]}(t,e[0])}function od(t,e,n){var i;const r=t.layout,a=null===(i=r.get("text-variable-anchor-offset"))||void 0===i?void 0:i.evaluate(e,{},n);if(a){const t=a.values,e=[];for(let n=0;n<t.length;n+=2){const i=e[n]=t[n],r=t[n+1].map(t=>t*eu);i.startsWith("top")?r[1]-=7:i.startsWith("bottom")&&(r[1]+=7),e[n+1]=r}return new Fe(e)}const s=r.get("text-variable-anchor");if(s){let i;i=void 0!==t._unevaluatedLayout.getValue("text-radial-offset")?[r.get("text-radial-offset").evaluate(e,{},n)*eu,ad]:r.get("text-offset").evaluate(e,{},n).map(t=>t*eu);const a=[];for(const t of s)a.push(t,sd(t,i));return new Fe(a)}return null}function ld(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function cd(e,n,i,r,a,s,o,l,c,u,h,d){let f=s.textMaxSize.evaluate(n,{});void 0===f&&(f=o);const p=e.layers[0].layout,m=p.get("icon-offset").evaluate(n,{},h),g=hd(i.horizontal),_=o/24,y=e.tilePixelRatio*_,v=e.tilePixelRatio*f/24,b=e.tilePixelRatio*l,x=e.tilePixelRatio*p.get("symbol-spacing"),w=p.get("text-padding")*e.tilePixelRatio,S=function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=t.get("icon-padding").evaluate(e,{},n),a=r&&r.values;return[a[0]*i,a[1]*i,a[2]*i,a[3]*i]}(p,n,h,e.tilePixelRatio),P=p.get("text-max-angle")/180*Math.PI,M="viewport"!==p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),A="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),k=p.get("symbol-placement"),E=x/2,T=p.get("icon-text-fit");let I;r&&"none"!==T&&(e.allowVerticalPlacement&&i.vertical&&(I=Zu(r,i.vertical,T,p.get("icon-text-fit-padding"),m,_)),g&&(r=Zu(r,g,T,p.get("icon-text-fit-padding"),m,_)));const L=h?d.line.getGranularityForZoomLevel(h.z):1,z=(l,d)=>{d.x<0||d.x>=C||d.y<0||d.y>=C||function(e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b,x,w,S,P,M){const A=e.addToLineVertexArray(n,i);let k,E,T,C,I=0,L=0,z=0,N=0,D=-1,R=-1;const F={};let O=ao("");if(e.allowVerticalPlacement&&r.vertical){const t=l.layout.get("text-rotate").evaluate(x,{},P)+90;T=new Qh(c,n,u,h,d,r.vertical,f,p,m,t),o&&(C=new Qh(c,n,u,h,d,o,_,y,m,t))}if(a){const i=l.layout.get("icon-rotate").evaluate(x,{}),r="none"!==l.layout.get("icon-text-fit"),s=Xh(a,i,S,r),f=o?Xh(o,i,S,r):void 0;E=new Qh(c,n,u,h,d,a,_,y,!1,i),I=4*s.length;const p=e.iconSizeData;let m=null;"source"===p.kind?(m=[Wu*l.layout.get("icon-size").evaluate(x,{})],m[0]>Hu&&Z("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".'))):"composite"===p.kind&&(m=[Wu*w.compositeIconSizes[0].evaluate(x,{},P),Wu*w.compositeIconSizes[1].evaluate(x,{},P)],(m[0]>Hu||m[1]>Hu)&&Z("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".'))),e.addSymbols(e.icon,s,m,b,v,x,t.ao.none,n,A.lineStartIndex,A.lineLength,-1,P),D=e.icon.placedSymbolArray.length-1,f&&(L=4*f.length,e.addSymbols(e.icon,f,m,b,v,x,t.ao.vertical,n,A.lineStartIndex,A.lineLength,-1,P),R=e.icon.placedSymbolArray.length-1)}const B=Object.keys(r.horizontal);for(const Z of B){const i=r.horizontal[Z];if(!k){O=ao(i.text);const t=l.layout.get("text-rotate").evaluate(x,{},P);k=new Qh(c,n,u,h,d,i,f,p,m,t)}const a=1===i.positionedLines.length;if(z+=ud(e,n,i,s,l,m,x,g,A,r.vertical?t.ao.horizontal:t.ao.horizontalOnly,a?B:[Z],F,D,w,P),a)break}r.vertical&&(N+=ud(e,n,r.vertical,s,l,m,x,g,A,t.ao.vertical,["vertical"],F,R,w,P));const j=k?k.boxStartIndex:e.collisionBoxArray.length,U=k?k.boxEndIndex:e.collisionBoxArray.length,G=T?T.boxStartIndex:e.collisionBoxArray.length,q=T?T.boxEndIndex:e.collisionBoxArray.length,V=E?E.boxStartIndex:e.collisionBoxArray.length,W=E?E.boxEndIndex:e.collisionBoxArray.length,H=C?C.boxStartIndex:e.collisionBoxArray.length,X=C?C.boxEndIndex:e.collisionBoxArray.length;let Y=-1;const K=(t,e)=>t&&t.circleDiameter?Math.max(t.circleDiameter,e):e;Y=K(k,Y),Y=K(T,Y),Y=K(E,Y),Y=K(C,Y);const J=Y>-1?1:0;J&&(Y*=M/eu),e.glyphOffsetArray.length>=nh.MAX_GLYPHS&&Z("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey);const $=od(l,x,P),[Q,tt]=function(e,n){const i=e.length,r=null==n?void 0:n.values;if((null==r?void 0:r.length)>0)for(let a=0;a<r.length;a+=2){const n=r[a+1];e.emplaceBack(t.aE[r[a]],n[0],n[1])}return[i,e.length]}(e.textAnchorOffsets,$);e.symbolInstances.emplaceBack(n.x,n.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical||-1,D,R,O,j,U,G,q,V,W,H,X,u,z,N,I,L,J,0,f,Y,Q,tt)}(e,d,l,i,r,a,I,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,y,[w,w,w,w],M,c,b,S,A,m,n,s,u,h,o)};if("line"===k)for(const t of Bh(n.geometry,0,0,C,C)){const n=rc(t,L),a=Wh(n,x,P,i.vertical||g,r,24,v,e.overscaling,C);for(const t of a)g&&dd(e,g.text,E,t)||z(n,t)}else if("line-center"===k){for(const t of n.geometry)if(t.length>1){const e=rc(t,L),n=Zh(e,P,i.vertical||g,r,24,v);n&&z(e,n)}}else if("Polygon"===n.type)for(const t of ei(n.geometry,0)){const e=ed(t,16);z(rc(t[0],L,!0),new jh(e.x,e.y,0))}else if("LineString"===n.type)for(const t of n.geometry){const e=rc(t,L);z(e,new jh(e[0].x,e[0].y,0))}else if("Point"===n.type)for(const t of n.geometry)for(const e of t)z([e],new jh(e.x,e.y,0))}function ud(t,e,i,r,a,s,o,l,c,u,h,d,f,p,m){const g=function(t,e,i,r,a,s,o,l){const c=r.layout.get("text-rotate").evaluate(s,{})*Math.PI/180,u=[];for(const h of e.positionedLines)for(const t of h.positionedGlyphs){if(!t.rect)continue;const r=t.rect||{};let s=4,d=!0,f=1,p=0;const m=(a||l)&&t.vertical,g=t.metrics.advance*t.scale/2;if(l&&e.verticalizable&&(p=h.lineOffset/2-(t.imageName?-(eu-t.metrics.width*t.scale)/2:(t.scale-1)*eu)),t.imageName){const e=o[t.imageName];d=e.sdf,f=e.pixelRatio,s=1/f}const _=a?[t.x+g,t.y]:[0,0];let y=a?[0,0]:[t.x+g+i[0],t.y+i[1]-p],v=[0,0];m&&(v=y,y=[0,0]);const b=t.metrics.isDoubleResolution?2:1,x=(t.metrics.left-s)*t.scale-g+y[0],w=(-t.metrics.top-s)*t.scale+y[1],S=x+r.w/b*t.scale/f,P=w+r.h/b*t.scale/f,M=new n(x,w),A=new n(S,w),k=new n(x,P),E=new n(S,P);if(m){const e=new n(-g,g- -17),i=-Math.PI/2,r=12-g,a=new n(22-r,-(t.imageName?r:0)),s=new n(...v);M._rotateAround(i,e)._add(a)._add(s),A._rotateAround(i,e)._add(a)._add(s),k._rotateAround(i,e)._add(a)._add(s),E._rotateAround(i,e)._add(a)._add(s)}if(c){const t=Math.sin(c),e=Math.cos(c),n=[e,-t,t,e];M._matMult(n),A._matMult(n),k._matMult(n),E._matMult(n)}const T=new n(0,0),C=new n(0,0);u.push({tl:M,tr:A,bl:k,br:E,tex:r,writingMode:e.writingMode,glyphOffset:_,sectionIndex:t.sectionIndex,isSDF:d,pixelOffsetTL:T,pixelOffsetBR:C,minFontScaleX:0,minFontScaleY:0})}return u}(0,i,l,a,s,o,r,t.allowVerticalPlacement),_=t.textSizeData;let y=null;"source"===_.kind?(y=[Wu*a.layout.get("text-size").evaluate(o,{})],y[0]>Hu&&Z("".concat(t.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".'))):"composite"===_.kind&&(y=[Wu*p.compositeTextSizes[0].evaluate(o,{},m),Wu*p.compositeTextSizes[1].evaluate(o,{},m)],(y[0]>Hu||y[1]>Hu)&&Z("".concat(t.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".'))),t.addSymbols(t.text,g,y,l,s,o,u,e,c.lineStartIndex,c.lineLength,f,m);for(const n of h)d[n]=t.text.placedSymbolArray.length-1;return 4*g.length}function hd(t){for(const e in t)return t[e];return null}function dd(t,e,n,i){const r=t.compareText;if(e in r){const t=r[e];for(let e=t.length-1;e>=0;e--)if(i.dist(t[e])<n)return!0}else r[e]=[];return r[e].push(i),!1}const fd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class pd{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,n]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(1!==i)throw new Error("Got v".concat(i," data when expected v1."));const r=fd[15&n];if(!r)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new pd(s,a,r,t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,i=arguments.length>3?arguments[3]:void 0;if(isNaN(t)||t<0)throw new Error("Unpexpected numItems value: ".concat(t,"."));this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const r=fd.indexOf(this.ArrayType),a=2*t*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,o=(8-s%8)%8;if(r<0)throw new Error("Unexpected typed array class: ".concat(n,"."));i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+o,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+a+s+o),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+s+o,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=e,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error("Added ".concat(t," items when expected ").concat(this.numItems,"."));return md(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:a,nodeSize:s}=this,o=[0,r.length-1,0],l=[];for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=s){for(let s=h;s<=u;s++){const o=a[2*s],c=a[2*s+1];o>=t&&o<=n&&c>=e&&c<=i&&l.push(r[s])}continue}const d=h+u>>1,f=a[2*d],p=a[2*d+1];f>=t&&f<=n&&p>=e&&p<=i&&l.push(r[d]),(0===c?t<=f:e<=p)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?n>=f:i>=p)&&(o.push(d+1),o.push(u),o.push(1-c))}return l}within(t,e,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:a}=this,s=[0,i.length-1,0],o=[],l=n*n;for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=a){for(let n=h;n<=u;n++)vd(r[2*n],r[2*n+1],t,e)<=l&&o.push(i[n]);continue}const d=h+u>>1,f=r[2*d],p=r[2*d+1];vd(f,p,t,e)<=l&&o.push(i[d]),(0===c?t-n<=f:e-n<=p)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?t+n>=f:e+n>=p)&&(s.push(d+1),s.push(u),s.push(1-c))}return o}}function md(t,e,n,i,r,a){if(r-i<=n)return;const s=i+r>>1;gd(t,e,s,i,r,a),md(t,e,n,i,s-1,1-a),md(t,e,n,s+1,r,1-a)}function gd(t,e,n,i,r,a){for(;r>i;){if(r-i>600){const s=r-i+1,o=n-i+1,l=Math.log(s),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(s-c)/s)*(o-s/2<0?-1:1);gd(t,e,n,Math.max(i,Math.floor(n-o*c/s+u)),Math.min(r,Math.floor(n+(s-o)*c/s+u)),a)}const s=e[2*n+a];let o=i,l=r;for(_d(t,e,i,n),e[2*r+a]>s&&_d(t,e,i,r);o<l;){for(_d(t,e,o,l),o++,l--;e[2*o+a]<s;)o++;for(;e[2*l+a]>s;)l--}e[2*i+a]===s?_d(t,e,i,l):(l++,_d(t,e,l,r)),l<=n&&(i=l+1),n<=l&&(r=l-1)}}function _d(t,e,n,i){yd(t,n,i),yd(e,2*n,2*i),yd(e,2*n+1,2*i+1)}function yd(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function vd(t,e,n,i){const r=t-n,a=e-i;return r*r+a*a}var bd;t.cx=void 0,(bd=t.cx||(t.cx={})).create="create",bd.load="load",bd.fullLoad="fullLoad";let xd=null,wd=[];const Sd=1e3/60,Pd="loadTime",Md="fullLoadTime",Ad={mark(t){performance.mark(t)},frame(t){const e=t;null!=xd&&wd.push(e-xd),xd=e},clearMetrics(){xd=null,wd=[],performance.clearMeasures(Pd),performance.clearMeasures(Md);for(const e in t.cx)performance.clearMarks(t.cx[e])},getPerformanceMetrics(){performance.measure(Pd,t.cx.create,t.cx.load),performance.measure(Md,t.cx.create,t.cx.fullLoad);const e=performance.getEntriesByName(Pd)[0].duration,n=performance.getEntriesByName(Md)[0].duration,i=wd.length,r=1/(wd.reduce((t,e)=>t+e,0)/i/1e3),a=wd.filter(t=>t>Sd).reduce((t,e)=>t+(e-Sd)/Sd,0);return{loadTime:e,fullLoadTime:n,fps:r,percentDroppedFrames:a/(i+a)*100,totalFrames:i}}};t.$=C,t.A=p,t.B=function(t){let[e,n,i]=t;return n+=90,n*=Math.PI/180,i*=Math.PI/180,{x:e*Math.cos(n)*Math.sin(i),y:e*Math.sin(n)*Math.sin(i),z:e*Math.cos(i)}},t.C=gn,t.D=Ba,t.E=yt,t.F=Ta,t.G=na,t.H=function(t){if(null==X){const e=t.navigator?t.navigator.userAgent:null;X=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return X},t.I=xu,t.J=class{constructor(t,e){this.target=t,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new mh(()=>this.process()),this.subscription=tt(this.target,"message",t=>this.receive(t),!1),this.globalScope=H(self)?t:window}registerMessageHandler(t,e){this.messageHandlers[t]=e}sendAsync(t,e){return new Promise((n,i)=>{const r=Math.round(1e18*Math.random()).toString(36).substring(0,10),a=e?tt(e.signal,"abort",()=>{null==a||a.unsubscribe(),delete this.resolveRejects[r];const e={id:r,type:"<cancel>",origin:location.origin,targetMapId:t.targetMapId,sourceMapId:this.mapId};this.target.postMessage(e)},gh):null;this.resolveRejects[r]={resolve:t=>{null==a||a.unsubscribe(),n(t)},reject:t=>{null==a||a.unsubscribe(),i(t)}};const s=[],o=Object.assign(Object.assign({},t),{id:r,sourceMapId:this.mapId,origin:location.origin,data:da(t.data,s)});this.target.postMessage(o,{transfer:s})})}receive(t){const e=t.data,n=e.id;if(!("file://"!==e.origin&&"file://"!==location.origin&&"resource://android"!==e.origin&&"resource://android"!==location.origin&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if("<cancel>"===e.type){delete this.tasks[n];const t=this.abortControllers[n];return delete this.abortControllers[n],void(t&&t.abort())}if(H(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(0===this.taskQueue.length)return;const t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(t,e)}processTask(t,n){return e(this,void 0,void 0,function*(){if("<response>"===n.type){const e=this.resolveRejects[t];if(delete this.resolveRejects[t],!e)return;return void(n.error?e.reject(fa(n.error)):e.resolve(fa(n.data)))}if(!this.messageHandlers[n.type])return void this.completeTask(t,new Error("Could not find a registered handler for ".concat(n.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));const e=fa(n.data),i=new AbortController;this.abortControllers[t]=i;try{const r=yield this.messageHandlers[n.type](n.sourceMapId,e,i);this.completeTask(t,null,r)}catch(e){this.completeTask(t,e)}})}completeTask(t,e,n){const i=[];delete this.abortControllers[t];const r={id:t,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?da(e):null,data:da(n,i)};this.target.postMessage(r,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},t.K=ct,t.L=function(){var t=new p(16);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.M=function(t,e,n){var i,r,a,s,o,l,c,u,h,d,f,p,m=n[0],g=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*_+e[12],t[13]=e[1]*m+e[5]*g+e[9]*_+e[13],t[14]=e[2]*m+e[6]*g+e[10]*_+e[14],t[15]=e[3]*m+e[7]*g+e[11]*_+e[15]):(r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=i=e[0],t[1]=r,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=i*m+o*g+h*_+e[12],t[13]=r*m+l*g+d*_+e[13],t[14]=a*m+c*g+f*_+e[14],t[15]=s*m+u*g+p*_+e[15]),t},t.N=function(t,e,n){var i=n[0],r=n[1],a=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.O=function(t,e,n){var i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],_=e[14],y=e[15],v=n[0],b=n[1],x=n[2],w=n[3];return t[0]=v*i+b*o+x*h+w*m,t[1]=v*r+b*l+x*d+w*g,t[2]=v*a+b*c+x*f+w*_,t[3]=v*s+b*u+x*p+w*y,t[4]=(v=n[4])*i+(b=n[5])*o+(x=n[6])*h+(w=n[7])*m,t[5]=v*r+b*l+x*d+w*g,t[6]=v*a+b*c+x*f+w*_,t[7]=v*s+b*u+x*p+w*y,t[8]=(v=n[8])*i+(b=n[9])*o+(x=n[10])*h+(w=n[11])*m,t[9]=v*r+b*l+x*d+w*g,t[10]=v*a+b*c+x*f+w*_,t[11]=v*s+b*u+x*p+w*y,t[12]=(v=n[12])*i+(b=n[13])*o+(x=n[14])*h+(w=n[15])*m,t[13]=v*r+b*l+x*d+w*g,t[14]=v*a+b*c+x*f+w*_,t[15]=v*s+b*u+x*p+w*y,t},t.P=n,t.Q=function(t,e){const n={};for(let i=0;i<e.length;i++){const r=e[i];r in t&&(n[r]=t[r])}return n},t.R=ul,t.S=yh,t.T=vl,t.U=wh,t.V=xh,t.W=h,t.X=d,t.Y=J,t.Z=Ch,t._=e,t.a=ot,t.a$=P,t.a0=function(t,e){var n,i,r,a,s;if(!t)return null!=e?e:{};if(!e)return t;let o=Object.assign({},t);if(e.removeAll&&(o={removeAll:!0}),e.remove){const i=new Set(e.remove);o.add&&(o.add=o.add.filter(t=>!i.has(t.id))),o.update&&(o.update=o.update.filter(t=>!i.has(t.id)));const r=new Set((null!==(n=t.add)&&void 0!==n?n:[]).map(t=>t.id));e.remove=e.remove.filter(t=>!r.has(t))}if(e.remove){const t=new Set(o.remove?o.remove.concat(e.remove):e.remove);o.remove=Array.from(t.values())}if(e.add){const t=o.add?o.add.concat(e.add):e.add,n=new Map(t.map(t=>[t.id,t]));o.add=Array.from(n.values())}if(e.update){const t=new Map(null===(i=o.update)||void 0===i?void 0:i.map(t=>[t.id,t]));for(const n of e.update){const e=null!==(r=t.get(n.id))&&void 0!==r?r:{id:n.id};n.newGeometry&&(e.newGeometry=n.newGeometry),n.addOrUpdateProperties&&(e.addOrUpdateProperties=(null!==(a=e.addOrUpdateProperties)&&void 0!==a?a:[]).concat(n.addOrUpdateProperties)),n.removeProperties&&(e.removeProperties=(null!==(s=e.removeProperties)&&void 0!==s?s:[]).concat(n.removeProperties)),n.removeAllProperties&&(e.removeAllProperties=!0),t.set(n.id,e)}o.update=Array.from(t.values())}return o.remove&&o.add&&(o.remove=o.remove.filter(t=>-1===o.add.findIndex(e=>e.id===t))),o},t.a1=Ah,t.a2=zh,t.a3=25,t.a4=Eh,t.a5=t=>{const e=window.document.createElement("video");return e.muted=!0,new Promise(n=>{e.onloadstart=()=>{n(e)};for(const i of t){const t=window.document.createElement("source");ft(i)||(e.crossOrigin="Anonymous"),t.src=i,e.appendChild(t)}})},t.a6=It,t.a7=function(){return j++},t.a8=ws,t.a9=nh,t.aA=function(t){let e=1/0,n=1/0,i=-1/0,r=-1/0;for(const a of t)e=Math.min(e,a.x),n=Math.min(n,a.y),i=Math.max(i,a.x),r=Math.max(r,a.y);return[e,n,i,r]},t.aB=eu,t.aC=I,t.aD=function(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!n[0]&&!n[1])return[0,0];const a=r?"map"===i?-t.bearingInRadians:0:"viewport"===i?t.bearingInRadians:0;if(a){const t=Math.sin(a),e=Math.cos(a);n=[n[0]*e-n[1]*t,n[0]*t+n[1]*e]}return[r?n[0]:I(e,n[0],t.zoom),r?n[1]:I(e,n[1],t.zoom)]},t.aF=Yu,t.aG=ld,t.aH=Ru,t.aI=pd,t.aJ=Ka,t.aK=Ql,t.aL=zs,t.aM=Ys,t.aN=Zs,t.aO=O,t.aP=nt,t.aQ=Mh,t.aR=x,t.aS=b,t.aT=function(t){var e=new p(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.aU=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},t.aV=function(t,e){var n=e[0],i=e[1],r=e[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t},t.aW=w,t.aX=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.aY=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},t.aZ=y,t.a_=function(t,e,n){const i=e[0]*n[0]+e[1]*n[1]+e[2]*n[2];return 0===i?null:(-(t[0]*n[0]+t[1]*n[1]+t[2]*n[2])-n[3])/i},t.aa=fr,t.ab=To,t.ac=Dh,t.ad=function(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(t,n,i,r)=>{const a=i||r;return e[n]=!a||a.toLowerCase(),""}),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e},t.ae=et,t.af=function(t){return Math.pow(2,t)},t.ag=g,t.ah=F,t.ai=85.051129,t.aj=Sh,t.ak=function(t){return Math.log(t)/Math.LN2},t.al=function(t){var e=t[0],n=t[1];return e*e+n*n},t.am=function(t,e){const n=[];for(const i in t)i in e||n.push(i);return n},t.an=function(t,e){let n=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){const{interpolationType:r,minZoom:a,maxZoom:s}=t,o=r?F(pn.interpolationFactor(r,e,a,s),0,1):0;"camera"===t.kind?i=gn.number(t.minSize,t.maxSize,o):n=o}return{uSizeT:n,uSize:i}},t.ap=function(t,e,n){let{uSize:i,uSizeT:r}=e,{lowerSize:a,upperSize:s}=n;return"source"===t.kind?a/Wu:"composite"===t.kind?gn.number(a/Wu,s/Wu,r):i},t.aq=function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],s=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],_=e[15],y=n*o-i*s,v=n*l-r*s,b=n*c-a*s,x=i*l-r*o,w=i*c-a*o,S=r*c-a*l,P=u*m-h*p,M=u*g-d*p,A=u*_-f*p,k=h*g-d*m,E=h*_-f*m,T=d*_-f*g,C=y*T-v*E+b*k+x*A-w*M+S*P;return C?(t[0]=(o*T-l*E+c*k)*(C=1/C),t[1]=(r*E-i*T-a*k)*C,t[2]=(m*S-g*w+_*x)*C,t[3]=(d*w-h*S-f*x)*C,t[4]=(l*A-s*T-c*M)*C,t[5]=(n*T-r*A+a*M)*C,t[6]=(g*b-p*S-_*v)*C,t[7]=(u*S-d*b+f*v)*C,t[8]=(s*E-o*A+c*P)*C,t[9]=(i*A-n*E-a*P)*C,t[10]=(p*w-m*b+_*y)*C,t[11]=(h*b-u*w-f*y)*C,t[12]=(o*M-s*k-l*P)*C,t[13]=(n*k-i*M+r*P)*C,t[14]=(m*v-p*x-g*y)*C,t[15]=(u*x-h*v+d*y)*C,t):null},t.ar=E,t.as=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},t.at=function(t){return t[0]=0,t[1]=0,t},t.au=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},t.av=$u,t.aw=M,t.ax=function(t,e,i,r){const a=e.y-t.y,s=e.x-t.x,o=r.y-i.y,l=r.x-i.x,c=o*s-l*a;if(0===c)return null;const u=(l*(t.y-i.y)-o*(t.x-i.x))/c;return new n(t.x+u*s,t.y+u*a)},t.ay=Bh,t.az=zo,t.b=Y,t.b$=class extends us{},t.b0=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},t.b1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]},t.b2=Th,t.b3=Ih,t.b4=function(t,e,n,i,r){var a=1/Math.tan(e/2);if(t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0){var s=1/(i-r);t[10]=(r+i)*s,t[14]=2*r*i*s}else t[10]=-1,t[14]=-2*i;return t},t.b5=function(t){var e=new p(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.b6=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],s=e[1],o=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+c*i,t[1]=s*r+u*i,t[2]=o*r+h*i,t[3]=l*r+d*i,t[4]=c*r-a*i,t[5]=u*r-s*i,t[6]=h*r-o*i,t[7]=d*r-l*i,t},t.b7=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+c*i,t[5]=s*r+u*i,t[6]=o*r+h*i,t[7]=l*r+d*i,t[8]=c*r-a*i,t[9]=u*r-s*i,t[10]=h*r-o*i,t[11]=d*r-l*i,t},t.b8=function(){const t=new Float32Array(16);return g(t),t},t.b9=function(){const t=new Float64Array(16);return g(t),t},t.bA=function(t,e){const n=L(t,360),i=L(e,360),r=i-n,a=i>n?r-360:r+360;return Math.abs(r)<Math.abs(a)?r:a},t.bB=function(t){return t[0]=0,t[1]=0,t[2]=0,t},t.bC=function(t,e,n,i){const r=Math.sqrt(t*t+e*e),a=Math.sqrt(n*n+i*i);t/=r,e/=r,n/=a,i/=a;const s=Math.acos(t*n+e*i);return-e*n+t*i>0?s:-s},t.bD=function(t,e){const n=L(t,2*Math.PI),i=L(e,2*Math.PI);return Math.min(Math.abs(n-i),Math.abs(n-i+2*Math.PI),Math.abs(n-i-2*Math.PI))},t.bE=function(){const t={},e=vt.$version;for(const n in vt.$root){const i=vt.$root[n];if(i.required){let r=null;r="version"===n?e:"array"===i.type?[]:{},null!=r&&(t[n]=r)}}return t},t.bF=pa,t.bG=ht,t.bH=function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const i in e)if(!t(e[i],n[i]))return!1;return!0}return e===n},t.bI=function(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=xt(t[n],e[t[n].ref]));return t},t.bJ=function(t,e){if("custom"===t.type)return new ph(t,e);switch(t.type){case"background":return new uh(t,e);case"circle":return new nl(t,e);case"color-relief":return new wl(t,e);case"fill":return new dc(t,e);case"fill-extrusion":return new Ic(t,e);case"heatmap":return new fl(t,e);case"hillshade":return new gl(t,e);case"line":return new Wc(t,e);case"raster":return new fh(t,e);case"symbol":return new oh(t,e)}},t.bK=q,t.bL=function(t,e){if(!t)return[{command:"setStyle",args:[e]}];let n=[];try{if(!wt(t.version,e.version))return[{command:"setStyle",args:[e]}];wt(t.center,e.center)||n.push({command:"setCenter",args:[e.center]}),wt(t.state,e.state)||n.push({command:"setGlobalState",args:[e.state]}),wt(t.centerAltitude,e.centerAltitude)||n.push({command:"setCenterAltitude",args:[e.centerAltitude]}),wt(t.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),wt(t.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),wt(t.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),wt(t.roll,e.roll)||n.push({command:"setRoll",args:[e.roll]}),wt(t.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),wt(t.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),wt(t.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),wt(t.light,e.light)||n.push({command:"setLight",args:[e.light]}),wt(t.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),wt(t.sky,e.sky)||n.push({command:"setSky",args:[e.sky]}),wt(t.projection,e.projection)||n.push({command:"setProjection",args:[e.projection]});const i={},r=[];!function(t,e,n,i){let r;for(r in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)||Mt(r,n,i));for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)?wt(t[r],e[r])||("geojson"===t[r].type&&"geojson"===e[r].type&&kt(t,e,r)?St(n,{command:"setGeoJSONSourceData",args:[r,e[r].data]}):At(r,e,n,i)):Pt(r,e,n))}(t.sources,e.sources,r,i);const a=[];t.layers&&t.layers.forEach(t=>{"source"in t&&i[t.source]?n.push({command:"removeLayer",args:[t.id]}):a.push(t)}),n=n.concat(r),function(t,e,n){e=e||[];const i=(t=t||[]).map(Tt),r=e.map(Tt),a=t.reduce(Ct,{}),s=e.reduce(Ct,{}),o=i.slice(),l=Object.create(null);let c,u,h,d,f;for(let p=0,m=0;p<i.length;p++)c=i[p],Object.prototype.hasOwnProperty.call(s,c)?m++:(St(n,{command:"removeLayer",args:[c]}),o.splice(o.indexOf(c,m),1));for(let p=0,m=0;p<r.length;p++)c=r[r.length-1-p],o[o.length-1-p]!==c&&(Object.prototype.hasOwnProperty.call(a,c)?(St(n,{command:"removeLayer",args:[c]}),o.splice(o.lastIndexOf(c,o.length-m),1)):m++,d=o[o.length-p],St(n,{command:"addLayer",args:[s[c],d]}),o.splice(o.length-p,0,c),l[c]=!0);for(let p=0;p<r.length;p++)if(c=r[p],u=a[c],h=s[c],!l[c]&&!wt(u,h))if(wt(u.source,h.source)&&wt(u["source-layer"],h["source-layer"])&&wt(u.type,h.type)){for(f in Et(u.layout,h.layout,n,c,null,"setLayoutProperty"),Et(u.paint,h.paint,n,c,null,"setPaintProperty"),wt(u.filter,h.filter)||St(n,{command:"setFilter",args:[c,h.filter]}),wt(u.minzoom,h.minzoom)&&wt(u.maxzoom,h.maxzoom)||St(n,{command:"setLayerZoomRange",args:[c,h.minzoom,h.maxzoom]}),u)Object.prototype.hasOwnProperty.call(u,f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?Et(u[f],h[f],n,c,f.slice(6),"setPaintProperty"):wt(u[f],h[f])||St(n,{command:"setLayerProperty",args:[c,f,h[f]]}));for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&!Object.prototype.hasOwnProperty.call(u,f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?Et(u[f],h[f],n,c,f.slice(6),"setPaintProperty"):wt(u[f],h[f])||St(n,{command:"setLayerProperty",args:[c,f,h[f]]}))}else St(n,{command:"removeLayer",args:[c]}),d=o[o.lastIndexOf(c)+1],St(n,{command:"addLayer",args:[h,d]})}(a,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:"setStyle",args:[e]}]}return n},t.bM=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:"layers.".concat(n,': missing required property "id"')}),void 0===t.render&&e.push({message:"layers.".concat(n,': missing required method "render"')}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers.".concat(n,': property "renderingMode" must be either "2d" or "3d"')}),e},t.bN=U,t.bO=G,t.bP=class extends uo{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.bQ=po,t.bR=class extends uo{constructor(t,e){super(t,e),this.current=mo}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.bS=fo,t.bT=class extends uo{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.bU=class extends uo{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.bV=m,t.bW=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.bX=function(t,e,n){var i=e[0],r=e[1],a=e[2];return t[0]=i*n[0]+r*n[3]+a*n[6],t[1]=i*n[1]+r*n[4]+a*n[7],t[2]=i*n[2]+r*n[5]+a*n[8],t},t.bY=function(t,e,n,i,r,a,s){var o=1/(e-n),l=1/(i-r),c=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*o,t[13]=(r+i)*l,t[14]=(s+a)*c,t[15]=1,t},t.bZ=class extends uo{constructor(t,e){super(t,e),this.current=new Array}set(t){if(t!=this.current){this.current=t;const e=new Float32Array(4*t.length);for(let n=0;n<t.length;n++)e[4*n]=t[n].r,e[4*n+1]=t[n].g,e[4*n+2]=t[n].b,e[4*n+3]=t[n].a;this.gl.uniform4fv(this.location,e)}}},t.b_=class extends uo{constructor(t,e){super(t,e),this.current=new Array}set(t){if(t!=this.current){this.current=t;const e=new Float32Array(t);this.gl.uniform1fv(this.location,e)}}},t.ba=function(){return new Float64Array(16)},t.bb=function(t,e,n){const i=new Float64Array(4);return k(i,t,e-90,n),i},t.bc=function(t,e,n,i){var r,a,s,o,l,c=e[0],u=e[1],h=e[2],d=e[3],p=n[0],m=n[1],g=n[2],_=n[3];return(a=c*p+u*m+h*g+d*_)<0&&(a=-a,p=-p,m=-m,g=-g,_=-_),1-a>f?(r=Math.acos(a),s=Math.sin(r),o=Math.sin((1-i)*r)/s,l=Math.sin(i*r)/s):(o=1-i,l=i),t[0]=o*c+l*p,t[1]=o*u+l*m,t[2]=o*h+l*g,t[3]=o*d+l*_,t},t.bd=function(t){const e=new Float64Array(9);var n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v;h=(r=(i=t)[0])*(l=r+r),d=(a=i[1])*l,p=(s=i[2])*l,m=s*(c=a+a),_=(o=i[3])*l,y=o*c,v=o*(u=s+s),(n=e)[0]=1-(f=a*c)-(g=s*u),n[3]=d-v,n[6]=p+y,n[1]=d+v,n[4]=1-h-g,n[7]=m-_,n[2]=p-y,n[5]=m+_,n[8]=1-h-f;const b=nt(-Math.asin(F(e[2],-1,1)));let x,w;return Math.hypot(e[5],e[8])<.001?(x=0,w=-nt(Math.atan2(e[3],e[4]))):(x=nt(0===e[5]&&0===e[8]?0:Math.atan2(e[5],e[8])),w=nt(0===e[1]&&0===e[0]?0:Math.atan2(e[1],e[0]))),{roll:x,pitch:b+90,bearing:w}},t.be=function(t,e){return t.roll==e.roll&&t.pitch==e.pitch&&t.bearing==e.bearing},t.bf=ke,t.bg=ho,t.bh=tc,t.bi=ec,t.bj=$l,t.bk=z,t.bl=N,t.bm=Be,t.bn=function(t,e,n,i,r){return z(i,r,F((t-e)/(n-e),0,1))},t.bo=L,t.bp=function(){return new Float64Array(3)},t.bq=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},t.br=k,t.bs=function(t,e,n){var i=n[0],r=n[1],a=n[2],s=n[3],o=e[0],l=e[1],c=e[2],u=r*c-a*l,h=a*o-i*c,d=i*l-r*o;return t[0]=o+s*(u+=u)+r*(d+=d)-a*(h+=h),t[1]=l+s*h+a*u-i*d,t[2]=c+s*d+i*h-r*u,t},t.bt=function(t,e,n){const i=(r=[t[0],t[1],t[2],e[0],e[1],e[2],n[0],n[1],n[2]])[0]*((u=r[8])*(s=r[4])-(o=r[5])*(c=r[7]))+r[1]*(-u*(a=r[3])+o*(l=r[6]))+r[2]*(c*a-s*l);var r,a,s,o,l,c,u;if(0===i)return null;const h=w([],[e[0],e[1],e[2]],[n[0],n[1],n[2]]),d=w([],[n[0],n[1],n[2]],[t[0],t[1],t[2]]),f=w([],[t[0],t[1],t[2]],[e[0],e[1],e[2]]),p=x([],h,-t[3]);return b(p,p,x([],d,-e[3])),b(p,p,x([],f,-n[3])),x(p,p,1/i),p},t.bu=_h,t.bv=function(){return new Float64Array(4)},t.bw=function(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),a[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),a[2]=r[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},t.bx=function(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[0],a[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),a[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},t.by=function(t,e,n,i){var r=[],a=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],a[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),a[1]=r[1],a[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},t.bz=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],s=e[1],o=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-c*i,t[1]=s*r-u*i,t[2]=o*r-h*i,t[3]=l*r-d*i,t[8]=a*i+c*r,t[9]=s*i+u*r,t[10]=o*i+h*r,t[11]=l*i+d*r,t},t.c=st,t.c0=$c,t.c1=class extends ds{},t.c2=dl,t.c3=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.c4=hl,t.c5=function(t,e,n){var i=e[0],r=e[1],a=e[2],s=n[3]*i+n[7]*r+n[11]*a+n[15];return t[0]=(n[0]*i+n[4]*r+n[8]*a+n[12])/(s=s||1),t[1]=(n[1]*i+n[5]*r+n[9]*a+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*a+n[14])/s,t},t.c6=class extends ts{},t.c7=class extends vs{},t.c8=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},t.c9=function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],s=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],m=t[12],g=t[13],_=t[14],y=t[15],v=e[0],b=e[1],x=e[2],w=e[3],S=e[4],P=e[5],M=e[6],A=e[7],k=e[8],E=e[9],T=e[10],C=e[11],I=e[12],L=e[13],z=e[14],N=e[15];return Math.abs(n-v)<=f*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(i-b)<=f*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(r-x)<=f*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-w)<=f*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=f*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(o-P)<=f*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(l-M)<=f*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(c-A)<=f*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(u-k)<=f*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(h-E)<=f*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-T)<=f*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-C)<=f*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-I)<=f*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(g-L)<=f*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(_-z)<=f*Math.max(1,Math.abs(_),Math.abs(z))&&Math.abs(y-N)<=f*Math.max(1,Math.abs(y),Math.abs(N))},t.cA=function(t,e){ot.REGISTERED_PROTOCOLS[t]=e},t.cB=function(t){delete ot.REGISTERED_PROTOCOLS[t]},t.cC=function(t,e){const n={};for(let r=0;r<t.length;r++){const i=e&&e[t[r].id]||wr(t[r]);e&&(e[t[r].id]=i);let a=n[i];a||(a=n[i]=[]),a.push(t[r])}const i=[];for(const r in n)i.push(n[r]);return i},t.cD=la,t.cE=Nh,t.cF=Rh,t.cG=wu,t.cH=function(e){e.bucket.createArrays(),e.bucket.tilePixelRatio=C/(512*e.bucket.overscaling),e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;const n=e.bucket.layers[0],i=n.layout,r=n._unevaluatedLayout._values,a={layoutIconSize:r["icon-size"].possiblyEvaluate(new Ta(e.bucket.zoom+1),e.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new Ta(e.bucket.zoom+1),e.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new Ta(18))};if("composite"===e.bucket.textSizeData.kind){const{minZoom:t,maxZoom:n}=e.bucket.textSizeData;a.compositeTextSizes=[r["text-size"].possiblyEvaluate(new Ta(t),e.canonical),r["text-size"].possiblyEvaluate(new Ta(n),e.canonical)]}if("composite"===e.bucket.iconSizeData.kind){const{minZoom:t,maxZoom:n}=e.bucket.iconSizeData;a.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new Ta(t),e.canonical),r["icon-size"].possiblyEvaluate(new Ta(n),e.canonical)]}const s=i.get("text-line-height")*eu,o="viewport"!==i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement"),l=i.get("text-keep-upright"),c=i.get("text-size");for(const u of e.bucket.features){const r=i.get("text-font").evaluate(u,{},e.canonical).join(","),h=c.evaluate(u,{},e.canonical),d=a.layoutTextSize.evaluate(u,{},e.canonical),f=a.layoutIconSize.evaluate(u,{},e.canonical),p={horizontal:{},vertical:void 0},m=u.text;let g,_=[0,0];if(m){const a=m.toString(),c=i.get("text-letter-spacing").evaluate(u,{},e.canonical)*eu,f=_a(a)?c:0,g=i.get("text-anchor").evaluate(u,{},e.canonical),y=od(n,u,e.canonical);if(!y){const t=i.get("text-radial-offset").evaluate(u,{},e.canonical);_=t?sd(g,[t*eu,ad]):i.get("text-offset").evaluate(u,{},e.canonical).map(t=>t*eu)}let v=o?"center":i.get("text-justify").evaluate(u,{},e.canonical);const b="point"===i.get("symbol-placement")?i.get("text-max-width").evaluate(u,{},e.canonical)*eu:1/0,x=()=>{e.bucket.allowVerticalPlacement&&ga(a)&&(p.vertical=Au(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,b,s,g,"left",f,_,t.ao.vertical,!0,d,h))};if(!o&&y){const n=new Set;if("auto"===v)for(let t=0;t<y.values.length;t+=2)n.add(ld(y.values[t]));else n.add(v);let i=!1;for(const a of n)if(!p.horizontal[a])if(i)p.horizontal[a]=p.horizontal[0];else{const n=Au(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,b,s,"center",a,f,_,t.ao.horizontal,!1,d,h);n&&(p.horizontal[a]=n,i=1===n.positionedLines.length)}x()}else{"auto"===v&&(v=ld(g));const n=Au(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,b,s,g,v,f,_,t.ao.horizontal,!1,d,h);n&&(p.horizontal[v]=n),x(),ga(a)&&o&&l&&(p.vertical=Au(m,e.glyphMap,e.glyphPositions,e.imagePositions,r,b,s,g,v,f,_,t.ao.vertical,!1,d,h))}}let y=!1;if(u.icon&&u.icon.name){const t=e.imageMap[u.icon.name];t&&(g=qu(e.imagePositions[u.icon.name],i.get("icon-offset").evaluate(u,{},e.canonical),i.get("icon-anchor").evaluate(u,{},e.canonical)),y=!!t.sdf,void 0===e.bucket.sdfIcons?e.bucket.sdfIcons=y:e.bucket.sdfIcons!==y&&Z("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.bucket.pixelRatio||0!==i.get("icon-rotate").constantOr(1))&&(e.bucket.iconsNeedLinear=!0))}const v=hd(p.horizontal)||p.vertical;e.bucket.iconsInText=!!v&&v.iconsInText,(v||g)&&cd(e.bucket,u,p,g,e.imageMap,a,d,f,_,y,e.canonical,e.subdivisionGranularity)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()},t.cI=jc,t.cJ=lc,t.cK=Mc,t.cL=xc,t.cM=au,t.cN=class{constructor(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let t=performance.getEntriesByName(this._marks.measure);return 0===t.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}},t.cO=function(t,n,i,r,a){return e(this,void 0,void 0,function*(){if(d())try{return yield J(t,n,i,r,a)}catch(t){}return function(t,e,n,i,r){const a=t.width,s=t.height;$&&Q||($=new OffscreenCanvas(a,s),Q=$.getContext("2d",{willReadFrequently:!0})),$.width=a,$.height=s,Q.drawImage(t,0,0,a,s);const o=Q.getImageData(e,n,i,r);return Q.clearRect(0,0,a,s),o.data}(t,n,i,r,a)})},t.cP=bl,t.cQ=r,t.cR=vc,t.cS=gc,t.cT=ir,t.cU=function(t,e){const n=new Map;if(null==t);else if("Feature"===t.type)n.set(Lh(t,e),t);else for(const i of t.features)n.set(Lh(i,e),i);return n},t.cV=function(t,e){if(null==t)return!0;if("Feature"===t.type)return null!=Lh(t,e);if("FeatureCollection"===t.type){const n=new Set;for(const i of t.features){const t=Lh(i,e);if(null==t)return!1;if(n.has(t))return!1;n.add(t)}return!0}return!1},t.cW=function(t,e,n){var i,r,a,s;if(e.removeAll&&t.clear(),e.remove)for(const o of e.remove)t.delete(o);if(e.add)for(const o of e.add){const e=Lh(o,n);null!=e&&t.set(e,o)}if(e.update)for(const o of e.update){let e=t.get(o.id);if(null==e)continue;const n=!o.removeAllProperties&&((null===(i=o.removeProperties)||void 0===i?void 0:i.length)>0||(null===(r=o.addOrUpdateProperties)||void 0===r?void 0:r.length)>0);if((o.newGeometry||o.removeAllProperties||n)&&(e=Object.assign({},e),t.set(o.id,e),n&&(e.properties=Object.assign({},e.properties))),o.newGeometry&&(e.geometry=o.newGeometry),o.removeAllProperties)e.properties={};else if((null===(a=o.removeProperties)||void 0===a?void 0:a.length)>0)for(const t of o.removeProperties)Object.prototype.hasOwnProperty.call(e.properties,t)&&delete e.properties[t];if((null===(s=o.addOrUpdateProperties)||void 0===s?void 0:s.length)>0)for(const{key:t,value:i}of o.addOrUpdateProperties)e.properties[t]=i}},t.cX=Ea,t.ca=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.cb=t=>"symbol"===t.type,t.cc=t=>"circle"===t.type,t.cd=t=>"heatmap"===t.type,t.ce=t=>"line"===t.type,t.cf=t=>"fill"===t.type,t.cg=t=>"fill-extrusion"===t.type,t.ch=t=>"hillshade"===t.type,t.ci=t=>"color-relief"===t.type,t.cj=t=>"raster"===t.type,t.ck=t=>"background"===t.type,t.cl=t=>"custom"===t.type,t.cm=D,t.cn=function(t,e,n){const i=T(e.x-n.x,e.y-n.y),r=T(t.x-n.x,t.y-n.y);var a,s;return nt(Math.atan2(i[0]*r[1]-i[1]*r[0],(a=i)[0]*(s=r)[0]+a[1]*s[1]))},t.co=R,t.cp=function(t,e){return rt[e]&&(t instanceof MouseEvent||t instanceof WheelEvent)},t.cq=function(t,e){return it[e]&&"touches"in t},t.cr=function(t){return it[t]||rt[t]},t.cs=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t},t.ct=function(t,e){const{x:n,y:i}=Ah.fromLngLat(e);return!(t<0||t>25||i<0||i>=1||n<0||n>=1)},t.cu=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.cv=class extends Qa{},t.cw=Ad,t.cy=function(t){return t.message===at},t.cz=ut,t.d=ft,t.e=B,t.f=t=>e(void 0,void 0,void 0,function*(){if(0===t.byteLength)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(t)],{type:"image/png"});try{return createImageBitmap(e)}catch(t){throw new Error("Could not load image because of ".concat(t.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}}),t.g=lt,t.h=t=>new Promise((e,n)=>{const i=new Image;i.onload=()=>{e(i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame(()=>{i.src=K})},i.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?URL.createObjectURL(r):K}),t.i=H,t.j=(t,e)=>dt(B(t,{type:"json"}),e),t.k=_t,t.l=gt,t.m=dt,t.n=(t,e)=>dt(B(t,{type:"arrayBuffer"}),e),t.o=function(t){return new au(t).readFields(_u,[])},t.p=bu,t.q=cl,t.r=Va,t.s=tt,t.t=za,t.u=ma,t.v=vt,t.w=Z,t.x=ea,t.y=aa,t.z=ta}),n("worker",["./shared"],function(t){class e{constructor(t,e){this.keyCache={},t&&this.replace(t,e)}replace(t,e){this._layerConfigs={},this._layers={},this.update(t,[],e)}update(e,n,i){for(const a of e){this._layerConfigs[a.id]=a;const e=this._layers[a.id]=t.bJ(a,i);e._featureFilter=t.aa(e.filter,i),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(const t of n)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=t.cC(Object.values(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map(t=>this._layers[t.id]),n=e[0];if("none"===n.visibility)continue;const i=n.source||"";let r=this.familiesBySource[i];r||(r=this.familiesBySource[i]={});const a=n.sourceLayer||"_geojsonTileLayer";let s=r[a];s||(s=r[a]=[]),s.push(e)}}}class n{constructor(e){const n={},i=[];for(const t in e){const r=e[t],a=n[t]={};for(const t in r){const e=r[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const n={x:0,y:0,w:e.bitmap.width+2,h:e.bitmap.height+2};i.push(n),a[t]={rect:n,metrics:e.metrics}}}const{w:r,h:a}=t.p(i),s=new t.q({width:r||1,height:a||1});for(const o in e){const i=e[o];for(const e in i){const r=i[+e];if(!r||0===r.bitmap.width||0===r.bitmap.height)continue;const a=n[o][e].rect;t.q.copy(r.bitmap,s,{x:0,y:0},{x:a.x+1,y:a.y+1},r.bitmap)}}this.image=s,this.positions=n}}t.cD("GlyphAtlas",n);class i{constructor(e){this.tileID=new t.Z(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[]}parse(e,i,a,s,o){return t._(this,void 0,void 0,function*(){this.status="parsing",this.data=e,this.collisionBoxArray=new t.a8;const l=new t.cE(Object.keys(e.layers).sort()),c=new t.cF(this.tileID,this.promoteId);c.bucketLayerIDs=[];const u={},h={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a,subdivisionGranularity:o},d=i.familiesBySource[this.source];for(const n in d){const i=e.layers[n];if(!i)continue;1===i.version&&t.w('Vector tile source "'.concat(this.source,'" layer "').concat(n,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));const s=l.encode(n),o=[];for(let t=0;t<i.length;t++){const e=i.feature(t),r=c.getId(e,n);o.push({feature:e,id:r,index:t,sourceLayerIndex:s})}for(const e of d[n]){const n=e[0];n.source!==this.source&&t.w("layer.source = ".concat(n.source," does not equal this.source = ").concat(this.source)),n.minzoom&&this.zoom<Math.floor(n.minzoom)||n.maxzoom&&this.zoom>=n.maxzoom||"none"!==n.visibility&&(r(e,this.zoom,a),(u[n.id]=n.createBucket({index:c.bucketLayerIDs.length,layers:e,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:s,sourceID:this.source})).populate(o,h,this.tileID.canonical),c.bucketLayerIDs.push(e.map(t=>t.id)))}}const f=t.bN(h.glyphDependencies,t=>Object.keys(t).map(Number));this.inFlightDependencies.forEach(t=>null==t?void 0:t.abort()),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(f).length){const t=new AbortController;this.inFlightDependencies.push(t),p=s.sendAsync({type:"GG",data:{stacks:f,source:this.source,tileID:this.tileID,type:"glyphs"}},t)}const m=Object.keys(h.iconDependencies);let g=Promise.resolve({});if(m.length){const t=new AbortController;this.inFlightDependencies.push(t),g=s.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"icons"}},t)}const _=Object.keys(h.patternDependencies);let y=Promise.resolve({});if(_.length){const t=new AbortController;this.inFlightDependencies.push(t),y=s.sendAsync({type:"GI",data:{icons:_,source:this.source,tileID:this.tileID,type:"patterns"}},t)}const[v,b,x]=yield Promise.all([p,g,y]),w=new n(v),S=new t.cG(b,x);for(const e in u){const n=u[e];n instanceof t.a9?(r(n.layers,this.zoom,a),t.cH({bucket:n,glyphMap:v,glyphPositions:w.positions,imageMap:b,imagePositions:S.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:h.subdivisionGranularity})):n.hasPattern&&(n instanceof t.cI||n instanceof t.cJ||n instanceof t.cK)&&(r(n.layers,this.zoom,a),n.addFeatures(h,this.tileID.canonical,S.patternPositions))}return this.status="done",{buckets:Object.values(u).filter(t=>!t.isEmpty()),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:w.image,imageAtlas:S,glyphMap:this.returnDependencies?v:null,iconMap:this.returnDependencies?b:null,glyphPositions:this.returnDependencies?w.positions:null}})}}function r(e,n,i){const r=new t.F(n);for(const t of e)t.recalculate(r,i)}class a{constructor(t,e,n){this.actor=t,this.layerIndex=e,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(e,n){return t._(this,void 0,void 0,function*(){const i=yield t.n(e.request,n);try{return{vectorTile:new t.cL(new t.cM(i.data)),rawData:i.data,cacheControl:i.cacheControl,expires:i.expires}}catch(t){const r=new Uint8Array(i.data);let a="Unable to parse the tile at ".concat(e.request.url,", ");throw a+=31===r[0]&&139===r[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":"got error: ".concat(t.message),new Error(a)}})}loadTile(e){return t._(this,void 0,void 0,function*(){const n=e.uid,r=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.cN(e.request),a=new i(e);this.loading[n]=a;const s=new AbortController;a.abort=s;try{const i=yield this.loadVectorTile(e,s);if(delete this.loading[n],!i)return null;const o=i.rawData,l={};i.expires&&(l.expires=i.expires),i.cacheControl&&(l.cacheControl=i.cacheControl);const c={};if(r){const t=r.finish();t&&(c.resourceTiming=JSON.parse(JSON.stringify(t)))}a.vectorTile=i.vectorTile;const u=a.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor,e.subdivisionGranularity);this.loaded[n]=a,this.fetching[n]={rawTileData:o,cacheControl:l,resourceTiming:c};try{const e=yield u;return t.e({rawTileData:o.slice(0)},e,l,c)}finally{delete this.fetching[n]}}catch(t){throw delete this.loading[n],a.status="done",this.loaded[n]=a,t}})}reloadTile(e){return t._(this,void 0,void 0,function*(){const n=e.uid;if(!this.loaded||!this.loaded[n])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const i=this.loaded[n];if(i.showCollisionBoxes=e.showCollisionBoxes,"parsing"===i.status){const r=yield i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor,e.subdivisionGranularity);let a;if(this.fetching[n]){const{rawTileData:e,cacheControl:i,resourceTiming:s}=this.fetching[n];delete this.fetching[n],a=t.e({rawTileData:e.slice(0)},r,i,s)}else a=r;return a}if("done"===i.status&&i.vectorTile)return i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor,e.subdivisionGranularity)})}abortTile(e){return t._(this,void 0,void 0,function*(){const t=this.loading,n=e.uid;t&&t[n]&&t[n].abort&&(t[n].abort.abort(),delete t[n])})}removeTile(e){return t._(this,void 0,void 0,function*(){this.loaded&&this.loaded[e.uid]&&delete this.loaded[e.uid]})}}class s{constructor(){this.loaded={}}loadTile(e){return t._(this,void 0,void 0,function*(){const{uid:n,encoding:i,rawImageData:r,redFactor:a,greenFactor:s,blueFactor:o,baseShift:l}=e,c=r.width+2,u=r.height+2,h=t.b(r)?new t.R({width:c,height:u},yield t.cO(r,-1,-1,c,u)):r,d=new t.cP(n,h,i,a,s,o,l);return this.loaded=this.loaded||{},this.loaded[n]=d,d})}removeTile(t){const e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]}}var o,l,c=function(){if(l)return o;function t(t,n){if(0!==t.length){e(t[0],n);for(var i=1;i<t.length;i++)e(t[i],!n)}}function e(t,e){for(var n=0,i=0,r=0,a=t.length,s=a-1;r<a;s=r++){var o=(t[r][0]-t[s][0])*(t[s][1]+t[r][1]),l=n+o;i+=Math.abs(n)>=Math.abs(o)?n-l+o:o-l+n,n=l}n+i>=0!=!!e&&t.reverse()}return l=1,o=function e(n,i){var r,a=n&&n.type;if("FeatureCollection"===a)for(r=0;r<n.features.length;r++)e(n.features[r],i);else if("GeometryCollection"===a)for(r=0;r<n.geometries.length;r++)e(n.geometries[r],i);else if("Feature"===a)e(n.geometry,i);else if("Polygon"===a)t(n.coordinates,i);else if("MultiPolygon"===a)for(r=0;r<n.coordinates.length;r++)t(n.coordinates[r],i);return n}}(),u=t.cQ(c);class h extends t.cS{constructor(e,n){super(new t.cM,0,n,[],[]),this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},"id"in e&&("string"==typeof e.id?this.id=parseInt(e.id,10):"number"!=typeof e.id||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],n=1===this.feature.type?[this.feature.geometry]:this.feature.geometry;for(const i of n){const n=[];for(const e of i)n.push(new t.P(e[0],e[1]));e.push(n)}return e}}class d extends t.cR{constructor(e,n){super(new t.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=n?n.version:1,this.extent=n?n.extent:4096,this.length=e.length,this.features=e}feature(t){return new h(this.features[t],this.extent)}}function f(t,e){e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);const n={keys:[],values:[],keycache:{},valuecache:{}};for(let a=0;a<t.length;a++)n.feature=t.feature(a),e.writeMessage(2,p,n);const i=n.keys;for(const a of i)e.writeStringField(3,a);const r=n.values;for(const a of r)e.writeMessage(4,v,a)}function p(t,e){if(!t.feature)return;const n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,m,t),e.writeVarintField(3,n.type),e.writeMessage(4,y,n)}function m(t,e){for(const i in null===(n=t.feature)||void 0===n?void 0:n.properties){var n;let r=t.feature.properties[i],a=t.keycache[i];if(null===r)continue;void 0===a&&(t.keys.push(i),a=t.keys.length-1,t.keycache[i]=a),e.writeVarint(a),"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r&&(r=JSON.stringify(r));const s=typeof r+":"+r;let o=t.valuecache[s];void 0===o&&(t.values.push(r),o=t.values.length-1,t.valuecache[s]=o),e.writeVarint(o)}}function g(t,e){return(e<<3)+(7&t)}function _(t){return t<<1^t>>31}function y(t,e){const n=t.loadGeometry(),i=t.type;let r=0,a=0;for(const s of n){let n=1;1===i&&(n=s.length),e.writeVarint(g(1,n));const o=3===i?s.length-1:s.length;for(let t=0;t<o;t++){1===t&&1!==i&&e.writeVarint(g(2,o-1));const n=s[t].x-r,l=s[t].y-a;e.writeVarint(_(n)),e.writeVarint(_(l)),r+=n,a+=l}3===t.type&&e.writeVarint(g(7,1))}}function v(t,e){const n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}const b={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},x=Math.fround||(w=new Float32Array(1),t=>(w[0]=+t,w[0]));var w;class S{constructor(t){this.options=Object.assign(Object.create(b),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:n,maxZoom:i}=this.options;e&&console.time("total time");const r="prepare ".concat(t.length," points");e&&console.time(r),this.points=t;const a=[];for(let o=0;o<t.length;o++){const e=t[o];if(!e.geometry)continue;const[n,i]=e.geometry.coordinates,r=x(A(n)),s=x(k(i));a.push(r,s,1/0,o,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);e&&console.timeEnd(r);for(let o=i;o>=n;o--){const t=+Date.now();s=this.trees[o]=this._createTree(this._cluster(s,o)),e&&console.log("z%d: %d clusters in %dms",o,s.numItems,+Date.now()-t)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){const t=this.getClusters([n,i,180,a],e),s=this.getClusters([-180,i,r,a],e);return t.concat(s)}const s=this.trees[this._limitZoom(e)],o=s.range(A(n),k(a),A(r),k(i)),l=s.data,c=[];for(const u of o){const t=this.stride*u;c.push(l[t+5]>1?P(l,t,this.clusterProps):this.points[l[t+3]])}return c}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);const a=r.data;if(e*this.stride>=a.length)throw new Error(i);const s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),o=r.within(a[e*this.stride],a[e*this.stride+1],s),l=[];for(const c of o){const e=c*this.stride;a[e+4]===t&&l.push(a[e+5]>1?P(a,e,this.clusterProps):this.points[a[e+3]])}if(0===l.length)throw new Error(i);return l}getLeaves(t,e,n){const i=[];return this._appendLeaves(i,t,e=e||10,n=n||0,0),i}getTile(t,e,n){const i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:a,radius:s}=this.options,o=s/a,l=(n-o)/r,c=(n+1+o)/r,u={features:[]};return this._addTileFeatures(i.range((e-o)/r,l,(e+1+o)/r,c),i.data,e,n,r,u),0===e&&this._addTileFeatures(i.range(1-o/r,l,1,c),i.data,r,n,r,u),e===r-1&&this._addTileFeatures(i.range(0,l,o/r,c),i.data,-1,n,r,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,i,r){const a=this.getChildren(e);for(const s of a){const e=s.properties;if(e&&e.cluster?r+e.point_count<=i?r+=e.point_count:r=this._appendLeaves(t,e.cluster_id,n,i,r):r<i?r++:t.push(s),t.length===n)break}return r}_createTree(e){const n=new t.aI(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)n.add(e[t],e[t+1]);return n.finish(),n.data=e,n}_addTileFeatures(t,e,n,i,r,a){for(const s of t){const t=s*this.stride,o=e[t+5]>1;let l,c,u;if(o)l=M(e,t,this.clusterProps),c=e[t],u=e[t+1];else{const n=this.points[e[t+3]];l=n.properties;const[i,r]=n.geometry.coordinates;c=A(i),u=k(r)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*r-n)),Math.round(this.options.extent*(u*r-i))]],tags:l};let d;d=o||this.options.generateId?e[t+3]:this.points[e[t+3]].id,void 0!==d&&(h.id=d),a.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:n,extent:i,reduce:r,minPoints:a}=this.options,s=n/(i*Math.pow(2,e)),o=t.data,l=[],c=this.stride;for(let u=0;u<o.length;u+=c){if(o[u+2]<=e)continue;o[u+2]=e;const n=o[u],i=o[u+1],h=t.within(o[u],o[u+1],s),d=o[u+5];let f=d;for(const t of h){const n=t*c;o[n+2]>e&&(f+=o[n+5])}if(f>d&&f>=a){let t,a=n*d,s=i*d,p=-1;const m=(u/c<<5)+(e+1)+this.points.length;for(const n of h){const i=n*c;if(o[i+2]<=e)continue;o[i+2]=e;const l=o[i+5];a+=o[i]*l,s+=o[i+1]*l,o[i+4]=m,r&&(t||(t=this._map(o,u,!0),p=this.clusterProps.length,this.clusterProps.push(t)),r(t,this._map(o,i)))}o[u+4]=m,l.push(a/f,s/f,1/0,m,-1,f),r&&l.push(p)}else{for(let t=0;t<c;t++)l.push(o[u+t]);if(f>1)for(const t of h){const n=t*c;if(!(o[n+2]<=e)){o[n+2]=e;for(let t=0;t<c;t++)l.push(o[n+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,n){if(t[e+5]>1){const i=this.clusterProps[t[e+6]];return n?Object.assign({},i):i}const i=this.points[t[e+3]].properties,r=this.options.map(i);return n&&r===i?Object.assign({},r):r}}function P(t,e,n){return{type:"Feature",id:t[e+3],properties:M(t,e,n),geometry:{type:"Point",coordinates:[(i=t[e],360*(i-.5)),E(t[e+1])]}};var i}function M(t,e,n){const i=t[e+5],r=i>=1e4?"".concat(Math.round(i/1e3),"k"):i>=1e3?Math.round(i/100)/10+"k":i,a=t[e+6],s=-1===a?{}:Object.assign({},n[a]);return Object.assign(s,{cluster:!0,cluster_id:t[e+3],point_count:i,point_count_abbreviated:r})}function A(t){return t/360+.5}function k(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function E(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function T(t,e,n,i){let r=i;const a=e+(n-e>>1);let s,o=n-e;const l=t[e],c=t[e+1],u=t[n],h=t[n+1];for(let d=e+3;d<n;d+=3){const e=C(t[d],t[d+1],l,c,u,h);if(e>r)s=d,r=e;else if(e===r){const t=Math.abs(d-a);t<o&&(s=d,o=t)}}r>i&&(s-e>3&&T(t,e,s,i),t[s+2]=r,n-s>3&&T(t,s,n,i))}function C(t,e,n,i,r,a){let s=r-n,o=a-i;if(0!==s||0!==o){const l=((t-n)*s+(e-i)*o)/(s*s+o*o);l>1?(n=r,i=a):l>0&&(n+=s*l,i+=o*l)}return s=t-n,o=e-i,s*s+o*o}function I(t,e,n,i){const r={id:null==t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===e||"MultiPoint"===e||"LineString"===e)L(r,n);else if("Polygon"===e)L(r,n[0]);else if("MultiLineString"===e)for(const a of n)L(r,a);else if("MultiPolygon"===e)for(const a of n)L(r,a[0]);return r}function L(t,e){for(let n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function z(t,e,n,i){if(!e.geometry)return;const r=e.geometry.coordinates;if(r&&0===r.length)return;const a=e.geometry.type,s=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2);let o=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===a)N(r,o);else if("MultiPoint"===a)for(const c of r)N(c,o);else if("LineString"===a)D(r,o,s,!1);else if("MultiLineString"===a){if(n.lineMetrics){for(const n of r)o=[],D(n,o,s,!1),t.push(I(l,"LineString",o,e.properties));return}R(r,o,s,!1)}else if("Polygon"===a)R(r,o,s,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(const r of e.geometry.geometries)z(t,{id:l,geometry:r,properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const t of r){const e=[];R(t,e,s,!0),o.push(e)}}t.push(I(l,a,o,e.properties))}function N(t,e){e.push(F(t[0]),O(t[1]),0)}function D(t,e,n,i){let r,a,s=0;for(let l=0;l<t.length;l++){const n=F(t[l][0]),o=O(t[l][1]);e.push(n,o,0),l>0&&(s+=i?(r*o-n*a)/2:Math.sqrt(Math.pow(n-r,2)+Math.pow(o-a,2))),r=n,a=o}const o=e.length-3;e[2]=1,T(e,0,o,n),e[o+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function R(t,e,n,i){for(let r=0;r<t.length;r++){const a=[];D(t[r],a,n,i),e.push(a)}}function F(t){return t/360+.5}function O(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function B(t,e,n,i,r,a,s,o){if(i/=e,a>=(n/=e)&&s<i)return t;if(s<n||a>=i)return null;const l=[];for(const c of t){const t=c.geometry;let e=c.type;const a=0===r?c.minX:c.minY,s=0===r?c.maxX:c.maxY;if(a>=n&&s<i){l.push(c);continue}if(s<n||a>=i)continue;let u=[];if("Point"===e||"MultiPoint"===e)j(t,u,n,i,r);else if("LineString"===e)U(t,u,n,i,r,!1,o.lineMetrics);else if("MultiLineString"===e)q(t,u,n,i,r,!1);else if("Polygon"===e)q(t,u,n,i,r,!0);else if("MultiPolygon"===e)for(const o of t){const t=[];q(o,t,n,i,r,!0),t.length&&u.push(t)}if(u.length){if(o.lineMetrics&&"LineString"===e){for(const t of u)l.push(I(c.id,e,t,c.tags));continue}"LineString"!==e&&"MultiLineString"!==e||(1===u.length?(e="LineString",u=u[0]):e="MultiLineString"),"Point"!==e&&"MultiPoint"!==e||(e=3===u.length?"Point":"MultiPoint"),l.push(I(c.id,e,u,c.tags))}}return l.length?l:null}function j(t,e,n,i,r){for(let a=0;a<t.length;a+=3){const s=t[a+r];s>=n&&s<=i&&V(e,t[a],t[a+1],t[a+2])}}function U(t,e,n,i,r,a,s){let o=G(t);const l=0===r?Z:W;let c,u,h=t.start;for(let g=0;g<t.length-3;g+=3){const d=t[g],f=t[g+1],p=t[g+2],m=t[g+3],_=t[g+4],y=0===r?d:f,v=0===r?m:_;let b=!1;s&&(c=Math.sqrt(Math.pow(d-m,2)+Math.pow(f-_,2))),y<n?v>n&&(u=l(o,d,f,m,_,n),s&&(o.start=h+c*u)):y>i?v<i&&(u=l(o,d,f,m,_,i),s&&(o.start=h+c*u)):V(o,d,f,p),v<n&&y>=n&&(u=l(o,d,f,m,_,n),b=!0),v>i&&y<=i&&(u=l(o,d,f,m,_,i),b=!0),!a&&b&&(s&&(o.end=h+c*u),e.push(o),o=G(t)),s&&(h+=c)}let d=t.length-3;const f=t[d],p=t[d+1],m=0===r?f:p;m>=n&&m<=i&&V(o,f,p,t[d+2]),d=o.length-3,a&&d>=3&&(o[d]!==o[0]||o[d+1]!==o[1])&&V(o,o[0],o[1],o[2]),o.length&&e.push(o)}function G(t){const e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function q(t,e,n,i,r,a){for(const s of t)U(s,e,n,i,r,a,!1)}function V(t,e,n,i){t.push(e,n,i)}function Z(t,e,n,i,r,a){const s=(a-e)/(i-e);return V(t,a,n+(r-n)*s,1),s}function W(t,e,n,i,r,a){const s=(a-n)/(r-n);return V(t,e+(i-e)*s,a,1),s}function H(t,e){const n=[];for(let i=0;i<t.length;i++){const r=t[i],a=r.type;let s;if("Point"===a||"MultiPoint"===a||"LineString"===a)s=X(r.geometry,e);else if("MultiLineString"===a||"Polygon"===a){s=[];for(const t of r.geometry)s.push(X(t,e))}else if("MultiPolygon"===a){s=[];for(const t of r.geometry){const n=[];for(const i of t)n.push(X(i,e));s.push(n)}}n.push(I(r.id,a,s,r.tags))}return n}function X(t,e){const n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(let i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function Y(t,e){if(t.transformed)return t;const n=1<<t.z,i=t.x,r=t.y;for(const a of t.features){const t=a.geometry,s=a.type;if(a.geometry=[],1===s)for(let o=0;o<t.length;o+=2)a.geometry.push(K(t[o],t[o+1],e,n,i,r));else for(let o=0;o<t.length;o++){const s=[];for(let a=0;a<t[o].length;a+=2)s.push(K(t[o][a],t[o][a+1],e,n,i,r));a.geometry.push(s)}}return t.transformed=!0,t}function K(t,e,n,i,r,a){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-a))]}function J(t,e,n,i,r){const a=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:t.length,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const o of t)$(s,o,a,r);return s}function $(t,e,n,i){const r=e.geometry,a=e.type,s=[];if(t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),"Point"===a||"MultiPoint"===a)for(let o=0;o<r.length;o+=3)s.push(r[o],r[o+1]),t.numPoints++,t.numSimplified++;else if("LineString"===a)Q(s,r,t,n,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(let o=0;o<r.length;o++)Q(s,r[o],t,n,"Polygon"===a,0===o);else if("MultiPolygon"===a)for(let o=0;o<r.length;o++){const e=r[o];for(let i=0;i<e.length;i++)Q(s,e[i],t,n,!0,0===i)}if(s.length){let n=e.tags||null;if("LineString"===a&&i.lineMetrics){n={};for(const t in e.tags)n[t]=e.tags[t];n.mapbox_clip_start=r.start/r.size,n.mapbox_clip_end=r.end/r.size}const o={geometry:s,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:n};null!==e.id&&(o.id=e.id),t.features.push(o)}}function Q(t,e,n,i,r,a){const s=i*i;if(i>0&&e.size<(r?s:i))return void(n.numPoints+=e.length/3);const o=[];for(let l=0;l<e.length;l+=3)(0===i||e[l+2]>s)&&(n.numSimplified++,o.push(e[l],e[l+1])),n.numPoints++;r&&function(t,e){let n=0;for(let i=0,r=t.length,a=r-2;i<r;a=i,i+=2)n+=(t[i]-t[a])*(t[i+1]+t[a+1]);if(n>0===e)for(let i=0,r=t.length;i<r/2;i+=2){const e=t[i],n=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=e,t[r-1-i]=n}}(o,a),t.push(o)}const tt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class et{constructor(t,e){const n=(e=this.options=function(t,e){for(const n in e)t[n]=e[n];return t}(Object.create(tt),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");let i=function(t,e){const n=[];if("FeatureCollection"===t.type)for(let i=0;i<t.features.length;i++)z(n,t.features[i],e,i);else z(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=function(t,e){const n=e.buffer/e.extent;let i=t;const r=B(t,1,-1-n,n,0,-1,2,e),a=B(t,1,1-n,2+n,0,-1,2,e);return(r||a)&&(i=B(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=H(r,1).concat(i)),a&&(i=i.concat(H(a,-1)))),i}(i,e),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(t,e,n,i,r,a,s){const o=[t,e,n,i],l=this.options,c=l.debug;for(;o.length;){i=o.pop(),n=o.pop(),e=o.pop(),t=o.pop();const u=1<<e,h=nt(e,n,i);let d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=J(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));const t="z".concat(e);this.stats[t]=(this.stats[t]||0)+1,this.total++}if(d.source=t,null==r){if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue}else{if(e===l.maxZoom||e===r)continue;if(null!=r){const t=r-e;if(n!==a>>t||i!==s>>t)continue}}if(d.source=null,0===t.length)continue;c>1&&console.time("clipping");const f=.5*l.buffer/l.extent,p=.5-f,m=.5+f,g=1+f;let _=null,y=null,v=null,b=null,x=B(t,u,n-f,n+m,0,d.minX,d.maxX,l),w=B(t,u,n+p,n+g,0,d.minX,d.maxX,l);t=null,x&&(_=B(x,u,i-f,i+m,1,d.minY,d.maxY,l),y=B(x,u,i+p,i+g,1,d.minY,d.maxY,l),x=null),w&&(v=B(w,u,i-f,i+m,1,d.minY,d.maxY,l),b=B(w,u,i+p,i+g,1,d.minY,d.maxY,l),w=null),c>1&&console.timeEnd("clipping"),o.push(_||[],e+1,2*n,2*i),o.push(y||[],e+1,2*n,2*i+1),o.push(v||[],e+1,2*n+1,2*i),o.push(b||[],e+1,2*n+1,2*i+1)}}getTile(t,e,n){t=+t,e=+e,n=+n;const i=this.options,{extent:r,debug:a}=i;if(t<0||t>24)return null;const s=1<<t,o=nt(t,e=e+s&s-1,n);if(this.tiles[o])return Y(this.tiles[o],r);a>1&&console.log("drilling down to z%d-%d-%d",t,e,n);let l,c=t,u=e,h=n;for(;!l&&c>0;)c--,u>>=1,h>>=1,l=this.tiles[nt(c,u,h)];return l&&l.source?(a>1&&(console.log("found parent tile z%d-%d-%d",c,u,h),console.time("drilling down")),this.splitTile(l.source,c,u,h,t,e,n),a>1&&console.timeEnd("drilling down"),this.tiles[o]?Y(this.tiles[o],r):null):null}}function nt(t,e,n){return 32*((1<<t)*n+e)+t}class it extends a{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(e,n){return t._(this,void 0,void 0,function*(){const n=e.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return null;const r=new d(i.features,{version:2,extent:t.$});let a=function(e){const n=new t.cM;return function(t,e){for(const n in t.layers)e.writeMessage(3,f,t.layers[n])}(e,n),n.finish()}(r);return 0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),{vectorTile:r,rawData:a.buffer}})}loadData(e){return t._(this,void 0,void 0,function*(){var n;null===(n=this._pendingRequest)||void 0===n||n.abort();const i=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.cN(e.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(e,this._pendingRequest);const n=yield this._pendingData;this._geoJSONIndex=e.cluster?new S(function(e){let{superclusterOptions:n,clusterProperties:i}=e;if(!i||!n)return n;const r={},a={},s={accumulated:null,zoom:0},o={properties:null},l=Object.keys(i);for(const c of l){const[e,n]=i[c],s=t.cT(n),o=t.cT("string"==typeof e?[e,["accumulated"],["get",c]]:e);r[c]=s.value,a[c]=o.value}return n.map=t=>{o.properties=t;const e={};for(const n of l)e[n]=r[n].evaluate(s,o);return e},n.reduce=(t,e)=>{o.properties=e;for(const n of l)s.accumulated=t[n],t[n]=a[n].evaluate(s,o)},n}(e)).load(n.features):function(t,e){return new et(t,e)}(n,e.geojsonVtOptions),this.loaded={};const r={data:n};if(i){const t=i.finish();t&&(r.resourceTiming={},r.resourceTiming[e.source]=JSON.parse(JSON.stringify(t)))}return r}catch(e){if(delete this._pendingRequest,t.cy(e))return{abandoned:!0};throw e}})}getData(){return t._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(t){const e=this.loaded;return e&&e[t.uid]?super.reloadTile(t):this.loadTile(t)}loadAndProcessGeoJSON(e,n){return t._(this,void 0,void 0,function*(){let i=yield this.loadGeoJSON(e,n);if(delete this._pendingRequest,"object"!=typeof i)throw new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object."));if(u(i,!0),e.filter){const n=t.cT(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map(t=>"".concat(t.key,": ").concat(t.message)).join(", "));const r=i.features.filter(t=>n.value.evaluate({zoom:0},t));i={type:"FeatureCollection",features:r}}return i})}loadGeoJSON(e,n){return t._(this,void 0,void 0,function*(){const{promoteId:i}=e;if(e.request){const r=yield t.j(e.request,n);return this._dataUpdateable=t.cV(r.data,i)?t.cU(r.data,i):void 0,r.data}if("string"==typeof e.data)try{const n=JSON.parse(e.data);return this._dataUpdateable=t.cV(n,i)?t.cU(n,i):void 0,n}catch(t){throw new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object."))}if(!e.dataDiff)throw new Error("Input data given to '".concat(e.source,"' is not a valid GeoJSON object."));if(!this._dataUpdateable)throw new Error("Cannot update existing geojson data in ".concat(e.source));return t.cW(this._dataUpdateable,e.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(e){return t._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(t){return this._geoJSONIndex.getClusterExpansionZoom(t.clusterId)}getClusterChildren(t){return this._geoJSONIndex.getChildren(t.clusterId)}getClusterLeaves(t){return this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset)}}class rt{constructor(e){this.self=e,this.actor=new t.J(e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(t,e)=>{if(this.externalWorkerSourceTypes[t])throw new Error('Worker source with name "'.concat(t,'" already registered.'));this.externalWorkerSourceTypes[t]=e},this.self.addProtocol=t.cA,this.self.removeProtocol=t.cB,this.self.registerRTLTextPlugin=e=>{t.cX.setMethods(e)},this.actor.registerMessageHandler("LDT",(t,e)=>this._getDEMWorkerSource(t,e.source).loadTile(e)),this.actor.registerMessageHandler("RDT",(e,n)=>t._(this,void 0,void 0,function*(){this._getDEMWorkerSource(e,n.source).removeTile(n)})),this.actor.registerMessageHandler("GCEZ",(e,n)=>t._(this,void 0,void 0,function*(){return this._getWorkerSource(e,n.type,n.source).getClusterExpansionZoom(n)})),this.actor.registerMessageHandler("GCC",(e,n)=>t._(this,void 0,void 0,function*(){return this._getWorkerSource(e,n.type,n.source).getClusterChildren(n)})),this.actor.registerMessageHandler("GCL",(e,n)=>t._(this,void 0,void 0,function*(){return this._getWorkerSource(e,n.type,n.source).getClusterLeaves(n)})),this.actor.registerMessageHandler("LD",(t,e)=>this._getWorkerSource(t,e.type,e.source).loadData(e)),this.actor.registerMessageHandler("GD",(t,e)=>this._getWorkerSource(t,e.type,e.source).getData()),this.actor.registerMessageHandler("LT",(t,e)=>this._getWorkerSource(t,e.type,e.source).loadTile(e)),this.actor.registerMessageHandler("RT",(t,e)=>this._getWorkerSource(t,e.type,e.source).reloadTile(e)),this.actor.registerMessageHandler("AT",(t,e)=>this._getWorkerSource(t,e.type,e.source).abortTile(e)),this.actor.registerMessageHandler("RMT",(t,e)=>this._getWorkerSource(t,e.type,e.source).removeTile(e)),this.actor.registerMessageHandler("RS",(e,n)=>t._(this,void 0,void 0,function*(){if(!this.workerSources[e]||!this.workerSources[e][n.type]||!this.workerSources[e][n.type][n.source])return;const t=this.workerSources[e][n.type][n.source];delete this.workerSources[e][n.type][n.source],void 0!==t.removeSource&&t.removeSource(n)})),this.actor.registerMessageHandler("RM",e=>t._(this,void 0,void 0,function*(){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],this.globalStates.delete(e)})),this.actor.registerMessageHandler("SR",(e,n)=>t._(this,void 0,void 0,function*(){this.referrer=n})),this.actor.registerMessageHandler("SRPS",(t,e)=>this._syncRTLPluginState(t,e)),this.actor.registerMessageHandler("IS",(e,n)=>t._(this,void 0,void 0,function*(){this.self.importScripts(n)})),this.actor.registerMessageHandler("SI",(t,e)=>this._setImages(t,e)),this.actor.registerMessageHandler("UL",(e,n)=>t._(this,void 0,void 0,function*(){this._getLayerIndex(e).update(n.layers,n.removedIds,this._getGlobalState(e))})),this.actor.registerMessageHandler("UGS",(e,n)=>t._(this,void 0,void 0,function*(){const t=this._getGlobalState(e);for(const e in n)t[e]=n[e]})),this.actor.registerMessageHandler("SL",(e,n)=>t._(this,void 0,void 0,function*(){this._getLayerIndex(e).replace(n,this._getGlobalState(e))}))}_getGlobalState(t){let e=this.globalStates.get(t);return e||(e={},this.globalStates.set(t,e)),e}_setImages(e,n){return t._(this,void 0,void 0,function*(){this.availableImages[e]=n;for(const t in this.workerSources[e]){const i=this.workerSources[e][t];for(const t in i)i[t].availableImages=n}})}_syncRTLPluginState(e,n){return t._(this,void 0,void 0,function*(){return yield t.cX.syncState(n,this.self.importScripts)})}_getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}_getLayerIndex(t){let n=this.layerIndexes[t];return n||(n=this.layerIndexes[t]=new e),n}_getWorkerSource(t,e,n){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){const i={sendAsync:(e,n)=>(e.targetMapId=t,this.actor.sendAsync(e,n))};switch(e){case"vector":this.workerSources[t][e][n]=new a(i,this._getLayerIndex(t),this._getAvailableImages(t));break;case"geojson":this.workerSources[t][e][n]=new it(i,this._getLayerIndex(t),this._getAvailableImages(t));break;default:this.workerSources[t][e][n]=new this.externalWorkerSourceTypes[e](i,this._getLayerIndex(t),this._getAvailableImages(t))}}return this.workerSources[t][e][n]}_getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new s),this.demWorkerSources[t][e]}}return t.i(self)&&(self.worker=new rt(self)),rt}),n("index",["exports","./shared"],function(t,e){var n="5.7.3";function i(){var t=new e.A(4);return e.A!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}let r,a;const s={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(t,n,i){const r=requestAnimationFrame(t=>{a(),n(t)}),{unsubscribe:a}=e.s(t.signal,"abort",()=>{a(),cancelAnimationFrame(r),i(e.c())},!1)},frameAsync(t){return new Promise((e,n)=>{this.frame(t,e,n)})},getImageData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0,t.width,t.height),n},resolveURL:t=>(r||(r=document.createElement("a")),r.href=t,r.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==a&&(a=matchMedia("(prefers-reduced-motion: reduce)")),a.matches)}};class o{static testProp(t){if(!o.docStyle)return t[0];for(let e=0;e<t.length;e++)if(t[e]in o.docStyle)return t[e];return t[0]}static create(t,e,n){const i=window.document.createElement(t);return void 0!==e&&(i.className=e),n&&n.appendChild(i),i}static createNS(t,e){return window.document.createElementNS(t,e)}static disableDrag(){o.docStyle&&o.selectProp&&(o.userSelect=o.docStyle[o.selectProp],o.docStyle[o.selectProp]="none")}static enableDrag(){o.docStyle&&o.selectProp&&(o.docStyle[o.selectProp]=o.userSelect)}static setTransform(t,e){t.style[o.transformProp]=e}static addEventListener(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.addEventListener(e,n,"passive"in i?i:i.capture)}static removeEventListener(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.removeEventListener(e,n,"passive"in i?i:i.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",o.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",o.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",o.suppressClickInternal,!0)},0)}static getScale(t){const e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}static getPoint(t,n,i){const r=n.boundingClientRect;return new e.P((i.clientX-r.left)/n.x-t.clientLeft,(i.clientY-r.top)/n.y-t.clientTop)}static mousePos(t,e){const n=o.getScale(t);return o.getPoint(t,n,e)}static touchPos(t,e){const n=[],i=o.getScale(t);for(let r=0;r<e.length;r++)n.push(o.getPoint(t,i,e[r]));return n}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const e=(new DOMParser).parseFromString(t,"text/html").body||document.createElement("body"),n=e.querySelectorAll("script");for(const i of n)i.remove();return o.clean(e),e.innerHTML}static isPossiblyDangerous(t,e){const n=e.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!n.includes("javascript:")&&!n.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const e=t.children;for(const n of e)o.removeAttributes(n),o.clean(n)}static removeAttributes(t){for(const{name:e,value:n}of t.attributes)o.isPossiblyDangerous(e,n)&&t.removeAttribute(e)}}o.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,o.selectProp=o.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o.transformProp=o.testProp(["transform","WebkitTransform"]);const l={supported:!1,testSupport:function(t){!h&&u&&(d?f(t):c=t)}};let c,u,h=!1,d=!1;function f(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,u),t.isContextLost())return;l.supported=!0}catch(t){}t.deleteTexture(e),h=!0}var p;"undefined"!=typeof document&&(u=document.createElement("img"),u.onload=()=>{c&&f(c),c=null,d=!0},u.onerror=()=>{h=!0,c=null},u.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(t){let n,i,r,a;t.resetRequestQueue=()=>{n=[],i=0,r=0,a={}},t.addThrottleControl=t=>{const e=r++;return a[e]=t,e},t.removeThrottleControl=t=>{delete a[t],o()},t.getImage=function(t,i){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise((a,s)=>{l.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),e.e(t,{type:"image"}),n.push({abortController:i,requestParameters:t,supportImageRefresh:r,state:"queued",onError:t=>{s(t)},onSuccess:t=>{a(t)}}),o()})};const s=t=>e._(this,void 0,void 0,function*(){t.state="running";const{requestParameters:n,supportImageRefresh:r,onError:a,onSuccess:s,abortController:l}=t,u=!1===r&&!e.i(self)&&!e.g(n.url)&&(!n.headers||Object.keys(n.headers).reduce((t,e)=>t&&"accept"===e,!0));i++;const h=u?c(n,l):e.m(n,l);try{const n=yield h;delete t.abortController,t.state="completed",n.data instanceof HTMLImageElement||e.b(n.data)?s(n):n.data&&s({data:yield(d=n.data,"function"==typeof createImageBitmap?e.f(d):e.h(d)),cacheControl:n.cacheControl,expires:n.expires})}catch(e){delete t.abortController,a(e)}finally{i--,o()}var d}),o=()=>{const t=(()=>{for(const t of Object.keys(a))if(a[t]())return!0;return!1})()?e.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:e.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let e=i;e<t&&n.length>0;e++){const t=n.shift();t.abortController.signal.aborted?e--:s(t)}},c=(t,n)=>new Promise((i,r)=>{const a=new Image,s=t.url,o=t.credentials;o&&"include"===o?a.crossOrigin="use-credentials":(o&&"same-origin"===o||!e.d(s))&&(a.crossOrigin="anonymous"),n.signal.addEventListener("abort",()=>{a.src="",r(e.c())}),a.fetchPriority="high",a.onload=()=>{a.onerror=a.onload=null,i({data:a})},a.onerror=()=>{a.onerror=a.onload=null,n.signal.aborted||r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},a.src=s})}(p||(p={})),p.resetRequestQueue();class m{constructor(t){this._transformRequestFn=null!=t?t:null}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function g(t){const e=[];if("string"==typeof t)e.push({id:"default",url:t});else if(t&&t.length>0){const n=[];for(const{id:i,url:r}of t){const t="".concat(i).concat(r);-1===n.indexOf(t)&&(n.push(t),e.push({id:i,url:r}))}}return e}function _(t,e,n){try{const i=new URL(t);return i.pathname+="".concat(e).concat(n),i.toString()}catch(e){throw new Error('Invalid sprite URL "'.concat(t,'", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically'))}}function y(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class v extends e.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,promiseResolve:e}of this.requestors)e(this._getImagesForIds(t));this.requestors=[]}}getImage(t){const n=this.images[t];if(n&&!n.data&&n.spriteData){const t=n.spriteData;n.data=new e.R({width:t.width,height:t.height},t.context.getImageData(t.x,t.y,t.width,t.height).data),n.spriteData=null}return n}addImage(t,e){if(this.images[t])throw new Error("Image id ".concat(t," already exist, use updateImage instead"));this._validate(t,e)&&(this.images[t]=e)}_validate(t,n){let i=!0;const r=n.data||n.spriteData;return this._validateStretch(n.stretchX,r&&r.width)||(this.fire(new e.k(new Error('Image "'.concat(t,'" has invalid "stretchX" value')))),i=!1),this._validateStretch(n.stretchY,r&&r.height)||(this.fire(new e.k(new Error('Image "'.concat(t,'" has invalid "stretchY" value')))),i=!1),this._validateContent(n.content,n)||(this.fire(new e.k(new Error('Image "'.concat(t,'" has invalid "content" value')))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let n=0;for(const i of t){if(i[0]<n||i[1]<i[0]||e<i[1])return!1;n=i[1]}return!0}_validateContent(t,e){if(!t)return!0;if(4!==t.length)return!1;const n=e.spriteData,i=n&&n.width||e.data.width,r=n&&n.height||e.data.height;return!(t[0]<0||i<t[0]||t[1]<0||r<t[1]||t[2]<0||i<t[2]||t[3]<0||r<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.getImage(t);if(n&&(i.data.width!==e.data.width||i.data.height!==e.data.height))throw new Error("size mismatch between old image (".concat(i.data.width,"x").concat(i.data.height,") and new image (").concat(e.data.width,"x").concat(e.data.height,")."));e.version=i.version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((e,n)=>{let i=!0;if(!this.isLoaded())for(const r of t)this.images[r]||(i=!1);this.isLoaded()||i?e(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:e})})}_getImagesForIds(t){const n={};for(const i of t){let t=this.getImage(i);t||(this.fire(new e.l("styleimagemissing",{id:i})),t=this.getImage(i)),t?n[i]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,textFitWidth:t.textFitWidth,textFitHeight:t.textFitHeight,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.w('Image "'.concat(i,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}return n}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(t){const n=this.patterns[t],i=this.getImage(t);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{const n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new e.I(n,i);this.patterns[t]={bin:n,position:r}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const n=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.T(t,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:n,h:i}=e.p(t),r=this.atlasImage;r.resize({width:n||1,height:i||1});for(const a in this.patterns){const{bin:t}=this.patterns[a],n=t.x+1,i=t.y+1,s=this.getImage(a).data,o=s.width,l=s.height;e.R.copy(s,r,{x:0,y:0},{x:n,y:i},{width:o,height:l}),e.R.copy(s,r,{x:0,y:l-1},{x:n,y:i-1},{width:o,height:1}),e.R.copy(s,r,{x:0,y:0},{x:n,y:i+l},{width:o,height:1}),e.R.copy(s,r,{x:o-1,y:0},{x:n-1,y:i},{width:1,height:l}),e.R.copy(s,r,{x:0,y:0},{x:n+o,y:i},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const n of t){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const t=this.getImage(n);t||e.w('Image with ID: "'.concat(n,'" was not found')),y(t)&&this.updateImage(n,t)}}}const b=1e20;function x(t,e,n,i,r,a,s,o,l){for(let c=e;c<e+i;c++)w(t,n*a+c,a,r,s,o,l);for(let c=n;c<n+r;c++)w(t,c*a+e,1,i,s,o,l)}function w(t,e,n,i,r,a,s){a[0]=0,s[0]=-b,s[1]=b,r[0]=t[e];for(let o=1,l=0,c=0;o<i;o++){r[o]=t[e+o*n];const i=o*o;do{const t=a[l];c=(r[o]-r[t]+i-t*t)/(o-t)/2}while(c<=s[l]&&--l>-1);l++,a[l]=o,s[l]=c,s[l+1]=b}for(let o=0,l=0;o<i;o++){for(;s[l+1]<o;)l++;const i=a[l],c=o-i;t[e+o*n]=r[i]+c*c}}class S{constructor(t,e,n){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={},this.lang=n}setURL(t){this.url=t}getGlyphs(t){return e._(this,void 0,void 0,function*(){const e=[];for(const r in t)for(const n of t[r])e.push(this._getAndCacheGlyphsPromise(r,n));const n=yield Promise.all(e),i={};for(const{stack:t,id:r,glyph:a}of n)i[t]||(i[t]={}),i[t][r]=a&&{id:a.id,bitmap:a.bitmap.clone(),metrics:a.metrics};return i})}_getAndCacheGlyphsPromise(t,n){return e._(this,void 0,void 0,function*(){let e=this.entries[t];e||(e=this.entries[t]={glyphs:{},requests:{},ranges:{}});let i=e.glyphs[n];if(void 0!==i)return{stack:t,id:n,glyph:i};if(i=this._tinySDF(e,t,n),i)return e.glyphs[n]=i,{stack:t,id:n,glyph:i};const r=Math.floor(n/256);if(256*r>65535)throw new Error("glyphs > 65535 not supported");if(e.ranges[r])return{stack:t,id:n,glyph:i};if(!this.url)throw new Error("glyphsUrl is not set");if(!e.requests[r]){const n=S.loadGlyphRange(t,r,this.url,this.requestManager);e.requests[r]=n}const a=yield e.requests[r];for(const t in a)this._doesCharSupportLocalGlyph(+t)||(e.glyphs[+t]=a[+t]);return e.ranges[r]=!0,{stack:t,id:n,glyph:a[n]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(/(?:[\u3006\u3007\u3021-\u3029\u3038-\u303A\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFA6D\uFA70-\uFAD9]|\uD81B[\uDFE4\uDFF2-\uDFF6]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82C[\uDD70-\uDEFB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])|[\u1100-\u11FF\u302E\u302F\u3131-\u318E\u3200-\u321E\u3260-\u327E\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|(?:[\u3041-\u3096\u309D-\u309F]|\uD82C[\uDC01-\uDD1F\uDD32\uDD50-\uDD52]|\uD83C\uDE00)|(?:[\u30A1-\u30FA\u30FD-\u30FF\u31F0-\u31FF\u32D0-\u32FE\u3300-\u3357\uFF66-\uFF6F\uFF71-\uFF9D]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00\uDD20-\uDD22\uDD55\uDD64-\uDD67])/.test(String.fromCodePoint(t))||e.u["CJK Unified Ideographs"](t)||e.u["Hangul Syllables"](t)||e.u.Hiragana(t)||e.u.Katakana(t)||e.u["CJK Symbols and Punctuation"](t)||e.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,n,i){const r=this.localIdeographFontFamily;if(!r)return;if(!this._doesCharSupportLocalGlyph(i))return;let a=t.tinySDF;if(!a){let e="400";/bold/i.test(n)?e="900":/medium/i.test(n)?e="500":/light/i.test(n)&&(e="200"),a=t.tinySDF=new S.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:r,fontWeight:e})}const s=a.draw(String.fromCharCode(i));return{id:i,bitmap:new e.q({width:s.width||60,height:s.height||60},s.data),metrics:{width:s.glyphWidth/2||24,height:s.glyphHeight/2||24,left:s.glyphLeft/2+.5||0,top:s.glyphTop/2-27.5||-8,advance:s.glyphAdvance/2||24,isDoubleResolution:!0}}}}S.loadGlyphRange=function(t,n,i,r){return e._(this,void 0,void 0,function*(){const a=256*n,s=a+255,o=r.transformRequest(i.replace("{fontstack}",t).replace("{range}","".concat(a,"-").concat(s)),"Glyphs"),l=yield e.n(o,new AbortController);if(!l||!l.data)throw new Error("Could not load glyph range. range: ".concat(n,", ").concat(a,"-").concat(s));const c={};for(const t of e.o(l.data))c[t.id]=t;return c})},S.TinySDF=class{constructor(){let{fontSize:t=24,buffer:e=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:a="normal",fontStyle:s="normal",lang:o=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=e,this.cutoff=i,this.radius=n,this.lang=o;const l=this.size=t+4*e,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font="".concat(s," ").concat(a," ").concat(t,"px ").concat(r),u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:a}=this.ctx.measureText(t),s=Math.ceil(n),o=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-r))),l=Math.min(this.size-this.buffer,s+Math.ceil(i)),c=o+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),f={data:d,width:c,height:u,glyphWidth:o,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===o||0===l)return f;const{ctx:p,buffer:m,gridInner:g,gridOuter:_}=this;this.lang&&(p.lang=this.lang),p.clearRect(m,m,o,l),p.fillText(t,m,m+s);const y=p.getImageData(m,m,o,l);_.fill(b,0,h),g.fill(0,0,h);for(let v=0;v<l;v++)for(let t=0;t<o;t++){const e=y.data[4*(v*o+t)+3]/255;if(0===e)continue;const n=(v+m)*c+t+m;if(1===e)_[n]=0,g[n]=b;else{const t=.5-e;_[n]=t>0?t*t:0,g[n]=t<0?t*t:0}}x(_,0,0,c,u,c,this.f,this.v,this.z),x(g,m,m,o,l,c,this.f,this.v,this.z);for(let v=0;v<h;v++){const t=Math.sqrt(_[v])-Math.sqrt(g[v]);d[v]=Math.round(255-255*(t/this.radius+this.cutoff))}return f}};class P{constructor(){this.specification=e.v.light.position}possiblyEvaluate(t,n){return e.B(t.expression.evaluate(n))}interpolate(t,n,i){return{x:e.C.number(t.x,n.x,i),y:e.C.number(t.y,n.y,i),z:e.C.number(t.z,n.z,i)}}}let M;class A extends e.E{constructor(t){super(),M=M||new e.r({anchor:new e.D(e.v.light.anchor),position:new P,color:new e.D(e.v.light.color),intensity:new e.D(e.v.light.intensity)}),this._transitionable=new e.t(M,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.x,t,n))for(const e in t){const n=t[e];e.endsWith("-transition")?this._transitionable.setTransition(e.slice(0,-11),n):this._transitionable.setValue(e,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,i){return(!i||!1!==i.validate)&&e.y(this,t.call(e.z,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.v}))}}const k=new e.r({"sky-color":new e.D(e.v.sky["sky-color"]),"horizon-color":new e.D(e.v.sky["horizon-color"]),"fog-color":new e.D(e.v.sky["fog-color"]),"fog-ground-blend":new e.D(e.v.sky["fog-ground-blend"]),"horizon-fog-blend":new e.D(e.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new e.D(e.v.sky["sky-horizon-blend"]),"atmosphere-blend":new e.D(e.v.sky["atmosphere-blend"])});class E extends e.E{constructor(t){super(),this._transitionable=new e.t(k,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new e.F(0))}setSky(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.G,t,n)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const e in t){const n=t[e];e.endsWith("-transition")?this._transitionable.setTransition(e.slice(0,-11),n):this._transitionable.setValue(e,n)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return!1!==(null==i?void 0:i.validate)&&e.y(this,t.call(e.z,e.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class T{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]}getDashRanges(t,e,n){const i=[];let r=t.length%2==1?-t[t.length-1]*n:0,a=t[0]*n,s=!0;i.push({left:r,right:a,isDash:s,zeroLength:0===t[0]});let o=t[0];for(let l=1;l<t.length;l++){s=!s;const e=t[l];r=o*n,o+=e,a=o*n,i.push({left:r,right:a,isDash:s,zeroLength:0===e})}return i}addRoundDash(t,e,n){const i=e/2;for(let r=-n;r<=n;r++){const e=this.width*(this.nextRow+n+r);let a=0,s=t[a];for(let o=0;o<this.width;o++){o/s.right>1&&(s=t[++a]);const l=Math.abs(o-s.left),c=Math.abs(o-s.right),u=Math.min(l,c);let h;const d=r/n*(i+1);if(s.isDash){const t=i-Math.abs(d);h=Math.sqrt(u*u+t*t)}else h=i-Math.sqrt(u*u+d*d);this.data[e+o]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t){for(let s=t.length-1;s>=0;--s){const e=t[s],n=t[s+1];e.zeroLength?t.splice(s,1):n&&n.isDash===e.isDash&&(n.left=e.left,t.splice(s,1))}const e=t[0],n=t[t.length-1];e.isDash===n.isDash&&(e.left=n.left-this.width,n.right=e.right+this.width);const i=this.width*this.nextRow;let r=0,a=t[r];for(let s=0;s<this.width;s++){s/a.right>1&&(a=t[++r]);const e=Math.abs(s-a.left),n=Math.abs(s-a.right),o=Math.min(e,n);this.data[i+s]=Math.max(0,Math.min(255,(a.isDash?o:-o)+128))}}addDash(t,n){const i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return e.w("LineAtlas out of space"),null;let a=0;for(let e=0;e<t.length;e++)a+=t[e];if(0!==a){const e=this.width/a,r=this.getDashRanges(t,this.width,e);n?this.addRoundDash(r,e,i):this.addRegularDash(r)}const s={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:a};return this.nextRow+=r,this.dirty=!0,s}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}const C="maplibre_preloaded_worker_pool";class I{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<I.workerCount;)this.workers.push(new Worker(e.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[C]}numActive(){return Object.keys(this.active).length}}const L=Math.floor(s.hardwareConcurrency/2);let z,N;function D(){return z||(z=new I),z}I.workerCount=e.H(globalThis)?Math.max(Math.min(L,3),1):1;class R{constructor(t,n){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=n;const i=this.workerPool.acquire(n);for(let r=0;r<i.length;r++){const t=new e.J(i[r],n);t.name="Worker ".concat(r),this.actors.push(t)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,e){const n=[];for(const i of this.actors)n.push(i.sendAsync({type:t,data:e}));return Promise.all(n)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.actors.forEach(t=>{t.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,e){for(const n of this.actors)n.registerMessageHandler(t,e)}}function F(){return N||(N=new R(D(),e.K),N.registerMessageHandler("GR",(t,n,i)=>e.m(n,i))),N}function O(t,n){const i=e.L();return e.M(i,i,[1,1,0]),e.N(i,i,[.5*t.width,.5*t.height,1]),t.calculatePosMatrix?e.O(i,i,t.calculatePosMatrix(n.toUnwrapped())):i}function B(t,e,n,i,r,a,s){var o;const l=function(t,e,n){if(t)for(const i of t){const t=e[i];if(t&&t.source===n&&"fill-extrusion"===t.type)return!0}else for(const i in e){const t=e[i];if(t.source===n&&"fill-extrusion"===t.type)return!0}return!1}(null!==(o=null==r?void 0:r.layers)&&void 0!==o?o:null,e,t.id),c=a.maxPitchScaleFactor(),u=t.tilesIn(i,c,l);u.sort(j);const h=[];for(const d of u)h.push({wrappedTileID:d.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(e,n,t._state,d.queryGeometry,d.cameraQueryGeometry,d.scale,r,a,c,O(t.transform,d.tileID),s?(t,e)=>s(d.tileID,t,e):void 0)});return function(t,e){for(const n in t)for(const i of t[n])U(i,e);return t}(function(t){const e={},n={};for(const i of t){const t=i.queryResults,r=i.wrappedTileID,a=n[r]=n[r]||{};for(const n in t){const i=t[n],r=a[n]=a[n]||{},s=e[n]=e[n]||[];for(const t of i)r[t.featureIndex]||(r[t.featureIndex]=!0,s.push(t))}}return e}(h),t)}function j(t,e){const n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function U(t,e){const n=t.feature,i=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i}function G(t,n,i){return e._(this,void 0,void 0,function*(){let r=t;if(t.url?r=(yield e.j(n.transformRequest(t.url,"Source"),i)).data:yield s.frameAsync(i),!r)return null;const a=e.Q(e.e(r,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(a.vectorLayerIds=r.vector_layers.map(t=>t.id)),a})}class q{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):Array.isArray(t)&&(4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof e.S?new e.S(t.lng,t.lat):e.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof e.S?new e.S(t.lng,t.lat):e.S.convert(t),this}extend(t){const n=this._sw,i=this._ne;let r,a;if(t instanceof e.S)r=t,a=t;else{if(!(t instanceof q))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(q.convert(t)):this.extend(e.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(e.S.convert(t)):this;if(r=t._sw,a=t._ne,!r||!a)return this}return n||i?(n.lng=Math.min(r.lng,n.lng),n.lat=Math.min(r.lat,n.lat),i.lng=Math.max(a.lng,i.lng),i.lat=Math.max(a.lat,i.lat)):(this._sw=new e.S(r.lng,r.lat),this._ne=new e.S(a.lng,a.lat)),this}getCenter(){return new e.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new e.S(this.getWest(),this.getNorth())}getSouthEast(){return new e.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:n,lat:i}=e.S.convert(t);let r=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r}static convert(t){return t instanceof q?t:t?new q(t):t}static fromLngLat(t){const n=360*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/40075017,i=n/Math.cos(Math.PI/180*t.lat);return new q(new e.S(t.lng-i,t.lat-n),new e.S(t.lng+i,t.lat+n))}adjustAntiMeridian(){const t=new e.S(this._sw.lng,this._sw.lat),n=new e.S(this._ne.lng,this._ne.lat);return new q(t,t.lng>n.lng?new e.S(n.lng+360,n.lat):n)}}class V{constructor(t,e,n){this.bounds=q.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=n||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const n=Math.pow(2,t.z),i=Math.floor(e.V(this.bounds.getWest())*n),r=Math.floor(e.U(this.bounds.getNorth())*n),a=Math.ceil(e.V(this.bounds.getEast())*n),s=Math.ceil(e.U(this.bounds.getSouth())*n);return t.x>=i&&t.x<a&&t.y>=r&&t.y<s}}class Z extends e.E{constructor(t,n,i,r){if(super(),this.id=t,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.e(this,e.Q(n,["url","scheme","tileSize","promoteId"])),this._options=e.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}load(){return e._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new e.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield G(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(e.e(this,t),t.bounds&&(this.tileBounds=new V(t.bounds,this.minzoom,this.maxzoom)),this.fire(new e.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,this.fire(new e.k(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return e.e({},this._options)}loadTile(t){return e._(this,void 0,void 0,function*(){const e=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(e,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};n.request.collectResourceTiming=this._collectResourceTiming;let i="RT";if(t.actor&&"expired"!==t.state){if("loading"===t.state)return new Promise((e,n)=>{t.reloadPromise={resolve:e,reject:n}})}else t.actor=this.dispatcher.getActor(),i="LT";t.abortController=new AbortController;try{const e=yield t.actor.sendAsync({type:i,data:n},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,e)}catch(e){if(delete t.abortController,t.aborted)return;if(e&&404!==e.status)throw e;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,e){if(e&&e.resourceTiming&&(t.resourceTiming=e.resourceTiming),e&&this.map._refreshExpiredTiles&&t.setExpiryData(e),t.loadVectorData(e,this.map.painter),t.reloadPromise){const e=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(e.resolve).catch(e.reject)}}abortTile(t){return e._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return e._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class W extends e.E{constructor(t,n,i,r){super(),this.id=t,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.e({type:"raster"},n),e.e(this,e.Q(n,["url","scheme","tileSize"]))}load(){return e._(this,arguments,void 0,function(){var t=this;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function*(){t._loaded=!1,t.fire(new e.l("dataloading",{dataType:"source"})),t._tileJSONRequest=new AbortController;try{const i=yield G(t._options,t.map._requestManager,t._tileJSONRequest);t._tileJSONRequest=null,t._loaded=!0,i&&(e.e(t,i),i.bounds&&(t.tileBounds=new V(i.bounds,t.minzoom,t.maxzoom)),t.fire(new e.l("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:n})))}catch(n){t._tileJSONRequest=null,t._loaded=!0,t.fire(new e.k(n))}}()})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return e.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return e._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const i=yield p.getImage(this.map._requestManager.transformRequest(n,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(i&&i.data){this.map._refreshExpiredTiles&&(i.cacheControl||i.expires)&&t.setExpiryData({cacheControl:i.cacheControl,expires:i.expires});const n=this.map.painter.context,r=n.gl,a=i.data;t.texture=this.map.painter.getTileTexture(a.width),t.texture?t.texture.update(a,{useMipmap:!0}):(t.texture=new e.T(n,a,r.RGBA,{useMipmap:!0}),t.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(e){if(delete t.abortController,t.aborted)t.state="unloaded";else if(e)throw t.state="errored",e}})}abortTile(t){return e._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return e._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class H extends W{constructor(t,n,i,r){super(t,n,i,r),this.type="raster-dem",this.maxzoom=22,this._options=e.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(t){return e._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i=this.map._requestManager.transformRequest(n,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const n=yield p.getImage(i,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(n&&n.data){const i=n.data;this.map._refreshExpiredTiles&&(n.cacheControl||n.expires)&&t.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const r=e.b(i)&&e.W()?i:yield this.readImageNow(i),a={type:this.type,uid:t.uid,source:this.id,rawImageData:r,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||"expired"===t.state){t.actor=this.dispatcher.getActor();const e=yield t.actor.sendAsync({type:"LDT",data:a});t.dem=e,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(e){if(delete t.abortController,t.aborted)t.state="unloaded";else if(e)throw t.state="errored",e}})}readImageNow(t){return e._(this,void 0,void 0,function*(){if("undefined"!=typeof VideoFrame&&e.X()){const n=t.width+2,i=t.height+2;try{return new e.R({width:n,height:i},yield e.Y(t,-1,-1,n,i))}catch(t){}}return s.getImageData(t,1)})}_getNeighboringTiles(t){const n=t.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,a=0===n.x?t.wrap-1:t.wrap,s=(n.x+1+i)%i,o=n.x+1===i?t.wrap+1:t.wrap,l={};return l[new e.Z(t.overscaledZ,a,n.z,r,n.y).key]={backfilled:!1},l[new e.Z(t.overscaledZ,o,n.z,s,n.y).key]={backfilled:!1},n.y>0&&(l[new e.Z(t.overscaledZ,a,n.z,r,n.y-1).key]={backfilled:!1},l[new e.Z(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new e.Z(t.overscaledZ,o,n.z,s,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new e.Z(t.overscaledZ,a,n.z,r,n.y+1).key]={backfilled:!1},l[new e.Z(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new e.Z(t.overscaledZ,o,n.z,s,n.y+1).key]={backfilled:!1}),l}unloadTile(t){return e._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class X extends e.E{constructor(t,n,i,r){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:n.data},this.actor=i.getActor(),this.setEventedParent(r),this._data=n.data,this._options=e.e({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,void 0!==n.clusterMaxZoom&&this.maxzoom<=n.clusterMaxZoom&&e.w('The maxzoom value "'.concat(this.maxzoom,'" is expected to be greater than the clusterMaxZoom value "').concat(n.clusterMaxZoom,'".')),this.workerOptions=e.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(void 0!==n.buffer?n.buffer:128),tolerance:this._pixelsToTileUnits(void 0!==n.tolerance?n.tolerance:.375),extent:e.$,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(n.clusterMaxZoom),minPoints:Math.max(2,n.clusterMinPoints||2),extent:e.$,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(e.$/this.tileSize)}_getClusterMaxZoom(t){const n=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||void 0===t||e.w("Integer expected for option 'clusterMaxZoom': provided value \"".concat(t,'" rounded to "').concat(n,'"')),n}load(){return e._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._pendingWorkerUpdate={data:t},this._updateWorkerData(),this}updateData(t){return this._pendingWorkerUpdate.diff=e.a0(this._pendingWorkerUpdate.diff,t),this._updateWorkerData(),this}getData(){return e._(this,void 0,void 0,function*(){const t=e.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}getCoordinatesFromGeometry(t){return"GeometryCollection"===t.type?t.geometries.map(t=>t.coordinates).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return e._(this,void 0,void 0,function*(){const t=new q,e=yield this.getData();let n;switch(e.type){case"FeatureCollection":n=e.features.map(t=>this.getCoordinatesFromGeometry(t.geometry)).flat(1/0);break;case"Feature":n=this.getCoordinatesFromGeometry(e.geometry);break;default:n=this.getCoordinatesFromGeometry(e)}if(0==n.length)return t;for(let i=0;i<n.length-1;i+=2)t.extend([n[i],n[i+1]]);return t})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(void 0!==t.clusterRadius&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),void 0!==t.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,e,n){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:e,offset:n}})}_updateWorkerData(){return e._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:t,diff:n}=this._pendingWorkerUpdate;if(!t&&!n)return void e.w("No data or diff provided to GeoJSONSource ".concat(this.id,"."));const i=e.e({type:this.type},this.workerOptions);t?("string"==typeof t?(i.request=this.map._requestManager.transformRequest(s.resolveURL(t),"Source"),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(t),this._pendingWorkerUpdate.data=void 0):n&&(i.dataDiff=n,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new e.l("dataloading",{dataType:"source"}));try{const t=yield this.actor.sendAsync({type:"LD",data:i});if(this._isUpdatingWorker=!1,this._removed||t.abandoned)return void this.fire(new e.l("dataabort",{dataType:"source"}));this._data=t.data;let n=null;t.resourceTiming&&t.resourceTiming[this.id]&&(n=t.resourceTiming[this.id].slice(0));const r={dataType:"source"};this._collectResourceTiming&&n&&n.length>0&&e.e(r,{resourceTiming:n}),this.fire(new e.l("data",Object.assign(Object.assign({},r),{sourceDataType:"metadata"}))),this.fire(new e.l("data",Object.assign(Object.assign({},r),{sourceDataType:"content"})))}catch(t){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new e.l("dataabort",{dataType:"source"}));this.fire(new e.k(t))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&void 0===this._pendingWorkerUpdate.data&&void 0===this._pendingWorkerUpdate.diff}loadTile(t){return e._(this,void 0,void 0,function*(){const e=t.actor?"RT":"LT";t.actor=this.actor;const n={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const i=yield this.actor.sendAsync({type:e,data:n},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(i,this.map.painter,"RT"===e)})}abortTile(t){return e._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return e._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return e.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Y extends e.E{constructor(t,e,n,i){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=e}load(t){return e._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new e.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const e=yield p.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,e&&e.data&&(this.image=e.data,t&&(this.coordinates=t),this._finishLoading())}catch(t){this._request=null,this._loaded=!0,this.fire(new e.k(t))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const n=t.map(e.a1.fromLngLat);var i;return this.tileID=function(t){const n=e.a2.fromPoints(t),i=n.width(),r=n.height(),a=Math.max(i,r),s=Math.max(0,Math.floor(-Math.log(a)/Math.LN2)),o=Math.pow(2,s);return new e.a4(s,Math.floor((n.minX+n.maxX)/2*o),Math.floor((n.minY+n.maxY)/2*o))}(n),this.terrainTileRanges=this._getOverlappingTileRanges(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(t=>this.tileID.getTilePoint(t)._round()),this.flippedWindingOrder=((i=this.tileCoords)[1].x-i[0].x)*(i[2].y-i[0].y)-(i[1].y-i[0].y)*(i[2].x-i[0].x)<0,this.fire(new e.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,n=t.gl;this.texture||(this.texture=new e.T(t,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let i=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,i=!0)}i&&this.fire(new e.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return e._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:n,minY:i,maxX:r,maxY:a}=e.a2.fromPoints(t),s={};for(let o=0;o<=e.a3;o++){const t=Math.pow(2,o),e=Math.floor(n*t),l=Math.floor(i*t),c=Math.floor(r*t),u=Math.floor(a*t);s[o]={minTileX:e,minTileY:l,maxTileX:c,maxTileY:u}}return s}}class K extends Y{constructor(t,e,n,i){super(t,e,n,i),this.roundZoom=!0,this.type="video",this.options=e}load(){return e._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,"Source").url);try{const t=yield e.a5(this.urls);if(this._loaded=!0,!t)return;this.video=t,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(t){this.fire(new e.k(t))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new e.k(new e.a6("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(n.start(0)," and ").concat(n.end(0),"-second mark.")))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,n=t.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new e.T(t,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let i=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,i=!0)}i&&this.fire(new e.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class J extends Y{constructor(t,n,i,r){super(t,n,i,r),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(t=>!Array.isArray(t)||2!==t.length||t.some(t=>"number"!=typeof t))||this.fire(new e.k(new e.a6("sources.".concat(t),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.k(new e.a6("sources.".concat(t),null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new e.k(new e.a6("sources.".concat(t),null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new e.k(new e.a6("sources.".concat(t),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.k(new e.a6("sources.".concat(t),null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){return e._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,i=n.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.T(n,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture,r=!0)}r&&this.fire(new e.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const $={},Q=t=>{switch(t){case"geojson":return X;case"image":return Y;case"raster":return W;case"raster-dem":return H;case"vector":return Z;case"video":return K;case"canvas":return J}return $[t]},tt="RTLPluginLoaded";class et extends e.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=F()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(t=>{throw this.status="error",t})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return e._(this,arguments,void 0,function(t){var e=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){if(e.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(e.url=s.resolveURL(t),!e.url)throw new Error("requested url ".concat(t," is invalid"));if("unavailable"===e.status){if(!n)return e._requestImport();e.status="deferred",e._syncState(e.status)}else if("requested"===e.status)return e._requestImport()}()})}_requestImport(){return e._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new e.l(tt))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let nt=null;function it(){return nt||(nt=new et),nt}class rt{constructor(t,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=e.a7(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,n,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const i of t){const t=i.layerIds.map(t=>e.getLayer(t)).filter(Boolean);if(0!==t.length){i.layers=t,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map(e=>t.filter(t=>t.id===e)[0]));for(const e of t)n[e.id]=i}}return n}(t.buckets,null==n?void 0:n.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const n=this.buckets[t];if(n instanceof e.a9){if(this.hasSymbolBuckets=!0,!i)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const n=this.buckets[t];if(n instanceof e.a9&&n.hasRTLText){this.hasRTLText=!0,it().lazyLoad();break}}this.queryPadding=0;for(const t in this.buckets){const e=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(t).queryRadius(e))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new e.a8}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const n=this.buckets[e];n.uploadPending()&&n.upload(t)}const n=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new e.T(t,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new e.T(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,i,r,a,s,o,l,c,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:r,scale:a,tileSize:this.tileSize,pixelPosMatrix:c,transform:o,params:s,queryPadding:this.queryPadding*l,getElevation:u},t,e,n):{}}querySourceFeatures(t,n){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const r=i.loadVTLayers(),a=n&&n.sourceLayer?n.sourceLayer:"",s=r._geojsonTileLayer||r[a];if(!s)return;const o=e.aa(null==n?void 0:n.filter,null==n?void 0:n.globalState),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let d=0;d<s.length;d++){const n=s.feature(d);if(o.needGeometry){const t=e.ab(n,!0);if(!o.filter(new e.F(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!o.filter(new e.F(this.tileID.overscaledZ),n))continue;const r=i.getId(n,a),f=new e.ac(n,l,c,u,r);f.tile=h,t.push(f)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const n=this.expirationTime;if(t.cacheControl){const n=e.ad(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let e=!1;if(this.expirationTime>t)e=!1;else if(n)if(this.expirationTime<n)e=!0;else{const i=this.expirationTime-n;i?this.expirationTime=t+Math.max(i,3e4):e=!0}else e=!0;e?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const i in this.buckets){if(!e.style.hasLayer(i))continue;const r=this.buckets[i],a=r.layers[0].sourceLayer||"_geojsonTileLayer",s=n[a],o=t[a];if(!s||!o||0===Object.keys(o).length)continue;r.update(o,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=s.now()+t}setDependencies(t,e){const n={};for(const i of e)n[i]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}}class at{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const r={value:e,timeout:void 0};if(void 0!==n&&(r.timeout=setTimeout(()=>{this.remove(t,r)},n)),this.data[i].push(r),this.order.push(i),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const i of this.data[n])t(i.value)||e.push(i);for(const n of e)this.remove(n.value.tileID,n)}}class st{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,n,i){const r=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},e.e(this.stateChanges[t][r],i),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==r&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][r]){this.deletedStates[t][r]={};for(const e in this.state[t][r])i[e]||(this.deletedStates[t][r][e]=null)}else for(const e in i)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][e]&&delete this.deletedStates[t][r][e]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(n in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][n]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}getState(t,n){const i=String(n),r=e.e({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const e=this.deletedStates[t][n];if(null===e)return{};for(const t in e)delete r[t]}return r}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,n){const i={};for(const r in this.stateChanges){this.state[r]=this.state[r]||{};const t={};for(const n in this.stateChanges[r])this.state[r][n]||(this.state[r][n]={}),e.e(this.state[r][n],this.stateChanges[r][n]),t[n]=this.state[r][n];i[r]=t}for(const r in this.deletedStates){this.state[r]=this.state[r]||{};const t={};if(null===this.deletedStates[r])for(const e in this.state[r])t[e]={},this.state[r][e]={};else for(const e in this.deletedStates[r]){if(null===this.deletedStates[r][e])this.state[r][e]={};else for(const t of Object.keys(this.deletedStates[r][e]))delete this.state[r][e][t];t[e]=this.state[r][e]}i[r]=i[r]||{},e.e(i[r],t)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const e in t)t[e].setFeatureState(i,n)}}const ot=89.25;function lt(t,n){const i=e.ah(n.lat,-e.ai,e.ai);return new e.P(e.V(n.lng)*t,e.U(i)*t)}function ct(t,n){return new e.a1(n.x/t,n.y/t).toLngLat()}function ut(t){return t.cameraToCenterDistance*Math.min(.85*Math.tan(e.ae(90-t.pitch)),Math.tan(e.ae(ot-t.pitch)))}function ht(t,n){const i=t.canonical,r=n/e.af(i.z),a=i.x+Math.pow(2,i.z)*t.wrap,s=e.ag(new Float64Array(16));return e.M(s,s,[a*r,i.y*r,0]),e.N(s,s,[r/e.$,r/e.$,1]),s}function dt(t,n,i,r,a){const s=e.a1.fromLngLat(t,n),o=a*e.aj(1,t.lat),l=o*Math.cos(e.ae(i)),c=Math.sqrt(o*o-l*l),u=c*Math.sin(e.ae(-r)),h=c*Math.cos(e.ae(-r));return new e.a1(s.x+u,s.y+h,s.z+l)}function ft(t,e,n){const i=e.intersectsFrustum(t);if(!n||0===i)return i;const r=e.intersectsPlane(n);return 0===r?0:2===i&&2===r?2:1}function pt(t,e,n){let i=0;const r=(n-e)/10;for(let a=0;a<10;a++)i+=r*Math.pow(Math.cos(e+(a+.5)/10*(n-e)),t);return i}function mt(t,n){return function(i,r,a,s,o){const l=2*((t-1)/e.ak(Math.cos(e.ae(ot-o))/Math.cos(e.ae(ot)))-1),c=Math.acos(a/s),u=2*pt(l-1,0,e.ae(o/2)),h=Math.min(e.ae(ot),c+e.ae(o/2)),d=pt(l-1,Math.min(h,c-e.ae(o/2)),h),f=Math.atan(r/a),p=Math.hypot(r,a);let m=i;return m+=e.ak(s/p/Math.max(.5,Math.cos(e.ae(o/2)))),m+=l*e.ak(Math.cos(f))/2,m-=e.ak(Math.max(1,d/u/n))/2,m}}const gt=mt(9.314,3);function _t(t,n){const i=(n.roundZoom?Math.round:Math.floor)(t.zoom+e.ak(t.tileSize/n.tileSize));return Math.max(0,i)}function yt(t,n){const i=t.getCameraFrustum(),r=t.getClippingPlane(),a=t.screenPointToMercatorCoordinate(t.getCameraPoint()),s=e.a1.fromLngLat(t.center,t.elevation);a.z=s.z+Math.cos(t.pitchInRadians)*t.cameraToCenterDistance/t.worldSize;const o=t.getCoveringTilesDetailsProvider(),l=o.allowVariableZoom(t,n),c=_t(t,n),u=n.minzoom||0,h=void 0!==n.maxzoom?n.maxzoom:t.maxZoom,d=Math.min(Math.max(0,c),h),f=Math.pow(2,d),p=[f*a.x,f*a.y,0],m=[f*s.x,f*s.y,0],g=Math.hypot(s.x-a.x,s.y-a.y),_=Math.abs(s.z-a.z),y=Math.hypot(g,_),v=t=>({zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),b=[],x=[];if(t.renderWorldCopies&&o.allowWorldCopies())for(let e=1;e<=3;e++)b.push(v(-e)),b.push(v(e));for(b.push(v(0));b.length>0;){const f=b.pop(),g=f.x,v=f.y;let w=f.fullyVisible;const S={x:g,y:v,z:f.zoom},P=o.getTileBoundingVolume(S,f.wrap,t.elevation,n);if(!w){const t=ft(i,P,r);if(0===t)continue;w=2===t}const M=o.distanceToTile2d(a.x,a.y,S,P);let A=c;l&&(A=(n.calculateTileZoom||gt)(t.zoom+e.ak(t.tileSize/n.tileSize),M,_,y,t.fov)),A=(n.roundZoom?Math.round:Math.floor)(A),A=Math.max(0,A);const k=Math.min(A,h);if(f.wrap=o.getWrap(s,S,f.wrap),f.zoom>=k){if(f.zoom<u)continue;const t=d-f.zoom,i=p[0]-.5-(g<<t),r=p[1]-.5-(v<<t),a=n.reparseOverscaled?Math.max(f.zoom,A):f.zoom;x.push({tileID:new e.Z(f.zoom===h?a:f.zoom,f.wrap,f.zoom,g,v),distanceSq:e.al([m[0]-.5-g,m[1]-.5-v]),tileDistanceToCamera:Math.sqrt(i*i+r*r)})}else for(let t=0;t<4;t++)b.push({zoom:f.zoom+1,x:(g<<1)+t%2,y:(v<<1)+(t>>1),wrap:f.wrap,fullyVisible:w})}return x.sort((t,e)=>t.distanceSq-e.distanceSq).map(t=>t.tileID)}const vt=e.a2.fromPoints([new e.P(0,0),new e.P(e.$,e.$)]);class bt extends e.E{constructor(t,e,n){super(),this.id=t,this.dispatcher=n,this.on("data",t=>this._dataHandler(t)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((t,e,n,i)=>{const r=new(Q(e.type))(t,e,n,i);if(r.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(r.id));return r})(t,e,n,this),this._tiles={},this._cache=new at(0,t=>this._unloadTile(t)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new st,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,n,i){return e._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,n,i)}catch(n){t.state="errored",404!==n.status?this._source.fire(new e.k(n,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new e.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(xt).map(t=>t.key)}getRenderableIds(t){const n=[];for(const e in this._tiles)this._isIdRenderable(e,t)&&n.push(this._tiles[e]);return t?n.sort((t,n)=>{const i=t.tileID,r=n.tileID,a=new e.P(i.canonical.x,i.canonical.y)._rotate(-this.transform.bearingInRadians),s=new e.P(r.canonical.x,r.canonical.y)._rotate(-this.transform.bearingInRadians);return i.overscaledZ-r.overscaledZ||s.y-a.y||s.x-a.x}).map(t=>t.tileID.key):n.map(t=>t.tileID).sort(xt).map(t=>t.key)}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)t?this._reloadTile(e,"expired"):"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")}}_reloadTile(t,n){return e._(this,void 0,void 0,function*(){const e=this._tiles[t];e&&("loading"!==e.state&&(e.state=n),yield this._loadTile(e,t,n))})}_tileLoaded(t,n,i){t.timeAdded=s.now(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new e.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const e=this.getRenderableIds();for(let i=0;i<e.length;i++){const r=e[i];if(t.neighboringTiles&&t.neighboringTiles[r]){const e=this.getTileByID(r);n(t,e),n(e,t)}}function n(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),a=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[a]&&(t.neighboringTiles[a].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e){const n=Object.values(t),i=this._getLoadedDescendents(n);for(const r of n){const t=i[r.key];if(!t)continue;const n=r.overscaledZ+bt.maxUnderzooming;let a=1/0;for(const e of t){const t=e.tileID.overscaledZ;t<=n&&t<a&&(a=t)}if(a!==1/0)for(const i of t)i.tileID.overscaledZ===a&&(e[i.tileID.key]=i.tileID)}}_getLoadedDescendents(t){var e;const n={};for(const i in this._tiles){const r=this._tiles[i];if(r.hasData())for(const i of t)r.tileID.isChildOf(i)&&(n[e=i.key]||(n[e]=[])).push(r)}return n}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),i=this._getLoadedTile(e);if(i)return i}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const n=Math.ceil(t.width/this._source.tileSize)+1,i=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(n*i*(null===this._maxTileCacheZoomLevels?e.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(a)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),t[i.tileID.key]=i}this._tiles=t;for(const e in this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(const e in this._tiles)this._setTileReloadTimer(e,this._tiles[e])}}_updateCoveredAndRetainedTiles(t,e,n,i){const r={},a={},o=Object.keys(t),l=s.now();for(const s of o){const n=t[s],i=this._tiles[s];if(!i||0!==i.fadeEndTime&&i.fadeEndTime<=l)continue;const o=this.findLoadedParent(n,e),c=this.findLoadedSibling(n),u=o||c||null;u&&(this._addTile(u.tileID),r[u.tileID.key]=u.tileID),a[s]=n}this._retainLoadedChildren(a,t);for(const s in r)t[s]||(this._coveredTiles[s]=!0,t[s]=r[s]);if(i){const e={},i={};for(const t of n)this._tiles[t.key].hasData()?e[t.key]=t:i[t.key]=t;for(const n in i){const r=i[n].children(this._source.maxzoom);this._tiles[r[0].key]&&this._tiles[r[1].key]&&this._tiles[r[2].key]&&this._tiles[r[3].key]&&(e[r[0].key]=t[r[0].key]=r[0],e[r[1].key]=t[r[1].key]=r[1],e[r[2].key]=t[r[2].key]=r[2],e[r[3].key]=t[r[3].key]=r[3],delete i[n])}for(const n in i){const r=i[n],a=this.findLoadedParent(r,this._source.minzoom),s=this.findLoadedSibling(r),o=a||s||null;if(o){e[o.tileID.key]=t[o.tileID.key]=o.tileID;for(const t in e)e[t].isChildOf(o.tileID)&&delete e[t]}}for(const t in this._tiles)e[t]||(this._coveredTiles[t]=!0)}}update(t,n){if(!this._sourceLoaded||this._paused)return;let i;this.transform=t,this.terrain=n,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(t=>new e.Z(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)):(i=yt(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(i=i.filter(t=>this._source.hasTile(t)))):i=[];const r=_t(t,this._source),a=Math.max(r-bt.maxOverzooming,this._source.minzoom);if(this.usedForTerrain){const t={};for(const e of i)if(e.canonical.z>this._source.minzoom){const n=e.scaledTo(e.canonical.z-1);t[n.key]=n;const i=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)));t[i.key]=i}i=i.concat(Object.values(t))}const s=0===i.length&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new e.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const o=this._updateRetainedTiles(i,r);wt(this._source.type)&&this._updateCoveredAndRetainedTiles(o,a,i,n);for(const e in o)this._tiles[e].clearFadeHold();const l=e.am(this._tiles,o);for(const e of l){const t=this._tiles[e];t.hasSymbolBuckets&&!t.holdingForFade()?t.setHoldDuration(this.map._fadeDuration):t.hasSymbolBuckets&&!t.symbolFadeFinished()||this._removeTile(e)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,e){var n;const i={},r={},a=Math.max(e-bt.maxOverzooming,this._source.minzoom),s={};for(const o of t){const t=this._addTile(o);i[o.key]=o,t.hasData()||e<this._source.maxzoom&&(s[o.key]=o)}this._retainLoadedChildren(s,i);for(const o of t){let t=this._tiles[o.key];if(t.hasData())continue;if(e+1>this._source.maxzoom){const t=o.children(this._source.maxzoom)[0],e=this.getTile(t);if(e&&e.hasData()){i[t.key]=t;continue}}else{const t=o.children(this._source.maxzoom);if(4===t.length&&i[t[0].key]&&i[t[1].key]&&i[t[2].key]&&i[t[3].key])continue;if(1===t.length&&i[t[0].key])continue}let s=t.wasRequested();for(let e=o.overscaledZ-1;e>=a;--e){const a=o.scaledTo(e);if(r[a.key])break;if(r[a.key]=!0,t=this.getTile(a),!t&&s&&(t=this._addTile(a)),t){const e=t.hasData();if((e||!(null===(n=this.map)||void 0===n?void 0:n.cancelPendingTileRequestsWhileZooming)||s)&&(i[a.key]=a),s=t.wasRequested(),e)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,i=this._tiles[t].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);const t=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;i=t}for(const t of e)this._loadedParentTiles[t]=n}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const e=this._tiles[t].tileID,n=this._getLoadedTile(e);this._loadedSiblingTiles[e.key]=n}}_addTile(t){let n=this._tiles[t.key];if(n)return n;n=this._cache.getAndRemove(t),n&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));const i=n;return n||(n=new rt(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(n,t.key,n.state)),n.uses++,this._tiles[t.key]=n,i||this._source.fire(new e.l("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},n))}refreshTiles(t){for(const e in this._tiles)(this._isIdRenderable(e)||"errored"==this._tiles[e].state)&&t.some(t=>t.equals(this._tiles[e].tileID.canonical))&&this._reloadTile(e,"expired")}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}_dataHandler(t){const e=t.sourceDataType;"source"===t.dataType&&"metadata"===e&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===e&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,n,i){const r=[],a=this.transform;if(!a)return r;const s=a.getCoveringTilesDetailsProvider().allowWorldCopies(),o=i?a.getCameraQueryGeometry(t):t,l=t=>a.screenPointToMercatorCoordinate(t,this.terrain),c=this.transformBbox(t,l,!s),u=this.transformBbox(o,l,!s),h=this.getIds(),d=e.a2.fromPoints(u);for(let f=0;f<h.length;f++){const t=this._tiles[h[f]];if(t.holdingForFade())continue;const i=s?[t.tileID]:[t.tileID.unwrapTo(-1),t.tileID.unwrapTo(0)],o=Math.pow(2,a.zoom-t.tileID.overscaledZ),l=n*t.queryPadding*e.$/t.tileSize/o;for(const n of i){const i=d.map(t=>n.getTilePoint(new e.a1(t.x,t.y)));if(i.expandBy(l),i.intersects(vt)){const e=c.map(t=>n.getTilePoint(t)),i=u.map(t=>n.getTilePoint(t));r.push({tile:t,tileID:s?n:n.unwrapTo(0),queryGeometry:e,cameraQueryGeometry:i,scale:o})}}}return r}transformBbox(t,n,i){let r=t.map(n);if(i){const i=e.a2.fromPoints(t);i.shrinkBy(.001*Math.min(i.width(),i.height()));const a=i.map(n);e.a2.fromPoints(r).covers(a)||(r=r.map(t=>t.x>.5?new e.a1(t.x-1,t.y,t.z):t))}return r}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map(t=>this._tiles[t].tileID);return this.transform&&this.transform.populateCache(e),e}hasTransition(){if(this._source.hasTransition())return!0;if(wt(this._source.type)){const t=s.now();for(const e in this._tiles)if(this._tiles[e].fadeEndTime>=t)return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const i=this._tiles[t];i&&i.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter(n=>!n.hasDependency(t,e))}}function xt(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function wt(t){return"raster"===t||"image"===t||"video"===t}bt.maxOverzooming=10,bt.maxUnderzooming=3;class St{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.ah(t,0,1);let n=1,i=this._distances[n];const r=t*this.paddedLength+this.padding;for(;i<r&&n<this._distances.length;)i=this._distances[++n];const a=n-1,s=this._distances[a],o=i-s,l=o>0?(r-s)/o:0;return this.points[a].mult(1-l).add(this.points[n].mult(l))}}function Pt(t,e){let n=!0;return"always"===t||"never"!==t&&"never"!==e||(n=!1),n}class Mt{constructor(t,e,n){const i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}insertCircle(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)}_insertBoxCell(t,e,n,i,r,a){this.boxCells[r].push(a)}_insertCircleCell(t,e,n,i,r,a){this.circleCells[r].push(a)}_query(t,e,n,i,r,a,s){if(n<0||t>this.width||i<0||e>this.height)return[];const o=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return[{key:null,x1:t,y1:e,x2:n,y2:i}];for(let t=0;t<this.boxKeys.length;t++)o.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],i=this.circles[3*t+2];o.push({key:this.circleKeys[t],x1:e-i,y1:n-i,x2:e+i,y2:n+i})}}else this._forEachCell(t,e,n,i,this._queryCell,o,{hitTest:r,overlapMode:a,seenUids:{box:{},circle:{}}},s);return o}query(t,e,n,i){return this._query(t,e,n,i,!1,null)}hitTest(t,e,n,i,r,a){return this._query(t,e,n,i,!0,r,a).length>0}hitTestCircle(t,e,n,i,r){const a=t-n,s=t+n,o=e-n,l=e+n;if(s<0||a>this.width||l<0||o>this.height)return!1;const c=[];return this._forEachCell(a,o,s,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},r),c.length>0}_queryCell(t,e,n,i,r,a,s,o){const{seenUids:l,hitTest:c,overlapMode:u}=s,h=this.boxCells[r];if(null!==h){const r=this.bboxes;for(const s of h)if(!l.box[s]){l.box[s]=!0;const h=4*s,d=this.boxKeys[s];if(t<=r[h+2]&&e<=r[h+3]&&n>=r[h+0]&&i>=r[h+1]&&(!o||o(d))&&(!c||!Pt(u,d.overlapMode))&&(a.push({key:d,x1:r[h],y1:r[h+1],x2:r[h+2],y2:r[h+3]}),c))return!0}}const d=this.circleCells[r];if(null!==d){const r=this.circles;for(const s of d)if(!l.circle[s]){l.circle[s]=!0;const h=3*s,d=this.circleKeys[s];if(this._circleAndRectCollide(r[h],r[h+1],r[h+2],t,e,n,i)&&(!o||o(d))&&(!c||!Pt(u,d.overlapMode))){const t=r[h],e=r[h+1],n=r[h+2];if(a.push({key:d,x1:t-n,y1:e-n,x2:t+n,y2:e+n}),c)return!0}}}return!1}_queryCellCircle(t,e,n,i,r,a,s,o){const{circle:l,seenUids:c,overlapMode:u}=s,h=this.boxCells[r];if(null!==h){const t=this.bboxes;for(const e of h)if(!c.box[e]){c.box[e]=!0;const n=4*e,i=this.boxKeys[e];if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!o||o(i))&&!Pt(u,i.overlapMode))return a.push(!0),!0}}const d=this.circleCells[r];if(null!==d){const t=this.circles;for(const e of d)if(!c.circle[e]){c.circle[e]=!0;const n=3*e,i=this.circleKeys[e];if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!o||o(i))&&!Pt(u,i.overlapMode))return a.push(!0),!0}}}_forEachCell(t,e,n,i,r,a,s,o){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,t,e,n,i,this.xCellCount*l+d,a,s,o))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,i,r,a){const s=i-t,o=r-e,l=n+a;return l*l>s*s+o*o}_circleAndRectCollide(t,e,n,i,r,a,s){const o=(a-i)/2,l=Math.abs(t-(i+o));if(l>o+n)return!1;const c=(s-r)/2,u=Math.abs(e-(r+c));if(u>c+n)return!1;if(l<=o||u<=c)return!0;const h=l-o,d=u-c;return h*h+d*d<=n*n}}function At(t,n,r){const a=e.L();if(!t){const{vecSouth:t,vecEast:e}=Et(n),r=i();r[0]=e[0],r[1]=e[1],r[2]=t[0],r[3]=t[1],s=r,(d=(l=(o=r)[0])*(h=o[3])-(u=o[2])*(c=o[1]))&&(s[0]=h*(d=1/d),s[1]=-c*d,s[2]=-u*d,s[3]=l*d),a[0]=r[0],a[1]=r[1],a[4]=r[2],a[5]=r[3]}var s,o,l,c,u,h,d;return e.N(a,a,[1/r,1/r,1]),a}function kt(t,n,i,r){if(t){const t=e.L();if(!n){const{vecSouth:e,vecEast:n}=Et(i);t[0]=n[0],t[1]=n[1],t[4]=e[0],t[5]=e[1]}return e.N(t,t,[r,r,1]),t}return i.pixelsToClipSpaceMatrix}function Et(t){const n=Math.cos(t.rollInRadians),i=Math.sin(t.rollInRadians),r=Math.cos(t.pitchInRadians),a=Math.cos(t.bearingInRadians),s=Math.sin(t.bearingInRadians),o=e.ar();o[0]=-a*r*i-s*n,o[1]=-s*r*i+a*n;const l=e.as(o);l<1e-9?e.at(o):e.au(o,o,1/l);const c=e.ar();c[0]=a*r*n-s*i,c[1]=s*r*n+a*i;const u=e.as(c);return u<1e-9?e.at(c):e.au(c,c,1/u),{vecEast:c,vecSouth:o}}function Tt(t,n,i,r){let a;r?(a=[t,n,r(t,n),1],e.aw(a,a,i)):(a=[t,n,0,1],Wt(a,a,i));const s=a[3];return{point:new e.P(a[0]/s,a[1]/s),signedDistanceFromCamera:s,isOccluded:!1}}function Ct(t,e){return.5+t/e*.5}function It(t,e){return t.x>=-e[0]&&t.x<=e[0]&&t.y>=-e[1]&&t.y<=e[1]}function Lt(t,n,i,r,a,s,o,l,c,u,h,d,f){const p=i?t.textSizeData:t.iconSizeData,m=e.an(p,n.transform.zoom),g=[256/n.width*2+1,256/n.height*2+1],_=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;_.clear();const y=t.lineVertexArray,v=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,b=n.transform.width/n.transform.height;let x=!1;for(let w=0;w<v.length;w++){const i=v.get(w);if(i.hidden||i.writingMode===e.ao.vertical&&!x){Zt(i.numGlyphs,_);continue}x=!1;const S=new e.P(i.anchorX,i.anchorY),P={getElevation:f,pitchedLabelPlaneMatrix:r,lineVertexArray:y,pitchWithMap:s,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:n.transform,tileAnchorPoint:S,unwrappedTileID:c,width:u,height:h,translation:d},M=jt(i.anchorX,i.anchorY,P);if(!It(M.point,g)){Zt(i.numGlyphs,_);continue}const A=Ct(n.transform.cameraToCenterDistance,M.signedDistanceFromCamera),k=e.ap(p,m,i),E=s?k*n.transform.getPitchedTextCorrection(i.anchorX,i.anchorY,c)/A:k*A,T=Dt({projectionContext:P,pitchedLabelPlaneMatrixInverse:a,symbol:i,fontSize:E,flip:!1,keepUpright:o,glyphOffsetArray:t.glyphOffsetArray,dynamicLayoutVertexArray:_,aspectRatio:b,rotateToLine:l});x=T.useVertical,(T.notEnoughRoom||x||T.needsFlipping&&Dt({projectionContext:P,pitchedLabelPlaneMatrixInverse:a,symbol:i,fontSize:E,flip:!0,keepUpright:o,glyphOffsetArray:t.glyphOffsetArray,dynamicLayoutVertexArray:_,aspectRatio:b,rotateToLine:l}).notEnoughRoom)&&Zt(i.numGlyphs,_)}i?t.text.dynamicLayoutVertexBuffer.updateData(_):t.icon.dynamicLayoutVertexBuffer.updateData(_)}function zt(t,e,n,i,r,a,s,o){const l=a.glyphStartIndex+a.numGlyphs,c=a.lineStartIndex,u=a.lineStartIndex+a.lineLength,h=e.getoffsetX(a.glyphStartIndex),d=e.getoffsetX(l-1),f=qt(t*h,n,i,r,a.segment,c,u,o,s);if(!f)return null;const p=qt(t*d,n,i,r,a.segment,c,u,o,s);return p?o.projectionCache.anyProjectionOccluded?null:{first:f,last:p}:null}function Nt(t,n,i,r){return t===e.ao.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(t===e.ao.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function Dt(t){const{projectionContext:n,pitchedLabelPlaneMatrixInverse:i,symbol:r,fontSize:a,flip:s,keepUpright:o,glyphOffsetArray:l,dynamicLayoutVertexArray:c,aspectRatio:u,rotateToLine:h}=t,d=a/24,f=r.lineOffsetX*d,p=r.lineOffsetY*d;let m;if(r.numGlyphs>1){const t=r.glyphStartIndex+r.numGlyphs,e=r.lineStartIndex,a=r.lineStartIndex+r.lineLength,c=zt(d,l,f,p,s,r,h,n);if(!c)return{notEnoughRoom:!0};const g=Bt(c.first.point.x,c.first.point.y,n,i),_=Bt(c.last.point.x,c.last.point.y,n,i);if(o&&!s){const t=Nt(r.writingMode,g,_,u);if(t)return t}m=[c.first];for(let i=r.glyphStartIndex+1;i<t-1;i++){const t=qt(d*l.getoffsetX(i),f,p,s,r.segment,e,a,n,h);if(!t)return{notEnoughRoom:!0};m.push(t)}m.push(c.last)}else{if(o&&!s){const t=Ot(n.tileAnchorPoint.x,n.tileAnchorPoint.y,n).point,a=r.lineStartIndex+r.segment+1,s=new e.P(n.lineVertexArray.getx(a),n.lineVertexArray.gety(a)),o=Ot(s.x,s.y,n),l=o.signedDistanceFromCamera>0?o.point:Rt(n.tileAnchorPoint,s,t,1,n),c=Bt(t.x,t.y,n,i),h=Bt(l.x,l.y,n,i),d=Nt(r.writingMode,c,h,u);if(d)return d}const t=qt(d*l.getoffsetX(r.glyphStartIndex),f,p,s,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,n,h);if(!t||n.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};m=[t]}for(const g of m)e.av(c,g.point,g.angle);return{}}function Rt(t,e,n,i,r){const a=t.add(t.sub(e)._unit()),s=Ot(a.x,a.y,r).point,o=n.sub(s);return n.add(o._mult(i/o.mag()))}function Ft(t,n,i){const r=n.projectionCache;if(r.projections[t])return r.projections[t];const a=new e.P(n.lineVertexArray.getx(t),n.lineVertexArray.gety(t)),s=Ot(a.x,a.y,n);if(s.signedDistanceFromCamera>0)return r.projections[t]=s.point,r.anyProjectionOccluded=r.anyProjectionOccluded||s.isOccluded,s.point;const o=t-i.direction;return Rt(0===i.distanceFromAnchor?n.tileAnchorPoint:new e.P(n.lineVertexArray.getx(o),n.lineVertexArray.gety(o)),a,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,n)}function Ot(t,e,n){const i=t+n.translation[0],r=e+n.translation[1];let a;return n.pitchWithMap?(a=Tt(i,r,n.pitchedLabelPlaneMatrix,n.getElevation),a.isOccluded=!1):(a=n.transform.projectTileCoordinates(i,r,n.unwrappedTileID,n.getElevation),a.point.x=(.5*a.point.x+.5)*n.width,a.point.y=(.5*-a.point.y+.5)*n.height),a}function Bt(t,n,i,r){if(i.pitchWithMap){const a=[t,n,0,1];return e.aw(a,a,r),i.transform.projectTileCoordinates(a[0]/a[3],a[1]/a[3],i.unwrappedTileID,i.getElevation).point}return{x:t/i.width*2-1,y:1-n/i.height*2}}function jt(t,e,n){return n.transform.projectTileCoordinates(t,e,n.unwrappedTileID,n.getElevation)}function Ut(t,e,n){return t._unit()._perp()._mult(e*n)}function Gt(t,n,i,r,a,s,o,l,c){if(l.projectionCache.offsets[t])return l.projectionCache.offsets[t];const u=i.add(n);if(t+c.direction<r||t+c.direction>=a)return l.projectionCache.offsets[t]=u,u;const h=Ft(t+c.direction,l,c),d=Ut(h.sub(i),o,c.direction),f=i.add(d),p=h.add(d);return l.projectionCache.offsets[t]=e.ax(s,u,f,p)||u,l.projectionCache.offsets[t]}function qt(t,e,n,i,r,a,s,o,l){const c=i?t-e:t+e;let u=c>0?1:-1,h=0;i&&(u*=-1,h=Math.PI),u<0&&(h+=Math.PI);let d,f=u>0?a+r:a+r+1;o.projectionCache.cachedAnchorPoint?d=o.projectionCache.cachedAnchorPoint:(d=Ot(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,o.projectionCache.cachedAnchorPoint=d);let p,m,g=d,_=d,y=0,v=0;const b=Math.abs(c),x=[];let w;for(;y+v<=b;){if(f+=u,f<a||f>=s)return null;y+=v,_=g,m=p;const t={absOffsetX:b,direction:u,distanceFromAnchor:y,previousVertex:_};if(g=Ft(f,o,t),0===n)x.push(_),w=g.sub(_);else{let e;const i=g.sub(_);e=0===i.mag()?Ut(Ft(f+u,o,t).sub(g),n,u):Ut(i,n,u),m||(m=_.add(e)),p=Gt(f,e,g,a,s,m,n,o,t),x.push(m),w=p.sub(m)}v=w.mag()}const S=w._mult((b-y)/v)._add(m||_),P=h+Math.atan2(g.y-_.y,g.x-_.x);return x.push(S),{point:S,angle:l?P:0,path:x}}const Vt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Zt(t,e){for(let n=0;n<t;n++){const t=e.length;e.resize(t+4),e.float32.set(Vt,3*t)}}function Wt(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15],t}const Ht=100;class Xt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Mt(t.width+200,t.height+200,25),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Mt(t.width+200,t.height+200,25);this.transform=t,this.grid=e,this.ignoredGrid=n,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Ht,this.screenBottomBoundary=t.height+Ht,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,e,n,i,r,a,s,o,l,c,u,h){const d=this.projectAndGetPerspectiveRatio(t.anchorPointX+o[0],t.anchorPointY+o[1],r,c,h),f=n*d.perspectiveRatio;let p;if(a||s)p=this._projectCollisionBox(t,f,i,r,a,s,o,d,c,u,h);else{const e=d.x+(u?u.x*f:0),n=d.y+(u?u.y*f:0);p={allPointsOccluded:!1,box:[e+t.x1*f,n+t.y1*f,e+t.x2*f,n+t.y2*f]}}const[m,g,_,y]=p.box,v=a?p.allPointsOccluded:d.isOccluded;let b=v;return b||(b=d.perspectiveRatio<this.perspectiveRatioCutoff),b||(b=!this.isInsideGrid(m,g,_,y)),b||"always"!==e&&this.grid.hitTest(m,g,_,y,e,l)?{box:[m,g,_,y],placeable:!1,offscreen:!1,occluded:v}:{box:[m,g,_,y],placeable:!0,offscreen:this.isOffscreen(m,g,_,y),occluded:v}}placeCollisionCircles(t,n,i,r,a,s,o,l,c,u,h,d,f,p){const m=[],g=new e.P(n.anchorX,n.anchorY),_=this.getPerspectiveRatio(g.x,g.y,s,p),y=(c?a*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,s)/_:a*_)/e.aB,v={getElevation:p,pitchedLabelPlaneMatrix:o,lineVertexArray:i,pitchWithMap:c,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:g,unwrappedTileID:s,width:this.transform.width,height:this.transform.height,translation:f},b=zt(y,r,n.lineOffsetX*y,n.lineOffsetY*y,!1,n,!1,v);let x=!1,w=!1,S=!0;if(b){const n=.5*h*_+d,i=new e.P(-100,-100),r=new e.P(this.screenRightBoundary,this.screenBottomBoundary),a=new St,s=b.first,o=b.last;let f=[];for(let t=s.path.length-1;t>=1;t--)f.push(s.path[t]);for(let t=1;t<o.path.length;t++)f.push(o.path[t]);const p=2.5*n;if(c){const t=this.projectPathToScreenSpace(f,v);f=t.some(t=>t.signedDistanceFromCamera<=0)?[]:t.map(t=>t.point)}let g=[];if(f.length>0){const t=f[0].clone(),n=f[0].clone();for(let e=1;e<f.length;e++)t.x=Math.min(t.x,f[e].x),t.y=Math.min(t.y,f[e].y),n.x=Math.max(n.x,f[e].x),n.y=Math.max(n.y,f[e].y);g=t.x>=i.x&&n.x<=r.x&&t.y>=i.y&&n.y<=r.y?[f]:n.x<i.x||t.x>r.x||n.y<i.y||t.y>r.y?[]:e.ay([f],i.x,i.y,r.x,r.y)}for(const e of g){a.reset(e,.25*n);let i=0;i=a.length<=.5*n?1:Math.ceil(a.paddedLength/p)+1;for(let e=0;e<i;e++){const r=e/Math.max(i-1,1),s=a.lerp(r),o=s.x+Ht,c=s.y+Ht;m.push(o,c,n,0);const h=o-n,d=c-n,f=o+n,p=c+n;if(S=S&&this.isOffscreen(h,d,f,p),w=w||this.isInsideGrid(h,d,f,p),"always"!==t&&this.grid.hitTestCircle(o,c,n,t,u)&&(x=!0,!l))return{circles:[],offscreen:!1,collisionDetected:x}}}}return{circles:!l&&x||!w||_<this.perspectiveRatioCutoff?[]:m,offscreen:S,collisionDetected:x}}projectPathToScreenSpace(t,n){const i=function(t,n){const i=e.L();return e.aq(i,n.pitchedLabelPlaneMatrix),t.map(t=>{const e=Tt(t.x,t.y,i,n.getElevation),r=n.transform.projectTileCoordinates(e.point.x,e.point.y,n.unwrappedTileID,n.getElevation);return r.point.x=(.5*r.point.x+.5)*n.width,r.point.y=(.5*-r.point.y+.5)*n.height,r})}(t,n);return function(t){let e=0,n=0,i=0,r=0;for(let a=0;a<t.length;a++)t[a].isOccluded?(i=a+1,r=0):(r++,r>n&&(n=r,e=i));return t.slice(e,e+n)}(i)}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[],i=new e.a2;for(const h of t){const t=new e.P(h.x+Ht,h.y+Ht);i.extend(t),n.push(t)}const{minX:r,minY:a,maxX:s,maxY:o}=i,l=this.grid.query(r,a,s,o).concat(this.ignoredGrid.query(r,a,s,o)),c={},u={};for(const h of l){const t=h.key;if(void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]={}),c[t.bucketInstanceId][t.featureIndex])continue;const i=[new e.P(h.x1,h.y1),new e.P(h.x2,h.y1),new e.P(h.x2,h.y2),new e.P(h.x1,h.y2)];e.az(n,i)&&(c[t.bucketInstanceId][t.featureIndex]=!0,void 0===u[t.bucketInstanceId]&&(u[t.bucketInstanceId]=[]),u[t.bucketInstanceId].push(t.featureIndex))}return u}insertCollisionBox(t,e,n,i,r,a){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:r,collisionGroupID:a,overlapMode:e},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,i,r,a){const s=n?this.ignoredGrid:this.grid,o={bucketInstanceId:i,featureIndex:r,collisionGroupID:a,overlapMode:e};for(let l=0;l<t.length;l+=4)s.insertCircle(o,t[l],t[l+1],t[l+2])}projectAndGetPerspectiveRatio(t,n,i,r,a){if(a){let i;r?(i=[t,n,r(t,n),1],e.aw(i,i,a)):(i=[t,n,0,1],Wt(i,i,a));const s=i[3];return{x:(i[0]/s+1)/2*this.transform.width+Ht,y:(-i[1]/s+1)/2*this.transform.height+Ht,perspectiveRatio:.5+this.transform.cameraToCenterDistance/s*.5,isOccluded:!1,signedDistanceFromCamera:s}}{const e=this.transform.projectTileCoordinates(t,n,i,r);return{x:(e.point.x+1)/2*this.transform.width+Ht,y:(1-e.point.y)/2*this.transform.height+Ht,perspectiveRatio:.5+this.transform.cameraToCenterDistance/e.signedDistanceFromCamera*.5,isOccluded:e.isOccluded,signedDistanceFromCamera:e.signedDistanceFromCamera}}}getPerspectiveRatio(t,e,n,i){const r=this.transform.projectTileCoordinates(t,e,n,i);return.5+this.transform.cameraToCenterDistance/r.signedDistanceFromCamera*.5}isOffscreen(t,e,n,i){return n<Ht||t>=this.screenRightBoundary||i<Ht||e>this.screenBottomBoundary}isInsideGrid(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const t=e.ag([]);return e.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,n,i,r,a,s,o,l,c,u,h){let d=1,f=0,p=0,m=1;const g=t.anchorPointX+o[0],_=t.anchorPointY+o[1];if(s&&!a){const t=this.projectAndGetPerspectiveRatio(g+1,_,r,c,h),e=t.x-l.x,n=Math.atan((t.y-l.y)/e)+(e<0?Math.PI:0),i=Math.sin(n),a=Math.cos(n);d=a,f=i,p=-i,m=a}else if(!s&&a){const t=Et(this.transform);d=t.vecEast[0],f=t.vecEast[1],p=t.vecSouth[0],m=t.vecSouth[1]}let y=l.x,v=l.y,b=n;a&&(y=g,v=_,b=Math.pow(2,-(this.transform.zoom-i.overscaledZ)),b*=this.transform.getPitchedTextCorrection(g,_,r),u||(b*=e.ah(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),u&&(y+=d*u.x*b+p*u.y*b,v+=f*u.x*b+m*u.y*b);const x=t.x1*b,w=t.x2*b,S=(x+w)/2,P=t.y1*b,M=t.y2*b,A=(P+M)/2,k=[{offsetX:x,offsetY:P},{offsetX:S,offsetY:P},{offsetX:w,offsetY:P},{offsetX:w,offsetY:A},{offsetX:w,offsetY:M},{offsetX:S,offsetY:M},{offsetX:x,offsetY:M},{offsetX:x,offsetY:A}];let E=[];for(const{offsetX:C,offsetY:I}of k)E.push(new e.P(y+d*C+p*I,v+f*C+m*I));let T=!1;if(a){const t=E.map(t=>this.projectAndGetPerspectiveRatio(t.x,t.y,r,c,h));T=t.some(t=>!t.isOccluded),E=t.map(t=>new e.P(t.x,t.y))}else T=!0;return{box:e.aA(E),allPointsOccluded:!T}}}class Yt{constructor(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class Kt{constructor(t,e,n,i,r){this.text=new Yt(t?t.text:null,e,n,r),this.icon=new Yt(t?t.icon:null,e,i,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Jt{constructor(t,e,n){this.text=t,this.icon=e,this.skipFade=n}}class $t{constructor(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}}class Qt{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function te(t,n,i,r,a){const{horizontalAlign:s,verticalAlign:o}=e.aH(t);return new e.P(-(s-.5)*n+r[0]*a,-(o-.5)*i+r[1]*a)}class ee{constructor(t,e,n,i,r){this.transform=t.clone(),this.terrain=e,this.collisionIndex=new Xt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new Qt(i),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const e=this.terrain;return e?(n,i)=>e.getElevation(t,n,i):null}getBucketParts(t,n,i,r){const a=i.getBucket(n),s=i.latestFeatureIndex;if(!a||!s||n.id!==a.layerIds[0])return;const o=i.collisionBoxArray,l=a.layers[0].layout,c=a.layers[0].paint,u=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),h=i.tileSize/e.$,d=i.tileID.toUnwrapped(),f="map"===l.get("text-rotation-alignment"),p=e.aC(i,1,this.transform.zoom),m=e.aD(this.collisionIndex.transform,i,c.get("text-translate"),c.get("text-translate-anchor")),g=e.aD(this.collisionIndex.transform,i,c.get("icon-translate"),c.get("icon-translate-anchor")),_=At(f,this.transform,p);this.retainedQueryData[a.bucketInstanceId]=new $t(a.bucketInstanceId,s,a.sourceLayerIndex,a.index,i.tileID);const y={bucket:a,layout:l,translationText:m,translationIcon:g,unwrappedTileID:d,pitchedLabelPlaneMatrix:_,scale:u,textPixelRatio:h,holdingForFade:i.holdingForFade(),collisionBoxArray:o,partiallyEvaluatedTextSize:e.an(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(r)for(const e of a.sortKeyRanges){const{sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r}=e;t.push({sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r,parameters:y})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:y})}attemptAnchorPlacement(t,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b){const x=e.aE[t.textAnchor],w=[t.textOffset0,t.textOffset1],S=te(x,i,r,w,a),P=this.collisionIndex.placeCollisionBox(n,d,l,c,u,o,s,g,h.predicate,v,S,b);if((!y||this.collisionIndex.placeCollisionBox(y,d,l,c,u,o,s,_,h.predicate,v,S,b).placeable)&&P.placeable){let t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID].text&&(t=this.prevPlacement.variableOffsets[f.crossTileID].anchor),0===f.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[f.crossTileID]={textOffset:w,width:i,height:r,anchor:x,textBoxScale:a,prevAnchor:t},this.markUsedJustification(p,x,f,m),p.allowVerticalPlacement&&(this.markUsedOrientation(p,m,f),this.placedOrientations[f.crossTileID]=m),{shift:S,placedGlyphBoxes:P}}}placeLayerBucketPart(t,n,i){const{bucket:r,layout:a,translationText:s,translationIcon:o,unwrappedTileID:l,pitchedLabelPlaneMatrix:c,textPixelRatio:u,holdingForFade:h,collisionBoxArray:d,partiallyEvaluatedTextSize:f,collisionGroup:p}=t.parameters,m=a.get("text-optional"),g=a.get("icon-optional"),_=e.aF(a,"text-overlap","text-allow-overlap"),y="always"===_,v=e.aF(a,"icon-overlap","icon-allow-overlap"),b="always"===v,x="map"===a.get("text-rotation-alignment"),w="map"===a.get("text-pitch-alignment"),S="none"!==a.get("icon-text-fit"),P="viewport-y"===a.get("symbol-z-order"),M=y&&(b||!r.hasIconData()||g),A=b&&(y||!r.hasTextData()||m);!r.collisionArrays&&d&&r.deserializeCollisionBoxes(d);const k=this.retainedQueryData[r.bucketInstanceId].tileID,E=this._getTerrainElevationFunc(k),T=this.transform.getFastPathSimpleProjectionMatrix(k),C=(t,d,b)=>{var P,C;if(n[t.crossTileID])return;if(h)return void(this.placements[t.crossTileID]=new Jt(!1,!1,!1));let I=!1,L=!1,z=!0,N=null,D={box:null,placeable:!1,offscreen:null,occluded:!1},R={placeable:!1},F=null,O=null,B=null,j=0,U=0,G=0;d.textFeatureIndex?j=d.textFeatureIndex:t.useRuntimeCollisionCircles&&(j=t.featureIndex),d.verticalTextFeatureIndex&&(U=d.verticalTextFeatureIndex);const q=d.textBox;if(q){const n=n=>{let i=e.ao.horizontal;if(r.allowVerticalPlacement&&!n&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[t.crossTileID];e&&(this.placedOrientations[t.crossTileID]=e,i=e,this.markUsedOrientation(r,i,t))}return i},a=(n,i)=>{if(r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&d.verticalTextBox){for(const t of r.writingModes)if(t===e.ao.vertical?(D=i(),R=D):D=n(),D&&D.placeable)break}else D=n()},c=t.textAnchorOffsetStartIndex,h=t.textAnchorOffsetEndIndex;if(h===c){const i=(e,n)=>{const i=this.collisionIndex.placeCollisionBox(e,_,u,k,l,w,x,s,p.predicate,E,void 0,T);return i&&i.placeable&&(this.markUsedOrientation(r,n,t),this.placedOrientations[t.crossTileID]=n),i};a(()=>i(q,e.ao.horizontal),()=>{const n=d.verticalTextBox;return r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&n?i(n,e.ao.vertical):{box:null,offscreen:null}}),n(D&&D.placeable)}else{let f=e.aE[null===(C=null===(P=this.prevPlacement)||void 0===P?void 0:P.variableOffsets[t.crossTileID])||void 0===C?void 0:C.anchor];const m=(e,n,a)=>{const d=e.x2-e.x1,m=e.y2-e.y1,g=t.textBoxScale,y=S&&"never"===v?n:null;let b=null,P="never"===_?1:2,M="never";f&&P++;for(let i=0;i<P;i++){for(let n=c;n<h;n++){const i=r.textAnchorOffsets.get(n);if(f&&i.textAnchor!==f)continue;const c=this.attemptAnchorPlacement(i,e,d,m,g,x,w,u,k,l,p,M,t,r,a,s,o,y,E);if(c&&(b=c.placedGlyphBoxes,b&&b.placeable))return I=!0,N=c.shift,b}f?f=null:M=_}return i&&!b&&(b={box:this.collisionIndex.placeCollisionBox(q,"always",u,k,l,w,x,s,p.predicate,E,void 0,T).box,offscreen:!1,placeable:!1,occluded:!1}),b};a(()=>m(q,d.iconBox,e.ao.horizontal),()=>{const n=d.verticalTextBox;return r.allowVerticalPlacement&&(!D||!D.placeable)&&t.numVerticalGlyphVertices>0&&n?m(n,d.verticalIconBox,e.ao.vertical):{box:null,occluded:!0,offscreen:null}}),D&&(I=D.placeable,z=D.offscreen);const g=n(D&&D.placeable);if(!I&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[t.crossTileID];e&&(this.variableOffsets[t.crossTileID]=e,this.markUsedJustification(r,e.anchor,t,g))}}}if(F=D,I=F&&F.placeable,z=F&&F.offscreen,t.useRuntimeCollisionCircles){const n=r.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),o=e.ap(r.textSizeData,f,n),u=a.get("text-padding");O=this.collisionIndex.placeCollisionCircles(_,n,r.lineVertexArray,r.glyphOffsetArray,o,l,c,i,w,p.predicate,t.collisionCircleDiameter,u,s,E),O.circles.length&&O.collisionDetected&&!i&&e.w("Collisions detected, but collision boxes are not shown"),I=y||O.circles.length>0&&!O.collisionDetected,z=z&&O.offscreen}if(d.iconFeatureIndex&&(G=d.iconFeatureIndex),d.iconBox){const t=t=>this.collisionIndex.placeCollisionBox(t,v,u,k,l,w,x,o,p.predicate,E,S&&N?N:void 0,T);R&&R.placeable&&d.verticalIconBox?(B=t(d.verticalIconBox),L=B.placeable):(B=t(d.iconBox),L=B.placeable),z=z&&B.offscreen}const V=m||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,Z=g||0===t.numIconVertices;V||Z?Z?V||(L=L&&I):I=L&&I:L=I=L&&I;const W=L&&B.placeable;if(I&&F.placeable&&this.collisionIndex.insertCollisionBox(F.box,_,a.get("text-ignore-placement"),r.bucketInstanceId,R&&R.placeable&&U?U:j,p.ID),W&&this.collisionIndex.insertCollisionBox(B.box,v,a.get("icon-ignore-placement"),r.bucketInstanceId,G,p.ID),O&&I&&this.collisionIndex.insertCollisionCircles(O.circles,_,a.get("text-ignore-placement"),r.bucketInstanceId,j,p.ID),i&&this.storeCollisionData(r.bucketInstanceId,b,d,F,B,O),0===t.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===r.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[t.crossTileID]=new Jt((I||M)&&!(null==F?void 0:F.occluded),(L||A)&&!(null==B?void 0:B.occluded),z||r.justReloaded),n[t.crossTileID]=!0};if(P){if(0!==t.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const e=r.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let t=e.length-1;t>=0;--t){const n=e[t];C(r.symbolInstances.get(n),r.collisionArrays[n],n)}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)C(r.symbolInstances.get(e),r.collisionArrays[e],e);r.justReloaded=!1}storeCollisionData(t,e,n,i,r,a){if(n.textBox||n.iconBox){let a,s;this.collisionBoxArrays.has(t)?a=this.collisionBoxArrays.get(t):(a=new Map,this.collisionBoxArrays.set(t,a)),a.has(e)?s=a.get(e):(s={text:null,icon:null},a.set(e,s)),n.textBox&&(s.text=i.box),n.iconBox&&(s.icon=r.box)}if(a){let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=[]);for(let t=0;t<a.circles.length;t+=4)e.push(a.circles[t+0]-Ht),e.push(a.circles[t+1]-Ht),e.push(a.circles[t+2]),e.push(a.collisionDetected?1:0)}}markUsedJustification(t,n,i,r){let a;a=r===e.ao.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[e.aG(n)];const s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(const e of s)e>=0&&(t.text.placedSymbolArray.get(e).crossTileID=a>=0&&e!==a?0:i.crossTileID)}markUsedOrientation(t,n,i){const r=n===e.ao.horizontal||n===e.ao.horizontalOnly?n:0,a=n===e.ao.vertical?n:0,s=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(const e of s)t.text.placedSymbolArray.get(e).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const i=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},a=e?e.variableOffsets:{},s=e?e.placedOrientations:{};for(const o in this.placements){const t=this.placements[o],e=r[o];e?(this.opacities[o]=new Kt(e,i,t.text,t.icon),n=n||t.text!==e.text.placed||t.icon!==e.icon.placed):(this.opacities[o]=new Kt(null,i,t.text,t.icon,t.skipFade),n=n||t.text||t.icon)}for(const o in r){const t=r[o];if(!this.opacities[o]){const e=new Kt(t,i,!1,!1);e.isHidden()||(this.opacities[o]=e,n=n||t.text.placed||t.icon.placed)}}for(const o in a)this.variableOffsets[o]||!this.opacities[o]||this.opacities[o].isHidden()||(this.variableOffsets[o]=a[o]);for(const o in s)this.placedOrientations[o]||!this.opacities[o]||this.opacities[o].isHidden()||(this.placedOrientations[o]=s[o]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n={};for(const i of e){const e=i.getBucket(t);e&&i.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,i.tileID,n,i.collisionBoxArray)}}updateBucketOpacities(t,n,i,r){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const a=t.layers[0],s=a.layout,o=new Kt(null,0,!1,!1,!0),l=s.get("text-allow-overlap"),c=s.get("icon-allow-overlap"),u=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===s.get("text-rotation-alignment"),d="map"===s.get("text-pitch-alignment"),f="none"!==s.get("icon-text-fit"),p=new Kt(null,0,l&&(c||!t.hasIconData()||s.get("icon-optional")),c&&(l||!t.hasTextData()||s.get("text-optional")),!0);!t.collisionArrays&&r&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(r);const m=(t,e,n)=>{for(let i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(n);t.hasVisibleVertices=t.hasVisibleVertices||n!==he},g=this.collisionBoxArrays.get(t.bucketInstanceId);for(let _=0;_<t.symbolInstances.length;_++){const n=t.symbolInstances.get(_),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:s}=n;let l=this.opacities[s];i[s]?l=o:l||(l=p,this.opacities[s]=l),i[s]=!0;const c=n.numIconVertices>0,y=this.placedOrientations[n.crossTileID],v=y===e.ao.vertical,b=y===e.ao.horizontal||y===e.ao.horizontalOnly;if(r>0||a>0){const e=ue(l.text);m(t.text,r,v?he:e),m(t.text,a,b?he:e);const i=l.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach(e=>{e>=0&&(t.text.placedSymbolArray.get(e).hidden=i||v?1:0)}),n.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=i||b?1:0);const s=this.variableOffsets[n.crossTileID];s&&this.markUsedJustification(t,s.anchor,n,y);const o=this.placedOrientations[n.crossTileID];o&&(this.markUsedJustification(t,"left",n,o),this.markUsedOrientation(t,o,n))}if(c){const e=ue(l.icon),i=!(f&&n.verticalPlacedIconSymbolIndex&&v);n.placedIconSymbolIndex>=0&&(m(t.icon,n.numIconVertices,i?e:he),t.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=l.icon.isHidden()),n.verticalPlacedIconSymbolIndex>=0&&(m(t.icon,n.numVerticalIconVertices,i?he:e),t.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=l.icon.isHidden())}const x=g&&g.has(_)?g.get(_):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const n=t.collisionArrays[_];if(n){let i=new e.P(0,0);if(n.textBox||n.verticalTextBox){let e=!0;if(u){const t=this.variableOffsets[s];t?(i=te(t.anchor,t.width,t.height,t.textOffset,t.textBoxScale),h&&i._rotate(d?-this.transform.bearingInRadians:this.transform.bearingInRadians)):e=!1}if(n.textBox||n.verticalTextBox){let r;n.textBox&&(r=v),n.verticalTextBox&&(r=b),ne(t.textCollisionBox.collisionVertexArray,l.text.placed,!e||r,x.text,i.x,i.y)}}if(n.iconBox||n.verticalIconBox){const e=Boolean(!b&&n.verticalIconBox);let r;n.iconBox&&(r=e),n.verticalIconBox&&(r=!e),ne(t.iconCollisionBox.collisionVertexArray,l.icon.placed,r,x.icon,f?i.x:0,f?i.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error("bucket.text.opacityVertexArray.length (= ".concat(t.text.opacityVertexArray.length,") !== bucket.text.layoutVertexArray.length (= ").concat(t.text.layoutVertexArray.length,") / 4"));if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error("bucket.icon.opacityVertexArray.length (= ".concat(t.icon.opacityVertexArray.length,") !== bucket.icon.layoutVertexArray.length (= ").concat(t.icon.layoutVertexArray.length,") / 4"));t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function ne(t,e,n,i,r,a){i&&0!==i.length||(i=[0,0,0,0]);const s=i[0]-Ht,o=i[1]-Ht,l=i[2]-Ht,c=i[3]-Ht;t.emplaceBack(e?1:0,n?1:0,r||0,a||0,s,o),t.emplaceBack(e?1:0,n?1:0,r||0,a||0,l,o),t.emplaceBack(e?1:0,n?1:0,r||0,a||0,l,c),t.emplaceBack(e?1:0,n?1:0,r||0,a||0,s,c)}const ie=Math.pow(2,25),re=Math.pow(2,24),ae=Math.pow(2,17),se=Math.pow(2,16),oe=Math.pow(2,9),le=Math.pow(2,8),ce=Math.pow(2,1);function ue(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*ie+e*re+n*ae+e*se+n*oe+e*le+n*ce+e}const he=0;class de{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,n,i,r){const a=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(a,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((t,e)=>t.sortKey-e.sortKey));this._currentPartIndex<a.length;)if(e.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,r())return!0;return!1}}class fe{constructor(t,e,n,i,r,a,s,o){this.placement=new ee(t,e,a,s,o),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(t,e,n){const i=s.now(),r=()=>!this._forceFullPlacement&&s.now()-i>2;for(;this._currentPlacementIndex>=0;){const i=e[t[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===i.type&&(!i.minzoom||i.minzoom<=a)&&(!i.maxzoom||i.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new de(i)),this._inProgressLayer.continuePlacement(n[i.source],this.placement,this._showCollisionBoxes,i,r))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const pe=512/e.$/2;class me{constructor(t,n,i){this.tileID=t,this.bucketInstanceId=i,this._symbolsByKey={};const r=new Map;for(let e=0;e<n.length;e++){const t=n.get(e),i=t.key,a=r.get(i);a?a.push(t):r.set(i,[t])}for(const[a,s]of r){const t={positions:s.map(t=>({x:Math.floor(t.anchorX*pe),y:Math.floor(t.anchorY*pe)})),crossTileIDs:s.map(t=>t.crossTileID)};if(t.positions.length>128){const n=new e.aI(t.positions.length,16,Uint16Array);for(const{x:e,y:i}of t.positions)n.add(e,i);n.finish(),delete t.positions,t.index=n}this._symbolsByKey[a]=t}}getScaledCoordinates(t,n){const{x:i,y:r,z:a}=this.tileID.canonical,{x:s,y:o,z:l}=n.canonical,c=pe/Math.pow(2,l-a),u=(o*e.$+t.anchorY)*c,h=r*e.$*pe;return{x:Math.floor((s*e.$+t.anchorX)*c-i*e.$*pe),y:Math.floor(u-h)}}findMatches(t,e,n){const i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let r=0;r<t.length;r++){const a=t.get(r);if(a.crossTileID)continue;const s=this._symbolsByKey[a.key];if(!s)continue;const o=this.getScaledCoordinates(a,e);if(s.index){const t=s.index.range(o.x-i,o.y-i,o.x+i,o.y+i).sort();for(const e of t){const t=s.crossTileIDs[e];if(!n[t]){n[t]=!0,a.crossTileID=t;break}}}else if(s.positions)for(let t=0;t<s.positions.length;t++){const e=s.positions[t],r=s.crossTileIDs[t];if(Math.abs(e.x-o.x)<=i&&Math.abs(e.y-o.y)<=i&&!n[r]){n[r]=!0,a.crossTileID=r;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(t=>{let{crossTileIDs:e}=t;return e})}}class ge{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class _e{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const n in this.indexes){const t=this.indexes[n],i={};for(const n in t){const r=t[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),i[r.tileID.key]=r}this.indexes[n]=i}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const i=this.usedCrossTileIDs[t.overscaledZ];for(const r in this.indexes){const n=this.indexes[r];if(Number(r)>t.overscaledZ)for(const r in n){const a=n[r];a.tileID.isChildOf(t)&&a.findMatches(e.symbolInstances,t,i)}else{const a=n[t.scaledTo(Number(r)).key];a&&a.findMatches(e.symbolInstances,t,i)}}for(let r=0;r<e.symbolInstances.length;r++){const t=e.symbolInstances.get(r);t.crossTileID||(t.crossTileID=n.generate(),i[t.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new me(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n of e.getCrossTileIDsLists())for(const e of n)delete this.usedCrossTileIDs[t][e]}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const i=this.indexes[n];for(const r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e}}class ye{constructor(){this.layerIndexes={},this.crossTileIDs=new ge,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n){let i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new _e);let r=!1;const a={};i.handleWrapJump(n);for(const s of e){const e=s.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,e,this.crossTileIDs)&&(r=!0),a[e.bucketInstanceId]=!0)}return i.removeStaleBuckets(a)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach(t=>{e[t]=!0});for(const n in this.layerIndexes)e[n]||delete this.layerIndexes[n]}}var ve="void main() {fragColor=vec4(1.0);}";const be={prelude:xe("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nout highp vec4 fragColor;","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c\n);}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\n#ifdef GLOBE\nif ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}\n#endif\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;"),projectionMercator:xe("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:xe("","#define GLOBE_RADIUS 6371008.8\nuniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos\n);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); \nif (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len\n);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}"),background:xe("uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:xe("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:xe("in vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {\n#ifdef GLOBE\nvec3 center_vector=projectToSphere(circle_center);\n#endif\nfloat angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {\n#ifdef GLOBE\nvec4 projected_center=interpolateProjection(circle_center,center_vector,ele);\n#else\nvec4 projected_center=projectTileWithElevation(circle_center,ele);\n#endif\ncorner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}\n#ifdef GLOBE\nvec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);\n#else\ngl_Position=projectTileWithElevation(corner_position,ele);\n#endif\n} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:xe(ve,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:xe("uniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);\n#ifdef GLOBE\nvec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);\n#else\ngl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));\n#endif\n}"),heatmapTexture:xe("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:xe("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:xe("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:xe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else\n{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:xe("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:xe(ve,"in vec2 a_pos;void main() {\n#ifdef GLOBE\ngl_Position=projectTileFor3D(a_pos,0.0);\n#else\ngl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);\n#endif\n}"),fill:xe("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nfragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_fill_translate;in vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);}"),fillOutline:xe("in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillOutlinePattern:xe("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillPattern:xe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:xe("in vec4 v_color;void main() {fragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\nout vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);\n#ifdef GLOBE\nmat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);\n#endif\ndirectional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:xe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\n#ifdef GLOBE\nout vec3 v_sphere_pos;\n#endif\nout vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nvec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:xe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xe("uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];\n#define PI 3.141592653589793\n#define STANDARD 0\n#define COMBINED 1\n#define IGOR 2\n#define MULTIDIRECTIONAL 3\n#define BASIC 4\nfloat get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else\n{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else\n{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:xe("uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:xe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:xe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:xe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:xe("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;\n#ifdef GLOBE\nif (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}\n#endif\nv_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:xe("uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:xe("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:xe("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:xe("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:xe("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:xe("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:xe("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:xe("in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}","in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:xe("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function xe(t,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=e.match(/in ([\w]+) ([\w]+)/g),r=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),s=a?a.concat(r):r,o={};return{fragmentSource:t=t.replace(n,(t,e,n,i,r)=>(o[r]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\nin ").concat(n," ").concat(i," ").concat(r,";\n#else\nuniform ").concat(n," ").concat(i," u_").concat(r,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(r,"\n    ").concat(n," ").concat(i," ").concat(r," = u_").concat(r,";\n#endif\n"))),vertexSource:e=e.replace(n,(t,e,n,i,r)=>{const a="float"===i?"vec2":"vec4",s=r.match(/color/)?"color":a;return o[r]?"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\nuniform lowp float u_").concat(r,"_t;\nin ").concat(n," ").concat(a," a_").concat(r,";\nout ").concat(n," ").concat(i," ").concat(r,";\n#else\nuniform ").concat(n," ").concat(i," u_").concat(r,";\n#endif\n"):"vec4"===s?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(r," = a_").concat(r,";\n#else\n    ").concat(n," ").concat(i," ").concat(r," = u_").concat(r,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(r," = unpack_mix_").concat(s,"(a_").concat(r,", u_").concat(r,"_t);\n#else\n    ").concat(n," ").concat(i," ").concat(r," = u_").concat(r,";\n#endif\n"):"define"===e?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\nuniform lowp float u_").concat(r,"_t;\nin ").concat(n," ").concat(a," a_").concat(r,";\n#else\nuniform ").concat(n," ").concat(i," u_").concat(r,";\n#endif\n"):"vec4"===s?"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(n," ").concat(i," ").concat(r," = a_").concat(r,";\n#else\n    ").concat(n," ").concat(i," ").concat(r," = u_").concat(r,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(r,"\n    ").concat(n," ").concat(i," ").concat(r," = unpack_mix_").concat(s,"(a_").concat(r,", u_").concat(r,"_t);\n#else\n    ").concat(n," ").concat(i," ").concat(r," = u_").concat(r,";\n#endif\n")}),staticAttributes:i,staticUniforms:s}}class we{constructor(t,e,n){this.vertexBuffer=t,this.indexBuffer=e,this.segments=n}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Se=e.aJ([{name:"a_pos",type:"Int16",components:2}]);const Pe="#define PROJECTION_MERCATOR",Me="mercator";class Ae{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Me}get shaderDefine(){return Pe}get shaderPreludeCode(){return be.projectionMercator}get vertexShaderPreludeCode(){return be.projectionMercator.vertexSource}get subdivisionGranularity(){return e.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,n,i,r,a){if(this._cachedMesh)return this._cachedMesh;const s=new e.aL;s.emplaceBack(0,0),s.emplaceBack(e.$,0),s.emplaceBack(0,e.$),s.emplaceBack(e.$,e.$);const o=t.createVertexBuffer(s,Se.members),l=e.aM.simpleSegment(0,0,4,2),c=new e.aN;c.emplaceBack(1,0,2),c.emplaceBack(1,2,3);const u=t.createIndexBuffer(c);return this._cachedMesh=new we(o,u,l),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class ke{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=i}interpolate(t,n,i){return null!=n.top&&null!=t.top&&(this.top=e.C.number(t.top,n.top,i)),null!=n.bottom&&null!=t.bottom&&(this.bottom=e.C.number(t.bottom,n.bottom,i)),null!=n.left&&null!=t.left&&(this.left=e.C.number(t.left,n.left,i)),null!=n.right&&null!=t.right&&(this.right=e.C.number(t.right,n.right,i)),this}getCenter(t,n){const i=e.ah((this.left+t-this.right)/2,0,t),r=e.ah((this.top+n-this.bottom)/2,0,n);return new e.P(i,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ke(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ee(t,e){if(!t.renderWorldCopies||t.lngRange)return;const n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}function Te(t){return Math.max(0,Math.floor(t))}class Ce{constructor(t,n,i,r,a,s){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=void 0===s||!!s,this._minZoom=n||0,this._maxZoom=i||22,this._minPitch=null==r?0:r,this._maxPitch=null==a?60:a,this.setMaxBounds(),this._width=0,this._height=0,this._center=new e.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Te(this._zoom),this._scale=e.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ke,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,n,i){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Te(this._zoom),this._scale=e.af(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new ke(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!i&&t.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const n=e.aO(t,-180,180)*Math.PI/180;var r,a,s,o,l,c,u,h,d;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=i(),r=this._rotationMatrix,s=-this._bearingInRadians,o=(a=this._rotationMatrix)[0],l=a[1],c=a[2],u=a[3],h=Math.sin(s),d=Math.cos(s),r[0]=o*d+c*h,r[1]=l*d+u*h,r[2]=o*-h+c*d,r[3]=l*-h+u*d)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const n=e.ah(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const e=t/180*Math.PI;this._rollInRadians!==e&&(this._unmodified=!1,this._rollInRadians=e,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return e.aP(this._fovInRadians)}setFov(t){t=e.ah(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=e.ae(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const n=this.getConstrained(this._center,t).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=e.af(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,e){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=e,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}resize(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._width=t,this._height=e,n&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&2===this._latRange.length&&this._lngRange&&2===this._lngRange.length?new q([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-e.ai,e.ai])}getConstrained(t,e){return this._callbacks.getConstrained(t,e)}getCameraQueryGeometry(t,n){if(1===n.length)return[n[0],t];{const{minX:i,minY:r,maxX:a,maxY:s}=e.a2.fromPoints(n).extend(t);return[new e.P(i,r),new e.P(a,r),new e.P(a,s),new e.P(i,s),new e.P(i,r)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:e,zoom:n}=this.getConstrained(this.center,this.zoom);this.setCenter(e),this.setZoom(n),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=e.ag(new Float64Array(16));e.N(t,t,[this._width/2,-this._height/2,1]),e.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=e.ag(new Float64Array(16)),e.N(t,t,[1,-1,1]),e.M(t,t,[-1,-1,0]),e.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,n,i,r){const a=void 0!==i?i:this.bearing,s=r=void 0!==r?r:this.pitch,o=e.a1.fromLngLat(t,n),l=-Math.cos(e.ae(s)),c=Math.sin(e.ae(s)),u=c*Math.sin(e.ae(a)),h=-c*Math.cos(e.ae(a));let d=this.elevation;const f=n-d;let p;l*f>=0||Math.abs(l)<.1?(p=1e4,d=n+p*l):p=-f/l;let m,g,_=e.aQ(1,o.y),y=0;do{if(y+=1,y>10)break;g=p/_,m=new e.a1(o.x+u*g,o.y+h*g),_=1/m.meterInMercatorCoordinateUnits()}while(Math.abs(p-g*_)>1e-12);return{center:m.toLngLat(),elevation:d,zoom:e.ak(this.height/2/Math.tan(this.fovInRadians/2)/g/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const n=e.aj(1,this.center.lat)*this.worldSize,i=this.cameraToCenterDistance/n,r=e.a1.fromLngLat(this.center,this.elevation),a=dt(this.center,this.elevation,this.pitch,this.bearing,i);this._elevation=t;const s=this.calculateCenterFromCameraLngLatAlt(a.toLngLat(),e.aQ(a.z,r.y),this.bearing,this.pitch);this._elevation=s.elevation,this._center=s.center,this.setZoom(s.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=e.aj(1,this.center.lat)*this.worldSize;return dt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const n=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/n,t.canonical.y/n,1/n/e.$,1/n/e.$]}}class Ie{constructor(t,n){this.min=t,this.max=n,this.center=e.aR([],e.aS([],this.min,this.max),.5)}quadrant(t){const n=[t%2==0,t<2],i=e.aT(this.min),r=e.aT(this.max);for(let e=0;e<n.length;e++)i[e]=n[e]?this.min[e]:this.center[e],r[e]=n[e]?this.center[e]:this.max[e];return r[2]=this.max[2],new Ie(i,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let e=!0;for(let n=0;n<t.planes.length;n++){const i=this.intersectsPlane(t.planes[n]);if(0===i)return 0;1===i&&(e=!1)}return e?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let e=t[3],n=t[3];for(let i=0;i<3;i++)t[i]>0?(e+=t[i]*this.min[i],n+=t[i]*this.max[i]):(n+=t[i]*this.min[i],e+=t[i]*this.max[i]);return e>=0?2:n<0?0:1}}class Le{distanceToTile2d(t,e,n,i){const r=i.distanceX([t,e]),a=i.distanceY([t,e]);return Math.hypot(r,a)}getWrap(t,e,n){return n}getTileBoundingVolume(t,n,i,r){var a,s;let o=0,l=0;if(null==r?void 0:r.terrain){const c=new e.Z(t.z,n,t.z,t.x,t.y),u=r.terrain.getMinMaxElevation(c);o=null!==(a=u.minElevation)&&void 0!==a?a:Math.min(0,i),l=null!==(s=u.maxElevation)&&void 0!==s?s:Math.max(0,i)}const c=1<<t.z;return new Ie([n+t.x/c,t.y/c,o],[n+(t.x+1)/c,(t.y+1)/c,l])}allowVariableZoom(t,n){const i=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,r=e.ah(78.5-i/2,0,60);return!!n.terrain||t.pitch>r}allowWorldCopies(){return!0}prepareNextFrame(){}}class ze{constructor(t,e,n){this.points=t,this.planes=e,this.aabb=n}static fromInvProjectionMatrix(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const s=a?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],o=Math.pow(2,i),l=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(i=>function(t,n,i,r){const a=e.aw([],t,n),s=1/a[3]/i*r;return e.aY(a,a,[s,s,1/a[3],s])}(i,t,n,o));r&&function(t,n,i,r){const a=r?4:0,s=r?0:4;let o=0;const l=[],c=[];for(let d=0;d<4;d++){const n=e.aU([],t[d+s],t[d+a]),i=e.aZ(n);e.aR(n,n,1/i),l.push(i),c.push(n)}for(let d=0;d<4;d++){const n=e.a_(t[d+a],c[d],i);o=null!==n&&n>=0?Math.max(o,n):Math.max(o,l[d])}const u=function(t,n){const i=e.aU([],t[n[0]],t[n[1]]),r=e.aU([],t[n[2]],t[n[1]]),a=[0,0,0,0];return e.aV(a,e.aW([],i,r)),a[3]=-e.aX(a,t[n[0]]),a}(t,n),h=function(t,n){const i=e.a$(t),r=e.b0([],t,1/i),a=e.aU([],n,e.aR([],r,e.aX(n,r))),s=e.a$(a);if(s>0){const t=Math.sqrt(1-r[3]*r[3]),i=e.aR([],r,-r[3]),o=e.aS([],i,e.aR([],a,t/s));return e.b1(n,o)}return null}(i,u);if(null!==h){const t=h/e.aX(c[0],u);o=Math.min(o,t)}for(let e=0;e<4;e++){const n=Math.min(o,l[e]);t[e+s]=[t[e+a][0]+c[e][0]*n,t[e+a][1]+c[e][1]*n,t[e+a][2]+c[e][2]*n,1]}}(l,s[0],r,a);const c=s.map(t=>{const n=e.aU([],l[t[0]],l[t[1]]),i=e.aU([],l[t[2]],l[t[1]]),r=e.aV([],e.aW([],n,i)),a=-e.aX(r,l[t[1]]);return r.concat(a)}),u=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],h=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const e of l)for(let t=0;t<3;t++)u[t]=Math.min(u[t],e[t]),h[t]=Math.max(h[t],e[t]);return new ze(l,c,new Ie(u,h))}}class Ne{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,e,n){return this._helper.interpolatePadding(t,e,n)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._helper.resize(t,e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,e){this._helper.overrideNearFarZ(t,e)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,e){}constructor(t,e,n,i,r){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ce({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,e)=>this.getConstrained(t,e)},t,e,n,i,r),this._coveringTilesDetailsProvider=new Le}clone(){const t=new Ne;return t.apply(this),t}apply(t,e,n){this._helper.apply(t,e,n)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const n=[new e.b2(0,t)];if(this._helper._renderWorldCopies){const i=this.screenPointToMercatorCoordinate(new e.P(0,0)),r=this.screenPointToMercatorCoordinate(new e.P(this._helper._width,0)),a=this.screenPointToMercatorCoordinate(new e.P(this._helper._width,this._helper._height)),s=this.screenPointToMercatorCoordinate(new e.P(0,this._helper._height)),o=Math.floor(Math.min(i.x,r.x,a.x,s.x)),l=Math.floor(Math.max(i.x,r.x,a.x,s.x)),c=1;for(let u=o-c;u<=l+c;u++)0!==u&&n.push(new e.b2(u,t))}return n}getCameraFrustum(){return ze.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const e=this.screenPointToLocation(this.centerPoint,t),n=t?t.getElevationForLngLatZoom(e,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(n)}setLocationAtPoint(t,n){const i=e.aj(this.elevation,this.center.lat),r=this.screenPointToMercatorCoordinateAtZ(n,i),a=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,i),s=e.a1.fromLngLat(t),o=new e.a1(s.x-(r.x-a.x),s.y-(r.y-a.y));this.setCenter(null==o?void 0:o.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,n){return n?this.coordinatePoint(e.a1.fromLngLat(t),n.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(e.a1.fromLngLat(t))}screenPointToLocation(t,e){var n;return null===(n=this.screenPointToMercatorCoordinate(t,e))||void 0===n?void 0:n.toLngLat()}screenPointToMercatorCoordinate(t,e){if(e){const n=e.pointCoordinate(t);if(null!=n)return n}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,n){const i=n||0,r=[t.x,t.y,0,1],a=[t.x,t.y,1,1];e.aw(r,r,this._pixelMatrixInverse),e.aw(a,a,this._pixelMatrixInverse);const s=r[3],o=a[3],l=r[1]/s,c=a[1]/o,u=r[2]/s,h=a[2]/o,d=u===h?0:(i-u)/(h-u);return new e.a1(e.C.number(r[0]/s,a[0]/o,d)/this.worldSize,e.C.number(l,c,d)/this.worldSize,i)}coordinatePoint(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._pixelMatrix;const r=[t.x*this.worldSize,t.y*this.worldSize,n,1];return e.aw(r,r,i),new e.P(r[0]/r[3],r[1]/r[3])}getBounds(){const t=Math.max(0,this._helper._height/2-ut(this));return(new q).extend(this.screenPointToLocation(new e.P(0,t))).extend(this.screenPointToLocation(new e.P(this._helper._width,t))).extend(this.screenPointToLocation(new e.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new e.P(0,this._helper._height)))}isPointOnMapSurface(t,e){return e?null!=e.pointCoordinate(t):t.y>this.height/2-ut(this)}calculatePosMatrix(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;var r;const a=null!==(r=t.key)&&void 0!==r?r:e.b3(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),s=n?this._alignedPosMatrixCache:this._posMatrixCache;if(s.has(a)){const t=s.get(a);return i?t.f32:t.f64}const o=ht(t,this.worldSize);e.O(o,n?this._alignedProjMatrix:this._viewProjMatrix,o);const l={f64:o,f32:new Float32Array(o)};return s.set(a,l),i?l.f32:l.f64}calculateFogMatrix(t){const n=t.key,i=this._fogMatrixCacheF32;if(i.has(n))return i.get(n);const r=ht(t,this.worldSize);return e.O(r,this._fogMatrix,r),i.set(n,new Float32Array(r)),i.get(n)}getConstrained(t,n){n=e.ah(+n,this.minZoom,this.maxZoom);const i={center:new e.S(t.lng,t.lat),zoom:n};let r=this._helper._lngRange;if(!this._helper._renderWorldCopies&&null===r){const t=180-1e-10;r=[-t,t]}const a=this.tileSize*e.af(i.zoom);let s=0,o=a,l=0,c=a,u=0,h=0;const{x:d,y:f}=this.size;if(this._helper._latRange){const t=this._helper._latRange;s=e.U(t[1])*a,o=e.U(t[0])*a,o-s<f&&(u=f/(o-s))}r&&(l=e.aO(e.V(r[0])*a,0,a),c=e.aO(e.V(r[1])*a,0,a),c<l&&(c+=a),c-l<d&&(h=d/(c-l)));const{x:p,y:m}=lt(a,t);let g,_;const y=Math.max(h||0,u||0);if(y){const t=new e.P(h?(c+l)/2:p,u?(o+s)/2:m);return i.center=ct(a,t).wrap(),i.zoom+=e.ak(y),i}if(this._helper._latRange){const t=f/2;m-t<s&&(_=s+t),m+t>o&&(_=o-t)}if(r){const t=(l+c)/2;let n=p;this._helper._renderWorldCopies&&(n=e.aO(p,t-a/2,t+a/2));const i=d/2;n-i<l&&(g=l+i),n+i>c&&(g=c-i)}if(void 0!==g||void 0!==_){const t=new e.P(null!=g?g:p,null!=_?_:m);i.center=ct(a,t).wrap()}return i}calculateCenterFromCameraLngLatAlt(t,e,n,i){return this._helper.calculateCenterFromCameraLngLatAlt(t,e,n,i)}_calculateNearFarZIfNeeded(t,n,i){if(!this._helper.autoCalculateNearFarZ)return;const r=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),a=t-r*this._helper._pixelPerMeter/Math.cos(n),s=r<0?a:t,o=Math.PI/2+this.pitchInRadians,l=e.ae(this.fov)*(Math.abs(Math.cos(e.ae(this.roll)))*this.height+Math.abs(Math.sin(e.ae(this.roll)))*this.width)/this.height*(.5+i.y/this.height),c=Math.sin(l)*s/Math.sin(e.ah(Math.PI-o-l,.01,Math.PI-.01)),u=ut(this),h=Math.atan(u/this._helper.cameraToCenterDistance),d=e.ae(.75),f=h>d?2*h*(.5+i.y/(2*u)):d,p=Math.sin(f)*s/Math.sin(e.ah(Math.PI-o-f,.01,Math.PI-.01)),m=Math.min(c,p);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*m+s),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,n=lt(this.worldSize,this.center),i=n.x,r=n.y;this._helper._pixelPerMeter=e.aj(1,this.center.lat)*this.worldSize;const a=e.ae(Math.min(this.pitch,ot)),s=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(a));let o;this._calculateNearFarZIfNeeded(s,a,t),o=new Float64Array(16),e.b4(o,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),e.aq(this._invProjMatrix,o),o[8]=2*-t.x/this._helper._width,o[9]=2*t.y/this._helper._height,this._projectionMatrix=e.b5(o),e.N(o,o,[1,-1,1]),e.M(o,o,[0,0,-this._helper.cameraToCenterDistance]),e.b6(o,o,-this.rollInRadians),e.b7(o,o,this.pitchInRadians),e.b6(o,o,-this.bearingInRadians),e.M(o,o,[-i,-r,0]),this._mercatorMatrix=e.N([],o,[this.worldSize,this.worldSize,this.worldSize]),e.N(o,o,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=e.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,o),e.M(o,o,[0,0,-this.elevation]),this._viewProjMatrix=o,this._invViewProjMatrix=e.aq([],o);const l=[0,0,-1,1];e.aw(l,l,this._invViewProjMatrix),this._cameraPosition=[l[0]/l[3],l[1]/l[3],l[2]/l[3]],this._fogMatrix=new Float64Array(16),e.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,s,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,e.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),e.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),e.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),e.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),e.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),e.M(this._fogMatrix,this._fogMatrix,[-i,-r,0]),e.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),e.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=e.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,o);const c=this._helper._width%2/2,u=this._helper._height%2/2,h=Math.cos(this.bearingInRadians),d=Math.sin(-this.bearingInRadians),f=i-Math.round(i)+h*c+d*u,p=r-Math.round(r)+h*u+d*c,m=new Float64Array(o);if(e.M(m,m,[f>.5?f-1:f,p>.5?p-1:p,0]),this._alignedProjMatrix=m,o=e.aq(new Float64Array(16),this._pixelMatrix),!o)throw new Error("failed to invert matrix");this._pixelMatrixInverse=o,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new e.P(0,0)),n=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.aw(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=e.aj(1,this.center.lat)*this.worldSize;return dt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,n){const i=e.a1.fromLngLat(t),r=[i.x*this.worldSize,i.y*this.worldSize,n,1];return e.aw(r,r,this._viewProjMatrix),r[2]/r[3]}getProjectionData(t){const{overscaledTileID:n,aligned:i,applyTerrainMatrix:r}=t,a=this._helper.getMercatorTileCoordinates(n),s=n?this.calculatePosMatrix(n,i,!0):null;let o;return o=n&&n.terrainRttPosMatrix32f&&r?n.terrainRttPosMatrix32f:s||e.b8(),{mainMatrix:o,tileMercatorCoords:a,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:o}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,e,n){return 1}transformLightDirection(t){return e.aT(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,n,i,r){const a=this.calculatePosMatrix(i);let s;r?(s=[t,n,r(t,n),1],e.aw(s,s,a)):(s=[t,n,0,1],Wt(s,s,a));const o=s[3];return{point:new e.P(s[0]/o,s[1]/o),signedDistanceFromCamera:o,isOccluded:!1}}populateCache(t){for(const e of t)this.calculatePosMatrix(e)}getMatrixForModel(t,n){const i=e.a1.fromLngLat(t,n),r=i.meterInMercatorCoordinateUnits(),a=e.b9();return e.M(a,a,[i.x,i.y,i.z]),e.b6(a,a,Math.PI),e.b7(a,a,Math.PI/2),e.N(a,a,[-r,r,r]),a}getProjectionDataForCustomLayer(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const n=new e.Z(0,0,0,0,0),i=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:t}),r=ht(n,this.worldSize);e.O(r,this._viewProjMatrix,r),i.tileMercatorCoords=[0,0,1,1];const a=[e.$,e.$,this.worldSize/this._helper.pixelsPerMeter],s=e.ba();return e.N(s,r,a),i.fallbackMatrix=s,i.mainMatrix=s,i}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function De(){e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Re(t){if(t.useSlerp)if(t.k<1){const n=e.bb(t.startEulerAngles.roll,t.startEulerAngles.pitch,t.startEulerAngles.bearing),i=e.bb(t.endEulerAngles.roll,t.endEulerAngles.pitch,t.endEulerAngles.bearing),r=new Float64Array(4);e.bc(r,n,i,t.k);const a=e.bd(r);t.tr.setRoll(a.roll),t.tr.setPitch(a.pitch),t.tr.setBearing(a.bearing)}else t.tr.setRoll(t.endEulerAngles.roll),t.tr.setPitch(t.endEulerAngles.pitch),t.tr.setBearing(t.endEulerAngles.bearing);else t.tr.setRoll(e.C.number(t.startEulerAngles.roll,t.endEulerAngles.roll,t.k)),t.tr.setPitch(e.C.number(t.startEulerAngles.pitch,t.endEulerAngles.pitch,t.k)),t.tr.setBearing(e.C.number(t.startEulerAngles.bearing,t.endEulerAngles.bearing,t.k))}function Fe(t,n,i,r,a){const s=a.padding,o=lt(a.worldSize,i.getNorthWest()),l=lt(a.worldSize,i.getNorthEast()),c=lt(a.worldSize,i.getSouthEast()),u=lt(a.worldSize,i.getSouthWest()),h=e.ae(-r),d=o.rotate(h),f=l.rotate(h),p=c.rotate(h),m=u.rotate(h),g=new e.P(Math.max(d.x,f.x,m.x,p.x),Math.max(d.y,f.y,m.y,p.y)),_=new e.P(Math.min(d.x,f.x,m.x,p.x),Math.min(d.y,f.y,m.y,p.y)),y=g.sub(_),v=(a.width-(s.left+s.right+n.left+n.right))/y.x,b=(a.height-(s.top+s.bottom+n.top+n.bottom))/y.y;if(b<0||v<0)return void De();const x=Math.min(e.ak(a.scale*Math.min(v,b)),t.maxZoom),w=e.P.convert(t.offset),S=new e.P((n.left-n.right)/2,(n.top-n.bottom)/2).rotate(e.ae(r)),P=w.add(S).mult(a.scale/e.af(x));return{center:ct(a.worldSize,o.add(c).div(2).sub(P)),zoom:x,bearing:r}}class Oe{get useGlobeControls(){return!1}handlePanInertia(t,e){const n=t.mag(),i=Math.abs(ut(e));return{easingOffset:t.mult(Math.min(.75*i/n,1)),easingCenter:e.center}}handleMapControlsRollPitchBearingZoom(t,e){t.bearingDelta&&e.setBearing(e.bearing+t.bearingDelta),t.pitchDelta&&e.setPitch(e.pitch+t.pitchDelta),t.rollDelta&&e.setRoll(e.roll+t.rollDelta),t.zoomDelta&&e.setZoom(e.zoom+t.zoomDelta)}handleMapControlsPan(t,e,n){t.around.distSqr(e.centerPoint)<.01||e.setLocationAtPoint(n,t.around)}cameraForBoxAndBearing(t,e,n,i,r){return Fe(t,e,n,i,r)}handleJumpToCenterZoom(t,n){t.zoom!==(void 0!==n.zoom?+n.zoom:t.zoom)&&t.setZoom(+n.zoom),void 0!==n.center&&t.setCenter(e.S.convert(n.center))}handleEaseTo(t,n){const i=t.zoom,r=t.padding,a={roll:t.roll,pitch:t.pitch,bearing:t.bearing},s={roll:void 0===n.roll?t.roll:n.roll,pitch:void 0===n.pitch?t.pitch:n.pitch,bearing:void 0===n.bearing?t.bearing:n.bearing},o=void 0!==n.zoom,l=!t.isPaddingEqual(n.padding);let c=!1;const u=o?+n.zoom:t.zoom;let h=t.centerPoint.add(n.offsetAsPoint);const d=t.screenPointToLocation(h),{center:f,zoom:p}=t.getConstrained(e.S.convert(n.center||d),null!=u?u:i);Ee(t,f);const m=lt(t.worldSize,d),g=lt(t.worldSize,f).sub(m),_=e.af(p-i);return c=p!==i,{easeFunc:o=>{if(c&&t.setZoom(e.C.number(i,p,o)),e.be(a,s)||Re({startEulerAngles:a,endEulerAngles:s,tr:t,k:o,useSlerp:a.roll!=s.roll}),l&&(t.interpolatePadding(r,n.padding,o),h=t.centerPoint.add(n.offsetAsPoint)),n.around)t.setLocationAtPoint(n.around,n.aroundPoint);else{const n=e.af(t.zoom-i),r=p>i?Math.min(2,_):Math.max(.5,_),a=Math.pow(r,1-o),s=ct(t.worldSize,m.add(g.mult(o*a)).mult(n));t.setLocationAtPoint(t.renderWorldCopies?s.wrap():s,h)}},isZooming:c,elevationCenter:f}}handleFlyTo(t,n){const i=void 0!==n.zoom,r=t.zoom,a=t.getConstrained(e.S.convert(n.center||n.locationAtOffset),i?+n.zoom:r),s=a.center,o=a.zoom;Ee(t,s);const l=lt(t.worldSize,n.locationAtOffset),c=lt(t.worldSize,s).sub(l),u=c.mag(),h=e.af(o-r);let d;if(void 0!==n.minZoom){const i=Math.min(+n.minZoom,r,o),a=t.getConstrained(s,i).zoom;d=e.af(a-r)}return{easeFunc:(n,i,a,u)=>{t.setZoom(1===n?o:r+e.ak(i));const h=1===n?s:ct(t.worldSize,l.add(c.mult(a)).mult(i));t.setLocationAtPoint(t.renderWorldCopies?h.wrap():h,u)},scaleOfZoom:h,targetCenter:s,scaleOfMinZoom:d,pixelPathLength:u}}}class Be{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}Be.Replace=[1,0],Be.disabled=new Be(Be.Replace,e.bf.transparent,[!1,!1,!1,!1]),Be.unblended=new Be(Be.Replace,e.bf.transparent,[!0,!0,!0,!0]),Be.alphaBlended=new Be([1,771],e.bf.transparent,[!0,!0,!0,!0]);const je=2305;class Ue{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}Ue.disabled=new Ue(!1,1029,je),Ue.backCCW=new Ue(!0,1029,je),Ue.frontCCW=new Ue(!0,1028,je);class Ge{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}Ge.ReadOnly=!1,Ge.ReadWrite=!0,Ge.disabled=new Ge(519,Ge.ReadOnly,[0,1]);const qe=7680;class Ve{constructor(t,e,n,i,r,a){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=a}}Ve.disabled=new Ve({func:519,mask:0},0,0,qe,qe,qe);const Ze=new WeakMap;function We(t){var e;if(Ze.has(t))return Ze.get(t);{const n=null===(e=t.getParameter(t.VERSION))||void 0===e?void 0:e.startsWith("WebGL 2.0");return Ze.set(t,n),n}}class He{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const n=t.context,i=n.gl;this._texFormat=i.RGBA,this._texType=i.UNSIGNED_BYTE;const r=new e.aL;r.emplaceBack(-1,-1),r.emplaceBack(2,-1),r.emplaceBack(-1,2);const a=new e.aN;a.emplaceBack(0,1,2),this._fullscreenTriangle=new we(n.createVertexBuffer(r,Se.members),n.createIndexBuffer(a),e.aM.simpleSegment(0,0,r.length,a.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(i.TEXTURE1);const s=i.createTexture();i.bindTexture(i.TEXTURE_2D,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texImage2D(i.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(s),We(i)&&(this._pbo=i.createBuffer(),i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.bufferData(i.PIXEL_PACK_BUFFER,4,i.STREAM_READ),i.bindBuffer(i.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,e){const n=this._updateCount;return this._readbackQueue?n>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():n>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,e),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,e=t.gl;t.activeTexture.set(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,n){const i=this._cachedRenderContext.context,r=i.gl;if(this._bindFramebuffer(),i.viewport.set([0,0,this._texWidth,this._texHeight]),i.clear({color:e.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(i,r.TRIANGLES,Ge.disabled,Ve.disabled,Be.unblended,Ue.disabled,((t,e)=>({u_input:t,u_output_expected:e}))(t,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&We(r)){r.bindBuffer(r.PIXEL_PACK_BUFFER,this._pbo),r.readBuffer(r.COLOR_ATTACHMENT0),r.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),r.bindBuffer(r.PIXEL_PACK_BUFFER,null);const t=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);r.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:t}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&We(t)){const n=t.clientWaitSync(this._readbackQueue.sync,0,0);if(n===t.WAIT_FAILED)return e.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=He._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let e=0;return e+=t[0]/256,e+=t[1]/65536,e+=t[2]/16777216,t[3]<127&&(e=-e),e/128}}const Xe=e.$/128;function Ye(t,n){const i=void 0!==t.granularity?Math.max(t.granularity,1):1,r=i+(t.generateBorders?2:0),a=i+(t.extendToNorthPole||t.generateBorders?1:0)+(t.extendToSouthPole||t.generateBorders?1:0),s=r+1,o=a+1,l=t.generateBorders?-1:0,c=t.generateBorders||t.extendToNorthPole?-1:0,u=i+(t.generateBorders?1:0),h=i+(t.generateBorders||t.extendToSouthPole?1:0),d=s*o,f=r*a*6,p=s*o>65536;if(p&&"16bit"===n)throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const m=p||"32bit"===n,g=new Int16Array(2*d);let _=0;for(let b=c;b<=h;b++)for(let n=l;n<=u;n++){let r=n/i*e.$;-1===n&&(r=-Xe),n===i+1&&(r=e.$+Xe);let a=b/i*e.$;-1===b&&(a=t.extendToNorthPole?e.bh:-Xe),b===i+1&&(a=t.extendToSouthPole?e.bi:e.$+Xe),g[_++]=r,g[_++]=a}const y=m?new Uint32Array(f):new Uint16Array(f);let v=0;for(let e=0;e<a;e++)for(let t=0;t<r;t++){const n=t+1+e*s,i=t+(e+1)*s,r=t+1+(e+1)*s;y[v++]=t+e*s,y[v++]=i,y[v++]=n,y[v++]=n,y[v++]=i,y[v++]=r}return{vertices:g.buffer.slice(0),indices:y.buffer.slice(0),uses32bitIndices:m}}const Ke=new e.aK({fill:new e.bj(128,2),line:new e.bj(512,0),tile:new e.bj(128,32),stencil:new e.bj(128,1),circle:3});class Je{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return be.projectionGlobe}get vertexShaderPreludeCode(){return be.projectionMercator.vertexSource}get subdivisionGranularity(){return Ke}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new He(t));const n=e.U(this._errorQueryLatitudeDegrees),i=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,r=this._errorMeasurement.updateErrorLoop(n,i),a=s.now();r!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=r,this._errorMeasurementLastChangeTime=a);const o=Math.min(Math.max((a-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=e.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,e.bl(o))}_getMeshKey(t){return"".concat(t.granularity.toString(36),"_").concat(t.generateBorders?"b":"").concat(t.extendToNorthPole?"n":"").concat(t.extendToSouthPole?"s":"")}getMeshFromTileID(t,e,n,i,r){const a=("stencil"===r?Ke.stencil:Ke.tile).getGranularityForZoomLevel(e.z);return this._getMesh(t,{granularity:a,generateBorders:n,extendToNorthPole:0===e.y&&i,extendToSouthPole:e.y===(1<<e.z)-1&&i})}_getMesh(t,n){const i=this._getMeshKey(n);if(i in this._tileMeshCache)return this._tileMeshCache[i];const r=function(t,n){const i=Ye(n,"16bit"),r=e.aL.deserialize({arrayBuffer:i.vertices,length:i.vertices.byteLength/2/2}),a=e.aN.deserialize({arrayBuffer:i.indices,length:i.indices.byteLength/2/3});return new we(t.createVertexBuffer(r,Se.members),t.createIndexBuffer(a),e.aM.simpleSegment(0,0,r.length,a.length))}(t,n);return this._tileMeshCache[i]=r,r}recalculate(t){}hasTransition(){const t=s.now();let e=!1;return e=e||(t-this._errorMeasurementLastChangeTime)/1e3<.7,e=e||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,e}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const $e=new e.r({type:new e.D(e.v.projection.type)});class Qe extends e.E{constructor(t){super(),this._transitionable=new e.t($e,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new e.F(0)),this._mercatorProjection=new Ae,this._verticalPerspectiveProjection=new Je}get transitionState(){const t=this.properties.get("type");if("string"==typeof t&&"mercator"===t)return 0;if("string"==typeof t&&"vertical-perspective"===t)return 1;if(t instanceof e.bm){if("vertical-perspective"===t.from&&"mercator"===t.to)return 1-t.transition;if("mercator"===t.from&&"vertical-perspective"===t.to)return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,e,n,i,r){return this.currentProjection.getMeshFromTileID(t,e,n,i,r)}setProjection(t){this._transitionable.setValue("type",(null==t?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function tn(t){const e=rn(t.worldSize,t.center.lat);return 2*Math.PI*e}function en(t,n,i,r,a){const s=1/(1<<a),o=n/e.$*s+r*s,l=e.bo((t/e.$*s+i*s)*Math.PI*2+Math.PI,2*Math.PI),c=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,u=Math.cos(c),h=new Float64Array(3);return h[0]=Math.sin(l)*u,h[1]=Math.sin(c),h[2]=Math.cos(l)*u,h}function nn(t){return function(t,e){const n=Math.cos(e),i=new Float64Array(3);return i[0]=Math.sin(t)*n,i[1]=Math.sin(e),i[2]=Math.cos(t)*n,i}(t.lng*Math.PI/180,t.lat*Math.PI/180)}function rn(t,e){return t/(2*Math.PI)/Math.cos(e*Math.PI/180)}function an(t){const n=Math.asin(t[1])/Math.PI*180,i=Math.sqrt(t[0]*t[0]+t[2]*t[2]);if(i>1e-6){const r=t[0]/i,a=Math.acos(t[2]/i),s=(r>0?a:-a)/Math.PI*180;return new e.S(e.aO(s,-180,180),n)}return new e.S(0,n)}function sn(t){return Math.cos(t*Math.PI/180)}function on(t,n){const i=sn(t),r=sn(n);return e.ak(r/i)}function ln(t,n){const i=t.rotate(n.bearingInRadians),r=n.zoom+on(n.center.lat,0),a=e.bk(1/sn(n.center.lat),1/sn(Math.min(Math.abs(n.center.lat),60)),e.bn(r,7,3,0,1)),s=360/tn({worldSize:n.worldSize,center:{lat:n.center.lat}});return new e.S(n.center.lng-i.x*s*a,e.ah(n.center.lat+i.y*s,-e.ai,e.ai))}function cn(t){const e=.5*t,n=Math.sin(e),i=Math.cos(e);return Math.log(n+i)-Math.log(i-n)}function un(t,n,i,r){const a=t.lat+i*r;if(Math.abs(i)>1){const s=(Math.sign(t.lat+i)!==Math.sign(t.lat)?-Math.abs(t.lat):Math.abs(t.lat))*Math.PI/180,o=Math.abs(t.lat+i)*Math.PI/180,l=cn(s+r*(o-s)),c=cn(s),u=cn(o);return new e.S(t.lng+n*((l-c)/(u-c)),a)}return new e.S(t.lng+n*r,a)}class hn{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,e,n,i){const r="".concat(t.z,"_").concat(t.x,"_").concat(t.y,"_").concat((null==i?void 0:i.terrain)?"t":""),a=this._cache.get(r);if(a)return a;const s=this._cachePrevious.get(r);if(s)return this._cache.set(r,s),s;const o=this._boundingVolumeFactory(t,e,n,i);return this._cache.set(r,o),this._hadAnyChanges=!0,o}}class dn{constructor(t,e,n,i){this.min=n,this.max=i,this.points=t,this.planes=e}static fromAabb(t,e){const n=[];for(let i=0;i<8;i++)n.push([1&~i?t[0]:e[0],1==(i>>1&1)?e[1]:t[1],1==(i>>2&1)?e[2]:t[2]]);return new dn(n,[[-1,0,0,e[0]],[1,0,0,-t[0]],[0,-1,0,e[1]],[0,1,0,-t[1]],[0,0,-1,e[2]],[0,0,1,-t[2]]],t,e)}static fromCenterSizeAngles(t,n,i){const r=e.br([],i[0],i[1],i[2]),a=e.bs([],[n[0],0,0],r),s=e.bs([],[0,n[1],0],r),o=e.bs([],[0,0,n[2]],r),l=[...t],c=[...t];for(let e=0;e<8;e++)for(let n=0;n<3;n++){const i=t[n]+a[n]*(1&~e?-1:1)+s[n]*(1==(e>>1&1)?1:-1)+o[n]*(1==(e>>2&1)?1:-1);l[n]=Math.min(l[n],i),c[n]=Math.max(c[n],i)}const u=[];for(let h=0;h<8;h++){const n=[...t];e.aS(n,n,e.aR([],a,1&~h?-1:1)),e.aS(n,n,e.aR([],s,1==(h>>1&1)?1:-1)),e.aS(n,n,e.aR([],o,1==(h>>2&1)?1:-1)),u.push(n)}return new dn(u,[[...a,-e.aX(a,u[0])],[...s,-e.aX(s,u[0])],[...o,-e.aX(o,u[0])],[-a[0],-a[1],-a[2],-e.aX(a,u[7])],[-s[0],-s[1],-s[2],-e.aX(s,u[7])],[-o[0],-o[1],-o[2],-e.aX(o,u[7])]],l,c)}intersectsFrustum(t){let e=!0;const n=this.points.length,i=this.planes.length,r=t.planes.length,a=t.points.length;for(let s=0;s<r;s++){const i=t.planes[s];let r=0;for(let t=0;t<n;t++){const e=this.points[t];i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]>=0&&r++}if(0===r)return 0;r<n&&(e=!1)}if(e)return 2;for(let s=0;s<i;s++){const e=this.planes[s];let n=0;for(let i=0;i<a;i++){const r=t.points[i];e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]>=0&&n++}if(0===n)return 0}return 1}intersectsPlane(t){const e=this.points.length;let n=0;for(let i=0;i<e;i++){const e=this.points[i];t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]>=0&&n++}return n===e?2:0===n?0:1}}function fn(t,e,n){const i=t-e;return i<0?-i:Math.max(0,i-n)}function pn(t,e,n,i,r){const a=t-n;let s;return s=a<0?Math.min(-a,1+a-r):a>1?Math.min(Math.max(a-r,0),1-a):0,Math.max(s,fn(e,i,r))}class mn{constructor(){this._boundingVolumeCache=new hn(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,e,n,i){const r=1<<n.z,a=1/r,s=n.x/r,o=n.y/r;let l=2;return l=Math.min(l,pn(t,e,s,o,a)),l=Math.min(l,pn(t,e,s+.5,-o-a,a)),l=Math.min(l,pn(t,e,s+.5,2-o-a,a)),l}getWrap(t,e,n){const i=1<<e.z,r=1/i,a=e.x/i,s=fn(t.x,a,r),o=fn(t.x,a-1,r),l=fn(t.x,a+1,r),c=Math.min(s,o,l);return c===l?1:c===o?-1:0}allowVariableZoom(t,e){return _t(t,e)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,e,n,i){return this._boundingVolumeCache.getTileBoundingVolume(t,e,n,i)}_computeTileBoundingVolume(t,n,i,r){var a,s;let o=0,l=0;if(null==r?void 0:r.terrain){const c=new e.Z(t.z,n,t.z,t.x,t.y),u=r.terrain.getMinMaxElevation(c);o=null!==(a=u.minElevation)&&void 0!==a?a:Math.min(0,i),l=null!==(s=u.maxElevation)&&void 0!==s?s:Math.max(0,i)}if(o/=e.bu,l/=e.bu,o+=1,l+=1,t.z<=0)return dn.fromAabb([-l,-l,-l],[l,l,l]);if(1===t.z)return dn.fromAabb([0===t.x?-l:0,0===t.y?0:-l,-l],[0===t.x?0:l,0===t.y?l:0,l]);{const n=[en(0,0,t.x,t.y,t.z),en(e.$,0,t.x,t.y,t.z),en(e.$,e.$,t.x,t.y,t.z),en(0,e.$,t.x,t.y,t.z)],i=[];for(const t of n)i.push(e.aR([],t,l));if(l!==o)for(const t of n)i.push(e.aR([],t,o));0===t.y&&i.push([0,1,0]),t.y===(1<<t.z)-1&&i.push([0,-1,0]);const r=[1,1,1],a=[-1,-1,-1];for(const t of i)for(let e=0;e<3;e++)r[e]=Math.min(r[e],t[e]),a[e]=Math.max(a[e],t[e]);const s=en(e.$/2,e.$/2,t.x,t.y,t.z),c=e.aW([],[0,1,0],s);e.aV(c,c);const u=e.aW([],s,c);e.aV(u,u);const h=e.aW([],n[2],n[1]);e.aV(h,h);const d=e.aW([],n[0],n[3]);e.aV(d,d),i.push(e.aR([],s,l)),t.y>=(1<<t.z)/2&&i.push(e.aR([],en(e.$/2,0,t.x,t.y,t.z),l)),t.y<(1<<t.z)/2&&i.push(e.aR([],en(e.$/2,e.$,t.x,t.y,t.z),l));const f=gn(s,i),p=gn(u,i),m=[-s[0],-s[1],-s[2],f.max],g=[s[0],s[1],s[2],-f.min],_=[-u[0],-u[1],-u[2],p.max],y=[u[0],u[1],u[2],-p.min],v=[...h,0],b=[...d,0],x=[];return 0===t.y?x.push(e.bt(b,v,m),e.bt(b,v,g)):x.push(e.bt(_,v,m),e.bt(_,v,g),e.bt(_,b,m),e.bt(_,b,g)),t.y===(1<<t.z)-1?x.push(e.bt(b,v,m),e.bt(b,v,g)):x.push(e.bt(y,v,m),e.bt(y,v,g),e.bt(y,b,m),e.bt(y,b,g)),new dn(x,[m,g,_,y,v,b],r,a)}}}function gn(t,n){let i=1/0,r=-1/0;for(const a of n){const n=e.aX(t,a);i=Math.min(i,n),r=Math.max(r,n)}return{min:i,max:r}}class _n{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,e,n){return this._helper.interpolatePadding(t,e,n)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,e){this._helper.resize(t,e)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,e){this._helper.overrideNearFarZ(t,e)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=e.bv(),this._projectionMatrix=e.b9(),this._globeViewProjMatrix32f=e.b8(),this._globeViewProjMatrixNoCorrection=e.b9(),this._globeViewProjMatrixNoCorrectionInverted=e.b9(),this._globeProjMatrixInverted=e.b9(),this._cameraPosition=e.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ce({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,e)=>this.getConstrained(t,e)}),this._coveringTilesDetailsProvider=new mn}clone(){const t=new _n;return t.apply(this),t}apply(t,e){this._globeLatitudeErrorCorrectionRadians=e||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=e.bp();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:e,applyGlobeMatrix:n}=t,i=this._helper.getMercatorTileCoordinates(e);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:i,clippingPlane:this._cachedClippingPlane,projectionTransition:n?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const n=this.pitchInRadians,i=this.cameraToCenterDistance/t,r=Math.sin(n)*i,a=Math.cos(n)*i+1,s=1/Math.sqrt(r*r+a*a)*1;let o=-r,l=a;const c=Math.sqrt(o*o+l*l);o/=c,l/=c;const u=[0,o,l];e.bw(u,u,[0,0,0],-this.bearingInRadians),e.bx(u,u,[0,0,0],-1*this.center.lat*Math.PI/180),e.by(u,u,[0,0,0],this.center.lng*Math.PI/180);const h=1/e.aZ(u);return e.aR(u,u,h),[...u,-s*h]}isLocationOccluded(t){return!this.isSurfacePointVisible(nn(t))}transformLightDirection(t){const n=this._helper._center.lng*Math.PI/180,i=this._helper._center.lat*Math.PI/180,r=Math.cos(i),a=[Math.sin(n)*r,Math.sin(i),Math.cos(n)*r],s=[a[2],0,-a[0]],o=[0,0,0];e.aW(o,s,a),e.aV(s,s),e.aV(o,o);const l=[0,0,0];return e.aV(l,[s[0]*t[0]+o[0]*t[1]+a[0]*t[2],s[1]*t[0]+o[1]*t[1]+a[1]*t[2],s[2]*t[0]+o[2]*t[1]+a[2]*t[2]]),l}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,n,i){const r=function(t,n,i){const r=1/(1<<i.z);return new e.a1(t/e.$*r+i.x*r,n/e.$*r+i.y*r)}(t,n,i.canonical),a=(s=r.y,[e.bo(r.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI]);var s;return this.getCircleRadiusCorrection()/Math.cos(a[1])}projectTileCoordinates(t,n,i,r){const a=i.canonical,s=en(t,n,a.x,a.y,a.z),o=1+(r?r(t,n):0)/e.bu,l=[s[0]*o,s[1]*o,s[2]*o,1];e.aw(l,l,this._globeViewProjMatrixNoCorrection);const c=this._cachedClippingPlane,u=c[0]*s[0]+c[1]*s[1]+c[2]*s[2]+c[3]<0;return{point:new e.P(l[0]/l[3],l[1]/l[3]),signedDistanceFromCamera:l[3],isOccluded:u}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=rn(this.worldSize,this.center.lat),n=e.ba(),i=e.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),e.b4(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const r=this.centerOffset;n[8]=2*-r.x/this._helper._width,n[9]=2*r.y/this._helper._height,this._projectionMatrix=e.b5(n),this._globeProjMatrixInverted=e.ba(),e.aq(this._globeProjMatrixInverted,n),e.M(n,n,[0,0,-this.cameraToCenterDistance]),e.b6(n,n,this.rollInRadians),e.b7(n,n,-this.pitchInRadians),e.b6(n,n,this.bearingInRadians),e.M(n,n,[0,0,-t]);const a=e.bp();a[0]=t,a[1]=t,a[2]=t,e.b7(i,n,this.center.lat*Math.PI/180),e.bz(i,i,-this.center.lng*Math.PI/180),e.N(i,i,a),this._globeViewProjMatrixNoCorrection=i,e.b7(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),e.bz(n,n,-this.center.lng*Math.PI/180),e.N(n,n,a),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=e.ba(),e.aq(this._globeViewProjMatrixNoCorrectionInverted,i);const s=e.bp();this._cameraPosition=e.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/t,e.bw(this._cameraPosition,this._cameraPosition,s,-this.rollInRadians),e.bx(this._cameraPosition,this._cameraPosition,s,this.pitchInRadians),e.bw(this._cameraPosition,this._cameraPosition,s,-this.bearingInRadians),e.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),e.bx(this._cameraPosition,this._cameraPosition,s,-this.center.lat*Math.PI/180),e.by(this._cameraPosition,this._cameraPosition,s,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const o=e.b5(this._globeViewProjMatrixNoCorrectionInverted);e.N(o,o,[1,1,-1]),this._cachedFrustum=ze.fromInvProjectionMatrix(o,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){e.w("calculateFogMatrix is not supported on globe projection.");const n=e.ba();return e.ag(n),n}getVisibleUnwrappedCoordinates(t){return[new e.b2(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&e.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const i=nn(t);e.aR(i,i,1+n/e.bu);const r=e.bv();return e.aw(r,[i[0],i[1],i[2],1],this._globeViewProjMatrixNoCorrection),r[2]/r[3]}populateCache(t){}getBounds(){const t=.5*this.width,n=.5*this.height,i=[new e.P(0,0),new e.P(t,0),new e.P(this.width,0),new e.P(this.width,n),new e.P(this.width,this.height),new e.P(t,this.height),new e.P(0,this.height),new e.P(0,n)],r=[];for(const e of i)r.push(this.unprojectScreenPoint(e));let a=0,s=0,o=0,l=0;const c=this.center;for(const h of r){const t=e.bA(c.lng,h.lng),n=e.bA(c.lat,h.lat);t<s&&(s=t),t>a&&(a=t),n<l&&(l=n),n>o&&(o=n)}const u=[c.lng+s,c.lat+l,c.lng+a,c.lat+o];return this.isSurfacePointOnScreen([0,1,0])&&(u[3]=90,u[0]=-180,u[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(u[1]=-90,u[0]=-180,u[2]=180),new q(u)}getConstrained(t,n){const i=e.ah(t.lat,-e.ai,e.ai),r=e.ah(+n,this.minZoom+on(0,i),this.maxZoom);return{center:new e.S(t.lng,i),zoom:r}}calculateCenterFromCameraLngLatAlt(t,e,n,i){return this._helper.calculateCenterFromCameraLngLatAlt(t,e,n,i)}setLocationAtPoint(t,n){const i=nn(this.unprojectScreenPoint(n)),r=nn(t),a=e.bp();e.bB(a);const s=e.bp();e.by(s,i,a,-this.center.lng*Math.PI/180),e.bx(s,s,a,this.center.lat*Math.PI/180);const o=r[0]*r[0]+r[2]*r[2],l=s[0]*s[0];if(o<l)return;const c=Math.sqrt(o-l),u=-c,h=e.bC(r[0],r[2],s[0],c),d=e.bC(r[0],r[2],s[0],u),f=e.bp();e.by(f,r,a,-h);const p=e.bC(f[1],f[2],s[1],s[2]),m=e.bp();e.by(m,r,a,-d);const g=e.bC(m[1],m[2],s[1],s[2]),_=.5*Math.PI,y=p>=-_&&p<=_,v=g>=-_&&g<=_;let b,x;if(y&&v){const t=this.center.lng*Math.PI/180,n=this.center.lat*Math.PI/180;e.bD(h,t)+e.bD(p,n)<e.bD(d,t)+e.bD(g,n)?(b=h,x=p):(b=d,x=g)}else if(y)b=h,x=p;else{if(!v)return;b=d,x=g}const w=b/Math.PI*180,S=x/Math.PI*180,P=this.center.lat;this.setCenter(new e.S(w,e.ah(S,-90,90))),this.setZoom(this.zoom+on(P,this.center.lat))}locationToScreenPoint(t,n){const i=nn(t);if(n){const r=n.getElevationForLngLatZoom(t,this._helper._tileZoom);e.aR(i,i,1+r/e.bu)}return this._projectSurfacePointToScreen(i)}_projectSurfacePointToScreen(t){const n=e.bv();return e.aw(n,[...t,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new e.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,n){if(n){const e=n.pointCoordinate(t);if(e)return e}return e.a1.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,e){var n;return null===(n=this.screenPointToMercatorCoordinate(t,e))||void 0===n?void 0:n.toLngLat()}isPointOnMapSurface(t,e){const n=this._cameraPosition,i=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(n,i)}getRayDirectionFromPixel(t){const n=e.bv();n[0]=t.x/this.width*2-1,n[1]=-1*(t.y/this.height*2-1),n[2]=1,n[3]=1,e.aw(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const i=e.bp();i[0]=n[0]-this._cameraPosition[0],i[1]=n[1]-this._cameraPosition[1],i[2]=n[2]-this._cameraPosition[2];const r=e.bp();return e.aV(r,i),r}isSurfacePointVisible(t){const e=this._cachedClippingPlane;return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const n=e.bv();return e.aw(n,[...t,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(t,n){const i=e.aX(t,n),r=e.bp(),a=e.bp();e.aR(a,n,i),e.aU(r,t,a);const s=1-e.aX(r,r);if(s<0)return null;const o=e.aX(t,t)-1,l=-i+(i<0?1:-1)*Math.sqrt(s),c=o/l,u=l;return{tMin:Math.min(c,u),tMax:Math.max(c,u)}}unprojectScreenPoint(t){const n=this._cameraPosition,i=this.getRayDirectionFromPixel(t),r=this.rayPlanetIntersection(n,i);if(r){const t=e.bp();e.aS(t,n,[i[0]*r.tMin,i[1]*r.tMin,i[2]*r.tMin]);const a=e.bp();return e.aV(a,t),an(a)}const a=this._cachedClippingPlane,s=a[0]*i[0]+a[1]*i[1]+a[2]*i[2],o=-e.b1(a,n)/s,l=e.bp();if(o>0)e.aS(l,n,[i[0]*o,i[1]*o,i[2]*o]);else{const t=e.bp();e.aS(t,n,[2*i[0],2*i[1],2*i[2]]);const r=e.b1(this._cachedClippingPlane,t);e.aU(l,t,[this._cachedClippingPlane[0]*r,this._cachedClippingPlane[1]*r,this._cachedClippingPlane[2]*r])}const c=function(t){const n=e.bp();return n[0]=t[0]*-t[3],n[1]=t[1]*-t[3],n[2]=t[2]*-t[3],{center:n,radius:Math.sqrt(1-t[3]*t[3])}}(a);return an(function(t,n,i){const r=e.bp();e.aU(r,i,t);const a=e.bp();return e.bq(a,t,r,n/e.a$(r)),a}(c.center,c.radius,l))}getMatrixForModel(t,n){const i=e.S.convert(t),r=1/e.bu,a=e.b9();return e.bz(a,a,i.lng/180*Math.PI),e.b7(a,a,-i.lat/180*Math.PI),e.M(a,a,[0,0,1+n/e.bu]),e.b7(a,a,.5*Math.PI),e.N(a,a,[r,r,r]),a}getProjectionDataForCustomLayer(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const n=this.getProjectionData({overscaledTileID:new e.Z(0,0,0,0,0),applyGlobeMatrix:t});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(t){}}class yn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,e,n){return this._helper.interpolatePadding(t,e,n)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._helper.resize(t,e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,e){this._helper.overrideNearFarZ(t,e)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,e){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=e,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ce({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,e)=>this.getConstrained(t,e)}),this._globeness=1,this._mercatorTransform=new Ne,this._verticalPerspectiveTransform=new _n}clone(){const t=new yn;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const e=this._mercatorTransform.getProjectionData(t),n=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?n.mainMatrix:e.mainMatrix,clippingPlane:n.clippingPlane,tileMercatorCoords:n.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:e.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return e.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return e.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,n,i){const r=this._mercatorTransform.getPitchedTextCorrection(t,n,i),a=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,n,i);return e.bk(r,a,this._globeness)}projectTileCoordinates(t,e,n,i){return this.currentTransform.projectTileCoordinates(t,e,n,i)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,e){return this.currentTransform.lngLatToCameraDepth(t,e)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,e){return this.currentTransform.getConstrained(t,e)}calculateCenterFromCameraLngLatAlt(t,e,n,i){return this._helper.calculateCenterFromCameraLngLatAlt(t,e,n,i)}setLocationAtPoint(t,e){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,e),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,e),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,e){return this.currentTransform.locationToScreenPoint(t,e)}screenPointToMercatorCoordinate(t,e){return this.currentTransform.screenPointToMercatorCoordinate(t,e)}screenPointToLocation(t,e){return this.currentTransform.screenPointToLocation(t,e)}isPointOnMapSurface(t,e){return this.currentTransform.isPointOnMapSurface(t,e)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,e){return this.currentTransform.getMatrixForModel(t,e)}getProjectionDataForCustomLayer(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return e;const n=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return n.fallbackMatrix=e.mainMatrix,n}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class vn{get useGlobeControls(){return!0}handlePanInertia(t,n){const i=ln(t,n);return Math.abs(i.lng-n.center.lng)>180&&(i.lng=n.center.lng+179.5*Math.sign(i.lng-n.center.lng)),{easingCenter:i,easingOffset:new e.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,n){const i=t.around,r=n.screenPointToLocation(i);t.bearingDelta&&n.setBearing(n.bearing+t.bearingDelta),t.pitchDelta&&n.setPitch(n.pitch+t.pitchDelta),t.rollDelta&&n.setRoll(n.roll+t.rollDelta);const a=n.zoom;t.zoomDelta&&n.setZoom(n.zoom+t.zoomDelta);const s=n.zoom-a;if(0===s)return;const o=e.bA(n.center.lng,r.lng),l=o/(Math.abs(o/180)+1),c=e.bA(n.center.lat,r.lat),u=n.getRayDirectionFromPixel(i),h=n.cameraPosition,d=-1*e.aX(h,u),f=e.bp();e.aS(f,h,[u[0]*d,u[1]*d,u[2]*d]);const p=e.aZ(f)-1,m=Math.exp(.5*-Math.max(p-.3,0)),g=rn(n.worldSize,n.center.lat)/Math.min(n.width,n.height),_=e.bn(g,.9,.5,1,.25),y=(1-e.af(-s))*Math.min(m,_),v=n.center.lat,b=n.zoom,x=new e.S(n.center.lng+l*y,e.ah(n.center.lat+c*y,-e.ai,e.ai));n.setLocationAtPoint(r,i);const w=n.center,S=e.bn(Math.abs(o),45,85,0,1),P=e.bn(g,.75,.35,0,1),M=Math.pow(Math.max(S,P),.25),A=e.bA(w.lng,x.lng),k=e.bA(w.lat,x.lat);n.setCenter(new e.S(w.lng+A*M,w.lat+k*M).wrap()),n.setZoom(b+on(v,n.center.lat))}handleMapControlsPan(t,e,n){if(!t.panDelta)return;const i=e.center.lat,r=e.zoom;e.setCenter(ln(t.panDelta,e).wrap()),e.setZoom(r+on(i,e.center.lat))}cameraForBoxAndBearing(t,n,i,r,a){const s=Fe(t,n,i,r,a),o=n.left/a.width*2-1,l=(a.width-n.right)/a.width*2-1,c=n.top/a.height*-2+1,u=(a.height-n.bottom)/a.height*-2+1,h=e.bA(i.getWest(),i.getEast())<0,d=h?i.getEast():i.getWest(),f=h?i.getWest():i.getEast(),p=Math.max(i.getNorth(),i.getSouth()),m=Math.min(i.getNorth(),i.getSouth()),g=d+.5*e.bA(d,f),_=p+.5*e.bA(p,m),y=a.clone();y.setCenter(s.center),y.setBearing(s.bearing),y.setPitch(0),y.setRoll(0),y.setZoom(s.zoom);const v=y.modelViewProjectionMatrix,b=[nn(i.getNorthWest()),nn(i.getNorthEast()),nn(i.getSouthWest()),nn(i.getSouthEast()),nn(new e.S(f,_)),nn(new e.S(d,_)),nn(new e.S(g,p)),nn(new e.S(g,m))],x=nn(s.center);let w=Number.POSITIVE_INFINITY;for(const e of b)o<0&&(w=vn.getLesserNonNegativeNonNull(w,vn.solveVectorScale(e,x,v,"x",o))),l>0&&(w=vn.getLesserNonNegativeNonNull(w,vn.solveVectorScale(e,x,v,"x",l))),c>0&&(w=vn.getLesserNonNegativeNonNull(w,vn.solveVectorScale(e,x,v,"y",c))),u<0&&(w=vn.getLesserNonNegativeNonNull(w,vn.solveVectorScale(e,x,v,"y",u)));if(Number.isFinite(w)&&0!==w)return s.zoom=y.zoom+e.ak(w),s;De()}handleJumpToCenterZoom(t,n){const i=t.center.lat,r=t.getConstrained(n.center?e.S.convert(n.center):t.center,t.zoom).center;t.setCenter(r.wrap());const a=void 0!==n.zoom?+n.zoom:t.zoom+on(i,r.lat);t.zoom!==a&&t.setZoom(a)}handleEaseTo(t,n){const i=t.zoom,r=t.center,a=t.padding,s={roll:t.roll,pitch:t.pitch,bearing:t.bearing},o={roll:void 0===n.roll?t.roll:n.roll,pitch:void 0===n.pitch?t.pitch:n.pitch,bearing:void 0===n.bearing?t.bearing:n.bearing},l=void 0!==n.zoom,c=!t.isPaddingEqual(n.padding);let u=!1;const h=n.center?e.S.convert(n.center):r,d=t.getConstrained(h,i).center;Ee(t,d);const f=t.clone();f.setCenter(d),f.setZoom(l?+n.zoom:i+on(r.lat,h.lat)),f.setBearing(n.bearing);const p=new e.P(e.ah(t.centerPoint.x+n.offsetAsPoint.x,0,t.width),e.ah(t.centerPoint.y+n.offsetAsPoint.y,0,t.height));f.setLocationAtPoint(d,p);const m=(n.offset&&n.offsetAsPoint.mag())>0?f.center:d,g=l?+n.zoom:i+on(r.lat,m.lat),_=i+on(r.lat,0),y=g+on(m.lat,0),v=e.bA(r.lng,m.lng),b=e.bA(r.lat,m.lat),x=e.af(y-_);return u=g!==i,{easeFunc:i=>{if(e.be(s,o)||Re({startEulerAngles:s,endEulerAngles:o,tr:t,k:i,useSlerp:s.roll!=o.roll}),c&&t.interpolatePadding(a,n.padding,i),n.around)e.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(n.around,n.aroundPoint);else{const e=y>_?Math.min(2,x):Math.max(.5,x),n=Math.pow(e,1-i),a=un(r,v,b,i*n);t.setCenter(a.wrap())}if(u){const n=e.C.number(_,y,i)+on(0,t.center.lat);t.setZoom(n)}},isZooming:u,elevationCenter:m}}handleFlyTo(t,n){const i=void 0!==n.zoom,r=t.center,a=t.zoom,s=t.padding,o=!t.isPaddingEqual(n.padding),l=t.getConstrained(e.S.convert(n.center||n.locationAtOffset),a).center,c=i?+n.zoom:t.zoom+on(t.center.lat,l.lat),u=t.clone();u.setCenter(l),u.setZoom(c),u.setBearing(n.bearing);const h=new e.P(e.ah(t.centerPoint.x+n.offsetAsPoint.x,0,t.width),e.ah(t.centerPoint.y+n.offsetAsPoint.y,0,t.height));u.setLocationAtPoint(l,h);const d=u.center;Ee(t,d);const f=function(t,n,i){const r=nn(n),a=nn(i),s=e.aX(r,a),o=Math.acos(s),l=tn(t);return o/(2*Math.PI)*l}(t,r,d),p=a+on(r.lat,0),m=c+on(d.lat,0),g=e.af(m-p);let _;if("number"==typeof n.minZoom){const i=+n.minZoom+on(d.lat,0),r=Math.min(i,p,m)+on(0,d.lat),a=t.getConstrained(d,r).zoom+on(d.lat,0);_=e.af(a-p)}const y=e.bA(r.lng,d.lng),v=e.bA(r.lat,d.lat);return{easeFunc:(i,a,l,u)=>{const h=un(r,y,v,l);o&&t.interpolatePadding(s,n.padding,i);const f=1===i?d:h;t.setCenter(f.wrap());const m=p+e.ak(a);t.setZoom(1===i?c:m+on(0,f.lat))},scaleOfZoom:g,targetCenter:d,scaleOfMinZoom:_,pixelPathLength:f}}static solveVectorScale(t,e,n,i,r){const a="x"===i?[n[0],n[4],n[8],n[12]]:[n[1],n[5],n[9],n[13]],s=[n[3],n[7],n[11],n[15]],o=t[0]*a[0]+t[1]*a[1]+t[2]*a[2],l=t[0]*s[0]+t[1]*s[1]+t[2]*s[2],c=e[0]*a[0]+e[1]*a[1]+e[2]*a[2],u=e[0]*s[0]+e[1]*s[1]+e[2]*s[2];return c+r*l===o+r*u||s[3]*(o-c)+a[3]*(u-l)+o*u==c*l?null:(c+a[3]-r*u-r*s[3])/(c-o-r*u+r*l)}static getLesserNonNegativeNonNull(t,e){return null!==e&&e>=0&&e<t?e:t}}class bn{constructor(t){this._globe=t,this._mercatorCameraHelper=new Oe,this._verticalPerspectiveCameraHelper=new vn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,e){return this.currentHelper.handlePanInertia(t,e)}handleMapControlsRollPitchBearingZoom(t,e){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,e)}handleMapControlsPan(t,e,n){this.currentHelper.handleMapControlsPan(t,e,n)}cameraForBoxAndBearing(t,e,n,i,r){return this.currentHelper.cameraForBoxAndBearing(t,e,n,i,r)}handleJumpToCenterZoom(t,e){this.currentHelper.handleJumpToCenterZoom(t,e)}handleEaseTo(t,e){return this.currentHelper.handleEaseTo(t,e)}handleFlyTo(t,e){return this.currentHelper.handleFlyTo(t,e)}}const xn=(t,n)=>e.y(t,n&&n.filter(t=>"source.canvas"!==t.identifier)),wn=e.bE();class Sn extends e.E{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i,r;super(),this._rtlPluginLoaded=()=>{for(const t in this.sourceCaches){const e=this.sourceCaches[t].getSource().type;"vector"!==e&&"geojson"!==e||this.sourceCaches[t].reload()}},this.map=t,this.dispatcher=new R(D(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(t,e)=>this.getGlyphs(t,e)),this.dispatcher.registerMessageHandler("GI",(t,e)=>this.getImages(t,e)),this.imageManager=new v,this.imageManager.setEventedParent(this);const a=(null===(i=t._container)||void 0===i?void 0:i.lang)||"undefined"!=typeof document&&(null===(r=document.documentElement)||void 0===r?void 0:r.lang)||void 0;this.glyphManager=new S(t._requestManager,n.localIdeographFontFamily,a),this.lineAtlas=new T(256,512),this.crossTileSymbolIndex=new ye,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",e.bG()),it().on(tt,this._rtlPluginLoaded),this.on("data",t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.sourceCaches[t.sourceId];if(!e)return;const n=e.getSource();if(n&&n.vectorLayerIds)for(const i in this._layers){const t=this._layers[i];t.source===n.id&&this._validateLayer(t)}})}setGlobalStateProperty(t,n){var i,r,a;this._checkLoaded();const s=null===n?null!==(a=null===(r=null===(i=this.stylesheet.state)||void 0===i?void 0:i[t])||void 0===r?void 0:r.default)&&void 0!==a?a:null:n;if(e.bH(s,this._globalState[t]))return this;this._globalState[t]=s,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const n=[];for(const i in t)!e.bH(this._globalState[i],t[i].default)&&(n.push(i),this._globalState[i]=t[i].default);this._applyGlobalStateChanges(n)}_applyGlobalStateChanges(t){if(0===t.length)return;const e=new Set,n={};for(const i of t){n[i]=this._globalState[i];for(const t in this._layers){const n=this._layers[t],r=n.getLayoutAffectingGlobalStateRefs(),a=n.getPaintAffectingGlobalStateRefs();if(r.has(i)&&e.add(n.source),a.has(i))for(const{name:t,value:e}of a.get(i))this._updatePaintProperty(n,t,e)}}this.dispatcher.broadcast("UGS",n);for(const i in this.sourceCaches)e.has(i)&&(this._reloadSource(i),this._changed=!0)}loadURL(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this.fire(new e.l("dataloading",{dataType:"style"})),n.validate="boolean"!=typeof n.validate||n.validate;const r=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const a=this._loadStyleRequest;e.j(r,this._loadStyleRequest).then(t=>{this._loadStyleRequest=null,this._load(t.data,n,i)}).catch(t=>{this._loadStyleRequest=null,t&&!a.signal.aborted&&this.fire(new e.k(t))})}loadJSON(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this.fire(new e.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,s.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=!1!==n.validate,this._load(t,n,i)}).catch(()=>{})}loadEmpty(){this.fire(new e.l("dataloading",{dataType:"style"})),this._load(wn,{validate:!1})}_load(t,n,i){var r,a;let s=n.transformStyle?n.transformStyle(i,t):t;if(!n.validate||!xn(this,e.z(s))){s=Object.assign({},s),this._loaded=!0,this.stylesheet=s;for(const t in s.sources)this.addSource(t,s.sources[t],{validate:!1});s.sprite?this._loadSprite(s.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(s.glyphs),this._createLayers(),this.light=new A(this.stylesheet.light),this._setProjectionInternal((null===(r=this.stylesheet.projection)||void 0===r?void 0:r.type)||"mercator"),this.sky=new E(this.stylesheet.sky),this.map.setTerrain(null!==(a=this.stylesheet.terrain)&&void 0!==a?a:null),this.fire(new e.l("data",{dataType:"style"})),this.fire(new e.l("style.load"))}}_createLayers(){var t;const n=e.bI(this.stylesheet.layers);this.setGlobalState(null!==(t=this.stylesheet.state)&&void 0!==t?t:null),this.dispatcher.broadcast("SL",n),this._order=n.map(t=>t.id),this._layers={},this._serializedLayers=null;for(const i of n){const t=e.bJ(i,this._globalState);t.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=t}}_loadSprite(t){let n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(t,n,i,r){return e._(this,void 0,void 0,function*(){const a=g(t),o=i>1?"@2x":"",l={},c={};for(const{id:t,url:i}of a){const a=n.transformRequest(_(i,o,".json"),"SpriteJSON");l[t]=e.j(a,r);const s=n.transformRequest(_(i,o,".png"),"SpriteImage");c[t]=p.getImage(s,r)}return yield Promise.all([...Object.values(l),...Object.values(c)]),function(t,n){return e._(this,void 0,void 0,function*(){const e={};for(const i in t){e[i]={};const r=s.getImageCanvasContext((yield n[i]).data),a=(yield t[i]).data;for(const t in a){const{width:n,height:s,x:o,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:f,textFitWidth:p,textFitHeight:m}=a[t];e[i][t]={data:null,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:f,textFitWidth:p,textFitHeight:m,spriteData:{width:n,height:s,x:o,y:l,context:r}}}}return e})}(l,c)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(t=>{if(this._spriteRequest=null,t)for(const e in t){this._spritesImagesIds[e]=[];const n=this._spritesImagesIds[e]?this._spritesImagesIds[e].filter(e=>!(e in t)):[];for(const t of n)this.imageManager.removeImage(t),this._changedImages[t]=!0;for(const r in t[e]){const n="default"===e?r:"".concat(e,":").concat(r);this._spritesImagesIds[e].push(n),n in this.imageManager.images?this.imageManager.updateImage(n,t[e][r],!1):this.imageManager.addImage(n,t[e][r]),i&&(this._changedImages[n]=!0)}}}).catch(t=>{this._spriteRequest=null,n=t,this.fire(new e.k(n))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.l("data",{dataType:"style"})),r&&r(n)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.l("data",{dataType:"style"}))}_validateLayer(t){const n=this.sourceCaches[t.source];if(!n)return;const i=t.sourceLayer;if(!i)return;const r=n.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new e.k(new Error('Source layer "'.concat(i,'" does not exist on source "').concat(r.id,'" as specified by style layer "').concat(t.id,'".'))))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this._serializedAllLayers();if(!t||0===t.length)return Object.values(n?e.bK(i):i);const r=[];for(const a of t)if(i[a]){const t=n?e.bK(i[a]):i[a];r.push(t)}return r}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const e=Object.keys(this._layers);for(const n of e){const e=this._layers[n];"custom"!==e.type&&(t[n]=e.serialize())}return t}hasTransitions(){var t,e,n;if(null===(t=this.light)||void 0===t?void 0:t.hasTransition())return!0;if(null===(e=this.sky)||void 0===e?void 0:e.hasTransition())return!0;if(null===(n=this.projection)||void 0===n?void 0:n.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const n=this._changed;if(n){const e=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(e.length||n.length)&&this._updateWorkerLayers(e,n);for(const t in this._updatedSources){const e=this._updatedSources[t];if("reload"===e)this._reloadSource(t);else{if("clear"!==e)throw new Error("Invalid action ".concat(e));this._clearSource(t)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const i in this._updatedPaintProps)this._layers[i].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const i={};for(const e in this.sourceCaches){const t=this.sourceCaches[e];i[e]=t.used,t.used=!1}for(const e of this._order){const n=this._layers[e];n.recalculate(t,this._availableImages),!n.isHidden(t.zoom)&&n.source&&(this.sourceCaches[n.source].used=!0)}for(const r in i){const t=this.sourceCaches[r];!!i[r]!=!!t.used&&t.fire(new e.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:r}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,n&&this.fire(new e.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;this._checkLoaded();const r=this.serialize();if(t=n.transformStyle?n.transformStyle(r,t):t,(null===(i=n.validate)||void 0===i||i)&&xn(this,e.z(t)))return!1;(t=e.bK(t)).layers=e.bI(t.layers);const a=e.bL(r,t),s=this._getOperationsToPerform(a);if(s.unimplemented.length>0)throw new Error("Unimplemented: ".concat(s.unimplemented.join(", "),"."));if(0===s.operations.length)return!1;for(const e of s.operations)e();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const e=[],n=[];for(const i of t)switch(i.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":e.push(()=>this.addLayer.apply(this,i.args));break;case"removeLayer":e.push(()=>this.removeLayer.apply(this,i.args));break;case"setPaintProperty":e.push(()=>this.setPaintProperty.apply(this,i.args));break;case"setLayoutProperty":e.push(()=>this.setLayoutProperty.apply(this,i.args));break;case"setFilter":e.push(()=>this.setFilter.apply(this,i.args));break;case"addSource":e.push(()=>this.addSource.apply(this,i.args));break;case"removeSource":e.push(()=>this.removeSource.apply(this,i.args));break;case"setLayerZoomRange":e.push(()=>this.setLayerZoomRange.apply(this,i.args));break;case"setLight":e.push(()=>this.setLight.apply(this,i.args));break;case"setGeoJSONSourceData":e.push(()=>this.setGeoJSONSourceData.apply(this,i.args));break;case"setGlyphs":e.push(()=>this.setGlyphs.apply(this,i.args));break;case"setSprite":e.push(()=>this.setSprite.apply(this,i.args));break;case"setTerrain":e.push(()=>this.map.setTerrain.apply(this,i.args));break;case"setSky":e.push(()=>this.setSky.apply(this,i.args));break;case"setProjection":this.setProjection.apply(this,i.args);break;case"setGlobalState":e.push(()=>this.setGlobalState.apply(this,i.args));break;case"setTransition":e.push(()=>{});break;default:n.push(i.command)}return{operations:e,unimplemented:n}}addImage(t,n){if(this.getImage(t))return this.fire(new e.k(new Error('An image named "'.concat(t,'" already exists.'))));this.imageManager.addImage(t,n),this._afterImageUpdated(t)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new e.k(new Error('An image named "'.concat(t,'" does not exist.'))));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error('Source "'.concat(t,'" already exists.'));if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(n).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(e.z.source,"sources.".concat(t),n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const r=this.sourceCaches[t]=new bt(t,n,this.dispatcher);r.style=this,r.setEventedParent(this,()=>({isSourceLoaded:r.loaded(),source:r.serialize(),sourceId:t})),r.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===t)return this.fire(new e.k(new Error('Source "'.concat(t,'" cannot be removed while layer "').concat(i,'" is using it.'))));const n=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],n.fire(new e.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID=".concat(t));const n=this.sourceCaches[t].getSource();if("geojson"!==n.type)throw new Error("geojsonSource.type is ".concat(n.type,", which is !== 'geojson"));n.setData(e),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=t.id;if(this.getLayer(r))return void this.fire(new e.k(new Error('Layer "'.concat(r,'" already exists on this map.'))));let a;if("custom"===t.type){if(xn(this,e.bM(t)))return;a=e.bJ(t,this._globalState)}else{if("source"in t&&"object"==typeof t.source&&(this.addSource(r,t.source),t=e.bK(t),t=e.e(t,{source:r})),this._validate(e.z.layer,"layers.".concat(r),t,{arrayIndex:-1},i))return;a=e.bJ(t,this._globalState),this._validateLayer(a),a.setEventedParent(this,{layer:{id:r}})}const s=n?this._order.indexOf(n):this._order.length;if(n&&-1===s)this.fire(new e.k(new Error('Cannot add layer "'.concat(r,'" before non-existing layer "').concat(n,'".'))));else{if(this._order.splice(s,0,r),this._layerOrderChanged=!0,this._layers[r]=a,this._removedLayers[r]&&a.source&&"custom"!==a.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(t,n){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.k(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be moved."))));if(t===n)return;const i=this._order.indexOf(t);this._order.splice(i,1);const r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new e.k(new Error('Cannot move layer "'.concat(t,'" before non-existing layer "').concat(n,'".')))):(this._order.splice(r,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const n=this._layers[t];if(!n)return void this.fire(new e.k(new Error('Cannot remove non-existing layer "'.concat(t,'".'))));n.setEventedParent(null);const i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=n,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],n.onRemove&&n.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,n,i){this._checkLoaded();const r=this.getLayer(t);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new e.k(new Error('Cannot set the zoom range of non-existing layer "'.concat(t,'".'))))}setFilter(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const r=this.getLayer(t);if(r){if(!e.bH(r.filter,n))return null==n?(r.setFilter(void 0),void this._updateLayer(r)):void(this._validate(e.z.filter,"layers.".concat(r.id,".filter"),n,null,i)||(r.setFilter(e.bK(n)),this._updateLayer(r)))}else this.fire(new e.k(new Error('Cannot filter non-existing layer "'.concat(t,'".'))))}getFilter(t){return e.bK(this.getLayer(t).filter)}setLayoutProperty(t,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(t);a?e.bH(a.getLayoutProperty(n),i)||(a.setLayoutProperty(n,i,r),this._updateLayer(a)):this.fire(new e.k(new Error('Cannot style non-existing layer "'.concat(t,'".'))))}getLayoutProperty(t,n){const i=this.getLayer(t);if(i)return i.getLayoutProperty(n);this.fire(new e.k(new Error('Cannot get style of non-existing layer "'.concat(t,'".'))))}setPaintProperty(t,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(t);a?e.bH(a.getPaintProperty(n),i)||this._updatePaintProperty(a,n,i,r):this.fire(new e.k(new Error('Cannot style non-existing layer "'.concat(t,'".'))))}_updatePaintProperty(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t.setPaintProperty(e,n,i)&&this._updateLayer(t),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(t,n){this._checkLoaded();const i=t.source,r=t.sourceLayer,a=this.sourceCaches[i];if(void 0===a)return void this.fire(new e.k(new Error("The source '".concat(i,"' does not exist in the map's style."))));const s=a.getSource().type;"geojson"===s&&r?this.fire(new e.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==s||r?(void 0===t.id&&this.fire(new e.k(new Error("The feature id parameter must be provided."))),a.setFeatureState(r,t.id,n)):this.fire(new e.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,n){this._checkLoaded();const i=t.source,r=this.sourceCaches[i];if(void 0===r)return void this.fire(new e.k(new Error("The source '".concat(i,"' does not exist in the map's style."))));const a=r.getSource().type,s="vector"===a?t.sourceLayer:void 0;"vector"!==a||s?n&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.k(new Error("A feature id is required to remove its specific state property."))):r.removeFeatureState(s,t.id,n):this.fire(new e.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const n=t.source,i=t.sourceLayer,r=this.sourceCaches[n];if(void 0!==r)return"vector"!==r.getSource().type||i?(void 0===t.id&&this.fire(new e.k(new Error("The feature id parameter must be provided."))),r.getFeatureState(i,t.id)):void this.fire(new e.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new e.k(new Error("The source '".concat(n,"' does not exist in the map's style."))))}getTransition(){return e.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=e.bN(this.sourceCaches,t=>t.serialize()),n=this._serializeByIds(this._order,!0),i=this.map.getTerrain()||void 0,r=this.stylesheet;return e.bO({version:r.version,name:r.name,metadata:r.metadata,light:r.light,sky:r.sky,center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch,sprite:r.sprite,glyphs:r.glyphs,transition:r.transition,projection:r.projection,sources:t,layers:n,terrain:i},t=>void 0!==t)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},i=[];for(let a=this._order.length-1;a>=0;a--){const r=this._order[a];if(e(r)){n[r]=a;for(const e of t){const t=e[r];if(t)for(const e of t)i.push(e)}}}i.sort((t,e)=>e.intersectionZ-t.intersectionZ);const r=[];for(let a=this._order.length-1;a>=0;a--){const s=this._order[a];if(e(s))for(let t=i.length-1;t>=0;t--){const e=i[t].feature;if(n[e.layer.id]<a)break;r.push(e),i.pop()}else for(const e of t){const t=e[s];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(t,n,i){n&&n.filter&&this._validate(e.z.filter,"queryRenderedFeatures.filter",n.filter,null,n);const r={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new e.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const t of n.layers){const n=this._layers[t];if(!n)return this.fire(new e.k(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be queried for features.")))),[];r[n.source]=!0}}const a=[];n.availableImages=this._availableImages;const s=this._serializedAllLayers(),o=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,l=Object.assign(Object.assign({},n),{layers:o,globalState:this._globalState});for(const e in this.sourceCaches)n.layers&&!r[e]||a.push(B(this.sourceCaches[e],this._layers,s,t,l,i,this.map.terrain?(t,e,n)=>this.map.terrain.getElevation(t,e,n):void 0));return this.placement&&a.push(function(t,e,n,i,r,a,s){const o={},l=a.queryRenderedSymbols(i),c=[];for(const u of Object.keys(l).map(Number))c.push(s[u]);c.sort(j);for(const u of c){const n=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],e,u.bucketIndex,u.sourceLayerIndex,{filterSpec:r.filter,globalState:r.globalState},r.layers,r.availableImages,t);for(const t in n){const e=o[t]=o[t]||[],i=n[t];i.sort((t,e)=>{const n=u.featureSortOrder;if(n){const i=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex});for(const t of i)e.push(t)}}return function(t,e,n){for(const i in t)for(const r of t[i])U(r,n[e[i].source]);return t}(o,t,n)}(this._layers,s,this.sourceCaches,t,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(t,n){(null==n?void 0:n.filter)&&this._validate(e.z.filter,"querySourceFeatures.filter",n.filter,null,n);const i=this.sourceCaches[t];return i?function(t,e){const n=t.getRenderableIds().map(e=>t.getTileByID(e)),i=[],r={};for(let a=0;a<n.length;a++){const t=n[a],s=t.tileID.canonical.key;r[s]||(r[s]=!0,t.querySourceFeatures(i,e))}return i}(i,n?Object.assign(Object.assign({},n),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const i=this.light.getLight();let r=!1;for(const s in t)if(!e.bH(t[s],i[s])){r=!0;break}if(!r)return;const a={now:s.now(),transition:e.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,n),this.light.updateTransitions(a)}getProjection(){var t;return null===(t=this.stylesheet)||void 0===t?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return null===(t=this.stylesheet)||void 0===t?void 0:t.sky}setSky(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const i=this.getSky();let r=!1;if(!t&&!i)return;if(t&&!i)r=!0;else if(!t&&i)r=!0;else for(const s in t)if(!e.bH(t[s],i[s])){r=!0;break}if(!r)return;const a={now:s.now(),transition:e.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,n),this.sky.updateTransitions(a)}_setProjectionInternal(t){const n=function(t){if(Array.isArray(t)){const e=new Qe({type:t});return{projection:e,transform:new yn,cameraHelper:new bn(e)}}switch(t){case"mercator":return{projection:new Ae,transform:new Ne,cameraHelper:new Oe};case"globe":{const t=new Qe({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:t,transform:new yn,cameraHelper:new bn(t)}}case"vertical-perspective":return{projection:new Je,transform:new _n,cameraHelper:new vn};default:return e.w("Unknown projection name: ".concat(t,". Falling back to mercator projection.")),{projection:new Ae,transform:new Ne,cameraHelper:new Oe}}}(t);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const e in this.sourceCaches)this.sourceCaches[e].reload()}_validate(t,n,i,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!a||!1!==a.validate)&&xn(this,t.call(e.z,e.e({key:n,style:this.serialize(),value:i,styleSpec:e.v},r)))}_remove(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),it().off(tt,this._rtlPluginLoaded);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this.sourceCaches){const t=this.sourceCaches[e];t.setEventedParent(null),t.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const e in this.sourceCaches)this.sourceCaches[e].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!1,o=!1;const l={};for(const s of this._order){const e=this._layers[s];if("symbol"!==e.type)continue;if(!l[e.source]){const t=this.sourceCaches[e.source];l[e.source]=t.getRenderableIds(!0).map(e=>t.getTileByID(e)).sort((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1))}const n=this.crossTileSymbolIndex.addLayer(e,l[e.source],t.center.lng);a=a||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((r=r||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.now(),t.zoom))&&(this.pauseablePlacement=new fe(t,this.map.terrain,this._order,r,e,n,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.now()),o=!0),a&&this.pauseablePlacement.placement.setStale()),o||a)for(const s of this._order){const t=this._layers[s];"symbol"===t.type&&this.placement.updateLayerOpacities(t,l[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,n){return e._(this,void 0,void 0,function*(){const t=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const e=this.sourceCaches[n.source];return e&&e.setDependencies(n.tileID.key,n.type,n.icons),t})}getGlyphs(t,n){return e._(this,void 0,void 0,function*(){const t=yield this.glyphManager.getGlyphs(n.stacks),e=this.sourceCaches[n.source];return e&&e.setDependencies(n.tileID.key,n.type,[""]),t})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded(),t&&this._validate(e.z.glyphs,"glyphs",t,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const a=[{id:t,url:n}],s=[...g(this.stylesheet.sprite),...a];this._validate(e.z.sprite,"sprite",s,null,i)||(this.stylesheet.sprite=s,this._loadSprite(a,!0,r))}removeSprite(t){this._checkLoaded();const n=g(this.stylesheet.sprite);if(n.find(e=>e.id===t)){if(this._spritesImagesIds[t])for(const e of this._spritesImagesIds[t])this.imageManager.removeImage(e),this._changedImages[e]=!0;n.splice(n.findIndex(e=>e.id===t),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.l("data",{dataType:"style"}))}else this.fire(new e.k(new Error('Sprite "'.concat(t,"\" doesn't exists on this map."))))}getSprite(){return g(this.stylesheet.sprite)}setSprite(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),t&&this._validate(e.z.sprite,"sprite",t,null,n)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,i):(this._unloadSprite(),i&&i(null)))}}var Pn=e.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Mn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,n,i,r,a,s,o,l){this.context=t;let c=this.boundPaintVertexBuffers.length!==i.length;for(let u=0;!c&&u<i.length;u++)this.boundPaintVertexBuffers[u]!==i[u]&&(c=!0);!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||c||this.boundIndexBuffer!==r||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==o||this.boundDynamicVertexBuffer3!==l?this.freshBind(e,n,i,r,a,s,o,l):(t.bindVertexArray.set(this.vao),s&&s.bind(),r&&r.dynamicDraw&&r.bind(),o&&o.bind(),l&&l.bind())}freshBind(t,e,n,i,r,a,s,o){const l=t.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=s,this.boundDynamicVertexBuffer3=o,e.enableAttributes(u,t);for(const h of n)h.enableAttributes(u,t);a&&a.enableAttributes(u,t),s&&s.enableAttributes(u,t),o&&o.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,r);for(const h of n)h.bind(),h.setVertexAttribPointers(u,t,r);a&&(a.bind(),a.setVertexAttribPointers(u,t,r)),i&&i.bind(),s&&(s.bind(),s.setVertexAttribPointers(u,t,r)),o&&(o.bind(),o.setVertexAttribPointers(u,t,r)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const An=(t,n,i,r,a)=>({u_texture:0,u_ele_delta:t,u_fog_matrix:n,u_fog_color:i?i.properties.get("fog-color"):e.bf.white,u_fog_ground_blend:i?i.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:a?0:i?i.calculateFogBlendOpacity(r):0,u_horizon_color:i?i.properties.get("horizon-color"):e.bf.white,u_horizon_fog_blend:i?i.properties.get("horizon-fog-blend"):1,u_is_globe_mode:a?1:0}),kn={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function En(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const i=t[n].split(" ");e.push(i.pop())}return e}class Tn{constructor(t,n,i,r,a,s,o,l){let c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];const u=t.gl;this.program=u.createProgram();const h=En(n.staticAttributes),d=i?i.getBinderAttributes():[],f=h.concat(d),p=be.prelude.staticUniforms?En(be.prelude.staticUniforms):[],m=o.staticUniforms?En(o.staticUniforms):[],g=n.staticUniforms?En(n.staticUniforms):[],_=i?i.getBinderUniforms():[],y=p.concat(m).concat(g).concat(_),v=[];for(const e of y)v.indexOf(e)<0&&v.push(e);const b=i?i.defines():[];We(u)&&b.unshift("#version 300 es"),a&&b.push("#define OVERDRAW_INSPECTOR;"),s&&b.push("#define TERRAIN3D;"),l&&b.push(l),c&&b.push(...c);let x=b.concat(be.prelude.fragmentSource,o.fragmentSource,n.fragmentSource).join("\n"),w=b.concat(be.prelude.vertexSource,o.vertexSource,n.vertexSource).join("\n");We(u)||(x=function(t){return t.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(x),w=function(t){return t.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(w));const S=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);if(u.shaderSource(S,x),u.compileShader(S),!u.getShaderParameter(S,u.COMPILE_STATUS))throw new Error("Could not compile fragment shader: ".concat(u.getShaderInfoLog(S)));u.attachShader(this.program,S);const P=u.createShader(u.VERTEX_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);if(u.shaderSource(P,w),u.compileShader(P),!u.getShaderParameter(P,u.COMPILE_STATUS))throw new Error("Could not compile vertex shader: ".concat(u.getShaderInfoLog(P)));u.attachShader(this.program,P),this.attributes={};const M={};this.numAttributes=f.length;for(let e=0;e<this.numAttributes;e++)f[e]&&(u.bindAttribLocation(this.program,e,f[e]),this.attributes[f[e]]=e);if(u.linkProgram(this.program),!u.getProgramParameter(this.program,u.LINK_STATUS))throw new Error("Program failed to link: ".concat(u.getProgramInfoLog(this.program)));u.deleteShader(P),u.deleteShader(S);for(let e=0;e<v.length;e++){const t=v[e];if(t&&!M[t]){const e=u.getUniformLocation(this.program,t);e&&(M[t]=e)}}this.fixedUniforms=r(t,M),this.terrainUniforms=((t,n)=>({u_depth:new e.bP(t,n.u_depth),u_terrain:new e.bP(t,n.u_terrain),u_terrain_dim:new e.bg(t,n.u_terrain_dim),u_terrain_matrix:new e.bR(t,n.u_terrain_matrix),u_terrain_unpack:new e.bS(t,n.u_terrain_unpack),u_terrain_exaggeration:new e.bg(t,n.u_terrain_exaggeration)}))(t,M),this.projectionUniforms=((t,n)=>({u_projection_matrix:new e.bR(t,n.u_projection_matrix),u_projection_tile_mercator_coords:new e.bS(t,n.u_projection_tile_mercator_coords),u_projection_clipping_plane:new e.bS(t,n.u_projection_clipping_plane),u_projection_transition:new e.bg(t,n.u_projection_transition),u_projection_fallback_matrix:new e.bR(t,n.u_projection_fallback_matrix)}))(t,M),this.binderUniforms=i?i.getUniforms(t,M):[]}draw(t,e,n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y){const v=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(i),t.setColorMode(r),t.setCullFace(a),o){t.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,o.depthTexture),t.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,o.texture);for(const t in this.terrainUniforms)this.terrainUniforms[t].set(o[t])}if(l)for(const x in l)this.projectionUniforms[kn[x]].set(l[x]);if(s)for(const x in this.fixedUniforms)this.fixedUniforms[x].set(s[x]);m&&m.setUniforms(t,this.binderUniforms,f,{zoom:p});let b=0;switch(e){case v.LINES:b=2;break;case v.TRIANGLES:b=3;break;case v.LINE_STRIP:b=1}for(const x of d.get()){const n=x.vaos||(x.vaos={});(n[c]||(n[c]=new Mn)).bind(t,this,u,m?m.getPaintVertexBuffers():[],h,x.vertexOffset,g,_,y),v.drawElements(e,x.primitiveLength*b,v.UNSIGNED_SHORT,x.primitiveOffset*b*2)}}}function Cn(t,n,i){const r=1/e.aC(i,1,n.transform.tileZoom),a=Math.pow(2,i.tileID.overscaledZ),s=i.tileSize*Math.pow(2,n.transform.tileZoom)/a,o=s*(i.tileID.canonical.x+i.tileID.wrap*a),l=s*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,l>>16],u_pixel_coord_lower:[65535&o,65535&l]}}const In=(t,n,i,r)=>{const a=t.style.light,s=a.properties.get("position"),o=[s.x,s.y,s.z],l=e.bV();"viewport"===a.properties.get("anchor")&&e.bW(l,t.transform.bearingInRadians),e.bX(o,o,l);const c=t.transform.transformLightDirection(o),u=a.properties.get("color");return{u_lightpos:o,u_lightpos_globe:c,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+n,u_opacity:i,u_fill_translate:r}},Ln=(t,n,i,r,a,s,o)=>e.e(In(t,n,i,r),Cn(s,t,o),{u_height_factor:-Math.pow(2,a.overscaledZ)/o.tileSize/8}),zn=(t,n,i,r)=>e.e(Cn(n,t,i),{u_fill_translate:r}),Nn=(t,e)=>({u_world:t,u_fill_translate:e}),Dn=(t,n,i,r,a)=>e.e(zn(t,n,i,a),{u_world:r}),Rn=(t,n,i,r,a)=>{const s=t.transform;let o,l,c=0;if("map"===i.paint.get("circle-pitch-alignment")){const t=e.aC(n,1,s.zoom);o=!0,l=[t,t],c=t/(e.$*Math.pow(2,n.tileID.overscaledZ))*2*Math.PI*a}else o=!1,l=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_pitch_with_map:+o,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:l,u_globe_extrude_scale:c,u_translate:r}},Fn=t=>({u_pixel_extrude_scale:[1/t.width,1/t.height]}),On=t=>({u_viewport_size:[t.width,t.height]}),Bn=function(t){return{u_color:t,u_overlay:0,u_overlay_scale:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1}},jn=(t,n,i,r)=>{const a=e.aC(t,1,n)/(e.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*r;return{u_extrude_scale:e.aC(t,1,n),u_intensity:i,u_globe_extrude_scale:a}},Un=(t,n,i,r)=>{const a=e.L();e.bY(a,0,t.width,t.height,0,0,1);const s=t.context.gl;return{u_matrix:a,u_world:[s.drawingBufferWidth,s.drawingBufferHeight],u_image:i,u_color_ramp:r,u_opacity:n.paint.get("heatmap-opacity")}},Gn=(t,e,n)=>{const i=n.paint.get("hillshade-accent-color");let r;switch(n.paint.get("hillshade-method")){case"basic":r=4;break;case"combined":r=1;break;case"igor":r=2;break;case"multidirectional":r=3;break;default:r=0}const a=n.getIlluminationProperties();for(let s=0;s<a.directionRadians.length;s++)"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a.directionRadians[s]+=t.transform.bearingInRadians);return{u_image:0,u_latrange:Vn(0,e.tileID),u_exaggeration:n.paint.get("hillshade-exaggeration"),u_altitudes:a.altitudeRadians,u_azimuths:a.directionRadians,u_accent:i,u_method:r,u_highlights:a.highlightColor,u_shadows:a.shadowColor}},qn=(t,n)=>{const i=n.stride,r=e.L();return e.bY(r,0,e.$,-e.$,0,0,1),e.M(r,r,[0,-e.$,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_unpack:n.getUnpackVector()}};function Vn(t,n){const i=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new e.a1(0,r/i).toLngLat().lat,new e.a1(0,(r+1)/i).toLngLat().lat]}const Zn=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:n,u_opacity:t.paint.get("color-relief-opacity")}},Wn=(t,n,i,r)=>{const a=t.transform;return{u_translation:Jn(t,n,i),u_ratio:r/e.aC(n,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Hn=(t,n,i,r,a)=>e.e(Wn(t,n,i,r),{u_image:0,u_image_height:a}),Xn=(t,n,i,r,a)=>{const s=t.transform,o=Kn(n,s);return{u_translation:Jn(t,n,i),u_texsize:n.imageAtlasTexture.size,u_ratio:r/e.aC(n,1,s.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,a.fromScale,a.toScale],u_fade:a.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},Yn=(t,n,i,r,a,s)=>{const o=t.lineAtlas,l=Kn(n,t.transform),c="round"===i.layout.get("line-cap"),u=o.getDash(a.from,c),h=o.getDash(a.to,c),d=u.width*s.fromScale,f=h.width*s.toScale;return e.e(Wn(t,n,i,r),{u_patternscale_a:[l/d,-u.height/2],u_patternscale_b:[l/f,-h.height/2],u_sdfgamma:o.width/(256*Math.min(d,f)*t.pixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:h.y,u_mix:s.t})};function Kn(t,n){return 1/e.aC(t,1,n.tileZoom)}function Jn(t,n,i){return e.aD(t.transform,n,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const $n=(t,e,n,i,r)=>{return{u_tl_parent:t,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(s=i.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(a=i.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Qn(i.paint.get("raster-hue-rotate")),u_coords_top:[r[0].x,r[0].y,r[1].x,r[1].y],u_coords_bottom:[r[3].x,r[3].y,r[2].x,r[2].y]};var a,s};function Qn(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const ti=(t,e,n,i,r,a,s,o,l,c,u,h,d)=>{const f=s.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:f.cameraToCenterDistance,u_pitch:f.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:f.width/f.height,u_fade_change:s.options.fadeDuration?s.symbolFadeChange:1,u_label_plane_matrix:o,u_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+i,u_is_along_line:r,u_is_variable_anchor:a,u_texsize:h,u_texture:0,u_translation:c,u_pitched_scale:d}},ei=(t,n,i,r,a,s,o,l,c,u,h,d,f,p)=>{const m=o.transform;return e.e(ti(t,n,i,r,a,s,o,l,c,u,h,d,p),{u_gamma_scale:r?Math.cos(m.pitch*Math.PI/180)*m.cameraToCenterDistance:1,u_device_pixel_ratio:o.pixelRatio,u_is_halo:1})},ni=(t,n,i,r,a,s,o,l,c,u,h,d,f)=>e.e(ei(t,n,i,r,a,s,o,l,c,u,!0,h,0,f),{u_texsize_icon:d,u_texture_icon:1}),ii=(t,e)=>({u_opacity:t,u_color:e}),ri=(t,n,i,r,a)=>e.e(function(t,n,i,r){const a=i.imageManager.getPattern(t.from.toString()),s=i.imageManager.getPattern(t.to.toString()),{width:o,height:l}=i.imageManager.getPixelSize(),c=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,i.transform.tileZoom)/c,h=u*(r.tileID.canonical.x+r.tileID.wrap*c),d=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:a.tl,u_pattern_br_a:a.br,u_pattern_tl_b:s.tl,u_pattern_br_b:s.br,u_texsize:[o,l],u_mix:n.t,u_pattern_size_a:a.displaySize,u_pattern_size_b:s.displaySize,u_scale_a:n.fromScale,u_scale_b:n.toScale,u_tile_units_to_pixels:1/e.aC(r,1,i.transform.tileZoom),u_pixel_coord_upper:[h>>16,d>>16],u_pixel_coord_lower:[65535&h,65535&d]}}(i,a,n,r),{u_opacity:t}),ai=(t,e)=>{},si={fillExtrusion:(t,n)=>({u_lightpos:new e.bT(t,n.u_lightpos),u_lightpos_globe:new e.bT(t,n.u_lightpos_globe),u_lightintensity:new e.bg(t,n.u_lightintensity),u_lightcolor:new e.bT(t,n.u_lightcolor),u_vertical_gradient:new e.bg(t,n.u_vertical_gradient),u_opacity:new e.bg(t,n.u_opacity),u_fill_translate:new e.bU(t,n.u_fill_translate)}),fillExtrusionPattern:(t,n)=>({u_lightpos:new e.bT(t,n.u_lightpos),u_lightpos_globe:new e.bT(t,n.u_lightpos_globe),u_lightintensity:new e.bg(t,n.u_lightintensity),u_lightcolor:new e.bT(t,n.u_lightcolor),u_vertical_gradient:new e.bg(t,n.u_vertical_gradient),u_height_factor:new e.bg(t,n.u_height_factor),u_opacity:new e.bg(t,n.u_opacity),u_fill_translate:new e.bU(t,n.u_fill_translate),u_image:new e.bP(t,n.u_image),u_texsize:new e.bU(t,n.u_texsize),u_pixel_coord_upper:new e.bU(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.bU(t,n.u_pixel_coord_lower),u_scale:new e.bT(t,n.u_scale),u_fade:new e.bg(t,n.u_fade)}),fill:(t,n)=>({u_fill_translate:new e.bU(t,n.u_fill_translate)}),fillPattern:(t,n)=>({u_image:new e.bP(t,n.u_image),u_texsize:new e.bU(t,n.u_texsize),u_pixel_coord_upper:new e.bU(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.bU(t,n.u_pixel_coord_lower),u_scale:new e.bT(t,n.u_scale),u_fade:new e.bg(t,n.u_fade),u_fill_translate:new e.bU(t,n.u_fill_translate)}),fillOutline:(t,n)=>({u_world:new e.bU(t,n.u_world),u_fill_translate:new e.bU(t,n.u_fill_translate)}),fillOutlinePattern:(t,n)=>({u_world:new e.bU(t,n.u_world),u_image:new e.bP(t,n.u_image),u_texsize:new e.bU(t,n.u_texsize),u_pixel_coord_upper:new e.bU(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.bU(t,n.u_pixel_coord_lower),u_scale:new e.bT(t,n.u_scale),u_fade:new e.bg(t,n.u_fade),u_fill_translate:new e.bU(t,n.u_fill_translate)}),circle:(t,n)=>({u_camera_to_center_distance:new e.bg(t,n.u_camera_to_center_distance),u_scale_with_map:new e.bP(t,n.u_scale_with_map),u_pitch_with_map:new e.bP(t,n.u_pitch_with_map),u_extrude_scale:new e.bU(t,n.u_extrude_scale),u_device_pixel_ratio:new e.bg(t,n.u_device_pixel_ratio),u_globe_extrude_scale:new e.bg(t,n.u_globe_extrude_scale),u_translate:new e.bU(t,n.u_translate)}),collisionBox:(t,n)=>({u_pixel_extrude_scale:new e.bU(t,n.u_pixel_extrude_scale)}),collisionCircle:(t,n)=>({u_viewport_size:new e.bU(t,n.u_viewport_size)}),debug:(t,n)=>({u_color:new e.bQ(t,n.u_color),u_overlay:new e.bP(t,n.u_overlay),u_overlay_scale:new e.bg(t,n.u_overlay_scale)}),depth:ai,clippingMask:ai,heatmap:(t,n)=>({u_extrude_scale:new e.bg(t,n.u_extrude_scale),u_intensity:new e.bg(t,n.u_intensity),u_globe_extrude_scale:new e.bg(t,n.u_globe_extrude_scale)}),heatmapTexture:(t,n)=>({u_matrix:new e.bR(t,n.u_matrix),u_world:new e.bU(t,n.u_world),u_image:new e.bP(t,n.u_image),u_color_ramp:new e.bP(t,n.u_color_ramp),u_opacity:new e.bg(t,n.u_opacity)}),hillshade:(t,n)=>({u_image:new e.bP(t,n.u_image),u_latrange:new e.bU(t,n.u_latrange),u_exaggeration:new e.bg(t,n.u_exaggeration),u_altitudes:new e.b_(t,n.u_altitudes),u_azimuths:new e.b_(t,n.u_azimuths),u_accent:new e.bQ(t,n.u_accent),u_method:new e.bP(t,n.u_method),u_shadows:new e.bZ(t,n.u_shadows),u_highlights:new e.bZ(t,n.u_highlights)}),hillshadePrepare:(t,n)=>({u_matrix:new e.bR(t,n.u_matrix),u_image:new e.bP(t,n.u_image),u_dimension:new e.bU(t,n.u_dimension),u_zoom:new e.bg(t,n.u_zoom),u_unpack:new e.bS(t,n.u_unpack)}),colorRelief:(t,n)=>({u_image:new e.bP(t,n.u_image),u_unpack:new e.bS(t,n.u_unpack),u_dimension:new e.bU(t,n.u_dimension),u_elevation_stops:new e.bP(t,n.u_elevation_stops),u_color_stops:new e.bP(t,n.u_color_stops),u_color_ramp_size:new e.bP(t,n.u_color_ramp_size),u_opacity:new e.bg(t,n.u_opacity)}),line:(t,n)=>({u_translation:new e.bU(t,n.u_translation),u_ratio:new e.bg(t,n.u_ratio),u_device_pixel_ratio:new e.bg(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.bU(t,n.u_units_to_pixels)}),lineGradient:(t,n)=>({u_translation:new e.bU(t,n.u_translation),u_ratio:new e.bg(t,n.u_ratio),u_device_pixel_ratio:new e.bg(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.bU(t,n.u_units_to_pixels),u_image:new e.bP(t,n.u_image),u_image_height:new e.bg(t,n.u_image_height)}),linePattern:(t,n)=>({u_translation:new e.bU(t,n.u_translation),u_texsize:new e.bU(t,n.u_texsize),u_ratio:new e.bg(t,n.u_ratio),u_device_pixel_ratio:new e.bg(t,n.u_device_pixel_ratio),u_image:new e.bP(t,n.u_image),u_units_to_pixels:new e.bU(t,n.u_units_to_pixels),u_scale:new e.bT(t,n.u_scale),u_fade:new e.bg(t,n.u_fade)}),lineSDF:(t,n)=>({u_translation:new e.bU(t,n.u_translation),u_ratio:new e.bg(t,n.u_ratio),u_device_pixel_ratio:new e.bg(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.bU(t,n.u_units_to_pixels),u_patternscale_a:new e.bU(t,n.u_patternscale_a),u_patternscale_b:new e.bU(t,n.u_patternscale_b),u_sdfgamma:new e.bg(t,n.u_sdfgamma),u_image:new e.bP(t,n.u_image),u_tex_y_a:new e.bg(t,n.u_tex_y_a),u_tex_y_b:new e.bg(t,n.u_tex_y_b),u_mix:new e.bg(t,n.u_mix)}),raster:(t,n)=>({u_tl_parent:new e.bU(t,n.u_tl_parent),u_scale_parent:new e.bg(t,n.u_scale_parent),u_buffer_scale:new e.bg(t,n.u_buffer_scale),u_fade_t:new e.bg(t,n.u_fade_t),u_opacity:new e.bg(t,n.u_opacity),u_image0:new e.bP(t,n.u_image0),u_image1:new e.bP(t,n.u_image1),u_brightness_low:new e.bg(t,n.u_brightness_low),u_brightness_high:new e.bg(t,n.u_brightness_high),u_saturation_factor:new e.bg(t,n.u_saturation_factor),u_contrast_factor:new e.bg(t,n.u_contrast_factor),u_spin_weights:new e.bT(t,n.u_spin_weights),u_coords_top:new e.bS(t,n.u_coords_top),u_coords_bottom:new e.bS(t,n.u_coords_bottom)}),symbolIcon:(t,n)=>({u_is_size_zoom_constant:new e.bP(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.bP(t,n.u_is_size_feature_constant),u_size_t:new e.bg(t,n.u_size_t),u_size:new e.bg(t,n.u_size),u_camera_to_center_distance:new e.bg(t,n.u_camera_to_center_distance),u_pitch:new e.bg(t,n.u_pitch),u_rotate_symbol:new e.bP(t,n.u_rotate_symbol),u_aspect_ratio:new e.bg(t,n.u_aspect_ratio),u_fade_change:new e.bg(t,n.u_fade_change),u_label_plane_matrix:new e.bR(t,n.u_label_plane_matrix),u_coord_matrix:new e.bR(t,n.u_coord_matrix),u_is_text:new e.bP(t,n.u_is_text),u_pitch_with_map:new e.bP(t,n.u_pitch_with_map),u_is_along_line:new e.bP(t,n.u_is_along_line),u_is_variable_anchor:new e.bP(t,n.u_is_variable_anchor),u_texsize:new e.bU(t,n.u_texsize),u_texture:new e.bP(t,n.u_texture),u_translation:new e.bU(t,n.u_translation),u_pitched_scale:new e.bg(t,n.u_pitched_scale)}),symbolSDF:(t,n)=>({u_is_size_zoom_constant:new e.bP(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.bP(t,n.u_is_size_feature_constant),u_size_t:new e.bg(t,n.u_size_t),u_size:new e.bg(t,n.u_size),u_camera_to_center_distance:new e.bg(t,n.u_camera_to_center_distance),u_pitch:new e.bg(t,n.u_pitch),u_rotate_symbol:new e.bP(t,n.u_rotate_symbol),u_aspect_ratio:new e.bg(t,n.u_aspect_ratio),u_fade_change:new e.bg(t,n.u_fade_change),u_label_plane_matrix:new e.bR(t,n.u_label_plane_matrix),u_coord_matrix:new e.bR(t,n.u_coord_matrix),u_is_text:new e.bP(t,n.u_is_text),u_pitch_with_map:new e.bP(t,n.u_pitch_with_map),u_is_along_line:new e.bP(t,n.u_is_along_line),u_is_variable_anchor:new e.bP(t,n.u_is_variable_anchor),u_texsize:new e.bU(t,n.u_texsize),u_texture:new e.bP(t,n.u_texture),u_gamma_scale:new e.bg(t,n.u_gamma_scale),u_device_pixel_ratio:new e.bg(t,n.u_device_pixel_ratio),u_is_halo:new e.bP(t,n.u_is_halo),u_translation:new e.bU(t,n.u_translation),u_pitched_scale:new e.bg(t,n.u_pitched_scale)}),symbolTextAndIcon:(t,n)=>({u_is_size_zoom_constant:new e.bP(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.bP(t,n.u_is_size_feature_constant),u_size_t:new e.bg(t,n.u_size_t),u_size:new e.bg(t,n.u_size),u_camera_to_center_distance:new e.bg(t,n.u_camera_to_center_distance),u_pitch:new e.bg(t,n.u_pitch),u_rotate_symbol:new e.bP(t,n.u_rotate_symbol),u_aspect_ratio:new e.bg(t,n.u_aspect_ratio),u_fade_change:new e.bg(t,n.u_fade_change),u_label_plane_matrix:new e.bR(t,n.u_label_plane_matrix),u_coord_matrix:new e.bR(t,n.u_coord_matrix),u_is_text:new e.bP(t,n.u_is_text),u_pitch_with_map:new e.bP(t,n.u_pitch_with_map),u_is_along_line:new e.bP(t,n.u_is_along_line),u_is_variable_anchor:new e.bP(t,n.u_is_variable_anchor),u_texsize:new e.bU(t,n.u_texsize),u_texsize_icon:new e.bU(t,n.u_texsize_icon),u_texture:new e.bP(t,n.u_texture),u_texture_icon:new e.bP(t,n.u_texture_icon),u_gamma_scale:new e.bg(t,n.u_gamma_scale),u_device_pixel_ratio:new e.bg(t,n.u_device_pixel_ratio),u_is_halo:new e.bP(t,n.u_is_halo),u_translation:new e.bU(t,n.u_translation),u_pitched_scale:new e.bg(t,n.u_pitched_scale)}),background:(t,n)=>({u_opacity:new e.bg(t,n.u_opacity),u_color:new e.bQ(t,n.u_color)}),backgroundPattern:(t,n)=>({u_opacity:new e.bg(t,n.u_opacity),u_image:new e.bP(t,n.u_image),u_pattern_tl_a:new e.bU(t,n.u_pattern_tl_a),u_pattern_br_a:new e.bU(t,n.u_pattern_br_a),u_pattern_tl_b:new e.bU(t,n.u_pattern_tl_b),u_pattern_br_b:new e.bU(t,n.u_pattern_br_b),u_texsize:new e.bU(t,n.u_texsize),u_mix:new e.bg(t,n.u_mix),u_pattern_size_a:new e.bU(t,n.u_pattern_size_a),u_pattern_size_b:new e.bU(t,n.u_pattern_size_b),u_scale_a:new e.bg(t,n.u_scale_a),u_scale_b:new e.bg(t,n.u_scale_b),u_pixel_coord_upper:new e.bU(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.bU(t,n.u_pixel_coord_lower),u_tile_units_to_pixels:new e.bg(t,n.u_tile_units_to_pixels)}),terrain:(t,n)=>({u_texture:new e.bP(t,n.u_texture),u_ele_delta:new e.bg(t,n.u_ele_delta),u_fog_matrix:new e.bR(t,n.u_fog_matrix),u_fog_color:new e.bQ(t,n.u_fog_color),u_fog_ground_blend:new e.bg(t,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new e.bg(t,n.u_fog_ground_blend_opacity),u_horizon_color:new e.bQ(t,n.u_horizon_color),u_horizon_fog_blend:new e.bg(t,n.u_horizon_fog_blend),u_is_globe_mode:new e.bg(t,n.u_is_globe_mode)}),terrainDepth:(t,n)=>({u_ele_delta:new e.bg(t,n.u_ele_delta)}),terrainCoords:(t,n)=>({u_texture:new e.bP(t,n.u_texture),u_terrain_coords_id:new e.bg(t,n.u_terrain_coords_id),u_ele_delta:new e.bg(t,n.u_ele_delta)}),projectionErrorMeasurement:(t,n)=>({u_input:new e.bg(t,n.u_input),u_output_expected:new e.bg(t,n.u_output_expected)}),atmosphere:(t,n)=>({u_sun_pos:new e.bT(t,n.u_sun_pos),u_atmosphere_blend:new e.bg(t,n.u_atmosphere_blend),u_globe_position:new e.bT(t,n.u_globe_position),u_globe_radius:new e.bg(t,n.u_globe_radius),u_inv_proj_matrix:new e.bR(t,n.u_inv_proj_matrix)}),sky:(t,n)=>({u_sky_color:new e.bQ(t,n.u_sky_color),u_horizon_color:new e.bQ(t,n.u_horizon_color),u_horizon:new e.bU(t,n.u_horizon),u_horizon_normal:new e.bU(t,n.u_horizon_normal),u_sky_horizon_blend:new e.bg(t,n.u_sky_horizon_blend),u_sky_blend:new e.bg(t,n.u_sky_blend)})};class oi{constructor(t,e,n){this.context=t;const i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const li={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ci{constructor(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error("Length of new data is ".concat(t.length,", which doesn't match current length of ").concat(this.length));const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const i=e.attributes[this.attributes[n].name];void 0!==i&&t.enableVertexAttribArray(i)}}setVertexAttribPointers(t,e,n){for(let i=0;i<this.attributes.length;i++){const r=this.attributes[i],a=e.attributes[r.name];void 0!==a&&t.vertexAttribPointer(a,r.components,t[li[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ui{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class hi extends ui{getDefault(){return e.bf.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class di extends ui{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class fi extends ui{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class pi extends ui{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class mi extends ui{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class gi extends ui{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class _i extends ui{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class yi extends ui{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class vi extends ui{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class bi extends ui{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class xi extends ui{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class wi extends ui{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Si extends ui{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class Pi extends ui{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Mi extends ui{getDefault(){return e.bf.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ai extends ui{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class ki extends ui{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class Ei extends ui{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Ti extends ui{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Ci extends ui{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Ii extends ui{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Li extends ui{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class zi extends ui{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Ni extends ui{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Di extends ui{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ri extends ui{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Fi extends ui{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Oi extends ui{getDefault(){return null}set(t){var e;if(t===this.current&&!this.dirty)return;const n=this.gl;We(n)?n.bindVertexArray(t):null===(e=n.getExtension("OES_vertex_array_object"))||void 0===e||e.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Bi extends ui{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class ji extends ui{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Ui extends ui{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Gi extends ui{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class qi extends Gi{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Vi extends Gi{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Zi extends Gi{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Wi="Framebuffer is not complete";class Hi{constructor(t,e,n,i,r){this.context=t,this.width=e,this.height=n;const a=t.gl,s=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new qi(t,s),i)this.depthAttachment=r?new Zi(t,s):new Vi(t,s);else if(r)throw new Error("Stencil cannot be set without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error(Wi)}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Xi{constructor(t){var e,n;if(this.gl=t,this.clearColor=new hi(this),this.clearDepth=new di(this),this.clearStencil=new fi(this),this.colorMask=new pi(this),this.depthMask=new mi(this),this.stencilMask=new gi(this),this.stencilFunc=new _i(this),this.stencilOp=new yi(this),this.stencilTest=new vi(this),this.depthRange=new bi(this),this.depthTest=new xi(this),this.depthFunc=new wi(this),this.blend=new Si(this),this.blendFunc=new Pi(this),this.blendColor=new Mi(this),this.blendEquation=new Ai(this),this.cullFace=new ki(this),this.cullFaceSide=new Ei(this),this.frontFace=new Ti(this),this.program=new Ci(this),this.activeTexture=new Ii(this),this.viewport=new Li(this),this.bindFramebuffer=new zi(this),this.bindRenderbuffer=new Ni(this),this.bindTexture=new Di(this),this.bindVertexBuffer=new Ri(this),this.bindElementBuffer=new Fi(this),this.bindVertexArray=new Oi(this),this.pixelStoreUnpack=new Bi(this),this.pixelStoreUnpackPremultiplyAlpha=new ji(this),this.pixelStoreUnpackFlipY=new Ui(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),We(t)){this.HALF_FLOAT=t.HALF_FLOAT;const i=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(e=t.RGBA16F)&&void 0!==e?e:null==i?void 0:i.RGBA16F_EXT,this.RGB16F=null!==(n=t.RGB16F)&&void 0!==n?n:null==i?void 0:i.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const e=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==e?void 0:e.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new oi(this,t,e)}createVertexBuffer(t,e,n){return new ci(this,t,e,n)}createRenderbuffer(t,e,n){const i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,n,i){return new Hi(this,t,e,n,i)}clear(t){let{color:e,depth:n,stencil:i}=t;const r=this.gl;let a=0;e&&(a|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(a|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),void 0!==i&&(a|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),r.clear(a)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){e.bH(t.blendFunction,Be.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return We(this.gl)?this.gl.createVertexArray():null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var e;return We(this.gl)?this.gl.deleteVertexArray(t):null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Yi;function Ki(t,n,i,r,a){const s=t.context,o=t.transform,l=s.gl,c=t.useProgram("collisionBox"),u=[];let h=0,d=0;for(let e=0;e<r.length;e++){const f=r[e],p=n.getTile(f).getBucket(i);if(!p)continue;const m=a?p.textCollisionBox:p.iconCollisionBox,g=p.collisionCircleArray;g.length>0&&(u.push({circleArray:g,circleOffset:d,coord:f}),h+=g.length/4,d=h),m&&c.draw(s,l.LINES,Ge.disabled,Ve.disabled,t.colorModeForRenderPass(),Ue.disabled,Fn(t.transform),t.style.map.terrain&&t.style.map.terrain.getTerrainData(f),o.getProjectionData({overscaledTileID:f,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),i.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,t.transform.zoom,null,null,m.collisionVertexBuffer)}if(!a||!u.length)return;const f=t.useProgram("collisionCircle"),p=new e.b$;p.resize(4*h),p._trim();let m=0;for(const e of u)for(let t=0;t<e.circleArray.length/4;t++){const n=4*t,i=e.circleArray[n+0],r=e.circleArray[n+1],a=e.circleArray[n+2],s=e.circleArray[n+3];p.emplace(m++,i,r,a,s,0),p.emplace(m++,i,r,a,s,1),p.emplace(m++,i,r,a,s,2),p.emplace(m++,i,r,a,s,3)}(!Yi||Yi.length<2*h)&&(Yi=function(t){const n=2*t,i=new e.c1;i.resize(n),i._trim();for(let e=0;e<n;e++){const t=6*e;i.uint16[t+0]=4*e+0,i.uint16[t+1]=4*e+1,i.uint16[t+2]=4*e+2,i.uint16[t+3]=4*e+2,i.uint16[t+4]=4*e+3,i.uint16[t+5]=4*e+0}return i}(h));const g=s.createIndexBuffer(Yi,!0),_=s.createVertexBuffer(p,e.c0.members,!0);for(const y of u){const n=On(t.transform);f.draw(s,l.TRIANGLES,Ge.disabled,Ve.disabled,t.colorModeForRenderPass(),Ue.disabled,n,t.style.map.terrain&&t.style.map.terrain.getTerrainData(y.coord),null,i.id,_,g,e.aM.simpleSegment(0,2*y.circleOffset,y.circleArray.length,y.circleArray.length/2),null,t.transform.zoom,null,null,null)}_.destroy(),g.destroy()}const Ji=e.ag(new Float32Array(16));function $i(t,n,i,r,a,s){const{horizontalAlign:o,verticalAlign:l}=e.aH(t);return new e.P((-(o-.5)*n/a+r[0])*s,(-(l-.5)*i/a+r[1])*s)}function Qi(t,n,i,r,a,s){const o=n.tileAnchorPoint.add(new e.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let t=r.mult(s);i||(t=t.rotate(-a));const e=o.add(t);return Tt(e.x,e.y,n.pitchedLabelPlaneMatrix,n.getElevation).point}if(i){const e=Ot(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(t),i=Math.atan(e.y/e.x)+(e.x<0?Math.PI:0);return t.add(r.rotate(i))}return t.add(r)}function tr(t,n,i,r,a,s,o,l,c,u,h,d){const f=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,m=t.icon.dynamicLayoutVertexArray,g={};p.clear();for(let _=0;_<f.length;_++){const m=f.get(_),y=m.hidden||!m.crossTileID||t.allowVerticalPlacement&&!m.placedOrientation?null:r[m.crossTileID];if(y){const r=new e.P(m.anchorX,m.anchorY),f={getElevation:d,width:a.width,height:a.height,pitchedLabelPlaneMatrix:s,pitchWithMap:i,transform:a,tileAnchorPoint:r,translation:u,unwrappedTileID:h},_=i?jt(r.x,r.y,f):Ot(r.x,r.y,f),v=Ct(a.cameraToCenterDistance,_.signedDistanceFromCamera);let b=e.ap(t.textSizeData,l,m)*v/e.aB;i&&(b*=t.tilePixelRatio/o);const{width:x,height:w,anchor:S,textOffset:P,textBoxScale:M}=y,A=$i(S,x,w,P,M,b),k=a.getPitchedTextCorrection(r.x+u[0],r.y+u[1],h),E=Qi(_.point,f,n,A,-a.bearingInRadians,k),T=t.allowVerticalPlacement&&m.placedOrientation===e.ao.vertical?Math.PI/2:0;for(let t=0;t<m.numGlyphs;t++)e.av(p,E,T);c&&m.associatedIconIndex>=0&&(g[m.associatedIconIndex]={shiftedAnchor:E,angle:T})}else Zt(m.numGlyphs,p)}if(c){m.clear();const n=t.icon.placedSymbolArray;for(let t=0;t<n.length;t++){const i=n.get(t);if(i.hidden)Zt(i.numGlyphs,m);else{const n=g[t];if(n)for(let t=0;t<i.numGlyphs;t++)e.av(m,n.shiftedAnchor,n.angle);else Zt(i.numGlyphs,m)}}t.icon.dynamicLayoutVertexBuffer.updateData(m)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function er(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function nr(t,n,i,r,a,s,o,l,c,u,h,d,f){const p=t.context,m=p.gl,g=t.transform,_="map"===l,y="map"===c,v="viewport"!==l&&"point"!==i.layout.get("symbol-placement"),b=_&&!y&&!v,x=!i.layout.get("symbol-sort-key").isConstant();let w=!1;const S=t.getDepthModeForSublayer(0,Ge.ReadOnly),P=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),M=[],A=g.getCircleRadiusCorrection();for(const k of r){const r=n.getTile(k),l=r.getBucket(i);if(!l)continue;const c=a?l.text:l.icon;if(!c||!c.segments.get().length||!c.hasVisibleVertices)continue;const h=c.programConfigurations.get(i.id),d=a||l.sdfIcons,p=a?l.textSizeData:l.iconSizeData,S=y||0!==g.pitch,E=t.useProgram(er(d,a,l),h),T=e.an(p,g.zoom),C=t.style.map.terrain&&t.style.map.terrain.getTerrainData(k);let I,L,z,N,D=[0,0],R=null;if(a)L=r.glyphAtlasTexture,z=m.LINEAR,I=r.glyphAtlasTexture.size,l.iconsInText&&(D=r.imageAtlasTexture.size,R=r.imageAtlasTexture,N=S||t.options.rotating||t.options.zooming||"composite"===p.kind||"camera"===p.kind?m.LINEAR:m.NEAREST);else{const e=1!==i.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;L=r.imageAtlasTexture,z=d||t.options.rotating||t.options.zooming||e||S?m.LINEAR:m.NEAREST,I=r.imageAtlasTexture.size}const F=e.aC(r,1,t.transform.zoom),O=At(_,t.transform,F),B=e.L();e.aq(B,O);const j=kt(y,_,t.transform,F),U=e.aD(g,r,s,o),G=g.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!f,applyTerrainMatrix:!0}),q=P&&l.hasTextData(),V="none"!==i.layout.get("icon-text-fit")&&q&&l.hasIconData();if(v){const e=t.style.map.terrain?(e,n)=>t.style.map.terrain.getElevation(k,e,n):null,n="map"===i.layout.get("text-rotation-alignment");Lt(l,t,a,O,B,y,u,n,k.toUnwrapped(),g.width,g.height,U,e)}const Z=a&&P||V,W=v||Z?Ji:y?O:t.transform.clipSpaceToPixelsMatrix,H=d&&0!==i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let X;X=d?l.iconsInText?ni(p.kind,T,b,y,v,Z,t,W,j,U,I,D,A):ei(p.kind,T,b,y,v,Z,t,W,j,U,a,I,0,A):ti(p.kind,T,b,y,v,Z,t,W,j,U,a,I,A);const Y={program:E,buffers:c,uniformValues:X,projectionData:G,atlasTexture:L,atlasTextureIcon:R,atlasInterpolation:z,atlasInterpolationIcon:N,isSDF:d,hasHalo:H};if(x&&l.canOverlap){w=!0;const t=c.segments.get();for(const n of t)M.push({segments:new e.aM([n]),sortKey:n.sortKey,state:Y,terrainData:C})}else M.push({segments:c.segments,sortKey:0,state:Y,terrainData:C})}w&&M.sort((t,e)=>t.sortKey-e.sortKey);for(const e of M){const n=e.state;if(p.activeTexture.set(m.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,m.CLAMP_TO_EDGE),n.atlasTextureIcon&&(p.activeTexture.set(m.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,ir(n.buffers,e.segments,i,t,n.program,S,h,d,r,n.projectionData,e.terrainData)),r.u_is_halo=0}ir(n.buffers,e.segments,i,t,n.program,S,h,d,n.uniformValues,n.projectionData,e.terrainData)}}function ir(t,e,n,i,r,a,s,o,l,c,u){const h=i.context;r.draw(h,h.gl.TRIANGLES,a,s,o,Ue.backCCW,l,u,c,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,i.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function rr(t,n,i,r,a){const s=t.context,o=s.gl,l=Ve.disabled,c=new Be([o.ONE,o.ONE],e.bf.transparent,[!0,!0,!0,!0]),u=n.getBucket(i);if(!u)return;const h=r.key;let d=i.heatmapFbos.get(h);d||(d=sr(s,n.tileSize,n.tileSize),i.heatmapFbos.set(h,d)),s.bindFramebuffer.set(d.framebuffer),s.viewport.set([0,0,n.tileSize,n.tileSize]),s.clear({color:e.bf.transparent});const f=u.programConfigurations.get(i.id),p=t.useProgram("heatmap",f,!a),m=t.transform.getProjectionData({overscaledTileID:n.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),g=t.style.map.terrain.getTerrainData(r);p.draw(s,o.TRIANGLES,Ge.disabled,l,c,Ue.disabled,jn(n,t.transform.zoom,i.paint.get("heatmap-intensity"),1),g,m,i.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,i.paint,t.transform.zoom,f)}function ar(t,e,n,i,r){const a=t.context,s=a.gl,o=t.transform;a.setColorMode(t.colorModeForRenderPass());const l=or(a,e),c=n.key,u=e.heatmapFbos.get(c);if(!u)return;a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,u.colorAttachment.get()),a.activeTexture.set(s.TEXTURE1),l.bind(s.LINEAR,s.CLAMP_TO_EDGE);const h=o.getProjectionData({overscaledTileID:n,applyTerrainMatrix:r,applyGlobeMatrix:!i});t.useProgram("heatmapTexture").draw(a,s.TRIANGLES,Ge.disabled,Ve.disabled,t.colorModeForRenderPass(),Ue.disabled,Un(t,e,0,1),null,h,e.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments,e.paint,o.zoom),u.destroy(),e.heatmapFbos.delete(c)}function sr(t,e,n){var i,r;const a=t.gl,s=a.createTexture();a.bindTexture(a.TEXTURE_2D,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);const o=null!==(i=t.HALF_FLOAT)&&void 0!==i?i:a.UNSIGNED_BYTE,l=null!==(r=t.RGBA16F)&&void 0!==r?r:a.RGBA;a.texImage2D(a.TEXTURE_2D,0,l,e,n,0,a.RGBA,o,null);const c=t.createFramebuffer(e,n,!1,!1);return c.colorAttachment.set(s),c}function or(t,n){return n.colorRampTexture||(n.colorRampTexture=new e.T(t,n.colorRamp,t.gl.RGBA)),n.colorRampTexture}function lr(t,e,n,i,r){if(!n||!i||!i.imageAtlas)return;const a=i.imageAtlas.patternPositions;let s=a[n.to.toString()],o=a[n.from.toString()];if(!s&&o&&(s=o),!o&&s&&(o=s),!s||!o){const t=r.getPaintProperty(e);s=a[t],o=a[t]}s&&o&&t.setConstantPatternPositions(s,o)}function cr(t,n,i,r,a,s,o,l){const c=t.context.gl,u="fill-pattern",h=i.paint.get(u),d=h&&h.constantOr(1),f=i.getCrossfadeParameters();let p,m,g,_,y;const v=t.transform,b=i.paint.get("fill-translate"),x=i.paint.get("fill-translate-anchor");o?(m=d&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=c.LINES):(m=d?"fillPattern":"fill",p=c.TRIANGLES);const w=h.constantOr(null);for(const S of r){const r=n.getTile(S);if(d&&!r.patternsLoaded())continue;const h=r.getBucket(i);if(!h)continue;const P=h.programConfigurations.get(i.id),M=t.useProgram(m,P),A=t.style.map.terrain&&t.style.map.terrain.getTerrainData(S);d&&(t.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),P.updatePaintBuffers(f)),lr(P,u,w,r,i);const k=v.getProjectionData({overscaledTileID:S,applyGlobeMatrix:!l,applyTerrainMatrix:!0}),E=e.aD(v,r,b,x);if(o){_=h.indexBuffer2,y=h.segments2;const e=[c.drawingBufferWidth,c.drawingBufferHeight];g="fillOutlinePattern"===m&&d?Dn(t,f,r,e,E):Nn(e,E)}else _=h.indexBuffer,y=h.segments,g=d?zn(t,f,r,E):{u_fill_translate:E};const T=t.stencilModeForClipping(S);M.draw(t.context,p,a,T,s,Ue.backCCW,g,A,k,i.id,h.layoutVertexBuffer,_,y,i.paint,t.transform.zoom,P)}}function ur(t,n,i,r,a,s,o,l){const c=t.context,u=c.gl,h="fill-extrusion-pattern",d=i.paint.get(h),f=d.constantOr(1),p=i.getCrossfadeParameters(),m=i.paint.get("fill-extrusion-opacity"),g=d.constantOr(null),_=t.transform;for(const y of r){const r=n.getTile(y),d=r.getBucket(i);if(!d)continue;const v=t.style.map.terrain&&t.style.map.terrain.getTerrainData(y),b=d.programConfigurations.get(i.id),x=t.useProgram(f?"fillExtrusionPattern":"fillExtrusion",b);f&&(t.context.activeTexture.set(u.TEXTURE0),r.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),b.updatePaintBuffers(p));const w=_.getProjectionData({overscaledTileID:y,applyGlobeMatrix:!l,applyTerrainMatrix:!0});lr(b,h,g,r,i);const S=e.aD(_,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),P=i.paint.get("fill-extrusion-vertical-gradient"),M=f?Ln(t,P,m,S,y,p,r):In(t,P,m,S);x.draw(c,c.gl.TRIANGLES,a,s,o,Ue.backCCW,M,v,w,i.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,i.paint,t.transform.zoom,b,t.style.map.terrain&&d.centroidVertexBuffer)}}function hr(t,e,n,i,r,a,s,o,l){var c;const u=t.style.projection,h=t.context,d=t.transform,f=h.gl,p=["#define NUM_ILLUMINATION_SOURCES ".concat(n.paint.get("hillshade-highlight-color").values.length)],m=t.useProgram("hillshade",null,!1,p),g=!t.options.moving;for(const _ of i){const i=e.getTile(_),p=i.fbo;if(!p)continue;const y=u.getMeshFromTileID(h,_.canonical,o,!0,"raster"),v=null===(c=t.style.map.terrain)||void 0===c?void 0:c.getTerrainData(_);h.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,p.colorAttachment.get());const b=d.getProjectionData({overscaledTileID:_,aligned:g,applyGlobeMatrix:!l,applyTerrainMatrix:!0});m.draw(h,f.TRIANGLES,a,r[_.overscaledZ],s,Ue.backCCW,Gn(t,i,n),v,b,n.id,y.vertexBuffer,y.indexBuffer,y.segments)}}function dr(t,n,i,r,a,s,o,l,c){var u;const h=t.style.projection,d=t.context,f=t.transform,p=d.gl,m=t.useProgram("colorRelief"),g=!t.options.moving;let _=!0,y=0;for(const v of r){const r=n.getTile(v),b=r.dem;if(_){const t=p.getParameter(p.MAX_TEXTURE_SIZE),{elevationTexture:e,colorTexture:n}=i.getColorRampTextures(d,t,b.getUnpackVector());d.activeTexture.set(p.TEXTURE1),e.bind(p.NEAREST,p.CLAMP_TO_EDGE),d.activeTexture.set(p.TEXTURE4),n.bind(p.LINEAR,p.CLAMP_TO_EDGE),_=!1,y=e.size[0]}if(!b||!b.data)continue;const x=b.stride,w=b.getPixels();if(d.activeTexture.set(p.TEXTURE0),d.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(x),r.demTexture){const t=r.demTexture;t.update(w,{premultiply:!1}),t.bind(p.LINEAR,p.CLAMP_TO_EDGE)}else r.demTexture=new e.T(d,w,p.RGBA,{premultiply:!1}),r.demTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE);const S=h.getMeshFromTileID(d,v.canonical,l,!0,"raster"),P=null===(u=t.style.map.terrain)||void 0===u?void 0:u.getTerrainData(v),M=f.getProjectionData({overscaledTileID:v,aligned:g,applyGlobeMatrix:!c,applyTerrainMatrix:!0});m.draw(d,p.TRIANGLES,s,a[v.overscaledZ],o,Ue.backCCW,Zn(i,r.dem,y),P,M,i.id,S.vertexBuffer,S.indexBuffer,S.segments)}}const fr=[new e.P(0,0),new e.P(e.$,0),new e.P(e.$,e.$),new e.P(0,e.$)];function pr(t,e,n,i,r,a,s,o){let l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=arguments.length>9&&void 0!==arguments[9]&&arguments[9];const u=i[i.length-1].overscaledZ,h=t.context,d=h.gl,f=t.useProgram("raster"),p=t.transform,m=t.style.projection,g=t.colorModeForRenderPass(),_=!t.options.moving;for(const y of i){const i=t.getDepthModeForSublayer(y.overscaledZ-u,1===n.paint.get("raster-opacity")?Ge.ReadWrite:Ge.ReadOnly,d.LESS),v=e.getTile(y);v.registerFadeDuration(n.paint.get("raster-fade-duration"));const b=e.findLoadedParent(y,0),x=e.findLoadedSibling(y),w=mr(v,b||x||null,e,n,t.transform,t.style.map.terrain);let S,P;const M="nearest"===n.paint.get("raster-resampling")?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),v.texture.bind(M,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),b?(b.texture.bind(M,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),S=Math.pow(2,b.tileID.overscaledZ-v.tileID.overscaledZ),P=[v.tileID.canonical.x*S%1,v.tileID.canonical.y*S%1]):v.texture.bind(M,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),v.texture.useMipmap&&h.extTextureFilterAnisotropic&&t.transform.pitch>20&&d.texParameterf(d.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax);const A=t.style.map.terrain&&t.style.map.terrain.getTerrainData(y),k=p.getProjectionData({overscaledTileID:y,aligned:_,applyGlobeMatrix:!c,applyTerrainMatrix:!0}),E=$n(P||[0,0],S||1,w,n,o),T=m.getMeshFromTileID(h,y.canonical,a,s,"raster");f.draw(h,d.TRIANGLES,i,r?r[y.overscaledZ]:Ve.disabled,g,l?Ue.frontCCW:Ue.backCCW,E,A,k,n.id,T.vertexBuffer,T.indexBuffer,T.segments)}}function mr(t,n,i,r,a,o){const l=r.paint.get("raster-fade-duration");if(!o&&l>0){const r=s.now(),o=(r-t.timeAdded)/l,c=n?(r-n.timeAdded)/l:-1,u=i.getSource(),h=_t(a,{tileSize:u.tileSize,roundZoom:u.roundZoom}),d=!n||Math.abs(n.tileID.overscaledZ-h)>Math.abs(t.tileID.overscaledZ-h),f=d&&t.refreshedUponExpiration?1:e.ah(d?o:1-c,0,1);return t.refreshedUponExpiration&&o>=1&&(t.refreshedUponExpiration=!1),n?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}const gr=new e.bf(1,0,0,1),_r=new e.bf(0,1,0,1),yr=new e.bf(0,0,1,1),vr=new e.bf(1,0,1,1),br=new e.bf(0,1,1,1);function xr(t,e,n,i){Sr(t,0,e+n/2,t.transform.width,n,i)}function wr(t,e,n,i){Sr(t,e-n/2,0,n,t.transform.height,i)}function Sr(t,e,n,i,r,a){const s=t.context,o=s.gl;o.enable(o.SCISSOR_TEST),o.scissor(e*t.pixelRatio,n*t.pixelRatio,i*t.pixelRatio,r*t.pixelRatio),s.clear({color:a}),o.disable(o.SCISSOR_TEST)}function Pr(t,n,i){const r=t.context,a=r.gl,s=t.useProgram("debug"),o=Ge.disabled,l=Ve.disabled,c=t.colorModeForRenderPass(),u="$debug",h=t.style.map.terrain&&t.style.map.terrain.getTerrainData(i);r.activeTexture.set(a.TEXTURE0);const d=n.getTileByID(i.key).latestRawTileData,f=Math.floor((d&&d.byteLength||0)/1024),p=n.getTile(i).tileSize,m=512/Math.min(p,512)*(i.overscaledZ/t.transform.zoom)*.5;let g=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(g+=" => ".concat(i.overscaledZ)),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,i=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(t,"".concat(g," ").concat(f,"kB"));const _=t.transform.getProjectionData({overscaledTileID:i,applyGlobeMatrix:!0,applyTerrainMatrix:!0});s.draw(r,a.TRIANGLES,o,l,Be.alphaBlended,Ue.disabled,Bn(e.bf.transparent,m),null,_,u,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),s.draw(r,a.LINE_STRIP,o,l,c,Ue.disabled,Bn(e.bf.red),h,_,u,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function Mr(t,e,n,i){const{isRenderingGlobe:r}=i,a=t.context,s=a.gl,o=t.transform,l=t.colorModeForRenderPass(),c=t.getDepthModeFor3D(),u=t.useProgram("terrain");a.bindFramebuffer.set(null),a.viewport.set([0,0,t.width,t.height]);for(const h of n){const n=e.getTerrainMesh(h.tileID),i=t.renderToTexture.getTexture(h),d=e.getTerrainData(h.tileID);a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,i.texture);const f=e.getMeshFrameDelta(o.zoom),p=o.calculateFogMatrix(h.tileID.toUnwrapped()),m=An(f,p,t.style.sky,o.pitch,r),g=o.getProjectionData({overscaledTileID:h.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});u.draw(a,s.TRIANGLES,c,Ve.disabled,l,Ue.backCCW,m,d,g,"terrain",n.vertexBuffer,n.indexBuffer,n.segments)}}function Ar(t,n){if(!n.mesh){const i=new e.aL;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(1,1),i.emplaceBack(-1,1);const r=new e.aN;r.emplaceBack(0,1,2),r.emplaceBack(0,2,3),n.mesh=new we(t.createVertexBuffer(i,Se.members),t.createIndexBuffer(r),e.aM.simpleSegment(0,0,i.length,r.length))}return n.mesh}class kr{constructor(t,n){this.context=new Xi(t),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:e.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=bt.maxUnderzooming+bt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ye}resize(t,e,n){if(this.width=Math.floor(t*n),this.height=Math.floor(e*n),this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const i of this.style._order)this.style._layers[i].resize()}setup(){const t=this.context,n=new e.aL;n.emplaceBack(0,0),n.emplaceBack(e.$,0),n.emplaceBack(0,e.$),n.emplaceBack(e.$,e.$),this.tileExtentBuffer=t.createVertexBuffer(n,Se.members),this.tileExtentSegments=e.aM.simpleSegment(0,0,4,2);const i=new e.aL;i.emplaceBack(0,0),i.emplaceBack(e.$,0),i.emplaceBack(0,e.$),i.emplaceBack(e.$,e.$),this.debugBuffer=t.createVertexBuffer(i,Se.members),this.debugSegments=e.aM.simpleSegment(0,0,4,5);const r=new e.c6;r.emplaceBack(0,0,0,0),r.emplaceBack(e.$,0,e.$,0),r.emplaceBack(0,e.$,0,e.$),r.emplaceBack(e.$,e.$,e.$,e.$),this.rasterBoundsBuffer=t.createVertexBuffer(r,Pn.members),this.rasterBoundsSegments=e.aM.simpleSegment(0,0,4,2);const a=new e.aL;a.emplaceBack(0,0),a.emplaceBack(e.$,0),a.emplaceBack(0,e.$),a.emplaceBack(e.$,e.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(a,Se.members),this.rasterBoundsSegmentsPosOnly=e.aM.simpleSegment(0,0,4,5);const s=new e.aL;s.emplaceBack(0,0),s.emplaceBack(1,0),s.emplaceBack(0,1),s.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(s,Se.members),this.viewportSegments=e.aM.simpleSegment(0,0,4,2);const o=new e.c7;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(o);const l=new e.aN;l.emplaceBack(1,0,2),l.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(l);const c=this.context.gl;this.stencilClearMode=new Ve({func:c.ALWAYS,mask:0},0,255,c.ZERO,c.ZERO,c.ZERO),this.tileExtentMesh=new we(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,n=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const i=e.L();e.bY(i,0,this.width,this.height,0,0,1),e.N(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const r={mainMatrix:i,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:i};this.useProgram("clippingMask",null,!0).draw(t,n.TRIANGLES,Ge.disabled,this.stencilClearMode,Be.disabled,Ue.disabled,null,null,r,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,e,n){if(this.currentStencilSource===t.source||!t.isTileClipped()||!e||!e.length)return;this.currentStencilSource=t.source,this.nextStencilID+e.length>256&&this.clearStencil();const i=this.context;i.setColorMode(Be.disabled),i.setDepthMode(Ge.disabled);const r={};for(const a of e)r[a.key]=this.nextStencilID++;this._renderTileMasks(r,e,n,!0),this._renderTileMasks(r,e,n,!1),this._tileClippingMaskIDs=r}_renderTileMasks(t,e,n,i){const r=this.context,a=r.gl,s=this.style.projection,o=this.transform,l=this.useProgram("clippingMask");for(const c of e){const e=t[c.key],u=this.style.map.terrain&&this.style.map.terrain.getTerrainData(c),h=s.getMeshFromTileID(this.context,c.canonical,i,!0,"stencil"),d=o.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!n,applyTerrainMatrix:!0});l.draw(r,a.TRIANGLES,Ge.disabled,new Ve({func:a.ALWAYS,mask:0},e,255,a.KEEP,a.KEEP,a.REPLACE),Be.disabled,n?Ue.disabled:Ue.backCCW,null,u,d,"$clipping",h.vertexBuffer,h.indexBuffer,h.segments)}}_renderTilesDepthBuffer(){const t=this.context,e=t.gl,n=this.style.projection,i=this.transform,r=this.useProgram("depth"),a=this.getDepthModeFor3D(),s=yt(i,{tileSize:i.tileSize});for(const o of s){const s=this.style.map.terrain&&this.style.map.terrain.getTerrainData(o),l=n.getMeshFromTileID(this.context,o.canonical,!0,!0,"raster"),c=i.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});r.draw(t,e.TRIANGLES,a,Ve.disabled,Be.disabled,Ue.backCCW,null,s,c,"$clipping",l.vertexBuffer,l.indexBuffer,l.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,e=this.context.gl;return new Ve({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}stencilModeForClipping(t){const e=this.context.gl;return new Ve({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const e=this.context.gl,n=t.sort((t,e)=>e.overscaledZ-t.overscaledZ),i=n[n.length-1].overscaledZ,r=n[0].overscaledZ-i+1;if(r>1){this.currentStencilSource=void 0,this.nextStencilID+r>256&&this.clearStencil();const t={};for(let n=0;n<r;n++)t[n+i]=new Ve({func:e.GEQUAL,mask:255},n+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=r,[t,n]}return[{[i]:Ve.disabled},n]}stencilConfigForOverlapTwoPass(t){const e=this.context.gl,n=t.sort((t,e)=>e.overscaledZ-t.overscaledZ),i=n[n.length-1].overscaledZ,r=n[0].overscaledZ-i+1;if(this.clearStencil(),r>1){const t={},a={};for(let n=0;n<r;n++)t[n+i]=new Ve({func:e.GREATER,mask:255},r+1+n,255,e.KEEP,e.KEEP,e.REPLACE),a[n+i]=new Ve({func:e.GREATER,mask:255},1+n,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID=2*r+1,[t,a,n]}return this.nextStencilID=3,[{[i]:new Ve({func:e.GREATER,mask:255},2,255,e.KEEP,e.KEEP,e.REPLACE)},{[i]:new Ve({func:e.GREATER,mask:255},1,255,e.KEEP,e.KEEP,e.REPLACE)},n]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new Be([t.CONSTANT_COLOR,t.ONE],new e.bf(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Be.unblended:Be.alphaBlended}getDepthModeForSublayer(t,e,n){if(!this.opaquePassEnabledForLayer())return Ge.disabled;const i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Ge(n||this.context.gl.LEQUAL,e,[i,i])}getDepthModeFor3D(){return new Ge(this.context.gl.LEQUAL,Ge.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,n){var i,r;this.style=t,this.options=n,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(s.now()),this.imageManager.beginFrame();const a=this.style._order,o=this.style.sourceCaches,l={},c={},u={},h={isRenderingToTexture:!1,isRenderingGlobe:(null===(i=t.projection)||void 0===i?void 0:i.transitionState)>0};for(const e in o){const t=o[e];t.used&&t.prepare(this.context),l[e]=t.getVisibleCoordinates(!1),c[e]=l[e].slice().reverse(),u[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<a.length;e++)if(this.style._layers[a[e]].is3D()){this.opaquePassCutoff=e;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const e of a){const t=this.style._layers[e];if(!t.hasOffscreenPass()||t.isHidden(this.transform.zoom))continue;const n=c[t.source];("custom"===t.type||n.length)&&this.renderLayer(this,o[t.source],t,n,h)}if(null===(r=this.style.projection)||void 0===r||r.updateGPUdependent({context:this.context,useProgram:t=>this.useProgram(t)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?e.bf.black:e.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(t,e){const n=t.context,i=n.gl,r=((t,e,n)=>{const i=Math.cos(e.rollInRadians),r=Math.sin(e.rollInRadians),a=ut(e),s=e.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:t.properties.get("sky-color"),u_horizon_color:t.properties.get("horizon-color"),u_horizon:[(e.width/2-a*r)*n,(e.height/2+a*i)*n],u_horizon_normal:[-r,i],u_sky_horizon_blend:t.properties.get("sky-horizon-blend")*e.height/2*n,u_sky_blend:s}})(e,t.style.map.transform,t.pixelRatio),a=new Ge(i.LEQUAL,Ge.ReadWrite,[0,1]),s=Ve.disabled,o=t.colorModeForRenderPass(),l=t.useProgram("sky"),c=Ar(n,e);l.draw(n,i.TRIANGLES,a,s,o,Ue.disabled,r,null,void 0,"sky",c.vertexBuffer,c.indexBuffer,c.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[a[this.currentLayer]],e=o[t.source],n=l[t.source];this._renderTileClippingMasks(t,n,!1),this.renderLayer(this,e,t,n,h)}this.renderPass="translucent";let d=!1;for(this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){const t=this.style._layers[a[this.currentLayer]],e=o[t.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(t,h))continue;this.opaquePassEnabledForLayer()||d||(d=!0,h.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const n=("symbol"===t.type?u:c)[t.source];this._renderTileClippingMasks(t,l[t.source],!!this.renderToTexture),this.renderLayer(this,e,t,n,h)}if(h.isRenderingGlobe&&function(t,n,i){const r=t.context,a=r.gl,s=t.useProgram("atmosphere"),o=new Ge(a.LEQUAL,Ge.ReadOnly,[0,1]),l=t.transform,c=function(t,n){const i=t.properties.get("position"),r=[-i.x,-i.y,-i.z],a=e.ag(new Float64Array(16));return"map"===t.properties.get("anchor")&&(e.b6(a,a,n.rollInRadians),e.b7(a,a,-n.pitchInRadians),e.b6(a,a,n.bearingInRadians),e.b7(a,a,n.center.lat*Math.PI/180),e.bz(a,a,-n.center.lng*Math.PI/180)),e.c5(r,r,a),r}(i,t.transform),u=l.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),h=n.properties.get("atmosphere-blend")*u.projectionTransition;if(0===h)return;const d=rn(l.worldSize,l.center.lat),f=l.inverseProjectionMatrix,p=new Float64Array(4);p[3]=1,e.aw(p,p,l.modelViewProjectionMatrix),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3],p[3]=1,e.aw(p,p,f),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3],p[3]=1;const m=((t,e,n,i,r)=>({u_sun_pos:t,u_atmosphere_blend:e,u_globe_position:n,u_globe_radius:i,u_inv_proj_matrix:r}))(c,h,[p[0],p[1],p[2]],d,f),g=Ar(r,n);s.draw(r,a.TRIANGLES,o,Ve.disabled,Be.alphaBlended,Ue.disabled,m,null,null,"atmosphere",g.vertexBuffer,g.indexBuffer,g.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const t=function(t,e){let n=null;const i=Object.values(t._layers).flatMap(n=>n.source&&!n.isHidden(e)?[t.sourceCaches[n.source]]:[]),r=i.filter(t=>"vector"===t.getSource().type),a=i.filter(t=>"vector"!==t.getSource().type),s=t=>{(!n||n.getSource().maxzoom<t.getSource().maxzoom)&&(n=t)};return r.forEach(t=>s(t)),n||a.forEach(t=>s(t)),n}(this.style,this.transform.zoom);t&&function(t,e,n){for(let i=0;i<n.length;i++)Pr(t,e,n[i])}(this,t,t.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;xr(t,t.transform.height-(e.top||0),3,gr),xr(t,e.bottom||0,3,_r),wr(t,e.left||0,3,yr),wr(t,t.transform.width-(e.right||0),3,vr);const n=t.transform.centerPoint;!function(t,e,n,i){Sr(t,e-1,n-10,2,20,i),Sr(t,e-10,n-1,20,2,i)}(t,n.x,t.transform.height-n.y,br)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,i=this.transform.modelViewProjectionMatrix;let r=this.terrainFacilitator.dirty;r||(r=t?!e.c8(n,i):!e.c9(n,i)),r||(r=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),r&&(e.ca(n,i),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(t,n){const i=t.context,r=i.gl,a=t.transform,s=Be.unblended,o=new Ge(r.LEQUAL,Ge.ReadWrite,[0,1]),l=n.sourceCache.getRenderableTiles(),c=t.useProgram("terrainDepth");i.bindFramebuffer.set(n.getFramebuffer("depth").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:e.bf.transparent,depth:1});for(const e of l){const t=n.getTerrainMesh(e.tileID),l=n.getTerrainData(e.tileID),u=a.getProjectionData({overscaledTileID:e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),h={u_ele_delta:n.getMeshFrameDelta(a.zoom)};c.draw(i,r.TRIANGLES,o,Ve.disabled,s,Ue.backCCW,h,l,u,"terrain",t.vertexBuffer,t.indexBuffer,t.segments)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain),function(t,n){const i=t.context,r=i.gl,a=t.transform,s=Be.unblended,o=new Ge(r.LEQUAL,Ge.ReadWrite,[0,1]),l=n.getCoordsTexture(),c=n.sourceCache.getRenderableTiles(),u=t.useProgram("terrainCoords");i.bindFramebuffer.set(n.getFramebuffer("coords").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:e.bf.transparent,depth:1}),n.coordsIndex=[];for(const e of c){const t=n.getTerrainMesh(e.tileID),c=n.getTerrainData(e.tileID);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.texture);const h={u_terrain_coords_id:(255-n.coordsIndex.length)/255,u_texture:0,u_ele_delta:n.getMeshFrameDelta(a.zoom)},d=a.getProjectionData({overscaledTileID:e.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});u.draw(i,r.TRIANGLES,o,Ve.disabled,s,Ue.backCCW,h,c,d,"terrain",t.vertexBuffer,t.indexBuffer,t.segments),n.coordsIndex.push(e.tileID.key)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain))}renderLayer(t,n,i,r,a){i.isHidden(this.transform.zoom)||("background"===i.type||"custom"===i.type||(r||[]).length)&&(this.id=i.id,e.cb(i)?function(t,n,i,r,a,s){if("translucent"!==t.renderPass)return;const{isRenderingToTexture:o}=s,l=Ve.disabled,c=t.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(t,n,i,r,a,s,o,l,c){const u=n.transform,h=n.style.map.terrain,d="map"===a,f="map"===s;for(const p of t){const t=r.getTile(p),a=t.getBucket(i);if(!a||!a.text||!a.text.segments.get().length)continue;const s=e.an(a.textSizeData,u.zoom),m=e.aC(t,1,n.transform.zoom),g=At(d,n.transform,m),_="none"!==i.layout.get("icon-text-fit")&&a.hasIconData();if(s){const n=Math.pow(2,u.zoom-t.tileID.overscaledZ),i=h?(t,e)=>h.getElevation(p,t,e):null;tr(a,d,f,c,u,g,n,s,_,e.aD(u,t,o,l),p.toUnwrapped(),i)}}}(r,t,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),a),0!==i.paint.get("icon-opacity").constantOr(1)&&nr(t,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),l,c,o),0!==i.paint.get("text-opacity").constantOr(1)&&nr(t,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),l,c,o),n.map.showCollisionBoxes&&(Ki(t,n,i,r,!0),Ki(t,n,i,r,!1))}(t,n,i,r,this.style.placement.variableOffsets,a):e.cc(i)?function(t,n,i,r,a){if("translucent"!==t.renderPass)return;const{isRenderingToTexture:s}=a,o=i.paint.get("circle-opacity"),l=i.paint.get("circle-stroke-width"),c=i.paint.get("circle-stroke-opacity"),u=!i.layout.get("circle-sort-key").isConstant();if(0===o.constantOr(1)&&(0===l.constantOr(1)||0===c.constantOr(1)))return;const h=t.context,d=h.gl,f=t.transform,p=t.getDepthModeForSublayer(0,Ge.ReadOnly),m=Ve.disabled,g=t.colorModeForRenderPass(),_=[],y=f.getCircleRadiusCorrection();for(let v=0;v<r.length;v++){const a=r[v],o=n.getTile(a),l=o.getBucket(i);if(!l)continue;const c=i.paint.get("circle-translate"),h=i.paint.get("circle-translate-anchor"),d=e.aD(f,o,c,h),p=l.programConfigurations.get(i.id),m=t.useProgram("circle",p),g=l.layoutVertexBuffer,b=l.indexBuffer,x=t.style.map.terrain&&t.style.map.terrain.getTerrainData(a),w={programConfiguration:p,program:m,layoutVertexBuffer:g,indexBuffer:b,uniformValues:Rn(t,o,i,d,y),terrainData:x,projectionData:f.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!s,applyTerrainMatrix:!0})};if(u){const t=l.segments.get();for(const n of t)_.push({segments:new e.aM([n]),sortKey:n.sortKey,state:w})}else _.push({segments:l.segments,sortKey:0,state:w})}u&&_.sort((t,e)=>t.sortKey-e.sortKey);for(const e of _){const{programConfiguration:n,program:r,layoutVertexBuffer:a,indexBuffer:s,uniformValues:o,terrainData:l,projectionData:c}=e.state;r.draw(h,d.TRIANGLES,p,m,g,Ue.backCCW,o,l,c,i.id,a,s,e.segments,i.paint,t.transform.zoom,n)}}(t,n,i,r,a):e.cd(i)?function(t,n,i,r,a){if(0===i.paint.get("heatmap-opacity"))return;const s=t.context,{isRenderingToTexture:o,isRenderingGlobe:l}=a;if(t.style.map.terrain){for(const e of r){const r=n.getTile(e);n.hasRenderableParent(e)||("offscreen"===t.renderPass?rr(t,r,i,e,l):"translucent"===t.renderPass&&ar(t,i,e,o,l))}s.viewport.set([0,0,t.width,t.height])}else"offscreen"===t.renderPass?function(t,n,i,r){const a=t.context,s=a.gl,o=t.transform,l=Ve.disabled,c=new Be([s.ONE,s.ONE],e.bf.transparent,[!0,!0,!0,!0]);(function(t,n,i){const r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,n.width/4,n.height/4]);let a=i.heatmapFbos.get(e.c2);a?(r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),t.bindFramebuffer.set(a.framebuffer)):(a=sr(t,n.width/4,n.height/4),i.heatmapFbos.set(e.c2,a))})(a,t,i),a.clear({color:e.bf.transparent});for(let e=0;e<r.length;e++){const u=r[e];if(n.hasRenderableParent(u))continue;const h=n.getTile(u),d=h.getBucket(i);if(!d)continue;const f=d.programConfigurations.get(i.id),p=t.useProgram("heatmap",f),m=o.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),g=o.getCircleRadiusCorrection();p.draw(a,s.TRIANGLES,Ge.disabled,l,c,Ue.backCCW,jn(h,o.zoom,i.paint.get("heatmap-intensity"),g),null,m,i.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,i.paint,o.zoom,f)}a.viewport.set([0,0,t.width,t.height])}(t,n,i,r):"translucent"===t.renderPass&&function(t,n){const i=t.context,r=i.gl;i.setColorMode(t.colorModeForRenderPass());const a=n.heatmapFbos.get(e.c2);a&&(i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1),or(i,n).bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,r.TRIANGLES,Ge.disabled,Ve.disabled,t.colorModeForRenderPass(),Ue.disabled,Un(t,n,0,1),null,null,n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,n.paint,t.transform.zoom))}(t,i)}(t,n,i,r,a):e.ce(i)?function(t,n,i,r,a){if("translucent"!==t.renderPass)return;const{isRenderingToTexture:s}=a,o=i.paint.get("line-opacity"),l=i.paint.get("line-width");if(0===o.constantOr(1)||0===l.constantOr(1))return;const c=t.getDepthModeForSublayer(0,Ge.ReadOnly),u=t.colorModeForRenderPass(),h=i.paint.get("line-dasharray"),d=i.paint.get("line-pattern"),f=d.constantOr(1),p=i.paint.get("line-gradient"),m=i.getCrossfadeParameters(),g=f?"linePattern":h?"lineSDF":p?"lineGradient":"line",_=t.context,y=_.gl,v=t.transform;let b=!0;for(const x of r){const r=n.getTile(x);if(f&&!r.patternsLoaded())continue;const a=r.getBucket(i);if(!a)continue;const o=a.programConfigurations.get(i.id),l=t.context.program.get(),w=t.useProgram(g,o),S=b||w.program!==l,P=t.style.map.terrain&&t.style.map.terrain.getTerrainData(x),M=d.constantOr(null);if(M&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[M.to.toString()],n=t.patternPositions[M.from.toString()];e&&n&&o.setConstantPatternPositions(e,n)}const A=v.getProjectionData({overscaledTileID:x,applyGlobeMatrix:!s,applyTerrainMatrix:!0}),k=v.getPixelScale(),E=f?Xn(t,r,i,k,m):h?Yn(t,r,i,k,h,m):p?Hn(t,r,i,k,a.lineClipsArray.length):Wn(t,r,i,k);if(f)_.activeTexture.set(y.TEXTURE0),r.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),o.updatePaintBuffers(m);else if(h&&(S||t.lineAtlas.dirty))_.activeTexture.set(y.TEXTURE0),t.lineAtlas.bind(_);else if(p){const r=a.gradients[i.id];let s=r.texture;if(i.gradientVersion!==r.version){let o=256;if(i.stepInterpolant){const i=n.getSource().maxzoom,r=x.canonical.z===i?Math.ceil(1<<t.transform.maxZoom-x.canonical.z):1;o=e.ah(e.c3(a.maxLineLength/e.$*1024*r),256,_.maxTextureSize)}r.gradient=e.c4({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:o,image:r.gradient||void 0,clips:a.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new e.T(_,r.gradient,y.RGBA),r.version=i.gradientVersion,s=r.texture}_.activeTexture.set(y.TEXTURE0),s.bind(i.stepInterpolant?y.NEAREST:y.LINEAR,y.CLAMP_TO_EDGE)}const T=t.stencilModeForClipping(x);w.draw(_,y.TRIANGLES,c,T,u,Ue.disabled,E,P,A,i.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,i.paint,t.transform.zoom,o,a.layoutVertexBuffer2),b=!1}}(t,n,i,r,a):e.cf(i)?function(t,n,i,r,a){const s=i.paint.get("fill-color"),o=i.paint.get("fill-opacity");if(0===o.constantOr(1))return;const{isRenderingToTexture:l}=a,c=t.colorModeForRenderPass(),u=i.paint.get("fill-pattern"),h=t.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===s.constantOr(e.bf.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===h){const e=t.getDepthModeForSublayer(1,"opaque"===t.renderPass?Ge.ReadWrite:Ge.ReadOnly);cr(t,n,i,r,e,c,!1,l)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){const e=t.getDepthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Ge.ReadOnly);cr(t,n,i,r,e,c,!0,l)}}(t,n,i,r,a):e.cg(i)?function(t,e,n,i,r){const a=n.paint.get("fill-extrusion-opacity");if(0===a)return;const{isRenderingToTexture:s}=r;if("translucent"===t.renderPass){const r=new Ge(t.context.gl.LEQUAL,Ge.ReadWrite,t.depthRangeFor3D);if(1!==a||n.paint.get("fill-extrusion-pattern").constantOr(1))ur(t,e,n,i,r,Ve.disabled,Be.disabled,s),ur(t,e,n,i,r,t.stencilModeFor3D(),t.colorModeForRenderPass(),s);else{const a=t.colorModeForRenderPass();ur(t,e,n,i,r,Ve.disabled,a,s)}}}(t,n,i,r,a):e.ch(i)?function(t,n,i,r,a){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const{isRenderingToTexture:s}=a,o=t.context,l=t.style.projection.useSubdivision,c=t.getDepthModeForSublayer(0,Ge.ReadOnly),u=t.colorModeForRenderPass();if("offscreen"===t.renderPass)!function(t,n,i,r,a,s,o){const l=t.context,c=l.gl;for(const u of i){const i=n.getTile(u),h=i.dem;if(!h||!h.data)continue;if(!i.needsHillshadePrepare)continue;const d=h.dim,f=h.stride,p=h.getPixels();if(l.activeTexture.set(c.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||t.getTileTexture(f),i.demTexture){const t=i.demTexture;t.update(p,{premultiply:!1}),t.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else i.demTexture=new e.T(l,p,c.RGBA,{premultiply:!1}),i.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);l.activeTexture.set(c.TEXTURE0);let m=i.fbo;if(!m){const t=new e.T(l,{width:d,height:d,data:null},c.RGBA);t.bind(c.LINEAR,c.CLAMP_TO_EDGE),m=i.fbo=l.createFramebuffer(d,d,!0,!1),m.colorAttachment.set(t.texture)}l.bindFramebuffer.set(m.framebuffer),l.viewport.set([0,0,d,d]),t.useProgram("hillshadePrepare").draw(l,c.TRIANGLES,a,s,o,Ue.disabled,qn(i.tileID,h),null,null,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),i.needsHillshadePrepare=!1}}(t,n,r,i,c,Ve.disabled,u),o.viewport.set([0,0,t.width,t.height]);else if("translucent"===t.renderPass)if(l){const[e,a,o]=t.stencilConfigForOverlapTwoPass(r);hr(t,n,i,o,e,c,u,!1,s),hr(t,n,i,o,a,c,u,!0,s)}else{const[e,a]=t.getStencilConfigForOverlapAndUpdateStencilID(r);hr(t,n,i,a,e,c,u,!1,s)}}(t,n,i,r,a):e.ci(i)?function(t,e,n,i,r){if("translucent"!==t.renderPass)return;if(!i.length)return;const{isRenderingToTexture:a}=r,s=t.style.projection.useSubdivision,o=t.getDepthModeForSublayer(0,Ge.ReadOnly),l=t.colorModeForRenderPass();if(s){const[r,s,c]=t.stencilConfigForOverlapTwoPass(i);dr(t,e,n,c,r,o,l,!1,a),dr(t,e,n,c,s,o,l,!0,a)}else{const[r,s]=t.getStencilConfigForOverlapAndUpdateStencilID(i);dr(t,e,n,s,r,o,l,!1,a)}}(t,n,i,r,a):e.cj(i)?function(t,e,n,i,r){if("translucent"!==t.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!i.length)return;const{isRenderingToTexture:a}=r,s=e.getSource(),o=t.style.projection.useSubdivision;if(s instanceof Y)pr(t,e,n,i,null,!1,!1,s.tileCoords,s.flippedWindingOrder,a);else if(o){const[r,s,o]=t.stencilConfigForOverlapTwoPass(i);pr(t,e,n,o,r,!1,!0,fr,!1,a),pr(t,e,n,o,s,!0,!0,fr,!1,a)}else{const[r,s]=t.getStencilConfigForOverlapAndUpdateStencilID(i);pr(t,e,n,s,r,!1,!0,fr,!1,a)}}(t,n,i,r,a):e.ck(i)?function(t,e,n,i,r){const a=n.paint.get("background-color"),s=n.paint.get("background-opacity");if(0===s)return;const{isRenderingToTexture:o}=r,l=t.context,c=l.gl,u=t.style.projection,h=t.transform,d=h.tileSize,f=n.paint.get("background-pattern");if(t.isPatternMissing(f))return;const p=!f&&1===a.a&&1===s&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==p)return;const m=Ve.disabled,g=t.getDepthModeForSublayer(0,"opaque"===p?Ge.ReadWrite:Ge.ReadOnly),_=t.colorModeForRenderPass(),y=t.useProgram(f?"backgroundPattern":"background"),v=i||yt(h,{tileSize:d,terrain:t.style.map.terrain});f&&(l.activeTexture.set(c.TEXTURE0),t.imageManager.bind(t.context));const b=n.getCrossfadeParameters();for(const x of v){const e=h.getProjectionData({overscaledTileID:x,applyGlobeMatrix:!o,applyTerrainMatrix:!0}),i=f?ri(s,t,f,{tileID:x,tileSize:d},b):ii(s,a),r=t.style.map.terrain&&t.style.map.terrain.getTerrainData(x),p=u.getMeshFromTileID(l,x.canonical,!1,!0,"raster");y.draw(l,c.TRIANGLES,g,m,_,Ue.backCCW,i,r,e,n.id,p.vertexBuffer,p.indexBuffer,p.segments)}}(t,0,i,r,a):e.cl(i)&&function(t,e,n,i){const{isRenderingGlobe:r}=i,a=t.context,s=n.implementation,o=t.style.projection,l=t.transform,c=l.getProjectionDataForCustomLayer(r),u={farZ:l.farZ,nearZ:l.nearZ,fov:l.fov*Math.PI/180,modelViewProjectionMatrix:l.modelViewProjectionMatrix,projectionMatrix:l.projectionMatrix,shaderData:{variantName:o.shaderVariantName,vertexShaderPrelude:"const float PI = 3.141592653589793;\nuniform mat4 u_projection_matrix;\n".concat(o.shaderPreludeCode.vertexSource),define:o.shaderDefine},defaultProjectionData:c},h=s.renderingMode?s.renderingMode:"2d";if("offscreen"===t.renderPass){const e=s.prerender;e&&(t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),e.call(s,a.gl,u),a.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),a.setStencilMode(Ve.disabled);const e="3d"===h?t.getDepthModeFor3D():t.getDepthModeForSublayer(0,Ge.ReadOnly);a.setDepthMode(e),s.render(a.gl,u),a.setDirty(),t.setBaseState(),a.bindFramebuffer.set(null)}}(t,0,i,a))}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n}useProgram(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.cache=this.cache||{};const r=!!this.style.map.terrain,a=this.style.projection,s=n?be.projectionMercator:a.shaderPreludeCode,o=n?Pe:a.shaderDefine,l=t+(e?e.cacheKey:"")+"/".concat(n?Me:a.shaderVariantName)+(this._showOverdrawInspector?"/overdraw":"")+(r?"/terrain":"")+(i?"/".concat(i.join("/")):"");return this.cache[l]||(this.cache[l]=new Tn(this.context,be[t],e,si[t],this._showOverdrawInspector,r,s,o,i)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:e}=this.context.gl;return this.width!==t||this.height!==e}}function Er(t,e){var n=this;let i,r=!1,a=null,s=null;const o=()=>{a=null,r&&(t.apply(s,i),a=setTimeout(o,e),r=!1)};return function(){for(var t=arguments.length,e=new Array(t),l=0;l<t;l++)e[l]=arguments[l];return r=!0,s=n,i=e,a||o(),a}}class Tr{constructor(t){this._getCurrentHash=()=>{const t=window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map(t=>t.split("=")).forEach(t=>{t[0]===this._hashName&&(e=t)}),(e&&e[1]||"").split("/")}return t.split("/")},this._onHashChange=()=>{const t=this._getCurrentHash();if(!this._isValidHash(t))return!1;const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0},this._updateHashUnthrottled=()=>{const t=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,t)},this._removeHash=()=>{const t=this._getCurrentHash();if(0===t.length)return;const e=t.join("/");let n=e;n.split("&").length>0&&(n=n.split("&")[0]),this._hashName&&(n="".concat(this._hashName,"=").concat(e));let i=window.location.hash.replace(n,"");i.startsWith("#&")?i=i.slice(0,1)+i.slice(2):"#"===i&&(i="");let r=window.location.href.replace(/(#.+)?$/,i);r=r.replace("&&","&"),window.history.replaceState(window.history.state,null,r)},this._updateHash=Er(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,i),a=Math.round(e.lng*r)/r,s=Math.round(e.lat*r)/r,o=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=t?"/".concat(a,"/").concat(s,"/").concat(n):"".concat(n,"/").concat(s,"/").concat(a),(o||l)&&(c+="/"+Math.round(10*o)/10),l&&(c+="/".concat(Math.round(l))),this._hashName){const t=this._hashName;let e=!1;const n=window.location.hash.slice(1).split("&").map(n=>{const i=n.split("=")[0];return i===t?(e=!0,"".concat(i,"=").concat(c)):n}).filter(t=>t);return e||n.push("".concat(t,"=").concat(c)),"#".concat(n.join("&"))}return"#".concat(c)}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new e.S(+t[2],+t[1])}catch(t){return!1}const n=+t[0],i=+(t[3]||0),r=+(t[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&i>=-180&&i<=180&&r>=this._map.getMinPitch()&&r<=this._map.getMaxPitch()}}const Cr={linearity:.3,easing:e.cm(0,0,.3,1)},Ir=e.e({deceleration:2500,maxSpeed:1400},Cr),Lr=e.e({deceleration:20,maxSpeed:1400},Cr),zr=e.e({deceleration:1e3,maxSpeed:360},Cr),Nr=e.e({deceleration:1e3,maxSpeed:90},Cr),Dr=e.e({deceleration:1e3,maxSpeed:360},Cr);class Rr{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,e=s.now();for(;t.length>0&&e-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new e.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)n.zoom+=e.zoomDelta||0,n.bearing+=e.bearingDelta||0,n.pitch+=e.pitchDelta||0,n.roll+=e.rollDelta||0,e.panDelta&&n.pan._add(e.panDelta),e.around&&(n.around=e.around),e.pinchAround&&(n.pinchAround=e.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(n.pan.mag()){const a=Or(n.pan.mag(),i,e.e({},Ir,t||{})),s=n.pan.mult(a.amount/n.pan.mag()),o=this._map.cameraHelper.handlePanInertia(s,this._map.transform);r.center=o.easingCenter,r.offset=o.easingOffset,Fr(r,a)}if(n.zoom){const t=Or(n.zoom,i,Lr);r.zoom=this._map.transform.zoom+t.amount,Fr(r,t)}if(n.bearing){const t=Or(n.bearing,i,zr);r.bearing=this._map.transform.bearing+e.ah(t.amount,-179,179),Fr(r,t)}if(n.pitch){const t=Or(n.pitch,i,Nr);r.pitch=this._map.transform.pitch+t.amount,Fr(r,t)}if(n.roll){const t=Or(n.roll,i,Dr);r.roll=this._map.transform.roll+e.ah(t.amount,-179,179),Fr(r,t)}if(r.zoom||r.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),e.e(r,{noMoveStart:!0})}}function Fr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Or(t,n,i){const{maxSpeed:r,linearity:a,deceleration:s}=i,o=e.ah(t*a/(n/1e3),-r,r),l=Math.abs(o)/(s*a);return{easing:i.easing,duration:1e3*l,amount:o*(l/2)}}class Br extends e.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i=i instanceof MouseEvent?i:new MouseEvent(t,i);const a=o.mousePos(n.getCanvas(),i),s=n.unproject(a);super(t,e.e({point:a,lngLat:s,originalEvent:i},r)),this._defaultPrevented=!1,this.target=n}}class jr extends e.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,i){const r="touchend"===t?i.changedTouches:i.touches,a=o.touchPos(n.getCanvasContainer(),r),s=a.map(t=>n.unproject(t)),l=a.reduce((t,e,n,i)=>t.add(e.div(i.length)),new e.P(0,0));super(t,{points:a,point:l,lngLats:s,lngLat:n.unproject(l),originalEvent:i}),this._defaultPrevented=!1}}class Ur extends e.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class Gr{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Ur(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Br(t.type,this._map,t))}mouseup(t){this._map.fire(new Br(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Br(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Br(t.type,this._map,t))}mouseover(t){this._map.fire(new Br(t.type,this._map,t))}mouseout(t){this._map.fire(new Br(t.type,this._map,t))}touchstart(t){return this._firePreventable(new jr(t.type,this._map,t))}touchmove(t){this._map.fire(new jr(t.type,this._map,t))}touchend(t){this._map.fire(new jr(t.type,this._map,t))}touchcancel(t){this._map.fire(new jr(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Br(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Br("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Br(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vr{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(e.P.convert(t),this._map.terrain)}}class Zr{constructor(t,e){this._map=t,this._tr=new Vr(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(o.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const i=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const r=Math.min(i.x,n.x),a=Math.max(i.x,n.x),s=Math.min(i.y,n.y),l=Math.max(i.y,n.y);o.setTransform(this._box,"translate(".concat(r,"px,").concat(s,"px)")),this._box.style.width=a-r+"px",this._box.style.height=l-s+"px"}mouseupWindow(t,n){if(!this._active)return;if(0!==t.button)return;const i=this._startPos,r=n;if(this.reset(),o.suppressClick(),i.x!==r.x||i.y!==r.y)return this._map.fire(new e.l("boxzoomend",{originalEvent:t})),{cameraAnimation:t=>t.fitScreenCoordinates(i,r,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,n){return this._map.fire(new e.l(t,{originalEvent:n}))}}function Wr(t,e){if(t.length!==e.length)throw new Error("The number of touches and points are not equal - touches ".concat(t.length,", points ").concat(e.length));const n={};for(let i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}class Hr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){const n=new e.P(0,0);for(const e of t)n._add(e);return n.div(t.length)}(n),this.touches=Wr(i,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const i=Wr(n,e);for(const r in this.touches){const t=i[r];(!t||t.dist(this.touches[r])>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Xr{constructor(t){this.singleTap=new Hr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const i=this.singleTap.touchend(t,e,n);if(i){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(i)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class Yr{constructor(t){this._tr=new Vr(t),this._zoomIn=new Xr({numTouches:1,numTaps:2}),this._zoomOut=new Xr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const i=this._zoomIn.touchend(t,e,n),r=this._zoomOut.touchend(t,e,n),a=this._tr;return i?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(i)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kr{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(){const t=this._moveFunction(...arguments);if(t.bearingDelta||t.pitchDelta||t.rollDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(t,e){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(e)?e[0]:e,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,e){if(!this.isEnabled())return;const n=this._lastPoint;if(!n)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const i=Array.isArray(e)?e[0]:e;return!this._moved&&i.dist(n)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=i,this._move(n,i))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&o.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Jr=0,$r=2,Qr={[Jr]:1,[$r]:2};class ta{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const e=o.mouseButton(t);this._eventButton=e}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(t,e){const n=Qr[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton)}isValidEndEvent(t){return o.mouseButton(t)===this._eventButton}}class ea{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return 1===t.targetTouches.length}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class na{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ta({checkCorrectEvent:()=>!0}),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ea;this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=e}_executeRelevantHandler(t,e,n){return t instanceof MouseEvent?e(t):"undefined"!=typeof TouchEvent&&t instanceof TouchEvent?n(t):void 0}startMove(t){this._executeRelevantHandler(t,t=>this.mouseMoveStateManager.startMove(t),t=>this.oneFingerTouchMoveStateManager.startMove(t))}endMove(t){this._executeRelevantHandler(t,t=>this.mouseMoveStateManager.endMove(t),t=>this.oneFingerTouchMoveStateManager.endMove(t))}isValidStartEvent(t){return this._executeRelevantHandler(t,t=>this.mouseMoveStateManager.isValidStartEvent(t),t=>this.oneFingerTouchMoveStateManager.isValidStartEvent(t))}isValidMoveEvent(t){return this._executeRelevantHandler(t,t=>this.mouseMoveStateManager.isValidMoveEvent(t),t=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(t))}isValidEndEvent(t){return this._executeRelevantHandler(t,t=>this.mouseMoveStateManager.isValidEndEvent(t),t=>this.oneFingerTouchMoveStateManager.isValidEndEvent(t))}}const ia=t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=t=>{t.preventDefault()}};class ra{constructor(t,e){this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new e.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(t,e,n){if(this._active){if(!this._shouldBePrevented(n.length))return t.preventDefault(),this._calculateTransform(t,e,n);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&this._shouldBePrevented(n.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,n,i){i.length>0&&(this._active=!0);const r=Wr(i,n),a=new e.P(0,0),s=new e.P(0,0);let o=0;for(const e in r){const t=r[e],n=this._touches[e];n&&(a._add(t),s._add(t.sub(n)),o++,r[e]=t)}if(this._touches=r,this._shouldBePrevented(o)||!s.mag())return;const l=s.div(o);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(o),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class aa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){if(!this._firstTwoTouches)return;t.preventDefault();const[i,r]=this._firstTwoTouches,a=sa(n,e,i),s=sa(n,e,r);if(!a||!s)return;const o=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],o,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[i,r]=this._firstTwoTouches,a=sa(n,e,i),s=sa(n,e,r);a&&s||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function sa(t,e,n){for(let i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function oa(t,e){return Math.log(t/e)/Math.LN2}class la extends aa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(oa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oa(this._distance,n),pinchAround:e}}}function ca(t,e){return 180*t.angleWith(e)/Math.PI}class ua extends aa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e,n){const i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ca(this._vector,i),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=ca(t,this._startVector);return Math.abs(n)<e}}function ha(t){return Math.abs(t.y)>Math.abs(t.x)}class da extends aa{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,n){super.touchstart(t,e,n),this._currentTouchCount=n.length}_start(t){this._lastPoints=t,ha(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,n){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const i=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(i,r,n.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+r.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const i=t.mag()>=2,r=e.mag()>=2;if(!i&&!r)return;if(!i||!r)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const a=t.y>0==e.y>0;return ha(t)&&ha(e)&&a}}const fa={panStep:100,bearingStep:15,pitchStep:10};class pa{constructor(t){this._tr=new Vr(t);const e=fa;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,i=0,r=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:s=>{const o=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:ma,zoom:e?Math.round(o.zoom)+e*(t.shiftKey?2:1):o.zoom,bearing:o.bearing+n*this._bearingStep,pitch:o.pitch+i*this._pitchStep,offset:[-r*this._panStep,-a*this._panStep],center:o.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ma(t){return t*(2-t)}const ga=4.000244140625,_a=1/450;class ya{constructor(t,e){this._onTimeout=t=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},this._map=t,this._tr=new Vr(t),this._triggerRenderFrame=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=_a}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let e=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const n=s.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==e&&e%ga==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=o.mousePos(this._map.getCanvas(),t),i=this._tr;this._aroundPoint=this._aroundCenter?i.transform.locationToScreenPoint(e.S.convert(i.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._tr.transform;if("number"==typeof this._lastExpectedZoom){const e=t.zoom-this._lastExpectedZoom;"number"==typeof this._startZoom&&(this._startZoom+=e),"number"==typeof this._targetZoom&&(this._targetZoom+=e)}if(0!==this._delta){const n="wheel"===this._type&&Math.abs(this._delta)>ga?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&0!==i&&(i=1/i);const r="number"!=typeof this._targetZoom?t.scale:e.af(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),e.ak(r*i)).zoom,"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"!=typeof this._targetZoom?t.zoom:this._targetZoom,i=this._startZoom,r=this._easing;let a,o=!1;if("wheel"===this._type&&i&&r){const t=s.now()-this._lastWheelEventTime,l=Math.min((t+5)/200,1),c=r(l);a=e.C.number(i,n,c),l<1?this._frameId||(this._frameId=!0):o=!0}else a=n,o=!0;return this._active=!0,o&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=a,{noInertia:!0,needsRenderFrame:!o,zoomDelta:a-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let n=e.co;if(this._prevEase){const t=this._prevEase,i=(s.now()-t.start)/t.duration,r=t.easing(i+.01)-t.easing(i),a=.27/Math.sqrt(r*r+1e-4)*.01,o=Math.sqrt(.0729-a*a);n=e.cm(a,o,.25,1)}return this._prevEase={start:s.now(),duration:t,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class va{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ba{constructor(t){this._tr=new Vr(t),this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xa{constructor(){this._tap=new Xr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,e,n){if(!this._swipePoint)if(this._tapTime){const i=e[0],r=t.timeStamp-this._tapTime<500,a=this._tapPoint.dist(i)<30;r&&a?n.length>0&&(this._swipePoint=i,this._swipeTouch=n[0].identifier):this.reset()}else this._tap.touchstart(t,e,n)}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=e[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){if(this._tapTime)this._swipePoint&&0===n.length&&this.reset();else{const i=this._tap.touchend(t,e,n);i&&(this._tapTime=t.timeStamp,this._tapPoint=i)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wa{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Sa{constructor(t,e,n,i){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=e,this._mousePitch=n,this._mouseRoll=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Pa{constructor(t,e,n,i){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ma{constructor(t,e){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=t,this._options=e,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=o.create("div","maplibregl-cooperative-gesture-screen",t);let e=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(e=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const n=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),i=document.createElement("div");i.className="maplibregl-desktop-message",i.textContent=e,this._container.appendChild(i);const r=document.createElement("div");r.className="maplibregl-mobile-message",r.textContent=n,this._container.appendChild(r),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(o.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,n){this._enabled&&(this._map.fire(new e.l("cooperativegestureprevented",{gestureType:t,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Aa=t=>t.zoom||t.drag||t.roll||t.pitch||t.rotate;class ka extends e.l{}function Ea(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta||t.rollDelta}class Ta{constructor(t,n){this.handleWindowEvent=t=>{this.handleEvent(t,"".concat(t.type,"Window"))},this.handleEvent=(t,n)=>{if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const i="renderFrame"===t.type?void 0:t,r={needsRenderFrame:!1},a={},s={};for(const{handlerName:u,handler:h,allowed:d}of this._handlers){if(!h.isEnabled())continue;let l;if(this._blockedByActive(s,d,u))h.reset();else if(h[n||t.type]){if(e.cp(t,n||t.type)){const e=o.mousePos(this._map.getCanvas(),t);l=h[n||t.type](t,e)}else if(e.cq(t,n||t.type)){const e=this._getMapTouches(t.touches),i=o.touchPos(this._map.getCanvas(),e);l=h[n||t.type](t,i,e)}else e.cr(n||t.type)||(l=h[n||t.type](t));this.mergeHandlerResult(r,a,l,u,i),l&&l.needsRenderFrame&&this._triggerRenderFrame()}(l||h.isActive())&&(s[u]=h)}const l={};for(const e in this._previousActiveHandlers)s[e]||(l[e]=i);this._previousActiveHandlers=s,(Object.keys(l).length||Ea(r))&&(this._changes.push([r,a,l]),this._triggerRenderFrame()),(Object.keys(s).length||Ea(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:c}=r;c&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],c(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Rr(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[window,"blur",void 0]];for(const[e,r,a]of this._listeners)o.addEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,a)}destroy(){for(const[t,e,n]of this._listeners)o.removeEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(t){const n=this._map,i=n.getCanvasContainer();this._add("mapEvent",new Gr(n,t));const r=n.boxZoom=new Zr(n,t);this._add("boxZoom",r),t.interactive&&t.boxZoom&&r.enable();const a=n.cooperativeGestures=new Ma(n,t.cooperativeGestures);this._add("cooperativeGestures",a),t.cooperativeGestures&&a.enable();const s=new Yr(n),l=new ba(n);n.doubleClickZoom=new va(l,s),this._add("tapZoom",s),this._add("clickZoom",l),t.interactive&&t.doubleClickZoom&&n.doubleClickZoom.enable();const c=new xa;this._add("tapDragZoom",c);const u=n.touchPitch=new da(n);this._add("touchPitch",u),t.interactive&&t.touchPitch&&n.touchPitch.enable(t.touchPitch);const h=()=>n.project(n.getCenter()),d=function(t,n){let{enable:i,clickTolerance:r,aroundCenter:a=!0,minPixelCenterThreshold:s=100,rotateDegreesPerPixelMoved:l=.8}=t;const c=new ta({checkCorrectEvent:t=>0===o.mouseButton(t)&&t.ctrlKey||2===o.mouseButton(t)&&!t.ctrlKey});return new Kr({clickTolerance:r,move:(t,i)=>{const r=n();if(a&&Math.abs(r.y-t.y)>s)return{bearingDelta:e.cn(new e.P(t.x,i.y),i,r)};let o=(i.x-t.x)*l;return a&&i.y<r.y&&(o=-o),{bearingDelta:o}},moveStateManager:c,enable:i,assignEvents:ia})}(t,h),f=function(t){let{enable:e,clickTolerance:n,pitchDegreesPerPixelMoved:i=-.5}=t;const r=new ta({checkCorrectEvent:t=>0===o.mouseButton(t)&&t.ctrlKey||2===o.mouseButton(t)});return new Kr({clickTolerance:n,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:r,enable:e,assignEvents:ia})}(t),p=function(t,e){let{enable:n,clickTolerance:i,rollDegreesPerPixelMoved:r=.3}=t;const a=new ta({checkCorrectEvent:t=>2===o.mouseButton(t)&&t.ctrlKey});return new Kr({clickTolerance:i,move:(t,n)=>{const i=e();let a=(n.x-t.x)*r;return n.y<i.y&&(a=-a),{rollDelta:a}},moveStateManager:a,enable:n,assignEvents:ia})}(t,h);n.dragRotate=new Sa(t,d,f,p),this._add("mouseRotate",d,["mousePitch"]),this._add("mousePitch",f,["mouseRotate","mouseRoll"]),this._add("mouseRoll",p,["mousePitch"]),t.interactive&&t.dragRotate&&n.dragRotate.enable();const m=function(t){let{enable:e,clickTolerance:n}=t;const i=new ta({checkCorrectEvent:t=>0===o.mouseButton(t)&&!t.ctrlKey});return new Kr({clickTolerance:n,move:(t,e)=>({around:e,panDelta:e.sub(t)}),activateOnStart:!0,moveStateManager:i,enable:e,assignEvents:ia})}(t),g=new ra(t,n);n.dragPan=new wa(i,m,g),this._add("mousePan",m),this._add("touchPan",g,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&n.dragPan.enable(t.dragPan);const _=new ua,y=new la;n.touchZoomRotate=new Pa(i,y,_,c),this._add("touchRotate",_,["touchPan","touchZoom"]),this._add("touchZoom",y,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&n.touchZoomRotate.enable(t.touchZoomRotate);const v=n.scrollZoom=new ya(n,()=>this._triggerRenderFrame());this._add("scrollZoom",v,["mousePan"]),t.interactive&&t.scrollZoom&&n.scrollZoom.enable(t.scrollZoom);const b=n.keyboard=new pa(n);this._add("keyboard",b),t.interactive&&t.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new qr(n))}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Aa(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,n){for(const i in t)if(i!==n&&(!e||e.indexOf(i)<0))return!0;return!1}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}mergeHandlerResult(t,n,i,r,a){if(!i)return;e.e(t,i);const s={handlerName:r,originalEvent:i.originalEvent||a};void 0!==i.zoomDelta&&(n.zoom=s),void 0!==i.panDelta&&(n.drag=s),void 0!==i.rollDelta&&(n.roll=s),void 0!==i.pitchDelta&&(n.pitch=s),void 0!==i.bearingDelta&&(n.rotate=s)}_applyChanges(){const t={},n={},i={};for(const[r,a,s]of this._changes)r.panDelta&&(t.panDelta=(t.panDelta||new e.P(0,0))._add(r.panDelta)),r.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+r.pitchDelta),r.rollDelta&&(t.rollDelta=(t.rollDelta||0)+r.rollDelta),void 0!==r.around&&(t.around=r.around),void 0!==r.pinchAround&&(t.pinchAround=r.pinchAround),r.noInertia&&(t.noInertia=r.noInertia),e.e(n,a),e.e(i,s);this._updateMapTransform(t,n,i),this._changes=[]}_updateMapTransform(t,e,n){const i=this._map,r=i._getTransformForUpdate(),a=i.terrain;if(!(Ea(t)||a&&this._terrainMovement))return this._fireEvents(e,n,!0);i._stop(!0);let{panDelta:s,zoomDelta:o,bearingDelta:l,pitchDelta:c,rollDelta:u,around:h,pinchAround:d}=t;void 0!==d&&(h=d),h=h||i.transform.centerPoint,a&&!r.isPointOnMapSurface(h)&&(h=r.centerPoint);const f={panDelta:s,zoomDelta:o,rollDelta:u,pitchDelta:c,bearingDelta:l,around:h};this._map.cameraHelper.useGlobeControls&&!r.isPointOnMapSurface(h)&&(h=r.centerPoint);const p=h.distSqr(r.centerPoint)<.01?r.center:r.screenPointToLocation(s?h.sub(s):h);a?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(f,r),this._terrainMovement||!e.drag&&!e.zoom?e.drag&&this._terrainMovement?r.setCenter(r.screenPointToLocation(r.centerPoint.sub(s))):this._map.cameraHelper.handleMapControlsPan(f,r,p):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(f,r,p))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(f,r),this._map.cameraHelper.handleMapControlsPan(f,r,p)),i._applyUpdatedTransform(r),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,n,!0)}_fireEvents(t,n,i){const r=Aa(this._eventsInProgress),a=Aa(t),o={};for(const e in t){const{originalEvent:n}=t[e];this._eventsInProgress[e]||(o["".concat(e,"start")]=n),this._eventsInProgress[e]=t[e]}!r&&a&&this._fireEvent("movestart",a.originalEvent);for(const e in o)this._fireEvent(e,o[e]);a&&this._fireEvent("move",a.originalEvent);for(const e in t){const{originalEvent:n}=t[e];this._fireEvent(e,n)}const l={};let c;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:i}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],c=n[t]||i,l["".concat(e,"end")]=c)}for(const e in l)this._fireEvent(e,l[e]);const u=Aa(this._eventsInProgress),h=(r||a)&&!u;if(h&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const t=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&t.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(t)}if(i&&h){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;!t||!t.essential&&s.prefersReducedMotion?(this._map.fire(new e.l("moveend",{originalEvent:c})),n(this._map.getBearing())&&this._map.resetNorth()):(n(t.bearing||this._map.getBearing())&&(t.bearing=0),t.freezeElevation=!0,this._map.easeTo(t,{originalEvent:c})),this._updatingCamera=!1}}_fireEvent(t,n){this._map.fire(new e.l(t,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new ka("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Ca extends e.E{constructor(t,e,n){super(),this._renderFrameCallback=()=>{const t=Math.min((s.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=n.bearingSnap,this.cameraHelper=e,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,e){t.apply(this.transform),this.transform=t,this.cameraHelper=e}getCenter(){return new e.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,e){return this.jumpTo({elevation:t},e),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,n,i){return t=e.P.convert(t).mult(-1),this.panTo(this.transform.center,e.e({offset:t},n),i)}panTo(t,n,i){return this.easeTo(e.e({center:t},n),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(t,n,i){return this.easeTo(e.e({zoom:t},n),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,n){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new e.l("movestart",n)).fire(new e.l("move",n)).fire(new e.l("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(t,n,i){return this.easeTo(e.e({bearing:t},n),i)}resetNorth(t,n){return this.rotateTo(0,e.e({duration:1e3},t),n),this}resetNorthPitch(t,n){return this.easeTo(e.e({bearing:0,pitch:0,roll:0,duration:1e3},t),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}getRoll(){return this.transform.roll}setRoll(t,e){return this.jumpTo({roll:t},e),this}cameraForBounds(t,e){t=q.convert(t).adjustAntiMeridian();const n=e&&e.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),n,e)}_cameraForBoxAndBearing(t,n,i,r){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=e.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){const t=r.padding;r.padding={top:t,bottom:t,right:t,left:t}}const s=e.e(a,r.padding);r.padding=s;const o=this.transform,l=new q(t,n);return this.cameraHelper.cameraForBoxAndBearing(r,s,l,i,o)}fitBounds(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)}fitScreenCoordinates(t,n,i,r,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(e.P.convert(t)),this.transform.screenPointToLocation(e.P.convert(n)),i,r),r,a)}_fitInternal(t,n,i){return t?(delete(n=e.e(t,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}jumpTo(t,n){this.stop();const i=this._getTransformForUpdate();let r=!1,a=!1,s=!1;const o=i.zoom;this.cameraHelper.handleJumpToCenterZoom(i,t);const l=i.zoom!==o;return"elevation"in t&&i.elevation!==+t.elevation&&i.setElevation(+t.elevation),"bearing"in t&&i.bearing!==+t.bearing&&(r=!0,i.setBearing(+t.bearing)),"pitch"in t&&i.pitch!==+t.pitch&&(a=!0,i.setPitch(+t.pitch)),"roll"in t&&i.roll!==+t.roll&&(s=!0,i.setRoll(+t.roll)),null==t.padding||i.isPaddingEqual(t.padding)||i.setPadding(t.padding),this._applyUpdatedTransform(i),this.fire(new e.l("movestart",n)).fire(new e.l("move",n)),l&&this.fire(new e.l("zoomstart",n)).fire(new e.l("zoom",n)).fire(new e.l("zoomend",n)),r&&this.fire(new e.l("rotatestart",n)).fire(new e.l("rotate",n)).fire(new e.l("rotateend",n)),a&&this.fire(new e.l("pitchstart",n)).fire(new e.l("pitch",n)).fire(new e.l("pitchend",n)),s&&this.fire(new e.l("rollstart",n)).fire(new e.l("roll",n)).fire(new e.l("rollend",n)),this.fire(new e.l("moveend",n))}calculateCameraOptionsFromTo(t,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a=e.a1.fromLngLat(t,n),s=e.a1.fromLngLat(i,r),o=s.x-a.x,l=s.y-a.y,c=s.z-a.z,u=Math.hypot(o,l,c);if(0===u)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(o,l),d=e.ak(this.transform.cameraToCenterDistance/u/this.transform.tileSize),f=180*Math.atan2(o,-l)/Math.PI;let p=180*Math.acos(h/u)/Math.PI;return p=c<0?90-p:90+p,{center:s.toLngLat(),elevation:r,zoom:d,pitch:p,bearing:f}}calculateCameraOptionsFromCameraLngLatAltRotation(t,e,n,i,r){const a=this.transform.calculateCenterFromCameraLngLatAlt(t,e,n,i);return{center:a.center,elevation:a.elevation,zoom:a.zoom,bearing:n,pitch:i,roll:r}}easeTo(t,n){this._stop(!1,t.easeId),(!1===(t=e.e({offset:[0,0],duration:500,easing:e.co},t)).animate||!t.essential&&s.prefersReducedMotion)&&(t.duration=0);const i=this._getTransformForUpdate(),r=this.getBearing(),a=i.pitch,o=i.roll,l="bearing"in t?this._normalizeBearing(t.bearing,r):r,c="pitch"in t?+t.pitch:a,u="roll"in t?this._normalizeBearing(t.roll,o):o,h="padding"in t?t.padding:i.padding,d=e.P.convert(t.offset);let f,p;t.around&&(f=e.S.convert(t.around),p=i.locationToScreenPoint(f));const m={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},g=this.cameraHelper.handleEaseTo(i,{bearing:l,pitch:c,roll:u,padding:h,around:f,aroundPoint:p,offsetAsPoint:d,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||r!==l,this._pitching=this._pitching||c!==a,this._rolling=this._rolling||u!==o,this._padding=!i.isPaddingEqual(h),this._zooming=this._zooming||g.isZooming,this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,m),this.terrain&&this._prepareElevation(g.elevationCenter),this._ease(e=>{g.easeFunc(e),this.terrain&&!t.freezeElevation&&this._updateElevation(e),this._applyUpdatedTransform(i),this._fireMoveEvents(n)},e=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n,e)},t),this}_prepareEase(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,n||i.moving||this.fire(new e.l("movestart",t)),this._zooming&&!i.zooming&&this.fire(new e.l("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new e.l("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new e.l("pitchstart",t)),this._rolling&&!i.rolling&&this.fire(new e.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){void 0!==this._elevationStart&&void 0!==this._elevationCenter||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&n!==this._elevationTarget){const e=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(e-(n-(e*t+this._elevationStart))/(1-t)),this._elevationTarget=n}this.transform.setElevation(e.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const e=t.getCameraLngLat(),n=t.getCameraAltitude(),i=this.terrain?this.terrain.getElevationForLngLatZoom(e,t.zoom):0;if(n<i){const n=this.calculateCameraOptionsFromTo(e,i,t.center,t.elevation);return{pitch:n.pitch,zoom:n.zoom}}return{}}_applyUpdatedTransform(t){const e=[];if(e.push(t=>this._elevateCameraIfInsideTerrain(t)),this.transformCameraUpdate&&e.push(t=>this.transformCameraUpdate(t)),!e.length)return;const n=t.clone();for(const i of e){const t=n.clone(),{center:e,zoom:r,roll:a,pitch:s,bearing:o,elevation:l}=i(t);e&&t.setCenter(e),void 0!==l&&t.setElevation(l),void 0!==r&&t.setZoom(r),void 0!==a&&t.setRoll(a),void 0!==s&&t.setPitch(s),void 0!==o&&t.setBearing(o),n.apply(t)}this.transform.apply(n)}_fireMoveEvents(t){this.fire(new e.l("move",t)),this._zooming&&this.fire(new e.l("zoom",t)),this._rotating&&this.fire(new e.l("rotate",t)),this._pitching&&this.fire(new e.l("pitch",t)),this._rolling&&this.fire(new e.l("roll",t))}_afterEase(t,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const i=this._zooming,r=this._rotating,a=this._pitching,s=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,i&&this.fire(new e.l("zoomend",t)),r&&this.fire(new e.l("rotateend",t)),a&&this.fire(new e.l("pitchend",t)),s&&this.fire(new e.l("rollend",t)),this.fire(new e.l("moveend",t))}flyTo(t,n){if(!t.essential&&s.prefersReducedMotion){const i=e.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(i,n)}this.stop(),t=e.e({offset:[0,0],speed:1.2,curve:1.42,easing:e.co},t);const i=this._getTransformForUpdate(),r=i.bearing,a=i.pitch,o=i.roll,l=i.padding,c="bearing"in t?this._normalizeBearing(t.bearing,r):r,u="pitch"in t?+t.pitch:a,h="roll"in t?this._normalizeBearing(t.roll,o):o,d="padding"in t?t.padding:i.padding,f=e.P.convert(t.offset);let p=i.centerPoint.add(f);const m=i.screenPointToLocation(p),g=this.cameraHelper.handleFlyTo(i,{bearing:c,pitch:u,roll:h,padding:d,locationAtOffset:m,offsetAsPoint:f,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let _=t.curve;const y=Math.max(i.width,i.height),v=y/g.scaleOfZoom,b=g.pixelPathLength;"number"==typeof g.scaleOfMinZoom&&(_=Math.sqrt(y/g.scaleOfMinZoom/b*2));const x=_*_;function w(t){const e=(v*v-y*y+(t?-1:1)*x*x*b*b)/(2*(t?v:y)*x*b);return Math.log(Math.sqrt(e*e+1)-e)}function S(t){return(Math.exp(t)-Math.exp(-t))/2}function P(t){return(Math.exp(t)+Math.exp(-t))/2}const M=w(!1);let A=function(t){return P(M)/P(M+_*t)},k=function(t){return y*((P(M)*(S(e=M+_*t)/P(e))-S(M))/x)/b;var e},E=(w(!0)-M)/_;if(Math.abs(b)<2e-6||!isFinite(E)){if(Math.abs(y-v)<1e-6)return this.easeTo(t,n);const e=v<y?-1:1;E=Math.abs(Math.log(v/y))/_,k=()=>0,A=t=>Math.exp(e*_*t)}return t.duration="duration"in t?+t.duration:1e3*E/("screenSpeed"in t?+t.screenSpeed/_:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=r!==c,this._pitching=u!==a,this._rolling=h!==o,this._padding=!i.isPaddingEqual(d),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(g.targetCenter),this._ease(s=>{const m=s*E,_=1/A(m),y=k(m);this._rotating&&i.setBearing(e.C.number(r,c,s)),this._pitching&&i.setPitch(e.C.number(a,u,s)),this._rolling&&i.setRoll(e.C.number(o,h,s)),this._padding&&(i.interpolatePadding(l,d,s),p=i.centerPoint.add(f)),g.easeFunc(s,_,y,p),this.terrain&&!t.freezeElevation&&this._updateElevation(s),this._applyUpdatedTransform(i),this._fireMoveEvents(n)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){var n;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}return t||null===(n=this.handlers)||void 0===n||n.stop(!1),this}_ease(t,e,n){!1===n.animate||0===n.duration?(t(1),e()):(this._easeStart=s.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,n){t=e.aO(t,-180,180);const i=Math.abs(t-n);return Math.abs(t-360-n)<i&&(t-=360),Math.abs(t+360-n)<i&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(e.S.convert(t),this.transform.tileZoom):null}}const Ia={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class La{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ia;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=t=>{!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=o.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=o.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString("AttributionControl.".concat(e));t.title=n,t.setAttribute("aria-label",n)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(t=>"string"!=typeof t?"":t)):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style.sourceCaches;for(const i in e){const n=e[i];if(n.used||n.usedForTerrain){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t=t.filter(t=>String(t).trim()),t.sort((t,e)=>t.length-e.length),t=t.filter((e,n)=>{for(let i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0});const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=o.sanitize(n),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class za{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._updateCompact=()=>{const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact"):e.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=o.create("div","maplibregl-ctrl");const e=o.create("a","maplibregl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Na{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const i of n)if(i.id===t)return void(i.cancelled=!0)}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Da=e.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Ra extends e.E{constructor(t){super(),this._lastTilesetChange=s.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,n){this.sourceCache.update(t,n),this._renderableTilesKeys=[];const i={};for(const r of yt(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))i[r.key]=!0,this._renderableTilesKeys.push(r.key),this._tiles[r.key]||(r.terrainRttPosMatrix32f=new Float64Array(16),e.bY(r.terrainRttPosMatrix32f,0,e.$,e.$,0,0,1),this._tiles[r.key]=new rt(r,this.tileSize),this._lastTilesetChange=s.now());for(const e in this._tiles)i[e]||delete this._tiles[e]}freeRtt(t){for(const e in this._tiles){const n=this._tiles[e];(!t||n.tileID.equals(t)||n.tileID.isChildOf(t)||t.isChildOf(n.tileID))&&(n.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,e){return e?this._getTerrainCoordsForTileRanges(t,e):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const n={};for(const i of this._renderableTilesKeys){const r=this._tiles[i].tileID,a=t.clone(),s=e.ba();if(r.canonical.equals(t.canonical))e.bY(s,0,e.$,e.$,0,0,1);else if(r.canonical.isChildOf(t.canonical)){const n=r.canonical.z-t.canonical.z,i=r.canonical.x-(r.canonical.x>>n<<n),a=r.canonical.y-(r.canonical.y>>n<<n),o=e.$>>n;e.bY(s,0,o,o,0,0,1),e.M(s,s,[-i*o,-a*o,0])}else{if(!t.canonical.isChildOf(r.canonical))continue;{const n=t.canonical.z-r.canonical.z,i=t.canonical.x-(t.canonical.x>>n<<n),a=t.canonical.y-(t.canonical.y>>n<<n),o=e.$>>n;e.bY(s,0,e.$,e.$,0,0,1),e.M(s,s,[i*o,a*o,0]),e.N(s,s,[1/2**n,1/2**n,0])}}a.terrainRttPosMatrix32f=new Float32Array(s),n[i]=a}return n}_getTerrainCoordsForTileRanges(t,n){const i={};for(const r of this._renderableTilesKeys){const a=this._tiles[r].tileID;if(!this._isWithinTileRanges(a,n))continue;const s=t.clone(),o=e.ba();if(a.canonical.z===t.canonical.z){const n=t.canonical.x-a.canonical.x,i=t.canonical.y-a.canonical.y;e.bY(o,0,e.$,e.$,0,0,1),e.M(o,o,[n*e.$,i*e.$,0])}else if(a.canonical.z>t.canonical.z){const n=a.canonical.z-t.canonical.z,i=a.canonical.x-(a.canonical.x>>n<<n),r=a.canonical.y-(a.canonical.y>>n<<n),s=t.canonical.x-(a.canonical.x>>n),l=t.canonical.y-(a.canonical.y>>n),c=e.$>>n;e.bY(o,0,c,c,0,0,1),e.M(o,o,[-i*c+s*e.$,-r*c+l*e.$,0])}else{const n=t.canonical.z-a.canonical.z,i=t.canonical.x-(t.canonical.x>>n<<n),r=t.canonical.y-(t.canonical.y>>n<<n),s=(t.canonical.x>>n)-a.canonical.x,l=(t.canonical.y>>n)-a.canonical.y,c=e.$<<n;e.bY(o,0,c,c,0,0,1),e.M(o,o,[i*e.$+s*c,r*e.$+l*c,0])}s.terrainRttPosMatrix32f=new Float32Array(o),i[r]=s}return i}getSourceTile(t,e){const n=this.sourceCache._source;let i=t.overscaledZ-this.deltaZoom;if(i>n.maxzoom&&(i=n.maxzoom),i<n.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(i).key);let r=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!r||!r.dem)&&e)for(;i>=n.minzoom&&(!r||!r.dem);)r=this.sourceCache.getTileByID(t.scaledTo(i--).key);return r}anyTilesAfterTime(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return this._lastTilesetChange>=t}_isWithinTileRanges(t,e){return e[t.canonical.z]&&t.canonical.x>=e[t.canonical.z].minTileX&&t.canonical.x<=e[t.canonical.z].maxTileX&&t.canonical.y>=e[t.canonical.z].minTileY&&t.canonical.y<=e[t.canonical.z].maxTileY}}class Fa{constructor(t,e,n){this._meshCache={},this.painter=t,this.sourceCache=new Ra(e),this.options=n,this.exaggeration="number"==typeof n.exaggeration?n.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.$;var a;if(!(n>=0&&n<r&&i>=0&&i<r))return 0;const s=this.getTerrainData(t),o=null===(a=s.tile)||void 0===a?void 0:a.dem;if(!o)return 0;const l=e.cs([],[n/r*e.$,i/r*e.$],s.u_terrain_matrix),c=[l[0]*o.dim,l[1]*o.dim],u=Math.floor(c[0]),h=Math.floor(c[1]),d=c[0]-u,f=c[1]-h;return o.get(u,h)*(1-d)*(1-f)+o.get(u+1,h)*d*(1-f)+o.get(u,h+1)*(1-d)*f+o.get(u+1,h+1)*d*f}getElevationForLngLatZoom(t,n){if(!e.ct(n,t.wrap()))return 0;const{tileID:i,mercatorX:r,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(t,n);return this.getElevation(i,r%e.$,a%e.$,e.$)}getElevation(t,n,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.$;return this.getDEMElevation(t,n,i,r)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const t=this.painter.context,n=new e.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new e.T(t,n,t.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new e.T(t,new e.R({width:1,height:1}),t.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=e.ag([])}const n=this.sourceCache.getSourceTile(t,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const t=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new e.T(t,n.dem.getPixels(),t.gl.RGBA,{premultiply:!1}),n.demTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const i=n&&n+n.tileID.key+t.key;if(i&&!this._demMatrixCache[i]){const i=this.sourceCache.sourceCache._source.maxzoom;let r=t.canonical.z-n.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=i?r=t.canonical.z-i:e.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=t.canonical.x-(t.canonical.x>>r<<r),s=t.canonical.y-(t.canonical.y>>r<<r),o=e.cu(new Float64Array(16),[1/(e.$<<r),1/(e.$<<r),0]);e.M(o,o,[a*e.$,s*e.$,0]),this._demMatrixCache[t.key]={matrix:o,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(t){const n=this.painter,i=n.width/devicePixelRatio,r=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===i&&this._fbo.height===r||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new e.T(n.context,{width:i,height:r,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new e.T(n.context,{width:i,height:r,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(i,r,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,i,r))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let e=0,a=0;e<this._coordsTextureSize;e++)for(let t=0;t<this._coordsTextureSize;t++,a+=4)n[a+0]=255&t,n[a+1]=255&e,n[a+2]=t>>8<<4|e>>8,n[a+3]=0;const i=new e.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),r=new e.T(t,i,t.gl.RGBA,{premultiply:!1});return r.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=r,r}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),i=this.painter.context,r=i.gl,a=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),s=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),o=Math.round(this.painter.height/devicePixelRatio);i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),r.readPixels(a,o-s-1,1,1,r.RGBA,r.UNSIGNED_BYTE,n),i.bindFramebuffer.set(null);const l=n[0]+(n[2]>>4<<8),c=n[1]+((15&n[2])<<8),u=this.coordsIndex[255-n[3]],h=u&&this.sourceCache.getTileByID(u);if(!h)return null;const d=this._coordsTextureSize,f=(1<<h.tileID.canonical.z)*d;return new e.a1((h.tileID.canonical.x*d+l)/f+h.tileID.wrap,(h.tileID.canonical.y*d+c)/f,this.getElevation(h.tileID,l,c,d))}depthAtPoint(t){const e=new Uint8Array(4),n=this.painter.context,i=n.gl;return n.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),i.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,i.RGBA,i.UNSIGNED_BYTE,e),n.bindFramebuffer.set(null),(e[0]/16777216+e[1]/65536+e[2]/256+e[3])/256}getTerrainMesh(t){var n;const i=(null===(n=this.painter.style.projection)||void 0===n?void 0:n.transitionState)>0,r=i&&0===t.canonical.y,a=i&&t.canonical.y===(1<<t.canonical.z)-1,s="m_".concat(r?"n":"","_").concat(a?"s":"");if(this._meshCache[s])return this._meshCache[s];const o=this.painter.context,l=new e.cv,c=new e.aN,u=this.meshSize,h=e.$/u,d=u*u;for(let e=0;e<=u;e++)for(let t=0;t<=u;t++)l.emplaceBack(t*h,e*h,0);for(let e=0;e<d;e+=u+1)for(let t=0;t<u;t++)c.emplaceBack(t+e,u+t+e+1,u+t+e+2),c.emplaceBack(t+e,u+t+e+2,t+e+1);const f=l.length,p=f+(u+1),m=(u+1)*u,g=r?e.bh:0,_=r?0:1,y=a?e.bi:e.$,v=a?0:1;for(let e=0;e<=u;e++)l.emplaceBack(e*h,g,_);for(let e=0;e<=u;e++)l.emplaceBack(e*h,y,v);for(let e=0;e<u;e++)c.emplaceBack(m+e,p+e,p+e+1),c.emplaceBack(m+e,p+e+1,m+e+1),c.emplaceBack(0+e,f+e+1,f+e),c.emplaceBack(0+e,0+e+1,f+e+1);const b=l.length,x=b+2*(u+1);for(const S of[0,1])for(let t=0;t<=u;t++)for(const n of[0,1])l.emplaceBack(S*e.$,t*h,n);for(let e=0;e<2*u;e+=2)c.emplaceBack(b+e,b+e+1,b+e+3),c.emplaceBack(b+e,b+e+3,b+e+2),c.emplaceBack(x+e,x+e+3,x+e+1),c.emplaceBack(x+e,x+e+2,x+e+3);const w=new we(o.createVertexBuffer(l,Da.members),o.createIndexBuffer(c),e.aM.simpleSegment(0,0,l.length,c.length));return this._meshCache[s]=w,w}getMeshFrameDelta(t){return 2*Math.PI*e.bu/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,e){var n;const{tileID:i}=this._getOverscaledTileIDFromLngLatZoom(t,e);return null!==(n=this.getMinMaxElevation(i).minElevation)&&void 0!==n?n:0}getMinMaxElevation(t){const e=this.getTerrainData(t).tile,n={minElevation:null,maxElevation:null};return e&&e.dem&&(n.minElevation=e.dem.min*this.exaggeration,n.maxElevation=e.dem.max*this.exaggeration),n}_getOverscaledTileIDFromLngLatZoom(t,n){const i=e.a1.fromLngLat(t.wrap()),r=(1<<n)*e.$,a=i.x*r,s=i.y*r,o=Math.floor(a/e.$),l=Math.floor(s/e.$);return{tileID:new e.Z(n,0,n,o,l),mercatorX:a,mercatorY:s}}}class Oa{constructor(t,e,n){this._context=t,this._size=e,this._tileSize=n,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new e.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(i.texture),{id:t,fbo:n,texture:i,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(e=>t.id!==e),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const e of this._recentlyUsed)if(!this._objects[e].inUse)return this._objects[e];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(t=>!t.inUse)}}const Ba={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class ja{constructor(t,e){this.painter=t,this.terrain=e,this.pool=new Oa(t.context,30,e.sourceCache.tileSize*e.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,e){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(n=>!t._layers[n].isHidden(e)),this._coordsAscending={};for(const n in t.sourceCaches){this._coordsAscending[n]={};const e=t.sourceCaches[n].getVisibleCoordinates(),i=t.sourceCaches[n].getSource(),r=i instanceof Y?i.terrainTileRanges:null;for(const t of e){const e=this.terrain.sourceCache.getTerrainCoords(t,r);for(const t in e)this._coordsAscending[n][t]||(this._coordsAscending[n][t]=[]),this._coordsAscending[n][t].push(e[t])}}this._coordsAscendingStr={};for(const n of t._order){const e=t._layers[n],i=e.source;if(Ba[e.type]&&!this._coordsAscendingStr[i]){this._coordsAscendingStr[i]={};for(const t in this._coordsAscending[i])this._coordsAscendingStr[i][t]=this._coordsAscending[i][t].map(t=>t.key).sort().join()}}for(const n of this._renderableTiles)for(const t in this._coordsAscendingStr){const e=this._coordsAscendingStr[t][n.tileID.key];e&&e!==n.rttCoords[t]&&(n.rtt=[])}}renderLayer(t,n){if(t.isHidden(this.painter.transform.zoom))return!1;const i=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),r=t.type,a=this.painter,s=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Ba[r]&&(this._prevType&&Ba[this._prevType]||this._stacks.push([]),this._prevType=r,this._stacks[this._stacks.length-1].push(t.id),!s))return!0;if(Ba[this._prevType]||Ba[r]&&s){this._prevType=r;const t=this._stacks.length-1,n=this._stacks[t]||[];for(const r of this._renderableTiles){if(this.pool.isFull()&&(Mr(this.painter,this.terrain,this._rttTiles,i),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(r),r.rtt[t]){const e=this.pool.getObjectForId(r.rtt[t].id);if(e.stamp===r.rtt[t].stamp){this.pool.useObject(e);continue}}const s=this.pool.getOrCreateFreeObject();this.pool.useObject(s),this.pool.stampObject(s),r.rtt[t]={id:s.id,stamp:s.stamp},a.context.bindFramebuffer.set(s.fbo.framebuffer),a.context.clear({color:e.bf.transparent,stencil:0}),a.currentStencilSource=void 0;for(let t=0;t<n.length;t++){const e=a.style._layers[n[t]],o=e.source?this._coordsAscending[e.source][r.tileID.key]:[r.tileID];a.context.viewport.set([0,0,s.fbo.width,s.fbo.height]),a._renderTileClippingMasks(e,o,!0),a.renderLayer(a,a.style.sourceCaches[e.source],e,o,i),e.source&&(r.rttCoords[e.source]=this._coordsAscendingStr[e.source][r.tileID.key])}}return Mr(this.painter,this.terrain,this._rttTiles,i),this._rttTiles=[],this.pool.freeAllObjects(),Ba[r]}return!1}}const Ua={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ga=n,qa={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ia,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:e.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Va={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Za{constructor(t,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.mousedown=t=>{this.startMove(t,o.mousePos(this.element,t)),o.addEventListener(window,"mousemove",this.mousemove),o.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=t=>{this.move(t,o.mousePos(this.element,t))},this.mouseup=t=>{this._rotatePitchHandler.dragEnd(t),this.offTemp()},this.touchstart=t=>{1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.startMove(t,this._startPos),o.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.addEventListener(window,"touchend",this.touchend))},this.touchmove=t=>{1!==t.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.move(t,this._lastPos))},this.touchend=t=>{0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const r=new na;this._rotatePitchHandler=new Kr({clickTolerance:3,move:(t,r)=>{const a=n.getBoundingClientRect(),s=new e.P((a.bottom-a.top)/2,(a.right-a.left)/2);return{bearingDelta:e.cn(new e.P(t.x,r.y),r,s),pitchDelta:i?-.5*(r.y-t.y):void 0}},moveStateManager:r,enable:!0,assignEvents:()=>{}}),this.map=t,o.addEventListener(n,"mousedown",this.mousedown),o.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(n,"touchcancel",this.reset)}startMove(t,e){this._rotatePitchHandler.dragStart(t,e),o.disableDrag()}move(t,e){const n=this.map,{bearingDelta:i,pitchDelta:r}=this._rotatePitchHandler.dragMove(t,e)||{};i&&n.setBearing(n.getBearing()+i),r&&n.setPitch(n.getPitch()+r)}off(){const t=this.element;o.removeEventListener(t,"mousedown",this.mousedown),o.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend),o.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(window,"mousemove",this.mousemove),o.removeEventListener(window,"mouseup",this.mouseup),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend)}}let Wa;function Ha(t,n,i){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]||!i.getCoveringTilesDetailsProvider().allowWorldCopies())return null==t?void 0:t.wrap();const r=new e.S(t.lng,t.lat);if(t=new e.S(t.lng,t.lat),n){const r=new e.S(t.lng-360,t.lat),a=new e.S(t.lng+360,t.lat),s=i.locationToScreenPoint(t).distSqr(n);i.locationToScreenPoint(r).distSqr(n)<s?t=r:i.locationToScreenPoint(a).distSqr(n)<s&&(t=a)}for(;Math.abs(t.lng-i.center.lng)>180;){const e=i.locationToScreenPoint(t);if(e.x>=0&&e.y>=0&&e.x<=i.width&&e.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t.lng!==r.lng&&i.isPointOnMapSurface(i.locationToScreenPoint(t))?t:r}const Xa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ya(t,e,n){const i=t.classList;for(const r in Xa)i.remove("maplibregl-".concat(n,"-anchor-").concat(r));i.add("maplibregl-".concat(n,"-anchor-").concat(e))}class Ka extends e.E{constructor(t){if(super(),this._onKeyPress=t=>{const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()},this._onMapClick=t=>{const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},this._update=t=>{if(!this._map)return;const e=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==t?void 0:t.type)||"render"===(null==t?void 0:t.type)&&!e)&&this._map.once("render",this._update),this._lngLat=Ha(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let n="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?n="rotateZ(".concat(this._rotation,"deg)"):"map"===this._rotationAlignment&&(n="rotateZ(".concat(this._rotation-this._map.getBearing(),"deg)"));let i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX(".concat(this._map.getPitch(),"deg)")),this._subpixelPositioning||t&&"moveend"!==t.type||(this._pos=this._pos.round()),o.setTransform(this._element,"".concat(Xa[this._anchor]," translate(").concat(this._pos.x,"px, ").concat(this._pos.y,"px) ").concat(i," ").concat(n)),s.frameAsync(new AbortController).then(()=>{this._updateOpacity(t&&"moveend"===t.type)}).catch(()=>{})},this._onMove=t=>{if(!this._isDragging){const e=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=e}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.l("dragstart"))),this.fire(new e.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.l("dragend")),this._state="inactive"},this._addDragHandler=t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,this.setOpacity(null==t?void 0:t.opacity,null==t?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=e.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div");const n=o.createNS("http://www.w3.org/2000/svg","svg"),i=41,r=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height","".concat(i,"px")),n.setAttributeNS(null,"width","".concat(r,"px")),n.setAttributeNS(null,"viewBox","0 0 ".concat(r," ").concat(i));const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=o.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const u=o.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);const h=o.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);const d=o.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const f=o.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(f);const p=o.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(6.0, 7.0)"),p.setAttributeNS(null,"fill","#FFFFFF");const m=o.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=o.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const _=o.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#FFFFFF"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(_),s.appendChild(l),s.appendChild(u),s.appendChild(d),s.appendChild(p),s.appendChild(m),n.appendChild(s),n.setAttributeNS(null,"height",i*this._scale+"px"),n.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(n),this._offset=e.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()}),Ya(this._element,this._anchor,"marker"),t&&t.className)for(const e of t.className.split(" "))this._element.classList.add(e);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,i=Math.abs(n)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[i,-1*(e-n+i)],"bottom-right":[-i,-1*(e-n+i)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var n,i;const r=null===(n=this._map)||void 0===n?void 0:n.terrain,a=this._map.transform.isLocationOccluded(this._lngLat);if(!r||a){const t=a?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==t&&(this._element.style.opacity=t))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const s=this._map,o=s.terrain.depthAtPoint(this._pos),l=s.terrain.getElevationForLngLatZoom(this._lngLat,s.transform.tileZoom);if(s.transform.lngLatToCameraDepth(this._lngLat,l)-o<.006)return void(this._element.style.opacity=this._opacity);const c=-this._offset.y/s.transform.pixelsPerMeter,u=Math.sin(s.getPitch()*Math.PI/180)*c,h=s.terrain.depthAtPoint(new e.P(this._pos.x,this._pos.y-this._offset.y)),d=s.transform.lngLatToCameraDepth(this._lngLat,l+u)-h>.006;(null===(i=this._popup)||void 0===i?void 0:i.isOpen())&&d&&this._popup.remove(),this._element.style.opacity=d?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=e.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,e){return(void 0===this._opacity||void 0===t&&void 0===e)&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==t&&(this._opacity=t),void 0!==e&&(this._opacityWhenCovered=e),this._map&&this._updateOpacity(!0),this}}const Ja={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let $a=0,Qa=!1;const ts={maxWidth:100,unit:"metric"};function es(t,e,n){const i=n&&n.maxWidth||100,r=t._container.clientHeight/2,a=t._container.clientWidth/2,s=t.unproject([a-i/2,r]),o=t.unproject([a+i/2,r]),l=Math.round(t.project(o).x-t.project(s).x),c=Math.min(i,l,t._container.clientWidth),u=s.distanceTo(o);if(n&&"imperial"===n.unit){const n=3.2808*u;n>5280?ns(e,c,n/5280,t._getUIString("ScaleControl.Miles")):ns(e,c,n,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?ns(e,c,u/1852,t._getUIString("ScaleControl.NauticalMiles")):u>=1e3?ns(e,c,u/1e3,t._getUIString("ScaleControl.Kilometers")):ns(e,c,u,t._getUIString("ScaleControl.Meters"))}function ns(t,e,n,i){const r=function(t){const e=Math.pow(10,"".concat(Math.floor(t)).length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(n);t.style.width=e*(r/n)+"px",t.innerHTML="".concat(r,"&nbsp;").concat(i)}const is={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},rs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function as(t){if(t){if("number"==typeof t){const n=Math.round(Math.abs(t)/Math.SQRT2);return{center:new e.P(0,0),top:new e.P(0,t),"top-left":new e.P(n,n),"top-right":new e.P(-n,n),bottom:new e.P(0,-t),"bottom-left":new e.P(n,-n),"bottom-right":new e.P(-n,-n),left:new e.P(t,0),right:new e.P(-t,0)}}if(t instanceof e.P||Array.isArray(t)){const n=e.P.convert(t);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:e.P.convert(t.center||[0,0]),top:e.P.convert(t.top||[0,0]),"top-left":e.P.convert(t["top-left"]||[0,0]),"top-right":e.P.convert(t["top-right"]||[0,0]),bottom:e.P.convert(t.bottom||[0,0]),"bottom-left":e.P.convert(t["bottom-left"]||[0,0]),"bottom-right":e.P.convert(t["bottom-right"]||[0,0]),left:e.P.convert(t.left||[0,0]),right:e.P.convert(t.right||[0,0])}}return as(new e.P(0,0))}const ss=n;t.AJAXError=e.cz,t.Event=e.l,t.Evented=e.E,t.LngLat=e.S,t.MercatorCoordinate=e.a1,t.Point=e.P,t.addProtocol=e.cA,t.config=e.a,t.removeProtocol=e.cB,t.AttributionControl=La,t.BoxZoomHandler=Zr,t.CanvasSource=J,t.CooperativeGesturesHandler=Ma,t.DoubleClickZoomHandler=va,t.DragPanHandler=wa,t.DragRotateHandler=Sa,t.EdgeInsets=ke,t.FullscreenControl=class extends e.E{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._onFullscreenChange=()=>{var t;let e=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.fullscreenElement;)e=e.shadowRoot.fullscreenElement;e===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:e.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const t=this._fullscreenButton=o.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);o.create("span","maplibregl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new e.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new e.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},t.GeoJSONSource=X,t.GeolocateControl=class extends e.E{constructor(t){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new e.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const n=new e.S(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,r=this._map.getBearing(),a=e.e({bearing:r},this.options.fitBoundsOptions),s=q.fromLngLat(n,i);this._map.fitBounds(s,a,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const n=new e.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Qa)return;this.options.trackUserLocation&&this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new e.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=o.create("button","maplibregl-ctrl-geolocate",this._container),o.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(!1===t){e.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ka({element:this._dotElement}),this._circleElement=o.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ka({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{const n=(null==t?void 0:t[0])instanceof ResizeObserverEntry;t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||n||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new e.l("trackuserlocationend")),this.fire(new e.l("userlocationlostfocus")))})}},this.options=e.e({},Ja,t)}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return e._(this,arguments,void 0,function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function*(){if(void 0!==Wa&&!t)return Wa;if(void 0===window.navigator.permissions)return Wa=!!window.navigator.geolocation,Wa;try{const t=yield window.navigator.permissions.query({name:"geolocation"});Wa="denied"!==t.state}catch(t){Wa=!!window.navigator.geolocation}return Wa}()})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,$a=0,Qa=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}}_updateCircleRadiusIfNeeded(){const t=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&t))return;const e=this._map.project(t),n=this._map.unproject([e.x+100,e.y]),i=t.distanceTo(n)/100,r=2*this._accuracy/i;this._circleElement.style.width="".concat(r.toFixed(2),"px"),this._circleElement.style.height="".concat(r.toFixed(2),"px")}trigger(){if(!this._setup)return e.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":$a--,Qa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new e.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.l("trackuserlocationstart")),this.fire(new e.l("userlocationfocus"));break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),$a++,$a>1?(t={maximumAge:6e5,timeout:0},Qa=!0):(t=this.options.positionOptions,Qa=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},t.GlobeControl=class{constructor(){this._toggleProjection=()=>{var t;const e=null===(t=this._map.getProjection())||void 0===t?void 0:t.type;this._map.setProjection("mercator"!==e&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var t;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),"globe"===(null===(t=this._map.getProjection())||void 0===t?void 0:t.type)?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=o.create("button","maplibregl-ctrl-globe",this._container),o.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},t.Hash=Tr,t.ImageSource=Y,t.KeyboardHandler=pa,t.LngLatBounds=q,t.LogoControl=za,t.Map=class extends Ca{constructor(t){var n,i;e.cw.mark(e.cx.create);const r=Object.assign(Object.assign(Object.assign({},qa),t),{canvasContextAttributes:Object.assign(Object.assign({},qa.canvasContextAttributes),t.canvasContextAttributes)});if(null!=r.minZoom&&null!=r.maxZoom&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=r.minPitch&&null!=r.maxPitch&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=r.minPitch&&r.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=r.maxPitch&&r.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const a=new Ne,s=new Oe;if(void 0!==r.minZoom&&a.setMinZoom(r.minZoom),void 0!==r.maxZoom&&a.setMaxZoom(r.maxZoom),void 0!==r.minPitch&&a.setMinPitch(r.minPitch),void 0!==r.maxPitch&&a.setMaxPitch(r.maxPitch),void 0!==r.renderWorldCopies&&a.setRenderWorldCopies(r.renderWorldCopies),super(a,s,{bearingSnap:r.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Na,this._controls=[],this._mapId=e.a7(),this._contextLost=t=>{t.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new e.l("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new e.l("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=r.interactive,this._maxTileCacheSize=r.maxTileCacheSize,this._maxTileCacheZoomLevels=r.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},r.canvasContextAttributes),this._trackResize=!0===r.trackResize,this._bearingSnap=r.bearingSnap,this._centerClampedToGround=r.centerClampedToGround,this._refreshExpiredTiles=!0===r.refreshExpiredTiles,this._fadeDuration=r.fadeDuration,this._crossSourceCollisions=!0===r.crossSourceCollisions,this._collectResourceTiming=!0===r.collectResourceTiming,this._locale=Object.assign(Object.assign({},Ua),r.locale),this._clickTolerance=r.clickTolerance,this._overridePixelRatio=r.pixelRatio,this._maxCanvasSize=r.maxCanvasSize,this.transformCameraUpdate=r.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===r.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=p.addThrottleControl(()=>this.isMoving()),this._requestManager=new m(r.transformRequest),"string"==typeof r.container){if(this._container=document.getElementById(r.container),!this._container)throw new Error("Container '".concat(r.container,"' not found."))}else{if(!(r.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(r.maxBounds&&this.setMaxBounds(r.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let t=!1;const e=Er(t=>{this._trackResize&&!this._removed&&(this.resize(t),this.redraw())},50);this._resizeObserver=new ResizeObserver(n=>{t?e(n):t=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ta(this,r),this._hash=r.hash&&new Tr("string"==typeof r.hash&&r.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:r.center,elevation:r.elevation,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch,roll:r.roll}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,e.e({},r.fitBoundsOptions,{duration:0}))));const o="string"==typeof r.style||!("globe"===(null===(i=null===(n=r.style)||void 0===n?void 0:n.projection)||void 0===i?void 0:i.type));this.resize(null,o),this._localIdeographFontFamily=r.localIdeographFontFamily,this._validateStyle=r.validateStyle,r.style&&this.setStyle(r.style,{localIdeographFontFamily:r.localIdeographFontFamily}),r.attributionControl&&this.addControl(new La("boolean"==typeof r.attributionControl?void 0:r.attributionControl)),r.maplibreLogo&&this.addControl(new za,r.logoPosition),this.on("style.load",()=>{if(o||this._resizeTransform(),this.transform.unmodified){const t=e.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(t)}}),this.on("data",t=>{this._update("style"===t.dataType),this.fire(new e.l("".concat(t.dataType,"data"),t))}),this.on("dataloading",t=>{this.fire(new e.l("".concat(t.dataType,"dataloading"),t))}),this.on("dataabort",t=>{this.fire(new e.l("sourcedataabort",t))})}_getMapId(){return this._mapId}setGlobalStateProperty(t,e){return this.style.setGlobalStateProperty(t,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(t,n){if(void 0===n&&(n=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=t.onAdd(this);this._controls.push(t);const r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(t);return n>-1&&this._controls.splice(n,1),t.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}coveringTiles(t){return yt(this.transform,t)}calculateCameraOptionsFromTo(t,e,n,i){return null==i&&this.terrain&&(i=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(t,e,n,i)}resize(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const[i,r]=this._containerDimensions(),a=this._getClampedPixelRatio(i,r);if(this._resizeCanvas(i,r,a),this.painter.resize(i,r,a),this.painter.overLimit()){const t=this.painter.context.gl;this._maxCanvasSize=[t.drawingBufferWidth,t.drawingBufferHeight];const e=this._getClampedPixelRatio(i,r);this._resizeCanvas(i,r,e),this.painter.resize(i,r,e)}this._resizeTransform(n);const s=!this._moving;return s&&(this.stop(),this.fire(new e.l("movestart",t)).fire(new e.l("move",t))),this.fire(new e.l("resize",t)),s&&this.fire(new e.l("moveend",t)),this}_resizeTransform(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e;const[n,i]=this._containerDimensions();this.transform.resize(n,i,t),null===(e=this._requestedCameraState)||void 0===e||e.resize(n,i,t)}_getClampedPixelRatio(t,e){const{0:n,1:i}=this._maxCanvasSize,r=this.getPixelRatio(),a=t*r,s=e*r;return Math.min(a>n?n/a:1,s>i?i/s:1)*r}getPixelRatio(){var t;return null!==(t=this._overridePixelRatio)&&void 0!==t?t:devicePixelRatio}setPixelRatio(t){this._overridePixelRatio=t,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(q.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.setMinZoom(t),this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.setMaxZoom(t),this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.setMinPitch(t),this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?60:t)>180)throw new Error("maxPitch must be less than or equal to 180");if(t>=this.transform.minPitch)return this.transform.setMaxPitch(t),this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.setRenderWorldCopies(t),this._update()}project(t){return this.transform.locationToScreenPoint(e.S.convert(t),this.style&&this.terrain)}unproject(t){return this.transform.screenPointToLocation(e.P.convert(t),this.terrain)}isMoving(){var t;return this._moving||(null===(t=this.handlers)||void 0===t?void 0:t.isMoving())}isZooming(){var t;return this._zooming||(null===(t=this.handlers)||void 0===t?void 0:t.isZooming())}isRotating(){var t;return this._rotating||(null===(t=this.handlers)||void 0===t?void 0:t.isRotating())}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let i=!1;const r=r=>{const a=e.filter(t=>this.getLayer(t)),s=0!==a.length?this.queryRenderedFeatures(r.point,{layers:a}):[];s.length?i||(i=!0,n.call(this,new Br(t,this,r.originalEvent,{features:s}))):i=!1};return{layers:e,listener:n,delegates:{mousemove:r,mouseout:()=>{i=!1}}}}if("mouseleave"===t||"mouseout"===t){let i=!1;const r=r=>{const a=e.filter(t=>this.getLayer(t));(0!==a.length?this.queryRenderedFeatures(r.point,{layers:a}):[]).length?i=!0:i&&(i=!1,n.call(this,new Br(t,this,r.originalEvent)))},a=e=>{i&&(i=!1,n.call(this,new Br(t,this,e.originalEvent)))};return{layers:e,listener:n,delegates:{mousemove:r,mouseout:a}}}{const i=t=>{const i=e.filter(t=>this.getLayer(t)),r=0!==i.length?this.queryRenderedFeatures(t.point,{layers:i}):[];r.length&&(t.features=r,n.call(this,t),delete t.features)};return{layers:e,listener:n,delegates:{[t]:i}}}}_saveDelegatedListener(t,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(e)}_removeDelegatedListener(t,e,n){if(!this._delegatedListeners||!this._delegatedListeners[t])return;const i=this._delegatedListeners[t];for(let r=0;r<i.length;r++){const t=i[r];if(t.listener===n&&t.layers.length===e.length&&t.layers.every(t=>e.includes(t))){for(const e in t.delegates)this.off(e,t.delegates[e]);return void i.splice(r,1)}}}on(t,e,n){if(void 0===n)return super.on(t,e);const i="string"==typeof e?[e]:e,r=this._createDelegatedListener(t,i,n);this._saveDelegatedListener(t,r);for(const a in r.delegates)this.on(a,r.delegates[a]);return{unsubscribe:()=>{this._removeDelegatedListener(t,i,n)}}}once(t,e,n){var i=this;if(void 0===n)return super.once(t,e);const r="string"==typeof e?[e]:e,a=this._createDelegatedListener(t,r,n);for(const s in a.delegates){const e=a.delegates[s];a.delegates[s]=function(){i._removeDelegatedListener(t,r,n),e(...arguments)}}this._saveDelegatedListener(t,a);for(const s in a.delegates)this.once(s,a.delegates[s]);return this}off(t,e,n){return void 0===n?super.off(t,e):(this._removeDelegatedListener(t,"string"==typeof e?[e]:e,n),this)}queryRenderedFeatures(t,n){if(!this.style)return[];let i;const r=t instanceof e.P||Array.isArray(t),a=r?t:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(r?{}:t)||{},a instanceof e.P||"number"==typeof a[0])i=[e.P.convert(a)];else{const t=e.P.convert(a[0]),n=e.P.convert(a[1]);i=[t,new e.P(n.x,t.y),n,new e.P(t.x,n.y),t]}return this.style.queryRenderedFeatures(i,n,this.transform)}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(t,n){return!1!==(n=e.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(t,n))}setTransformRequest(t){return this._requestManager.setTransformRequest(t),this}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error("Missing UI string '".concat(t,"'"));return e}_updateStyle(t,e){var n,i;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(t,e));const r=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!t)),t?(this.style=new Sn(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t,e,r):this.style.loadJSON(t,e,r),this):(null===(i=null===(n=this.style)||void 0===n?void 0:n.projection)||void 0===i||i.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Sn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,n){if("string"==typeof t){const i=this._requestManager.transformRequest(t,"Style");e.j(i,new AbortController).then(t=>{this._updateDiff(t.data,n)}).catch(t=>{t&&this.fire(new e.k(t))})}else"object"==typeof t&&this._updateDiff(t,n)}_updateDiff(t,n){try{this.style.setState(t,n)&&this._update(!0)}catch(i){e.w("Unable to perform style diff: ".concat(i.message||i.error||i,".  Rebuilding the style from scratch.")),this._updateStyle(t,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():e.w("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){const n=this.style&&this.style.sourceCaches[t];if(void 0!==n)return n.loaded();this.fire(new e.k(new Error("There is no source with ID '".concat(t,"'"))))}setTerrain(t){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),t){const n=this.style.sourceCaches[t.source];if(!n)throw new Error("cannot load terrain, because there exists no source with ID: ".concat(t.source));null===this.terrain&&n.reload();for(const i in this.style._layers){const n=this.style._layers[i];"hillshade"===n.type&&n.source===t.source&&e.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),"color-relief"===n.type&&n.source===t.source&&e.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Fa(this.painter,n,t),this.painter.renderToTexture=new ja(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=e=>{var n;"style"===e.dataType?this.terrain.sourceCache.freeRtt():"source"===e.dataType&&e.tile&&(e.sourceId!==t.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),"image"===(null===(n=e.source)||void 0===n?void 0:n.type)?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(e.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new e.l("terrain",{terrain:t})),this}getTerrain(){var t,e;return null!==(e=null===(t=this.terrain)||void 0===t?void 0:t.options)&&void 0!==e?e:null}areTilesLoaded(){const t=this.style&&this.style.sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}removeSource(t){return this.style.removeSource(t),this._update(!0)}getSource(t){return this.style.getSource(t)}setSourceTileLodParams(t,e,n){if(n){const i=this.getSource(n);if(!i)throw new Error('There is no source with ID "'.concat(n,'", cannot set LOD parameters'));i.calculateTileZoom=mt(Math.max(1,t),Math.max(1,e))}else for(const i in this.style.sourceCaches)this.style.sourceCaches[i].getSource().calculateTileZoom=mt(Math.max(1,t),Math.max(1,e));return this._update(!0),this}refreshTiles(t,n){const i=this.style.sourceCaches[t];if(!i)throw new Error('There is no source cache with ID "'.concat(t,'", cannot refresh tile'));void 0===n?i.reload(!0):i.refreshTiles(n.map(t=>new e.a4(t.z,t.x,t.y)))}addImage(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{pixelRatio:r=1,sdf:a=!1,stretchX:o,stretchY:l,content:c,textFitWidth:u,textFitHeight:h}=i;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||e.b(n))){if(void 0===n.width||void 0===n.height)return this.fire(new e.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:i,height:s,data:d}=n,f=n;return this.style.addImage(t,{data:new e.R({width:i,height:s},new Uint8Array(d)),pixelRatio:r,stretchX:o,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:a,version:0,userImage:f}),f.onAdd&&f.onAdd(this,t),this}}{const{width:i,height:d,data:f}=s.getImageData(n);this.style.addImage(t,{data:new e.R({width:i,height:d},f),pixelRatio:r,stretchX:o,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:a,version:0})}}updateImage(t,n){const i=this.style.getImage(t);if(!i)return this.fire(new e.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=n instanceof HTMLImageElement||e.b(n)?s.getImageData(n):n,{width:a,height:o,data:l}=r;if(void 0===a||void 0===o)return this.fire(new e.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==i.data.width||o!==i.data.height)return this.fire(new e.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const c=!(n instanceof HTMLImageElement||e.b(n));return i.data.replace(l,c),this.style.updateImage(t,i),this}getImage(t){return this.style.getImage(t)}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.k(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t){return p.getImage(this._requestManager.transformRequest(t,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(t,e,n,i),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(t,e,n,i),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setGlyphs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(t,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(t,e,n,t=>{t||this._update(!0)}),this}removeSprite(t){return this._lazyInitEmptyStyle(),this.style.removeSprite(t),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(t,e,t=>{t||this._update(!0)}),this}setLight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSky(t,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_setupContainer(){const t=this._container;t.classList.add("maplibregl-map");const e=this._canvasContainer=o.create("div","maplibregl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=o.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),i=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],i);const r=this._controlContainer=o.create("div","maplibregl-control-container",t),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(t=>{a[t]=o.create("div","maplibregl-ctrl-".concat(t," "),r)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,e,n){this._canvas.width=Math.floor(n*t),this._canvas.height=Math.floor(n*e),this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(e,"px")}_setupPainter(){const t=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",n=>{e={requestedAttributes:t},n&&(e.statusMessage=n.statusMessage,e.type=n.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,t):this._canvas.getContext("webgl2",t)||this._canvas.getContext("webgl",t),!n){const t="Failed to initialize WebGL";throw e?(e.message=t,new Error(JSON.stringify(e))):new Error(t)}this.painter=new kr(n,this.transform),l.testSupport(n)}migrateProjection(t,n){super.migrateProjection(t,n),this.painter.transform=t,this.fire(new e.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(t){var n,i,r,a,o;const l=this._idleTriggered?this._fadeDuration:0,c=(null===(n=this.style.projection)||void 0===n?void 0:n.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._removed)return;let u=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,n=s.now();this.style.zoomHistory.update(t,n);const i=new e.F(t,{now:n,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),r=i.crossFadingFactor();1===r&&r===this._crossFadingFactor||(u=!0,this._crossFadingFactor=r),this.style.update(i)}const h=(null===(i=this.style.projection)||void 0===i?void 0:i.transitionState)>0!==c;null===(r=this.style.projection)||void 0===r||r.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState(null===(a=this.style.projection)||void 0===a?void 0:a.transitionState,null===(o=this.style.projection)||void 0===o?void 0:o.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||h)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,l,this._crossSourceCollisions,h),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new e.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,e.cw.mark(e.cx.load),this.fire(new e.l("load"))),this.style&&(this.style.hasTransitions()||u)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new e.l("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,e.cw.mark(e.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var t;this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),p.removeThrottleControl(this._imageQueueHandle),null===(t=this._resizeObserver)||void 0===t||t.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==n?void 0:n.loseContext)&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),o.remove(this._canvasContainer),o.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),e.cw.clearMetrics(),this._removed=!0,this.fire(new e.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,s.frame(this._frameRequest,t=>{e.cw.frame(t),this._frameRequest=null;try{this._render(t)}catch(t){if(!e.cy(t)&&!function(t){return t.message===Wi}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get version(){return Ga}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(t){return this._lazyInitEmptyStyle(),this.style.setProjection(t),this._update(!0)}},t.MapMouseEvent=Br,t.MapTouchEvent=jr,t.MapWheelEvent=Ur,t.Marker=Ka,t.NavigationControl=class{constructor(t){this._updateZoomButtons=()=>{const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5),") rotateZ(").concat(-this._map.transform.roll,"deg) rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(-this._map.transform.bearing,"deg)"):this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5),") rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(-this._map.transform.bearing,"deg)"):this.options.visualizeRoll?"rotate(".concat(-this._map.transform.bearing-this._map.transform.roll,"deg)"):"rotate(".concat(-this._map.transform.bearing,"deg)")},this._setButtonTitle=(t,e)=>{const n=this._map._getUIString("NavigationControl.".concat(e));t.title=n,t.setAttribute("aria-label",n)},this.options=e.e({},Va,t),this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),o.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),o.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=o.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Za(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const n=o.create("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}},t.Popup=class extends e.E{constructor(t){super(),this._updateOpacity=()=>{void 0!==this.options.locationOccludedOpacity&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?"".concat(this.options.locationOccludedOpacity):"")},this.remove=()=>(this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new e.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=o.create("div","maplibregl-popup",this._map.getContainer()),this._tip=o.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const t of this.options.className.split(" "))this._container.classList.add(t);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Ha(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const e=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let n=this.options.anchor;const i=as(this.options.offset);if(!n){const t=this._container.offsetWidth,r=this._container.offsetHeight;let a;a=e.y+i.bottom.y<r?["top"]:e.y>this._map.transform.height-r?["bottom"]:[],e.x<t/2?a.push("left"):e.x>this._map.transform.width-t/2&&a.push("right"),n=0===a.length?"bottom":a.join("-")}let r=e.add(i[n]);this.options.subpixelPositioning||(r=r.round()),o.setTransform(this._container,"".concat(Xa[n]," translate(").concat(r.x,"px,").concat(r.y,"px)")),Ya(this._container,n,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=e.e(Object.create(is),t)}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new e.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.S.convert(t),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),n=document.createElement("body");let i;for(n.innerHTML=t;i=n.firstChild,i;)e.appendChild(i);return this.setDOMContent(e)}getMaxWidth(){var t;return null===(t=this._container)||void 0===t?void 0:t.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){return this._container&&this._container.classList.add(t),this}removeClassName(t){return this._container&&this._container.classList.remove(t),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}setSubpixelPositioning(t){this.options.subpixelPositioning=t}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(rs);t&&t.focus()}},t.RasterDEMTileSource=H,t.RasterTileSource=W,t.ScaleControl=class{constructor(t){this._onMove=()=>{es(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,es(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ts),t)}getDefaultPosition(){return"bottom-left"}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},t.ScrollZoomHandler=ya,t.Style=Sn,t.TerrainControl=class{constructor(t){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=t}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=o.create("button","maplibregl-ctrl-terrain",this._container),o.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){o.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},t.TwoFingersTouchPitchHandler=da,t.TwoFingersTouchRotateHandler=ua,t.TwoFingersTouchZoomHandler=la,t.TwoFingersTouchZoomRotateHandler=Pa,t.VectorTileSource=Z,t.VideoSource=K,t.addSourceType=(t,n)=>e._(void 0,void 0,void 0,function*(){if(Q(t))throw new Error('A source type called "'.concat(t,'" already exists.'));((t,e)=>{$[t]=e})(t,n)}),t.clearPrewarmedResources=function(){const t=z;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(C),z=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},t.createTileMesh=Ye,t.getMaxParallelImageRequests=function(){return e.a.MAX_PARALLEL_IMAGE_REQUESTS},t.getRTLTextPluginStatus=function(){return it().getRTLTextPluginStatus()},t.getVersion=function(){return ss},t.getWorkerCount=function(){return I.workerCount},t.getWorkerUrl=function(){return e.a.WORKER_URL},t.importScriptInWorkers=function(t){return F().broadcast("IS",t)},t.prewarm=function(){D().acquire(C)},t.setMaxParallelImageRequests=function(t){e.a.MAX_PARALLEL_IMAGE_REQUESTS=t},t.setRTLTextPlugin=function(t,e){return it().setRTLTextPlugin(t,e)},t.setWorkerCount=function(t){I.workerCount=t},t.setWorkerUrl=function(t){e.a.WORKER_URL=t}}),t}()},4288:(t,e)=>{"use strict";var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function _(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}function y(){}function v(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}_.prototype.isReactComponent={},_.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},_.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},y.prototype=_.prototype;var b=v.prototype=new y;b.constructor=v,m(b,_.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w={H:null,A:null,T:null,S:null,V:null},S=Object.prototype.hasOwnProperty;function P(t,e,i,r,a,s){return i=s.ref,{$$typeof:n,type:t,key:e,ref:void 0!==i?i:null,props:s}}function M(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var A=/\/+/g;function k(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(t){return e[t]})}(""+t.key):e.toString(36)}function E(){}function T(t,e,r,a,s){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var l,c,u=!1;if(null===t)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case n:case i:u=!0;break;case d:return T((u=t._init)(t._payload),e,r,a,s)}}if(u)return s=s(t),u=""===a?"."+k(t,0):a,x(s)?(r="",null!=u&&(r=u.replace(A,"$&/")+"/"),T(s,e,r,"",function(t){return t})):null!=s&&(M(s)&&(l=s,c=r+(null==s.key||t&&t.key===s.key?"":(""+s.key).replace(A,"$&/")+"/")+u,s=P(l.type,c,void 0,0,0,l.props)),e.push(s)),1;u=0;var h,p=""===a?".":a+":";if(x(t))for(var m=0;m<t.length;m++)u+=T(a=t[m],e,r,o=p+k(a,m),s);else if("function"===typeof(m=null===(h=t)||"object"!==typeof h?null:"function"===typeof(h=f&&h[f]||h["@@iterator"])?h:null))for(t=m.call(t),m=0;!(a=t.next()).done;)u+=T(a=a.value,e,r,o=p+k(a,m++),s);else if("object"===o){if("function"===typeof t.then)return T(function(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch("string"===typeof t.status?t.then(E,E):(t.status="pending",t.then(function(e){"pending"===t.status&&(t.status="fulfilled",t.value=e)},function(e){"pending"===t.status&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}(t),e,r,a,s);throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return u}function C(t,e,n){if(null==t)return t;var i=[],r=0;return T(t,i,"","",function(t){return e.call(n,t,r++)}),i}function I(t){if(-1===t._status){var e=t._result;(e=e()).then(function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)},function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)}),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var L="function"===typeof reportError?reportError:function(t){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof t&&null!==t&&"string"===typeof t.message?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",t);console.error(t)};function z(){}e.Children={map:C,forEach:function(t,e,n){C(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return C(t,function(){e++}),e},toArray:function(t){return C(t,function(t){return t})||[]},only:function(t){if(!M(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=_,e.Fragment=r,e.Profiler=s,e.PureComponent=v,e.StrictMode=a,e.Suspense=u,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,e.__COMPILER_RUNTIME={__proto__:null,c:function(t){return w.H.useMemoCache(t)}},e.cache=function(t){return function(){return t.apply(null,arguments)}},e.cloneElement=function(t,e,n){if(null===t||void 0===t)throw Error("The argument must be a React element, but you passed "+t+".");var i=m({},t.props),r=t.key;if(null!=e)for(a in void 0!==e.ref&&void 0,void 0!==e.key&&(r=""+e.key),e)!S.call(e,a)||"key"===a||"__self"===a||"__source"===a||"ref"===a&&void 0===e.ref||(i[a]=e[a]);var a=arguments.length-2;if(1===a)i.children=n;else if(1<a){for(var s=Array(a),o=0;o<a;o++)s[o]=arguments[o+2];i.children=s}return P(t.type,r,void 0,0,0,i)},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider=t,t.Consumer={$$typeof:o,_context:t},t},e.createElement=function(t,e,n){var i,r={},a=null;if(null!=e)for(i in void 0!==e.key&&(a=""+e.key),e)S.call(e,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&(r[i]=e[i]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];r.children=o}if(t&&t.defaultProps)for(i in s=t.defaultProps)void 0===r[i]&&(r[i]=s[i]);return P(t,a,void 0,0,0,r)},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:c,render:t}},e.isValidElement=M,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:I}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=w.T,n={};w.T=n;try{var i=t(),r=w.S;null!==r&&r(n,i),"object"===typeof i&&null!==i&&"function"===typeof i.then&&i.then(z,L)}catch(a){L(a)}finally{w.T=e}},e.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},e.use=function(t){return w.H.use(t)},e.useActionState=function(t,e,n){return w.H.useActionState(t,e,n)},e.useCallback=function(t,e){return w.H.useCallback(t,e)},e.useContext=function(t){return w.H.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t,e){return w.H.useDeferredValue(t,e)},e.useEffect=function(t,e,n){var i=w.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return i.useEffect(t,e)},e.useId=function(){return w.H.useId()},e.useImperativeHandle=function(t,e,n){return w.H.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return w.H.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return w.H.useLayoutEffect(t,e)},e.useMemo=function(t,e){return w.H.useMemo(t,e)},e.useOptimistic=function(t,e){return w.H.useOptimistic(t,e)},e.useReducer=function(t,e,n){return w.H.useReducer(t,e,n)},e.useRef=function(t){return w.H.useRef(t)},e.useState=function(t){return w.H.useState(t)},e.useSyncExternalStore=function(t,e,n){return w.H.useSyncExternalStore(t,e,n)},e.useTransition=function(){return w.H.useTransition()},e.version="19.1.1"},4391:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(7004)},4980:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var i=n(2284);function r(t){var e=function(t,e){if("object"!=(0,i.A)(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=(0,i.A)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==(0,i.A)(e)?e:e+""}function a(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},5043:(t,e,n)=>{"use strict";t.exports=n(4288)},5896:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<a(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,s=r>>>1;i<s;){var o=2*(i+1)-1,l=t[o],c=o+1,u=t[c];if(0>a(l,n))c<r&&0>a(u,l)?(t[i]=u,t[c]=n,i=c):(t[i]=l,t[o]=n,i=o);else{if(!(c<r&&0>a(u,n)))break t;t[i]=u,t[c]=n,i=c}}}return e}function a(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if(e.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,_=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(t){for(var e=i(u);null!==e;){if(null===e.callback)r(u);else{if(!(e.startTime<=t))break;r(u),e.sortIndex=e.expirationTime,n(c,e)}e=i(u)}}function w(t){if(g=!1,x(t),!m)if(null!==i(c))m=!0,P||(P=!0,S());else{var e=i(u);null!==e&&L(w,e.startTime-t)}}var S,P=!1,M=-1,A=5,k=-1;function E(){return!!_||!(e.unstable_now()-k<A)}function T(){if(_=!1,P){var t=e.unstable_now();k=t;var n=!0;try{t:{m=!1,g&&(g=!1,v(M),M=-1),p=!0;var a=f;try{e:{for(x(t),d=i(c);null!==d&&!(d.expirationTime>t&&E());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=t);if(t=e.unstable_now(),"function"===typeof o){d.callback=o,x(t),n=!0;break e}d===i(c)&&r(c),x(t)}else r(c);d=i(c)}if(null!==d)n=!0;else{var l=i(u);null!==l&&L(w,l.startTime-t),n=!1}}break t}finally{d=null,f=a,p=!1}n=void 0}}finally{n?S():P=!1}}}if("function"===typeof b)S=function(){b(T)};else if("undefined"!==typeof MessageChannel){var C=new MessageChannel,I=C.port2;C.port1.onmessage=T,S=function(){I.postMessage(null)}}else S=function(){y(T,0)};function L(t,n){M=y(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,r,a){var s=e.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,t){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(t.sortIndex=a,n(u,t),null===i(c)&&t===i(u)&&(g?(v(M),M=-1):g=!0,L(w,a-s))):(t.sortIndex=o,n(c,t),m||p||(m=!0,P||(P=!0,S()))),t},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}},6672:(t,e,n)=>{"use strict";var i=n(5043);function r(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(r(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(t,e){return"font"===t?"":"string"===typeof e?"use-credentials"===e?e:"":void 0}e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)throw Error(r(299));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.flushSync=function(t){var e=l.T,n=s.p;try{if(l.T=null,s.p=2,t)return t()}finally{l.T=e,s.p=n,s.d.f()}},e.preconnect=function(t,e){"string"===typeof t&&(e?e="string"===typeof(e=e.crossOrigin)?"use-credentials"===e?e:"":void 0:e=null,s.d.C(t,e))},e.prefetchDNS=function(t){"string"===typeof t&&s.d.D(t)},e.preinit=function(t,e){if("string"===typeof t&&e&&"string"===typeof e.as){var n=e.as,i=c(n,e.crossOrigin),r="string"===typeof e.integrity?e.integrity:void 0,a="string"===typeof e.fetchPriority?e.fetchPriority:void 0;"style"===n?s.d.S(t,"string"===typeof e.precedence?e.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:a}):"script"===n&&s.d.X(t,{crossOrigin:i,integrity:r,fetchPriority:a,nonce:"string"===typeof e.nonce?e.nonce:void 0})}},e.preinitModule=function(t,e){if("string"===typeof t)if("object"===typeof e&&null!==e){if(null==e.as||"script"===e.as){var n=c(e.as,e.crossOrigin);s.d.M(t,{crossOrigin:n,integrity:"string"===typeof e.integrity?e.integrity:void 0,nonce:"string"===typeof e.nonce?e.nonce:void 0})}}else null==e&&s.d.M(t)},e.preload=function(t,e){if("string"===typeof t&&"object"===typeof e&&null!==e&&"string"===typeof e.as){var n=e.as,i=c(n,e.crossOrigin);s.d.L(t,n,{crossOrigin:i,integrity:"string"===typeof e.integrity?e.integrity:void 0,nonce:"string"===typeof e.nonce?e.nonce:void 0,type:"string"===typeof e.type?e.type:void 0,fetchPriority:"string"===typeof e.fetchPriority?e.fetchPriority:void 0,referrerPolicy:"string"===typeof e.referrerPolicy?e.referrerPolicy:void 0,imageSrcSet:"string"===typeof e.imageSrcSet?e.imageSrcSet:void 0,imageSizes:"string"===typeof e.imageSizes?e.imageSizes:void 0,media:"string"===typeof e.media?e.media:void 0})}},e.preloadModule=function(t,e){if("string"===typeof t)if(e){var n=c(e.as,e.crossOrigin);s.d.m(t,{as:"string"===typeof e.as&&"script"!==e.as?e.as:void 0,crossOrigin:n,integrity:"string"===typeof e.integrity?e.integrity:void 0})}else s.d.m(t)},e.requestFormReset=function(t){s.d.r(t)},e.unstable_batchedUpdates=function(t,e){return t(e)},e.useFormState=function(t,e,n){return l.H.useFormState(t,e,n)},e.useFormStatus=function(){return l.H.useHostTransitionStatus()},e.version="19.1.1"},7004:(t,e,n)=>{"use strict";var i=n(8853),r=n(5043),a=n(7950);function s(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function l(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function c(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function u(t){if(l(t)!==t)throw Error(s(188))}function h(t){var e=t.tag;if(5===e||26===e||27===e||6===e)return t;for(t=t.child;null!==t;){if(null!==(e=h(t)))return e;t=t.sibling}return null}var d=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),x=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope");var k=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var E=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var T=Symbol.iterator;function C(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=T&&t[T]||t["@@iterator"])?t:null}var I=Symbol.for("react.client.reference");function L(t){if(null==t)return null;if("function"===typeof t)return t.$$typeof===I?null:t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case g:return"Fragment";case y:return"Profiler";case _:return"StrictMode";case S:return"Suspense";case P:return"SuspenseList";case k:return"Activity"}if("object"===typeof t)switch(t.$$typeof){case m:return"Portal";case x:return(t.displayName||"Context")+".Provider";case b:return(t._context.displayName||"Context")+".Consumer";case w:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case M:return null!==(e=t.displayName||null)?e:L(t.type)||"Memo";case A:e=t._payload,t=t._init;try{return L(t(e))}catch(n){}}return null}var z=Array.isArray,N=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},F=[],O=-1;function B(t){return{current:t}}function j(t){0>O||(t.current=F[O],F[O]=null,O--)}function U(t,e){O++,F[O]=t.current,t.current=e}var G=B(null),q=B(null),V=B(null),Z=B(null);function W(t,e){switch(U(V,e),U(q,t),U(G,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?rh(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)t=ah(e=rh(e),t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}j(G),U(G,t)}function H(){j(G),j(q),j(V)}function X(t){null!==t.memoizedState&&U(Z,t);var e=G.current,n=ah(e,t.type);e!==n&&(U(q,t),U(G,n))}function Y(t){q.current===t&&(j(G),j(q)),Z.current===t&&(j(Z),Xh._currentValue=R)}var K=Object.prototype.hasOwnProperty,J=i.unstable_scheduleCallback,$=i.unstable_cancelCallback,Q=i.unstable_shouldYield,tt=i.unstable_requestPaint,et=i.unstable_now,nt=i.unstable_getCurrentPriorityLevel,it=i.unstable_ImmediatePriority,rt=i.unstable_UserBlockingPriority,at=i.unstable_NormalPriority,st=i.unstable_LowPriority,ot=i.unstable_IdlePriority,lt=i.log,ct=i.unstable_setDisableYieldValue,ut=null,ht=null;function dt(t){if("function"===typeof lt&&ct(t),ht&&"function"===typeof ht.setStrictMode)try{ht.setStrictMode(ut,t)}catch(e){}}var ft=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(pt(t)/mt|0)|0},pt=Math.log,mt=Math.LN2;var gt=256,_t=4194304;function yt(t){var e=42&t;if(0!==e)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&t;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&t;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function vt(t,e,n){var i=t.pendingLanes;if(0===i)return 0;var r=0,a=t.suspendedLanes,s=t.pingedLanes;t=t.warmLanes;var o=134217727&i;return 0!==o?0!==(i=o&~a)?r=yt(i):0!==(s&=o)?r=yt(s):n||0!==(n=o&~t)&&(r=yt(n)):0!==(o=i&~a)?r=yt(o):0!==s?r=yt(s):n||0!==(n=i&~t)&&(r=yt(n)),0===r?0:0!==e&&e!==r&&0===(e&a)&&((a=r&-r)>=(n=e&-e)||32===a&&0!==(4194048&n))?e:r}function bt(t,e){return 0===(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)}function xt(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function wt(){var t=gt;return 0===(4194048&(gt<<=1))&&(gt=256),t}function St(){var t=_t;return 0===(62914560&(_t<<=1))&&(_t=4194304),t}function Pt(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Mt(t,e){t.pendingLanes|=e,268435456!==e&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function At(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var i=31-ft(e);t.entangledLanes|=e,t.entanglements[i]=1073741824|t.entanglements[i]|4194090&n}function kt(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-ft(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}function Et(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Tt(t){return 2<(t&=-t)?8<t?0!==(134217727&t)?32:268435456:8:2}function Ct(){var t=D.p;return 0!==t?t:void 0===(t=window.event)?32:cd(t.type)}var It=Math.random().toString(36).slice(2),Lt="__reactFiber$"+It,zt="__reactProps$"+It,Nt="__reactContainer$"+It,Dt="__reactEvents$"+It,Rt="__reactListeners$"+It,Ft="__reactHandles$"+It,Ot="__reactResources$"+It,Bt="__reactMarker$"+It;function jt(t){delete t[Lt],delete t[zt],delete t[Dt],delete t[Rt],delete t[Ft]}function Ut(t){var e=t[Lt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Nt]||n[Lt]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=vh(t);null!==t;){if(n=t[Lt])return n;t=vh(t)}return e}n=(t=n).parentNode}return null}function Gt(t){if(t=t[Lt]||t[Nt]){var e=t.tag;if(5===e||6===e||13===e||26===e||27===e||3===e)return t}return null}function qt(t){var e=t.tag;if(5===e||26===e||27===e||6===e)return t.stateNode;throw Error(s(33))}function Vt(t){var e=t[Ot];return e||(e=t[Ot]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function Zt(t){t[Bt]=!0}var Wt=new Set,Ht={};function Xt(t,e){Yt(t,e),Yt(t+"Capture",e)}function Yt(t,e){for(Ht[t]=e,t=0;t<e.length;t++)Wt.add(e[t])}var Kt,Jt,$t=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qt={},te={};function ee(t,e,n){if(r=e,K.call(te,r)||!K.call(Qt,r)&&($t.test(r)?te[r]=!0:(Qt[r]=!0,0)))if(null===n)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":return void t.removeAttribute(e);case"boolean":var i=e.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void t.removeAttribute(e)}t.setAttribute(e,""+n)}var r}function ne(t,e,n){if(null===n)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void t.removeAttribute(e)}t.setAttribute(e,""+n)}}function ie(t,e,n,i){if(null===i)t.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void t.removeAttribute(n)}t.setAttributeNS(e,n,""+i)}}function re(t){if(void 0===Kt)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Kt=e&&e[1]||"",Jt=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Kt+t+Jt}var ae=!1;function se(t,e){if(!t||ae)return"";ae=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var i=r}Reflect.construct(t,[],n)}else{try{n.call()}catch(a){i=a}t.call(n.prototype)}}else{try{throw Error()}catch(s){i=s}(n=t())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(o){if(o&&i&&"string"===typeof o.stack)return[o.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=i.DetermineComponentFrameRoot(),s=a[0],o=a[1];if(s&&o){var l=s.split("\n"),c=o.split("\n");for(r=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(i===l.length||r===c.length)for(i=l.length-1,r=c.length-1;1<=i&&0<=r&&l[i]!==c[r];)r--;for(;1<=i&&0<=r;i--,r--)if(l[i]!==c[r]){if(1!==i||1!==r)do{if(i--,0>--r||l[i]!==c[r]){var u="\n"+l[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}}while(1<=i&&0<=r);break}}}finally{ae=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?re(n):""}function oe(t){switch(t.tag){case 26:case 27:case 5:return re(t.type);case 16:return re("Lazy");case 13:return re("Suspense");case 19:return re("SuspenseList");case 0:case 15:return se(t.type,!1);case 11:return se(t.type.render,!1);case 1:return se(t.type,!0);case 31:return re("Activity");default:return""}}function le(t){try{var e="";do{e+=oe(t),t=t.return}while(t);return e}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ce(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function ue(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function he(t){t._valueTracker||(t._valueTracker=function(t){var e=ue(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,a.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function de(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=ue(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function fe(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}var pe=/[\n"\\]/g;function me(t){return t.replace(pe,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function ge(t,e,n,i,r,a,s,o){t.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?t.type=s:t.removeAttribute("type"),null!=e?"number"===s?(0===e&&""===t.value||t.value!=e)&&(t.value=""+ce(e)):t.value!==""+ce(e)&&(t.value=""+ce(e)):"submit"!==s&&"reset"!==s||t.removeAttribute("value"),null!=e?ye(t,s,ce(e)):null!=n?ye(t,s,ce(n)):null!=i&&t.removeAttribute("value"),null==r&&null!=a&&(t.defaultChecked=!!a),null!=r&&(t.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?t.name=""+ce(o):t.removeAttribute("name")}function _e(t,e,n,i,r,a,s,o){if(null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(t.type=a),null!=e||null!=n){if(!("submit"!==a&&"reset"!==a||void 0!==e&&null!==e))return;n=null!=n?""+ce(n):"",e=null!=e?""+ce(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}i="function"!==typeof(i=null!=i?i:r)&&"symbol"!==typeof i&&!!i,t.checked=o?t.checked:!!i,t.defaultChecked=!!i,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(t.name=s)}function ye(t,e,n){"number"===e&&fe(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function ve(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+ce(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function be(t,e,n){null==e||((e=""+ce(e))!==t.value&&(t.value=e),null!=n)?t.defaultValue=null!=n?""+ce(n):"":t.defaultValue!==e&&(t.defaultValue=e)}function xe(t,e,n,i){if(null==e){if(null!=i){if(null!=n)throw Error(s(92));if(z(i)){if(1<i.length)throw Error(s(93));i=i[0]}n=i}null==n&&(n=""),e=n}n=ce(e),t.defaultValue=n,(i=t.textContent)===n&&""!==i&&null!==i&&(t.value=i)}function we(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var Se=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pe(t,e,n){var i=0===e.indexOf("--");null==n||"boolean"===typeof n||""===n?i?t.setProperty(e,""):"float"===e?t.cssFloat="":t[e]="":i?t.setProperty(e,n):"number"!==typeof n||0===n||Se.has(e)?"float"===e?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function Me(t,e,n){if(null!=e&&"object"!==typeof e)throw Error(s(62));if(t=t.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=e&&e.hasOwnProperty(i)||(0===i.indexOf("--")?t.setProperty(i,""):"float"===i?t.cssFloat="":t[i]="");for(var r in e)i=e[r],e.hasOwnProperty(r)&&n[r]!==i&&Pe(t,r,i)}else for(var a in e)e.hasOwnProperty(a)&&Pe(t,a,e[a])}function Ae(t){if(-1===t.indexOf("-"))return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ee=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Te(t){return Ee.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var Ce=null;function Ie(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Le=null,ze=null;function Ne(t){var e=Gt(t);if(e&&(t=e.stateNode)){var n=t[zt]||null;t:switch(t=e.stateNode,e.type){case"input":if(ge(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+me(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=i[zt]||null;if(!r)throw Error(s(90));ge(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(e=0;e<n.length;e++)(i=n[e]).form===t.form&&de(i)}break t;case"textarea":be(t,n.value,n.defaultValue);break t;case"select":null!=(e=n.value)&&ve(t,!!n.multiple,e,!1)}}}var De=!1;function Re(t,e,n){if(De)return t(e,n);De=!0;try{return t(e)}finally{if(De=!1,(null!==Le||null!==ze)&&(Uc(),Le&&(e=Le,t=ze,ze=Le=null,Ne(e),t)))for(e=0;e<t.length;e++)Ne(t[e])}}function Fe(t,e){var n=t.stateNode;if(null===n)return null;var i=n[zt]||null;if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(s(231,e,typeof n));return n}var Oe=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Be=!1;if(Oe)try{var je={};Object.defineProperty(je,"passive",{get:function(){Be=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch(zd){Be=!1}var Ue=null,Ge=null,qe=null;function Ve(){if(qe)return qe;var t,e,n=Ge,i=n.length,r="value"in Ue?Ue.value:Ue.textContent,a=r.length;for(t=0;t<i&&n[t]===r[t];t++);var s=i-t;for(e=1;e<=s&&n[i-e]===r[a-e];e++);return qe=r.slice(t,1<e?1-e:void 0)}function Ze(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function We(){return!0}function He(){return!1}function Xe(t){function e(e,n,i,r,a){for(var s in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=a,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?We:He,this.isPropagationStopped=He,this}return d(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=We)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=We)},persist:function(){},isPersistent:We}),e}var Ye,Ke,Je,$e={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qe=Xe($e),tn=d({},$e,{view:0,detail:0}),en=Xe(tn),nn=d({},tn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Je&&(Je&&"mousemove"===t.type?(Ye=t.screenX-Je.screenX,Ke=t.screenY-Je.screenY):Ke=Ye=0,Je=t),Ye)},movementY:function(t){return"movementY"in t?t.movementY:Ke}}),rn=Xe(nn),an=Xe(d({},nn,{dataTransfer:0})),sn=Xe(d({},tn,{relatedTarget:0})),on=Xe(d({},$e,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Xe(d({},$e,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}})),cn=Xe(d({},$e,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=dn[t])&&!!e[t]}function pn(){return fn}var mn=Xe(d({},tn,{key:function(t){if(t.key){var e=un[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=Ze(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?hn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(t){return"keypress"===t.type?Ze(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?Ze(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}})),gn=Xe(d({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=Xe(d({},tn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),yn=Xe(d({},$e,{propertyName:0,elapsedTime:0,pseudoElement:0})),vn=Xe(d({},nn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0})),bn=Xe(d({},$e,{newState:0,oldState:0})),xn=[9,13,27,32],wn=Oe&&"CompositionEvent"in window,Sn=null;Oe&&"documentMode"in document&&(Sn=document.documentMode);var Pn=Oe&&"TextEvent"in window&&!Sn,Mn=Oe&&(!wn||Sn&&8<Sn&&11>=Sn),An=String.fromCharCode(32),kn=!1;function En(t,e){switch(t){case"keyup":return-1!==xn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tn(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Cn=!1;var In={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!In[t.type]:"textarea"===e}function zn(t,e,n,i){Le?ze?ze.push(i):ze=[i]:Le=i,0<(e=Vu(e,"onChange")).length&&(n=new Qe("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Nn=null,Dn=null;function Rn(t){Ru(t,0)}function Fn(t){if(de(qt(t)))return t}function On(t,e){if("change"===t)return e}var Bn=!1;if(Oe){var jn;if(Oe){var Un="oninput"in document;if(!Un){var Gn=document.createElement("div");Gn.setAttribute("oninput","return;"),Un="function"===typeof Gn.oninput}jn=Un}else jn=!1;Bn=jn&&(!document.documentMode||9<document.documentMode)}function qn(){Nn&&(Nn.detachEvent("onpropertychange",Vn),Dn=Nn=null)}function Vn(t){if("value"===t.propertyName&&Fn(Dn)){var e=[];zn(e,Dn,t,Ie(t)),Re(Rn,e)}}function Zn(t,e,n){"focusin"===t?(qn(),Dn=n,(Nn=e).attachEvent("onpropertychange",Vn)):"focusout"===t&&qn()}function Wn(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Fn(Dn)}function Hn(t,e){if("click"===t)return Fn(e)}function Xn(t,e){if("input"===t||"change"===t)return Fn(e)}var Yn="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function Kn(t,e){if(Yn(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!K.call(e,r)||!Yn(t[r],e[r]))return!1}return!0}function Jn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $n(t,e){var n,i=Jn(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=Jn(i)}}function Qn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?Qn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function ti(t){for(var e=fe((t=null!=t&&null!=t.ownerDocument&&null!=t.ownerDocument.defaultView?t.ownerDocument.defaultView:window).document);e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(i){n=!1}if(!n)break;e=fe((t=e.contentWindow).document)}return e}function ei(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var ni=Oe&&"documentMode"in document&&11>=document.documentMode,ii=null,ri=null,ai=null,si=!1;function oi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;si||null==ii||ii!==fe(i)||("selectionStart"in(i=ii)&&ei(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},ai&&Kn(ai,i)||(ai=i,0<(i=Vu(ri,"onSelect")).length&&(e=new Qe("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=ii)))}function li(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ci={animationend:li("Animation","AnimationEnd"),animationiteration:li("Animation","AnimationIteration"),animationstart:li("Animation","AnimationStart"),transitionrun:li("Transition","TransitionRun"),transitionstart:li("Transition","TransitionStart"),transitioncancel:li("Transition","TransitionCancel"),transitionend:li("Transition","TransitionEnd")},ui={},hi={};function di(t){if(ui[t])return ui[t];if(!ci[t])return t;var e,n=ci[t];for(e in n)if(n.hasOwnProperty(e)&&e in hi)return ui[t]=n[e];return t}Oe&&(hi=document.createElement("div").style,"AnimationEvent"in window||(delete ci.animationend.animation,delete ci.animationiteration.animation,delete ci.animationstart.animation),"TransitionEvent"in window||delete ci.transitionend.transition);var fi=di("animationend"),pi=di("animationiteration"),mi=di("animationstart"),gi=di("transitionrun"),_i=di("transitionstart"),yi=di("transitioncancel"),vi=di("transitionend"),bi=new Map,xi="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wi(t,e){bi.set(t,e),Xt(e,[t])}xi.push("scrollEnd");var Si=new WeakMap;function Pi(t,e){if("object"===typeof t&&null!==t){var n=Si.get(t);return void 0!==n?n:(e={value:t,source:e,stack:le(e)},Si.set(t,e),e)}return{value:t,source:e,stack:le(e)}}var Mi=[],Ai=0,ki=0;function Ei(){for(var t=Ai,e=ki=Ai=0;e<t;){var n=Mi[e];Mi[e++]=null;var i=Mi[e];Mi[e++]=null;var r=Mi[e];Mi[e++]=null;var a=Mi[e];if(Mi[e++]=null,null!==i&&null!==r){var s=i.pending;null===s?r.next=r:(r.next=s.next,s.next=r),i.pending=r}0!==a&&Li(n,r,a)}}function Ti(t,e,n,i){Mi[Ai++]=t,Mi[Ai++]=e,Mi[Ai++]=n,Mi[Ai++]=i,ki|=i,t.lanes|=i,null!==(t=t.alternate)&&(t.lanes|=i)}function Ci(t,e,n,i){return Ti(t,e,n,i),zi(t)}function Ii(t,e){return Ti(t,null,null,e),zi(t)}function Li(t,e,n){t.lanes|=n;var i=t.alternate;null!==i&&(i.lanes|=n);for(var r=!1,a=t.return;null!==a;)a.childLanes|=n,null!==(i=a.alternate)&&(i.childLanes|=n),22===a.tag&&(null===(t=a.stateNode)||1&t._visibility||(r=!0)),t=a,a=a.return;return 3===t.tag?(a=t.stateNode,r&&null!==e&&(r=31-ft(n),null===(i=(t=a.hiddenUpdates)[r])?t[r]=[e]:i.push(e),e.lane=536870912|n),a):null}function zi(t){if(50<Lc)throw Lc=0,zc=null,Error(s(185));for(var e=t.return;null!==e;)e=(t=e).return;return 3===t.tag?t.stateNode:null}var Ni={};function Di(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ri(t,e,n,i){return new Di(t,e,n,i)}function Fi(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Oi(t,e){var n=t.alternate;return null===n?((n=Ri(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function Bi(t,e){t.flags&=65011714;var n=t.alternate;return null===n?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function ji(t,e,n,i,r,a){var o=0;if(i=t,"function"===typeof t)Fi(t)&&(o=1);else if("string"===typeof t)o=function(t,e,n){if(1===n||null!=e.itemProp)return!1;switch(t){case"meta":case"title":return!0;case"style":if("string"!==typeof e.precedence||"string"!==typeof e.href||""===e.href)break;return!0;case"link":if("string"!==typeof e.rel||"string"!==typeof e.href||""===e.href||e.onLoad||e.onError)break;return"stylesheet"!==e.rel||(t=e.disabled,"string"===typeof e.precedence&&null==t);case"script":if(e.async&&"function"!==typeof e.async&&"symbol"!==typeof e.async&&!e.onLoad&&!e.onError&&e.src&&"string"===typeof e.src)return!0}return!1}(t,n,G.current)?26:"html"===t||"head"===t||"body"===t?27:5;else t:switch(t){case k:return(t=Ri(31,n,e,r)).elementType=k,t.lanes=a,t;case g:return Ui(n.children,r,a,e);case _:o=8,r|=24;break;case y:return(t=Ri(12,n,e,2|r)).elementType=y,t.lanes=a,t;case S:return(t=Ri(13,n,e,r)).elementType=S,t.lanes=a,t;case P:return(t=Ri(19,n,e,r)).elementType=P,t.lanes=a,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case v:case x:o=10;break t;case b:o=9;break t;case w:o=11;break t;case M:o=14;break t;case A:o=16,i=null;break t}o=29,n=Error(s(130,null===t?"null":typeof t,"")),i=null}return(e=Ri(o,n,e,r)).elementType=t,e.type=i,e.lanes=a,e}function Ui(t,e,n,i){return(t=Ri(7,t,i,e)).lanes=n,t}function Gi(t,e,n){return(t=Ri(6,t,null,e)).lanes=n,t}function qi(t,e,n){return(e=Ri(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Vi=[],Zi=0,Wi=null,Hi=0,Xi=[],Yi=0,Ki=null,Ji=1,$i="";function Qi(t,e){Vi[Zi++]=Hi,Vi[Zi++]=Wi,Wi=t,Hi=e}function tr(t,e,n){Xi[Yi++]=Ji,Xi[Yi++]=$i,Xi[Yi++]=Ki,Ki=t;var i=Ji;t=$i;var r=32-ft(i)-1;i&=~(1<<r),n+=1;var a=32-ft(e)+r;if(30<a){var s=r-r%5;a=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Ji=1<<32-ft(e)+r|n<<r|i,$i=a+t}else Ji=1<<a|n<<r|i,$i=t}function er(t){null!==t.return&&(Qi(t,1),tr(t,1,0))}function nr(t){for(;t===Wi;)Wi=Vi[--Zi],Vi[Zi]=null,Hi=Vi[--Zi],Vi[Zi]=null;for(;t===Ki;)Ki=Xi[--Yi],Xi[Yi]=null,$i=Xi[--Yi],Xi[Yi]=null,Ji=Xi[--Yi],Xi[Yi]=null}var ir=null,rr=null,ar=!1,sr=null,or=!1,lr=Error(s(519));function cr(t){throw mr(Pi(Error(s(418,"")),t)),lr}function ur(t){var e=t.stateNode,n=t.type,i=t.memoizedProps;switch(e[Lt]=t,e[zt]=i,n){case"dialog":Fu("cancel",e),Fu("close",e);break;case"iframe":case"object":case"embed":Fu("load",e);break;case"video":case"audio":for(n=0;n<Nu.length;n++)Fu(Nu[n],e);break;case"source":Fu("error",e);break;case"img":case"image":case"link":Fu("error",e),Fu("load",e);break;case"details":Fu("toggle",e);break;case"input":Fu("invalid",e),_e(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),he(e);break;case"select":Fu("invalid",e);break;case"textarea":Fu("invalid",e),xe(e,i.value,i.defaultValue,i.children),he(e)}"string"!==typeof(n=i.children)&&"number"!==typeof n&&"bigint"!==typeof n||e.textContent===""+n||!0===i.suppressHydrationWarning||Ku(e.textContent,n)?(null!=i.popover&&(Fu("beforetoggle",e),Fu("toggle",e)),null!=i.onScroll&&Fu("scroll",e),null!=i.onScrollEnd&&Fu("scrollend",e),null!=i.onClick&&(e.onclick=Ju),e=!0):e=!1,e||cr(t)}function hr(t){for(ir=t.return;ir;)switch(ir.tag){case 5:case 13:return void(or=!1);case 27:case 3:return void(or=!0);default:ir=ir.return}}function dr(t){if(t!==ir)return!1;if(!ar)return hr(t),ar=!0,!1;var e,n=t.tag;if((e=3!==n&&27!==n)&&((e=5===n)&&(e=!("form"!==(e=t.type)&&"button"!==e)||sh(t.type,t.memoizedProps)),e=!e),e&&rr&&cr(t),hr(t),13===n){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,n=0;t;){if(8===t.nodeType)if("/$"===(e=t.data)){if(0===n){rr=_h(t.nextSibling);break t}n--}else"$"!==e&&"$!"!==e&&"$?"!==e||n++;t=t.nextSibling}rr=null}}else 27===n?(n=rr,fh(t.type)?(t=yh,yh=null,rr=t):rr=n):rr=ir?_h(t.stateNode.nextSibling):null;return!0}function fr(){rr=ir=null,ar=!1}function pr(){var t=sr;return null!==t&&(null===vc?vc=t:vc.push.apply(vc,t),sr=null),t}function mr(t){null===sr?sr=[t]:sr.push(t)}var gr=B(null),_r=null,yr=null;function vr(t,e,n){U(gr,e._currentValue),e._currentValue=n}function br(t){t._currentValue=gr.current,j(gr)}function xr(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function wr(t,e,n,i){var r=t.child;for(null!==r&&(r.return=t);null!==r;){var a=r.dependencies;if(null!==a){var o=r.child;a=a.firstContext;t:for(;null!==a;){var l=a;a=r;for(var c=0;c<e.length;c++)if(l.context===e[c]){a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),xr(a.return,n,t),i||(o=null);break t}a=l.next}}else if(18===r.tag){if(null===(o=r.return))throw Error(s(341));o.lanes|=n,null!==(a=o.alternate)&&(a.lanes|=n),xr(o,n,t),o=null}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===t){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}}function Sr(t,e,n,i){t=null;for(var r=e,a=!1;null!==r;){if(!a)if(0!==(524288&r.flags))a=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var o=r.alternate;if(null===o)throw Error(s(387));if(null!==(o=o.memoizedProps)){var l=r.type;Yn(r.pendingProps.value,o.value)||(null!==t?t.push(l):t=[l])}}else if(r===Z.current){if(null===(o=r.alternate))throw Error(s(387));o.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==t?t.push(Xh):t=[Xh])}r=r.return}null!==t&&wr(e,t,n,i),e.flags|=262144}function Pr(t){for(t=t.firstContext;null!==t;){if(!Yn(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Mr(t){_r=t,yr=null,null!==(t=t.dependencies)&&(t.firstContext=null)}function Ar(t){return Er(_r,t)}function kr(t,e){return null===_r&&Mr(t),Er(t,e)}function Er(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},null===yr){if(null===t)throw Error(s(308));yr=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else yr=yr.next=e;return n}var Tr="undefined"!==typeof AbortController?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(e,n){t.push(n)}};this.abort=function(){e.aborted=!0,t.forEach(function(t){return t()})}},Cr=i.unstable_scheduleCallback,Ir=i.unstable_NormalPriority,Lr={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zr(){return{controller:new Tr,data:new Map,refCount:0}}function Nr(t){t.refCount--,0===t.refCount&&Cr(Ir,function(){t.controller.abort()})}var Dr=null,Rr=0,Fr=0,Or=null;function Br(){if(0===--Rr&&null!==Dr){null!==Or&&(Or.status="fulfilled");var t=Dr;Dr=null,Fr=0,Or=null;for(var e=0;e<t.length;e++)(0,t[e])()}}var jr=N.S;N.S=function(t,e){"object"===typeof e&&null!==e&&"function"===typeof e.then&&function(t,e){if(null===Dr){var n=Dr=[];Rr=0,Fr=Tu(),Or={status:"pending",value:void 0,then:function(t){n.push(t)}}}Rr++,e.then(Br,Br)}(0,e),null!==jr&&jr(t,e)};var Ur=B(null);function Gr(){var t=Ur.current;return null!==t?t:ic.pooledCache}function qr(t,e){U(Ur,null===e?Ur.current:e.pool)}function Vr(){var t=Gr();return null===t?null:{parent:Lr._currentValue,pool:t}}var Zr=Error(s(460)),Wr=Error(s(474)),Hr=Error(s(542)),Xr={then:function(){}};function Yr(t){return"fulfilled"===(t=t.status)||"rejected"===t}function Kr(){}function Jr(t,e,n){switch(void 0===(n=t[n])?t.push(e):n!==e&&(e.then(Kr,Kr),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw ta(t=e.reason),t;default:if("string"===typeof e.status)e.then(Kr,Kr);else{if(null!==(t=ic)&&100<t.shellSuspendCounter)throw Error(s(482));(t=e).status="pending",t.then(function(t){if("pending"===e.status){var n=e;n.status="fulfilled",n.value=t}},function(t){if("pending"===e.status){var n=e;n.status="rejected",n.reason=t}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw ta(t=e.reason),t}throw $r=e,Zr}}var $r=null;function Qr(){if(null===$r)throw Error(s(459));var t=$r;return $r=null,t}function ta(t){if(t===Zr||t===Hr)throw Error(s(483))}var ea=!1;function na(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ia(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function ra(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function aa(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&nc)){var r=i.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),i.pending=e,e=zi(t),Li(t,null,n),e}return Ti(t,i,e,n),zi(t)}function sa(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194048&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,kt(t,n)}}function oa(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===a?r=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?r=a=e:a=a.next=e}else r=a=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:i.shared,callbacks:i.callbacks},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var la=!1;function ca(){if(la){if(null!==Or)throw Or}}function ua(t,e,n,i){la=!1;var r=t.updateQueue;ea=!1;var a=r.firstBaseUpdate,s=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=t.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=r.baseState;for(s=0,u=c=l=null,o=a;;){var f=-536870913&o.lane,p=f!==o.lane;if(p?(ac&f)===f:(i&f)===f){0!==f&&f===Fr&&(la=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});t:{var m=t,g=o;f=e;var _=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(_,h,f);break t}h=m;break t;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(f="function"===typeof(m=g.payload)?m.call(_,h,f):m)||void 0===f)break t;h=d({},h,f);break t;case 2:ea=!0}}null!==(f=o.callback)&&(t.flags|=64,p&&(t.flags|=8192),null===(p=r.callbacks)?r.callbacks=[f]:p.push(f))}else p={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=f;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(p=o).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null===a&&(r.shared.lanes=0),fc|=s,t.lanes=s,t.memoizedState=h}}function ha(t,e){if("function"!==typeof t)throw Error(s(191,t));t.call(e)}function da(t,e){var n=t.callbacks;if(null!==n)for(t.callbacks=null,t=0;t<n.length;t++)ha(n[t],e)}var fa=B(null),pa=B(0);function ma(t,e){U(pa,t=hc),U(fa,e),hc=t|e.baseLanes}function ga(){U(pa,hc),U(fa,fa.current)}function _a(){hc=pa.current,j(fa),j(pa)}var ya=0,va=null,ba=null,xa=null,wa=!1,Sa=!1,Pa=!1,Ma=0,Aa=0,ka=null,Ea=0;function Ta(){throw Error(s(321))}function Ca(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Yn(t[n],e[n]))return!1;return!0}function Ia(t,e,n,i,r,a){return ya=a,va=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,N.H=null===t||null===t.memoizedState?Zs:Ws,Pa=!1,a=n(i,r),Pa=!1,Sa&&(a=za(e,n,i,r)),La(t),a}function La(t){N.H=Vs;var e=null!==ba&&null!==ba.next;if(ya=0,xa=ba=va=null,wa=!1,Aa=0,ka=null,e)throw Error(s(300));null===t||ko||null!==(t=t.dependencies)&&Pr(t)&&(ko=!0)}function za(t,e,n,i){va=t;var r=0;do{if(Sa&&(ka=null),Aa=0,Sa=!1,25<=r)throw Error(s(301));if(r+=1,xa=ba=null,null!=t.updateQueue){var a=t.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}N.H=Hs,a=e(n,i)}while(Sa);return a}function Na(){var t=N.H,e=t.useState()[0];return e="function"===typeof e.then?ja(e):e,t=t.useState()[0],(null!==ba?ba.memoizedState:null)!==t&&(va.flags|=1024),e}function Da(){var t=0!==Ma;return Ma=0,t}function Ra(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function Fa(t){if(wa){for(t=t.memoizedState;null!==t;){var e=t.queue;null!==e&&(e.pending=null),t=t.next}wa=!1}ya=0,xa=ba=va=null,Sa=!1,Aa=Ma=0,ka=null}function Oa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===xa?va.memoizedState=xa=t:xa=xa.next=t,xa}function Ba(){if(null===ba){var t=va.alternate;t=null!==t?t.memoizedState:null}else t=ba.next;var e=null===xa?va.memoizedState:xa.next;if(null!==e)xa=e,ba=t;else{if(null===t){if(null===va.alternate)throw Error(s(467));throw Error(s(310))}t={memoizedState:(ba=t).memoizedState,baseState:ba.baseState,baseQueue:ba.baseQueue,queue:ba.queue,next:null},null===xa?va.memoizedState=xa=t:xa=xa.next=t}return xa}function ja(t){var e=Aa;return Aa+=1,null===ka&&(ka=[]),t=Jr(ka,t,e),e=va,null===(null===xa?e.memoizedState:xa.next)&&(e=e.alternate,N.H=null===e||null===e.memoizedState?Zs:Ws),t}function Ua(t){if(null!==t&&"object"===typeof t){if("function"===typeof t.then)return ja(t);if(t.$$typeof===x)return Ar(t)}throw Error(s(438,String(t)))}function Ga(t){var e=null,n=va.updateQueue;if(null!==n&&(e=n.memoCache),null==e){var i=va.alternate;null!==i&&(null!==(i=i.updateQueue)&&(null!=(i=i.memoCache)&&(e={data:i.data.map(function(t){return t.slice()}),index:0})))}if(null==e&&(e={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=n),n.memoCache=e,void 0===(n=e.data[e.index]))for(n=e.data[e.index]=Array(t),i=0;i<t;i++)n[i]=E;return e.index++,n}function qa(t,e){return"function"===typeof e?e(t):e}function Va(t){return Za(Ba(),ba,t)}function Za(t,e,n){var i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=n;var r=t.baseQueue,a=i.pending;if(null!==a){if(null!==r){var o=r.next;r.next=a.next,a.next=o}e.baseQueue=r=a,i.pending=null}if(a=t.baseState,null===r)t.memoizedState=a;else{var l=o=null,c=null,u=e=r.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(ac&d)===d:(ya&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Fr&&(h=!0);else{if((ya&f)===f){u=u.next,f===Fr&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,o=a):c=c.next=d,va.lanes|=f,fc|=f}d=u.action,Pa&&n(a,d),a=u.hasEagerState?u.eagerState:n(a,d)}else f={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=a):c=c.next=f,va.lanes|=d,fc|=d;u=u.next}while(null!==u&&u!==e);if(null===c?o=a:c.next=l,!Yn(a,t.memoizedState)&&(ko=!0,h&&null!==(n=Or)))throw n;t.memoizedState=a,t.baseState=o,t.baseQueue=c,i.lastRenderedState=a}return null===r&&(i.lanes=0),[t.memoizedState,i.dispatch]}function Wa(t){var e=Ba(),n=e.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{a=t(a,o.action),o=o.next}while(o!==r);Yn(a,e.memoizedState)||(ko=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function Ha(t,e,n){var i=va,r=Ba(),a=ar;if(a){if(void 0===n)throw Error(s(407));n=n()}else n=e();var o=!Yn((ba||r).memoizedState,n);if(o&&(r.memoizedState=n,ko=!0),r=r.queue,gs(2048,8,Ka.bind(null,i,r,t),[t]),r.getSnapshot!==e||o||null!==xa&&1&xa.memoizedState.tag){if(i.flags|=2048,fs(9,{destroy:void 0,resource:void 0},Ya.bind(null,i,r,n,e),null),null===ic)throw Error(s(349));a||0!==(124&ya)||Xa(i,e,n)}return n}function Xa(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=va.updateQueue)?(e={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Ya(t,e,n,i){e.value=n,e.getSnapshot=i,Ja(e)&&$a(t)}function Ka(t,e,n){return n(function(){Ja(e)&&$a(t)})}function Ja(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Yn(t,n)}catch(i){return!0}}function $a(t){var e=Ii(t,2);null!==e&&Rc(e,t,2)}function Qa(t){var e=Oa();if("function"===typeof t){var n=t;if(t=n(),Pa){dt(!0);try{n()}finally{dt(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:t},e}function ts(t,e,n,i){return t.baseState=n,Za(t,ba,"function"===typeof i?i:qa)}function es(t,e,n,i,r){if(Us(t))throw Error(s(485));if(null!==(t=e.action)){var a={payload:r,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(t){a.listeners.push(t)}};null!==N.T?n(!0):a.isTransition=!1,i(a),null===(n=e.pending)?(a.next=e.pending=a,ns(e,a)):(a.next=n.next,e.pending=n.next=a)}}function ns(t,e){var n=e.action,i=e.payload,r=t.state;if(e.isTransition){var a=N.T,s={};N.T=s;try{var o=n(r,i),l=N.S;null!==l&&l(s,o),is(t,e,o)}catch(c){as(t,e,c)}finally{N.T=a}}else try{is(t,e,a=n(r,i))}catch(u){as(t,e,u)}}function is(t,e,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){rs(t,e,n)},function(n){return as(t,e,n)}):rs(t,e,n)}function rs(t,e,n){e.status="fulfilled",e.value=n,ss(e),t.state=n,null!==(e=t.pending)&&((n=e.next)===e?t.pending=null:(n=n.next,e.next=n,ns(t,n)))}function as(t,e,n){var i=t.pending;if(t.pending=null,null!==i){i=i.next;do{e.status="rejected",e.reason=n,ss(e),e=e.next}while(e!==i)}t.action=null}function ss(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function os(t,e){return e}function ls(t,e){if(ar){var n=ic.formState;if(null!==n){t:{var i=va;if(ar){if(rr){e:{for(var r=rr,a=or;8!==r.nodeType;){if(!a){r=null;break e}if(null===(r=_h(r.nextSibling))){r=null;break e}}r="F!"===(a=r.data)||"F"===a?r:null}if(r){rr=_h(r.nextSibling),i="F!"===r.data;break t}}cr(i)}i=!1}i&&(e=n[0])}}return(n=Oa()).memoizedState=n.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:e},n.queue=i,n=Os.bind(null,va,i),i.dispatch=n,i=Qa(!1),a=js.bind(null,va,!1,i.queue),r={state:e,dispatch:null,action:t,pending:null},(i=Oa()).queue=r,n=es.bind(null,va,r,a,n),r.dispatch=n,i.memoizedState=t,[e,n,!1]}function cs(t){return us(Ba(),ba,t)}function us(t,e,n){if(e=Za(t,e,os)[0],t=Va(qa)[0],"object"===typeof e&&null!==e&&"function"===typeof e.then)try{var i=ja(e)}catch(s){if(s===Zr)throw Hr;throw s}else i=e;var r=(e=Ba()).queue,a=r.dispatch;return n!==e.memoizedState&&(va.flags|=2048,fs(9,{destroy:void 0,resource:void 0},hs.bind(null,r,n),null)),[i,a,t]}function hs(t,e){t.action=e}function ds(t){var e=Ba(),n=ba;if(null!==n)return us(e,n,t);Ba(),e=e.memoizedState;var i=(n=Ba()).queue.dispatch;return n.memoizedState=t,[e,i,!1]}function fs(t,e,n,i){return t={tag:t,create:n,deps:i,inst:e,next:null},null===(e=va.updateQueue)&&(e={lastEffect:null,events:null,stores:null,memoCache:null},va.updateQueue=e),null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function ps(){return Ba().memoizedState}function ms(t,e,n,i){var r=Oa();i=void 0===i?null:i,va.flags|=t,r.memoizedState=fs(1|e,{destroy:void 0,resource:void 0},n,i)}function gs(t,e,n,i){var r=Ba();i=void 0===i?null:i;var a=r.memoizedState.inst;null!==ba&&null!==i&&Ca(i,ba.memoizedState.deps)?r.memoizedState=fs(e,a,n,i):(va.flags|=t,r.memoizedState=fs(1|e,a,n,i))}function _s(t,e){ms(8390656,8,t,e)}function ys(t,e){gs(2048,8,t,e)}function vs(t,e){return gs(4,2,t,e)}function bs(t,e){return gs(4,4,t,e)}function xs(t,e){if("function"===typeof e){t=t();var n=e(t);return function(){"function"===typeof n?n():e(null)}}if(null!==e&&void 0!==e)return t=t(),e.current=t,function(){e.current=null}}function ws(t,e,n){n=null!==n&&void 0!==n?n.concat([t]):null,gs(4,4,xs.bind(null,e,t),n)}function Ss(){}function Ps(t,e){var n=Ba();e=void 0===e?null:e;var i=n.memoizedState;return null!==e&&Ca(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Ms(t,e){var n=Ba();e=void 0===e?null:e;var i=n.memoizedState;if(null!==e&&Ca(e,i[1]))return i[0];if(i=t(),Pa){dt(!0);try{t()}finally{dt(!1)}}return n.memoizedState=[i,e],i}function As(t,e,n){return void 0===n||0!==(1073741824&ya)?t.memoizedState=e:(t.memoizedState=n,t=Dc(),va.lanes|=t,fc|=t,n)}function ks(t,e,n,i){return Yn(n,e)?n:null!==fa.current?(t=As(t,n,i),Yn(t,e)||(ko=!0),t):0===(42&ya)?(ko=!0,t.memoizedState=n):(t=Dc(),va.lanes|=t,fc|=t,e)}function Es(t,e,n,i,r){var a=D.p;D.p=0!==a&&8>a?a:8;var s=N.T,o={};N.T=o,js(t,!1,e,n);try{var l=r(),c=N.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Bs(t,e,function(t,e){var n=[],i={status:"pending",value:null,reason:null,then:function(t){n.push(t)}};return t.then(function(){i.status="fulfilled",i.value=e;for(var t=0;t<n.length;t++)(0,n[t])(e)},function(t){for(i.status="rejected",i.reason=t,t=0;t<n.length;t++)(0,n[t])(void 0)}),i}(l,i),Nc());else Bs(t,e,i,Nc())}catch(u){Bs(t,e,{then:function(){},status:"rejected",reason:u},Nc())}finally{D.p=a,N.T=s}}function Ts(){}function Cs(t,e,n,i){if(5!==t.tag)throw Error(s(476));var r=Is(t).queue;Es(t,r,e,R,null===n?Ts:function(){return Ls(t),n(i)})}function Is(t){var e=t.memoizedState;if(null!==e)return e;var n={};return(e={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:R},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:n},next:null},t.memoizedState=e,null!==(t=t.alternate)&&(t.memoizedState=e),e}function Ls(t){Bs(t,Is(t).next.queue,{},Nc())}function zs(){return Ar(Xh)}function Ns(){return Ba().memoizedState}function Ds(){return Ba().memoizedState}function Rs(t){for(var e=t.return;null!==e;){switch(e.tag){case 24:case 3:var n=Nc(),i=aa(e,t=ra(n),n);return null!==i&&(Rc(i,e,n),sa(i,e,n)),e={cache:zr()},void(t.payload=e)}e=e.return}}function Fs(t,e,n){var i=Nc();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Us(t)?Gs(e,n):null!==(n=Ci(t,e,n,i))&&(Rc(n,t,i),qs(n,e,i))}function Os(t,e,n){Bs(t,e,n,Nc())}function Bs(t,e,n,i){var r={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Us(t))Gs(e,r);else{var a=t.alternate;if(0===t.lanes&&(null===a||0===a.lanes)&&null!==(a=e.lastRenderedReducer))try{var s=e.lastRenderedState,o=a(s,n);if(r.hasEagerState=!0,r.eagerState=o,Yn(o,s))return Ti(t,e,r,0),null===ic&&Ei(),!1}catch(l){}if(null!==(n=Ci(t,e,r,i)))return Rc(n,t,i),qs(n,e,i),!0}return!1}function js(t,e,n,i){if(i={lane:2,revertLane:Tu(),action:i,hasEagerState:!1,eagerState:null,next:null},Us(t)){if(e)throw Error(s(479))}else null!==(e=Ci(t,n,i,2))&&Rc(e,t,2)}function Us(t){var e=t.alternate;return t===va||null!==e&&e===va}function Gs(t,e){Sa=wa=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function qs(t,e,n){if(0!==(4194048&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,kt(t,n)}}var Vs={readContext:Ar,use:Ua,useCallback:Ta,useContext:Ta,useEffect:Ta,useImperativeHandle:Ta,useLayoutEffect:Ta,useInsertionEffect:Ta,useMemo:Ta,useReducer:Ta,useRef:Ta,useState:Ta,useDebugValue:Ta,useDeferredValue:Ta,useTransition:Ta,useSyncExternalStore:Ta,useId:Ta,useHostTransitionStatus:Ta,useFormState:Ta,useActionState:Ta,useOptimistic:Ta,useMemoCache:Ta,useCacheRefresh:Ta},Zs={readContext:Ar,use:Ua,useCallback:function(t,e){return Oa().memoizedState=[t,void 0===e?null:e],t},useContext:Ar,useEffect:_s,useImperativeHandle:function(t,e,n){n=null!==n&&void 0!==n?n.concat([t]):null,ms(4194308,4,xs.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ms(4194308,4,t,e)},useInsertionEffect:function(t,e){ms(4,2,t,e)},useMemo:function(t,e){var n=Oa();e=void 0===e?null:e;var i=t();if(Pa){dt(!0);try{t()}finally{dt(!1)}}return n.memoizedState=[i,e],i},useReducer:function(t,e,n){var i=Oa();if(void 0!==n){var r=n(e);if(Pa){dt(!0);try{n(e)}finally{dt(!1)}}}else r=e;return i.memoizedState=i.baseState=r,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},i.queue=t,t=t.dispatch=Fs.bind(null,va,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},Oa().memoizedState=t},useState:function(t){var e=(t=Qa(t)).queue,n=Os.bind(null,va,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:Ss,useDeferredValue:function(t,e){return As(Oa(),t,e)},useTransition:function(){var t=Qa(!1);return t=Es.bind(null,va,t.queue,!0,!1),Oa().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var i=va,r=Oa();if(ar){if(void 0===n)throw Error(s(407));n=n()}else{if(n=e(),null===ic)throw Error(s(349));0!==(124&ac)||Xa(i,e,n)}r.memoizedState=n;var a={value:n,getSnapshot:e};return r.queue=a,_s(Ka.bind(null,i,a,t),[t]),i.flags|=2048,fs(9,{destroy:void 0,resource:void 0},Ya.bind(null,i,a,n,e),null),n},useId:function(){var t=Oa(),e=ic.identifierPrefix;if(ar){var n=$i;e="\xab"+e+"R"+(n=(Ji&~(1<<32-ft(Ji)-1)).toString(32)+n),0<(n=Ma++)&&(e+="H"+n.toString(32)),e+="\xbb"}else e="\xab"+e+"r"+(n=Ea++).toString(32)+"\xbb";return t.memoizedState=e},useHostTransitionStatus:zs,useFormState:ls,useActionState:ls,useOptimistic:function(t){var e=Oa();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=js.bind(null,va,!0,n),n.dispatch=e,[t,e]},useMemoCache:Ga,useCacheRefresh:function(){return Oa().memoizedState=Rs.bind(null,va)}},Ws={readContext:Ar,use:Ua,useCallback:Ps,useContext:Ar,useEffect:ys,useImperativeHandle:ws,useInsertionEffect:vs,useLayoutEffect:bs,useMemo:Ms,useReducer:Va,useRef:ps,useState:function(){return Va(qa)},useDebugValue:Ss,useDeferredValue:function(t,e){return ks(Ba(),ba.memoizedState,t,e)},useTransition:function(){var t=Va(qa)[0],e=Ba().memoizedState;return["boolean"===typeof t?t:ja(t),e]},useSyncExternalStore:Ha,useId:Ns,useHostTransitionStatus:zs,useFormState:cs,useActionState:cs,useOptimistic:function(t,e){return ts(Ba(),0,t,e)},useMemoCache:Ga,useCacheRefresh:Ds},Hs={readContext:Ar,use:Ua,useCallback:Ps,useContext:Ar,useEffect:ys,useImperativeHandle:ws,useInsertionEffect:vs,useLayoutEffect:bs,useMemo:Ms,useReducer:Wa,useRef:ps,useState:function(){return Wa(qa)},useDebugValue:Ss,useDeferredValue:function(t,e){var n=Ba();return null===ba?As(n,t,e):ks(n,ba.memoizedState,t,e)},useTransition:function(){var t=Wa(qa)[0],e=Ba().memoizedState;return["boolean"===typeof t?t:ja(t),e]},useSyncExternalStore:Ha,useId:Ns,useHostTransitionStatus:zs,useFormState:ds,useActionState:ds,useOptimistic:function(t,e){var n=Ba();return null!==ba?ts(n,0,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:Ga,useCacheRefresh:Ds},Xs=null,Ys=0;function Ks(t){var e=Ys;return Ys+=1,null===Xs&&(Xs=[]),Jr(Xs,t,e)}function Js(t,e){e=e.props.ref,t.ref=void 0!==e?e:null}function $s(t,e){if(e.$$typeof===f)throw Error(s(525));throw t=Object.prototype.toString.call(e),Error(s(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qs(t){return(0,t._init)(t._payload)}function to(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t){for(var e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(t,e){return(t=Oi(t,e)).index=0,t.sibling=null,t}function a(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=67108866,n):i:(e.flags|=67108866,n):(e.flags|=1048576,n)}function o(e){return t&&null===e.alternate&&(e.flags|=67108866),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Gi(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function c(t,e,n,i){var a=n.type;return a===g?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===A&&Qs(a)===e.type)?(Js(e=r(e,n.props),n),e.return=t,e):(Js(e=ji(n.type,n.key,n.props,null,t.mode,i),n),e.return=t,e)}function u(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=qi(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,a){return null===e||7!==e.tag?((e=Ui(n,t.mode,i,a)).return=t,e):((e=r(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e||"bigint"===typeof e)return(e=Gi(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case p:return Js(n=ji(e.type,e.key,e.props,null,t.mode,n),e),n.return=t,n;case m:return(e=qi(e,t.mode,n)).return=t,e;case A:return d(t,e=(0,e._init)(e._payload),n)}if(z(e)||C(e))return(e=Ui(e,t.mode,n,null)).return=t,e;if("function"===typeof e.then)return d(t,Ks(e),n);if(e.$$typeof===x)return d(t,kr(t,e),n);$s(t,e)}return null}function f(t,e,n,i){var r=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:l(t,e,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===r?c(t,e,n,i):null;case m:return n.key===r?u(t,e,n,i):null;case A:return f(t,e,n=(r=n._init)(n._payload),i)}if(z(n)||C(n))return null!==r?null:h(t,e,n,i,null);if("function"===typeof n.then)return f(t,e,Ks(n),i);if(n.$$typeof===x)return f(t,e,kr(t,n),i);$s(t,n)}return null}function _(t,e,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case p:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r);case m:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case A:return _(t,e,n,i=(0,i._init)(i._payload),r)}if(z(i)||C(i))return h(e,t=t.get(n)||null,i,r,null);if("function"===typeof i.then)return _(t,e,n,Ks(i),r);if(i.$$typeof===x)return _(t,e,n,kr(e,i),r);$s(e,i)}return null}function y(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:t:{for(var v=u.key;null!==c;){if(c.key===v){if((v=u.type)===g){if(7===c.tag){n(l,c.sibling),(h=r(c,u.props.children)).return=l,l=h;break t}}else if(c.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===A&&Qs(v)===c.type){n(l,c.sibling),Js(h=r(c,u.props),u),h.return=l,l=h;break t}n(l,c);break}e(l,c),c=c.sibling}u.type===g?((h=Ui(u.props.children,l.mode,h,u.key)).return=l,l=h):(Js(h=ji(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return o(l);case m:t:{for(v=u.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=r(c,u.children||[])).return=l,l=h;break t}n(l,c);break}e(l,c),c=c.sibling}(h=qi(u,l.mode,h)).return=l,l=h}return o(l);case A:return y(l,c,u=(v=u._init)(u._payload),h)}if(z(u))return function(r,s,o,l){for(var c=null,u=null,h=s,p=s=0,m=null;null!==h&&p<o.length;p++){h.index>p?(m=h,h=null):m=h.sibling;var g=f(r,h,o[p],l);if(null===g){null===h&&(h=m);break}t&&h&&null===g.alternate&&e(r,h),s=a(g,s,p),null===u?c=g:u.sibling=g,u=g,h=m}if(p===o.length)return n(r,h),ar&&Qi(r,p),c;if(null===h){for(;p<o.length;p++)null!==(h=d(r,o[p],l))&&(s=a(h,s,p),null===u?c=h:u.sibling=h,u=h);return ar&&Qi(r,p),c}for(h=i(h);p<o.length;p++)null!==(m=_(h,r,p,o[p],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?p:m.key),s=a(m,s,p),null===u?c=m:u.sibling=m,u=m);return t&&h.forEach(function(t){return e(r,t)}),ar&&Qi(r,p),c}(l,c,u,h);if(C(u)){if("function"!==typeof(v=C(u)))throw Error(s(150));return function(r,o,l,c){if(null==l)throw Error(s(151));for(var u=null,h=null,p=o,m=o=0,g=null,y=l.next();null!==p&&!y.done;m++,y=l.next()){p.index>m?(g=p,p=null):g=p.sibling;var v=f(r,p,y.value,c);if(null===v){null===p&&(p=g);break}t&&p&&null===v.alternate&&e(r,p),o=a(v,o,m),null===h?u=v:h.sibling=v,h=v,p=g}if(y.done)return n(r,p),ar&&Qi(r,m),u;if(null===p){for(;!y.done;m++,y=l.next())null!==(y=d(r,y.value,c))&&(o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return ar&&Qi(r,m),u}for(p=i(p);!y.done;m++,y=l.next())null!==(y=_(p,r,m,y.value,c))&&(t&&null!==y.alternate&&p.delete(null===y.key?m:y.key),o=a(y,o,m),null===h?u=y:h.sibling=y,h=y);return t&&p.forEach(function(t){return e(r,t)}),ar&&Qi(r,m),u}(l,c,u=v.call(u),h)}if("function"===typeof u.then)return y(l,c,Ks(u),h);if(u.$$typeof===x)return y(l,c,kr(l,u),h);$s(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=r(c,u)).return=l,l=h):(n(l,c),(h=Gi(u,l.mode,h)).return=l,l=h),o(l)):n(l,c)}return function(t,e,n,i){try{Ys=0;var r=y(t,e,n,i);return Xs=null,r}catch(s){if(s===Zr||s===Hr)throw s;var a=Ri(29,s,null,t.mode);return a.lanes=i,a.return=t,a}}}var eo=to(!0),no=to(!1),io=B(null),ro=null;function ao(t){var e=t.alternate;U(co,1&co.current),U(io,t),null===ro&&(null===e||null!==fa.current||null!==e.memoizedState)&&(ro=t)}function so(t){if(22===t.tag){if(U(co,co.current),U(io,t),null===ro){var e=t.alternate;null!==e&&null!==e.memoizedState&&(ro=t)}}else oo()}function oo(){U(co,co.current),U(io,io.current)}function lo(t){j(io),ro===t&&(ro=null),j(co)}var co=B(0);function uo(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||gh(n)))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function ho(t,e,n,i){n=null===(n=n(i,e=t.memoizedState))||void 0===n?e:d({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var fo={enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Nc(),r=ra(i);r.payload=e,void 0!==n&&null!==n&&(r.callback=n),null!==(e=aa(t,r,i))&&(Rc(e,t,i),sa(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Nc(),r=ra(i);r.tag=1,r.payload=e,void 0!==n&&null!==n&&(r.callback=n),null!==(e=aa(t,r,i))&&(Rc(e,t,i),sa(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Nc(),i=ra(n);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),null!==(e=aa(t,i,n))&&(Rc(e,t,n),sa(e,t,n))}};function po(t,e,n,i,r,a,s){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,a,s):!e.prototype||!e.prototype.isPureReactComponent||(!Kn(n,i)||!Kn(r,a))}function mo(t,e,n,i){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&fo.enqueueReplaceState(e,e.state,null)}function go(t,e){var n=e;if("ref"in e)for(var i in n={},e)"ref"!==i&&(n[i]=e[i]);if(t=t.defaultProps)for(var r in n===e&&(n=d({},n)),t)void 0===n[r]&&(n[r]=t[r]);return n}var _o="function"===typeof reportError?reportError:function(t){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof t&&null!==t&&"string"===typeof t.message?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",t);console.error(t)};function yo(t){_o(t)}function vo(t){console.error(t)}function bo(t){_o(t)}function xo(t,e){try{(0,t.onUncaughtError)(e.value,{componentStack:e.stack})}catch(n){setTimeout(function(){throw n})}}function wo(t,e,n){try{(0,t.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===e.tag?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function So(t,e,n){return(n=ra(n)).tag=3,n.payload={element:null},n.callback=function(){xo(t,e)},n}function Po(t){return(t=ra(t)).tag=3,t}function Mo(t,e,n,i){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var a=i.value;t.payload=function(){return r(a)},t.callback=function(){wo(e,n,i)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(t.callback=function(){wo(e,n,i),"function"!==typeof r&&(null===Pc?Pc=new Set([this]):Pc.add(this));var t=i.stack;this.componentDidCatch(i.value,{componentStack:null!==t?t:""})})}var Ao=Error(s(461)),ko=!1;function Eo(t,e,n,i){e.child=null===t?no(e,null,n,i):eo(e,t.child,n,i)}function To(t,e,n,i,r){n=n.render;var a=e.ref;if("ref"in i){var s={};for(var o in i)"ref"!==o&&(s[o]=i[o])}else s=i;return Mr(e),i=Ia(t,e,n,s,a,r),o=Da(),null===t||ko?(ar&&o&&er(e),e.flags|=1,Eo(t,e,i,r),e.child):(Ra(t,e,r),Yo(t,e,r))}function Co(t,e,n,i,r){if(null===t){var a=n.type;return"function"!==typeof a||Fi(a)||void 0!==a.defaultProps||null!==n.compare?((t=ji(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=a,Io(t,e,a,i,r))}if(a=t.child,!Ko(t,r)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:Kn)(s,i)&&t.ref===e.ref)return Yo(t,e,r)}return e.flags|=1,(t=Oi(a,i)).ref=e.ref,t.return=e,e.child=t}function Io(t,e,n,i,r){if(null!==t){var a=t.memoizedProps;if(Kn(a,i)&&t.ref===e.ref){if(ko=!1,e.pendingProps=i=a,!Ko(t,r))return e.lanes=t.lanes,Yo(t,e,r);0!==(131072&t.flags)&&(ko=!0)}}return Do(t,e,n,i,r)}function Lo(t,e,n){var i=e.pendingProps,r=i.children,a=null!==t?t.memoizedState:null;if("hidden"===i.mode){if(0!==(128&e.flags)){if(i=null!==a?a.baseLanes|n:n,null!==t){for(r=e.child=t.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;e.childLanes=a&~i}else e.childLanes=0,e.child=null;return zo(t,e,i,n)}if(0===(536870912&n))return e.lanes=e.childLanes=536870912,zo(t,e,null!==a?a.baseLanes|n:n,n);e.memoizedState={baseLanes:0,cachePool:null},null!==t&&qr(0,null!==a?a.cachePool:null),null!==a?ma(e,a):ga(),so(e)}else null!==a?(qr(0,a.cachePool),ma(e,a),oo(),e.memoizedState=null):(null!==t&&qr(0,null),ga(),oo());return Eo(t,e,r,n),e.child}function zo(t,e,n,i){var r=Gr();return r=null===r?null:{parent:Lr._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},null!==t&&qr(0,null),ga(),so(e),null!==t&&Sr(t,e,i,!0),null}function No(t,e){var n=e.ref;if(null===n)null!==t&&null!==t.ref&&(e.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==t&&t.ref===n||(e.flags|=4194816)}}function Do(t,e,n,i,r){return Mr(e),n=Ia(t,e,n,i,void 0,r),i=Da(),null===t||ko?(ar&&i&&er(e),e.flags|=1,Eo(t,e,n,r),e.child):(Ra(t,e,r),Yo(t,e,r))}function Ro(t,e,n,i,r,a){return Mr(e),e.updateQueue=null,n=za(e,i,n,r),La(t),i=Da(),null===t||ko?(ar&&i&&er(e),e.flags|=1,Eo(t,e,n,a),e.child):(Ra(t,e,a),Yo(t,e,a))}function Fo(t,e,n,i,r){if(Mr(e),null===e.stateNode){var a=Ni,s=n.contextType;"object"===typeof s&&null!==s&&(a=Ar(s)),a=new n(i,a),e.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=fo,e.stateNode=a,a._reactInternals=e,(a=e.stateNode).props=i,a.state=e.memoizedState,a.refs={},na(e),s=n.contextType,a.context="object"===typeof s&&null!==s?Ar(s):Ni,a.state=e.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(ho(e,n,s,i),a.state=e.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(s=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),s!==a.state&&fo.enqueueReplaceState(a,a.state,null),ua(e,i,a,r),ca(),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308),i=!0}else if(null===t){a=e.stateNode;var o=e.memoizedProps,l=go(n,o);a.props=l;var c=a.context,u=n.contextType;s=Ni,"object"===typeof u&&null!==u&&(s=Ar(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate,o=e.pendingProps!==o,u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o||c!==s)&&mo(e,a,i,s),ea=!1;var d=e.memoizedState;a.state=d,ua(e,i,a,r),ca(),c=e.memoizedState,o||d!==c||ea?("function"===typeof h&&(ho(e,n,h,i),c=e.memoizedState),(l=ea||po(e,n,l,i,d,c,s))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(e.flags|=4194308)):("function"===typeof a.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),a.props=i,a.state=c,a.context=s,i=l):("function"===typeof a.componentDidMount&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,ia(t,e),u=go(n,s=e.memoizedProps),a.props=u,h=e.pendingProps,d=a.context,c=n.contextType,l=Ni,"object"===typeof c&&null!==c&&(l=Ar(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&mo(e,a,i,l),ea=!1,d=e.memoizedState,a.state=d,ua(e,i,a,r),ca();var f=e.memoizedState;s!==h||d!==f||ea||null!==t&&null!==t.dependencies&&Pr(t.dependencies)?("function"===typeof o&&(ho(e,n,o,i),f=e.memoizedState),(u=ea||po(e,n,u,i,d,f,l)||null!==t&&null!==t.dependencies&&Pr(t.dependencies))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof a.componentDidUpdate&&(e.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),a.props=i,a.state=f,a.context=l,i=u):("function"!==typeof a.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return a=i,No(t,e),i=0!==(128&e.flags),a||i?(a=e.stateNode,n=i&&"function"!==typeof n.getDerivedStateFromError?null:a.render(),e.flags|=1,null!==t&&i?(e.child=eo(e,t.child,null,r),e.child=eo(e,null,n,r)):Eo(t,e,n,r),e.memoizedState=a.state,t=e.child):t=Yo(t,e,r),t}function Oo(t,e,n,i){return fr(),e.flags|=256,Eo(t,e,n,i),e.child}var Bo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jo(t){return{baseLanes:t,cachePool:Vr()}}function Uo(t,e,n){return t=null!==t?t.childLanes&~n:0,e&&(t|=gc),t}function Go(t,e,n){var i,r=e.pendingProps,a=!1,o=0!==(128&e.flags);if((i=o)||(i=(null===t||null!==t.memoizedState)&&0!==(2&co.current)),i&&(a=!0,e.flags&=-129),i=0!==(32&e.flags),e.flags&=-33,null===t){if(ar){if(a?ao(e):oo(),ar){var l,c=rr;if(l=c){t:{for(l=c,c=or;8!==l.nodeType;){if(!c){c=null;break t}if(null===(l=_h(l.nextSibling))){c=null;break t}}c=l}null!==c?(e.memoizedState={dehydrated:c,treeContext:null!==Ki?{id:Ji,overflow:$i}:null,retryLane:536870912,hydrationErrors:null},(l=Ri(18,null,null,0)).stateNode=c,l.return=e,e.child=l,ir=e,rr=null,l=!0):l=!1}l||cr(e)}if(null!==(c=e.memoizedState)&&null!==(c=c.dehydrated))return gh(c)?e.lanes=32:e.lanes=536870912,null;lo(e)}return c=r.children,r=r.fallback,a?(oo(),c=Vo({mode:"hidden",children:c},a=e.mode),r=Ui(r,a,n,null),c.return=e,r.return=e,c.sibling=r,e.child=c,(a=e.child).memoizedState=jo(n),a.childLanes=Uo(t,i,n),e.memoizedState=Bo,r):(ao(e),qo(e,c))}if(null!==(l=t.memoizedState)&&null!==(c=l.dehydrated)){if(o)256&e.flags?(ao(e),e.flags&=-257,e=Zo(t,e,n)):null!==e.memoizedState?(oo(),e.child=t.child,e.flags|=128,e=null):(oo(),a=r.fallback,c=e.mode,r=Vo({mode:"visible",children:r.children},c),(a=Ui(a,c,n,null)).flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,eo(e,t.child,null,n),(r=e.child).memoizedState=jo(n),r.childLanes=Uo(t,i,n),e.memoizedState=Bo,e=a);else if(ao(e),gh(c)){if(i=c.nextSibling&&c.nextSibling.dataset)var u=i.dgst;i=u,(r=Error(s(419))).stack="",r.digest=i,mr({value:r,source:null,stack:null}),e=Zo(t,e,n)}else if(ko||Sr(t,e,n,!1),i=0!==(n&t.childLanes),ko||i){if(null!==(i=ic)&&(0!==(r=0!==((r=0!==(42&(r=n&-n))?1:Et(r))&(i.suspendedLanes|n))?0:r)&&r!==l.retryLane))throw l.retryLane=r,Ii(t,r),Rc(i,t,r),Ao;"$?"===c.data||Hc(),e=Zo(t,e,n)}else"$?"===c.data?(e.flags|=192,e.child=t.child,e=null):(t=l.treeContext,rr=_h(c.nextSibling),ir=e,ar=!0,sr=null,or=!1,null!==t&&(Xi[Yi++]=Ji,Xi[Yi++]=$i,Xi[Yi++]=Ki,Ji=t.id,$i=t.overflow,Ki=e),(e=qo(e,r.children)).flags|=4096);return e}return a?(oo(),a=r.fallback,c=e.mode,u=(l=t.child).sibling,(r=Oi(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?a=Oi(u,a):(a=Ui(a,c,n,null)).flags|=2,a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,null===(c=t.child.memoizedState)?c=jo(n):(null!==(l=c.cachePool)?(u=Lr._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Vr(),c={baseLanes:c.baseLanes|n,cachePool:l}),a.memoizedState=c,a.childLanes=Uo(t,i,n),e.memoizedState=Bo,r):(ao(e),t=(n=t.child).sibling,(n=Oi(n,{mode:"visible",children:r.children})).return=e,n.sibling=null,null!==t&&(null===(i=e.deletions)?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=n,e.memoizedState=null,n)}function qo(t,e){return(e=Vo({mode:"visible",children:e},t.mode)).return=t,t.child=e}function Vo(t,e){return(t=Ri(22,t,null,e)).lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function Zo(t,e,n){return eo(e,t.child,null,n),(t=qo(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Wo(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),xr(t.return,e,n)}function Ho(t,e,n,i,r){var a=t.memoizedState;null===a?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r)}function Xo(t,e,n){var i=e.pendingProps,r=i.revealOrder,a=i.tail;if(Eo(t,e,i.children,n),0!==(2&(i=co.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Wo(t,n,e);else if(19===t.tag)Wo(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}switch(U(co,i),r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===uo(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Ho(e,!1,r,n,a);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===uo(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Ho(e,!0,n,null,a);break;case"together":Ho(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Yo(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),fc|=e.lanes,0===(n&e.childLanes)){if(null===t)return null;if(Sr(t,e,n,!1),0===(n&e.childLanes))return null}if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(n=Oi(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Oi(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Ko(t,e){return 0!==(t.lanes&e)||!(null===(t=t.dependencies)||!Pr(t))}function Jo(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps)ko=!0;else{if(!Ko(t,n)&&0===(128&e.flags))return ko=!1,function(t,e,n){switch(e.tag){case 3:W(e,e.stateNode.containerInfo),vr(0,Lr,t.memoizedState.cache),fr();break;case 27:case 5:X(e);break;case 4:W(e,e.stateNode.containerInfo);break;case 10:vr(0,e.type,e.memoizedProps.value);break;case 13:var i=e.memoizedState;if(null!==i)return null!==i.dehydrated?(ao(e),e.flags|=128,null):0!==(n&e.child.childLanes)?Go(t,e,n):(ao(e),null!==(t=Yo(t,e,n))?t.sibling:null);ao(e);break;case 19:var r=0!==(128&t.flags);if((i=0!==(n&e.childLanes))||(Sr(t,e,n,!1),i=0!==(n&e.childLanes)),r){if(i)return Xo(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),U(co,co.current),i)break;return null;case 22:case 23:return e.lanes=0,Lo(t,e,n);case 24:vr(0,Lr,t.memoizedState.cache)}return Yo(t,e,n)}(t,e,n);ko=0!==(131072&t.flags)}else ko=!1,ar&&0!==(1048576&e.flags)&&tr(e,Hi,e.index);switch(e.lanes=0,e.tag){case 16:t:{t=e.pendingProps;var i=e.elementType,r=i._init;if(i=r(i._payload),e.type=i,"function"!==typeof i){if(void 0!==i&&null!==i){if((r=i.$$typeof)===w){e.tag=11,e=To(null,e,i,t,n);break t}if(r===M){e.tag=14,e=Co(null,e,i,t,n);break t}}throw e=L(i)||i,Error(s(306,e,""))}Fi(i)?(t=go(i,t),e.tag=1,e=Fo(null,e,i,t,n)):(e.tag=0,e=Do(null,e,i,t,n))}return e;case 0:return Do(t,e,e.type,e.pendingProps,n);case 1:return Fo(t,e,i=e.type,r=go(i,e.pendingProps),n);case 3:t:{if(W(e,e.stateNode.containerInfo),null===t)throw Error(s(387));i=e.pendingProps;var a=e.memoizedState;r=a.element,ia(t,e),ua(e,i,null,n);var o=e.memoizedState;if(i=o.cache,vr(0,Lr,i),i!==a.cache&&wr(e,[Lr],n,!0),ca(),i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache},e.updateQueue.baseState=a,e.memoizedState=a,256&e.flags){e=Oo(t,e,i,n);break t}if(i!==r){mr(r=Pi(Error(s(424)),e)),e=Oo(t,e,i,n);break t}if(9===(t=e.stateNode.containerInfo).nodeType)t=t.body;else t="HTML"===t.nodeName?t.ownerDocument.body:t;for(rr=_h(t.firstChild),ir=e,ar=!0,sr=null,or=!0,n=no(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fr(),i===r){e=Yo(t,e,n);break t}Eo(t,e,i,n)}e=e.child}return e;case 26:return No(t,e),null===t?(n=Eh(e.type,null,e.pendingProps,null))?e.memoizedState=n:ar||(n=e.type,t=e.pendingProps,(i=ih(V.current).createElement(n))[Lt]=e,i[zt]=t,th(i,n,t),Zt(i),e.stateNode=i):e.memoizedState=Eh(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return X(e),null===t&&ar&&(i=e.stateNode=bh(e.type,e.pendingProps,V.current),ir=e,or=!0,r=rr,fh(e.type)?(yh=r,rr=_h(i.firstChild)):rr=r),Eo(t,e,e.pendingProps.children,n),No(t,e),null===t&&(e.flags|=4194304),e.child;case 5:return null===t&&ar&&((r=i=rr)&&(null!==(i=function(t,e,n,i){for(;1===t.nodeType;){var r=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&("INPUT"!==t.nodeName||"hidden"!==t.type))break}else if(i){if(!t[Bt])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if("stylesheet"===(a=t.getAttribute("rel"))&&t.hasAttribute("data-precedence"))break;if(a!==r.rel||t.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||t.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||t.getAttribute("title")!==(null==r.title?null:r.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(((a=t.getAttribute("src"))!==(null==r.src?null:r.src)||t.getAttribute("type")!==(null==r.type?null:r.type)||t.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&a&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else{if("input"!==e||"hidden"!==t.type)return t;var a=null==r.name?null:""+r.name;if("hidden"===r.type&&t.getAttribute("name")===a)return t}if(null===(t=_h(t.nextSibling)))break}return null}(i,e.type,e.pendingProps,or))?(e.stateNode=i,ir=e,rr=_h(i.firstChild),or=!1,r=!0):r=!1),r||cr(e)),X(e),r=e.type,a=e.pendingProps,o=null!==t?t.memoizedProps:null,i=a.children,sh(r,a)?i=null:null!==o&&sh(r,o)&&(e.flags|=32),null!==e.memoizedState&&(r=Ia(t,e,Na,null,null,n),Xh._currentValue=r),No(t,e),Eo(t,e,i,n),e.child;case 6:return null===t&&ar&&((t=n=rr)&&(null!==(n=function(t,e,n){if(""===e)return null;for(;3!==t.nodeType;){if((1!==t.nodeType||"INPUT"!==t.nodeName||"hidden"!==t.type)&&!n)return null;if(null===(t=_h(t.nextSibling)))return null}return t}(n,e.pendingProps,or))?(e.stateNode=n,ir=e,rr=null,t=!0):t=!1),t||cr(e)),null;case 13:return Go(t,e,n);case 4:return W(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=eo(e,null,i,n):Eo(t,e,i,n),e.child;case 11:return To(t,e,e.type,e.pendingProps,n);case 7:return Eo(t,e,e.pendingProps,n),e.child;case 8:case 12:return Eo(t,e,e.pendingProps.children,n),e.child;case 10:return i=e.pendingProps,vr(0,e.type,i.value),Eo(t,e,i.children,n),e.child;case 9:return r=e.type._context,i=e.pendingProps.children,Mr(e),i=i(r=Ar(r)),e.flags|=1,Eo(t,e,i,n),e.child;case 14:return Co(t,e,e.type,e.pendingProps,n);case 15:return Io(t,e,e.type,e.pendingProps,n);case 19:return Xo(t,e,n);case 31:return i=e.pendingProps,n=e.mode,i={mode:i.mode,children:i.children},null===t?((n=Vo(i,n)).ref=e.ref,e.child=n,n.return=e,e=n):((n=Oi(t.child,i)).ref=e.ref,e.child=n,n.return=e,e=n),e;case 22:return Lo(t,e,n);case 24:return Mr(e),i=Ar(Lr),null===t?(null===(r=Gr())&&(r=ic,a=zr(),r.pooledCache=a,a.refCount++,null!==a&&(r.pooledCacheLanes|=n),r=a),e.memoizedState={parent:i,cache:r},na(e),vr(0,Lr,r)):(0!==(t.lanes&n)&&(ia(t,e),ua(e,null,null,n),ca()),r=t.memoizedState,a=e.memoizedState,r.parent!==i?(r={parent:i,cache:i},e.memoizedState=r,0===e.lanes&&(e.memoizedState=e.updateQueue.baseState=r),vr(0,Lr,i)):(i=a.cache,vr(0,Lr,i),i!==r.cache&&wr(e,[Lr],n,!0))),Eo(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(s(156,e.tag))}function $o(t){t.flags|=4}function Qo(t,e){if("stylesheet"!==e.type||0!==(4&e.state.loading))t.flags&=-16777217;else if(t.flags|=16777216,!Uh(e)){if(null!==(e=io.current)&&((4194048&ac)===ac?null!==ro:(62914560&ac)!==ac&&0===(536870912&ac)||e!==ro))throw $r=Xr,Wr;t.flags|=8192}}function tl(t,e){null!==e&&(t.flags|=4),16384&t.flags&&(e=22!==t.tag?St():536870912,t.lanes|=e,_c|=e)}function el(t,e){if(!ar)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function nl(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=65011712&r.subtreeFlags,i|=65011712&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function il(t,e,n){var i=e.pendingProps;switch(nr(e),e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(e),null;case 3:return n=e.stateNode,i=null,null!==t&&(i=t.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),br(Lr),H(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||(dr(e)?$o(e):null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,pr())),nl(e),null;case 26:return n=e.memoizedState,null===t?($o(e),null!==n?(nl(e),Qo(e,n)):(nl(e),e.flags&=-16777217)):n?n!==t.memoizedState?($o(e),nl(e),Qo(e,n)):(nl(e),e.flags&=-16777217):(t.memoizedProps!==i&&$o(e),nl(e),e.flags&=-16777217),null;case 27:Y(e),n=V.current;var r=e.type;if(null!==t&&null!=e.stateNode)t.memoizedProps!==i&&$o(e);else{if(!i){if(null===e.stateNode)throw Error(s(166));return nl(e),null}t=G.current,dr(e)?ur(e):(t=bh(r,i,n),e.stateNode=t,$o(e))}return nl(e),null;case 5:if(Y(e),n=e.type,null!==t&&null!=e.stateNode)t.memoizedProps!==i&&$o(e);else{if(!i){if(null===e.stateNode)throw Error(s(166));return nl(e),null}if(t=G.current,dr(e))ur(e);else{switch(r=ih(V.current),t){case 1:t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(t=r.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t="string"===typeof i.is?r.createElement("select",{is:i.is}):r.createElement("select"),i.multiple?t.multiple=!0:i.size&&(t.size=i.size);break;default:t="string"===typeof i.is?r.createElement(n,{is:i.is}):r.createElement(n)}}t[Lt]=e,t[zt]=i;t:for(r=e.child;null!==r;){if(5===r.tag||6===r.tag)t.appendChild(r.stateNode);else if(4!==r.tag&&27!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break t;for(;null===r.sibling;){if(null===r.return||r.return===e)break t;r=r.return}r.sibling.return=r.return,r=r.sibling}e.stateNode=t;t:switch(th(t,n,i),n){case"button":case"input":case"select":case"textarea":t=!!i.autoFocus;break t;case"img":t=!0;break t;default:t=!1}t&&$o(e)}}return nl(e),e.flags&=-16777217,null;case 6:if(t&&null!=e.stateNode)t.memoizedProps!==i&&$o(e);else{if("string"!==typeof i&&null===e.stateNode)throw Error(s(166));if(t=V.current,dr(e)){if(t=e.stateNode,n=e.memoizedProps,i=null,null!==(r=ir))switch(r.tag){case 27:case 5:i=r.memoizedProps}t[Lt]=e,(t=!!(t.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||Ku(t.nodeValue,n)))||cr(e)}else(t=ih(t).createTextNode(i))[Lt]=e,e.stateNode=t}return nl(e),null;case 13:if(i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(r=dr(e),null!==i&&null!==i.dehydrated){if(null===t){if(!r)throw Error(s(318));if(!(r=null!==(r=e.memoizedState)?r.dehydrated:null))throw Error(s(317));r[Lt]=e}else fr(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;nl(e),r=!1}else r=pr(),null!==t&&null!==t.memoizedState&&(t.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&e.flags?(lo(e),e):(lo(e),null)}if(lo(e),0!==(128&e.flags))return e.lanes=n,e;if(n=null!==i,t=null!==t&&null!==t.memoizedState,n){r=null,null!==(i=e.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(r=i.alternate.memoizedState.cachePool.pool);var a=null;null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(a=i.memoizedState.cachePool.pool),a!==r&&(i.flags|=2048)}return n!==t&&n&&(e.child.flags|=8192),tl(e,e.updateQueue),nl(e),null;case 4:return H(),null===t&&ju(e.stateNode.containerInfo),nl(e),null;case 10:return br(e.type),nl(e),null;case 19:if(j(co),null===(r=e.memoizedState))return nl(e),null;if(i=0!==(128&e.flags),null===(a=r.rendering))if(i)el(r,!1);else{if(0!==dc||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(a=uo(t))){for(e.flags|=128,el(r,!1),t=a.updateQueue,e.updateQueue=t,tl(e,t),e.subtreeFlags=0,t=n,n=e.child;null!==n;)Bi(n,t),n=n.sibling;return U(co,1&co.current|2),e.child}t=t.sibling}null!==r.tail&&et()>wc&&(e.flags|=128,i=!0,el(r,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=uo(a))){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,tl(e,t),el(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate&&!ar)return nl(e),null}else 2*et()-r.renderingStartTime>wc&&536870912!==n&&(e.flags|=128,i=!0,el(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(null!==(t=r.last)?t.sibling=a:e.child=a,r.last=a)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=et(),e.sibling=null,t=co.current,U(co,i?1&t|2:1&t),e):(nl(e),null);case 22:case 23:return lo(e),_a(),i=null!==e.memoizedState,null!==t?null!==t.memoizedState!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?0!==(536870912&n)&&0===(128&e.flags)&&(nl(e),6&e.subtreeFlags&&(e.flags|=8192)):nl(e),null!==(n=e.updateQueue)&&tl(e,n.retryQueue),n=null,null!==t&&null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),i=null,null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(i=e.memoizedState.cachePool.pool),i!==n&&(e.flags|=2048),null!==t&&j(Ur),null;case 24:return n=null,null!==t&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),br(Lr),nl(e),null;case 25:case 30:return null}throw Error(s(156,e.tag))}function rl(t,e){switch(nr(e),e.tag){case 1:return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return br(Lr),H(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 26:case 27:case 5:return Y(e),null;case 13:if(lo(e),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(s(340));fr()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return j(co),null;case 4:return H(),null;case 10:return br(e.type),null;case 22:case 23:return lo(e),_a(),null!==t&&j(Ur),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 24:return br(Lr),null;default:return null}}function al(t,e){switch(nr(e),e.tag){case 3:br(Lr),H();break;case 26:case 27:case 5:Y(e);break;case 4:H();break;case 13:lo(e);break;case 19:j(co);break;case 10:br(e.type);break;case 22:case 23:lo(e),_a(),null!==t&&j(Ur);break;case 24:br(Lr)}}function sl(t,e){try{var n=e.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next;n=r;do{if((n.tag&t)===t){i=void 0;var a=n.create,s=n.inst;i=a(),s.destroy=i}n=n.next}while(n!==r)}}catch(o){uu(e,e.return,o)}}function ol(t,e,n){try{var i=e.updateQueue,r=null!==i?i.lastEffect:null;if(null!==r){var a=r.next;i=a;do{if((i.tag&t)===t){var s=i.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,r=e;var l=n,c=o;try{c()}catch(u){uu(r,l,u)}}}i=i.next}while(i!==a)}}catch(u){uu(e,e.return,u)}}function ll(t){var e=t.updateQueue;if(null!==e){var n=t.stateNode;try{da(e,n)}catch(i){uu(t,t.return,i)}}}function cl(t,e,n){n.props=go(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(i){uu(t,e,i)}}function ul(t,e){try{var n=t.ref;if(null!==n){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;default:i=t.stateNode}"function"===typeof n?t.refCleanup=n(i):n.current=i}}catch(r){uu(t,e,r)}}function hl(t,e){var n=t.ref,i=t.refCleanup;if(null!==n)if("function"===typeof i)try{i()}catch(r){uu(t,e,r)}finally{t.refCleanup=null,null!=(t=t.alternate)&&(t.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(a){uu(t,e,a)}else n.current=null}function dl(t){var e=t.type,n=t.memoizedProps,i=t.stateNode;try{t:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break t;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){uu(t,t.return,r)}}function fl(t,e,n){try{var i=t.stateNode;!function(t,e,n,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,a=null,o=null,l=null,c=null,u=null,h=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:i.hasOwnProperty(p)||$u(t,e,p,null,i,d)}}for(var f in i){var p=i[f];if(d=n[f],i.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":a=p;break;case"name":r=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,e));break;default:p!==d&&$u(t,e,f,p,i,d)}}return void ge(t,o,l,c,u,h,a,r);case"select":for(a in p=o=l=f=null,n)if(c=n[a],n.hasOwnProperty(a)&&null!=c)switch(a){case"value":break;case"multiple":p=c;default:i.hasOwnProperty(a)||$u(t,e,a,null,i,c)}for(r in i)if(a=i[r],c=n[r],i.hasOwnProperty(r)&&(null!=a||null!=c))switch(r){case"value":f=a;break;case"defaultValue":l=a;break;case"multiple":o=a;default:a!==c&&$u(t,e,r,a,i,c)}return e=l,n=o,i=p,void(null!=f?ve(t,!!n,f,!1):!!i!==!!n&&(null!=e?ve(t,!!n,e,!0):ve(t,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(r=n[l],n.hasOwnProperty(l)&&null!=r&&!i.hasOwnProperty(l))switch(l){case"value":case"children":break;default:$u(t,e,l,null,i,r)}for(o in i)if(r=i[o],a=n[o],i.hasOwnProperty(o)&&(null!=r||null!=a))switch(o){case"value":f=r;break;case"defaultValue":p=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(s(91));break;default:r!==a&&$u(t,e,o,r,i,a)}return void be(t,f,p);case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&null!=f&&!i.hasOwnProperty(m))if("selected"===m)t.selected=!1;else $u(t,e,m,null,i,f);for(c in i)if(f=i[c],p=n[c],i.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)t.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else $u(t,e,c,f,i,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&null!=f&&!i.hasOwnProperty(g)&&$u(t,e,g,null,i,f);for(u in i)if(f=i[u],p=n[u],i.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,e));break;default:$u(t,e,u,f,i,p)}return;default:if(Ae(e)){for(var _ in n)f=n[_],n.hasOwnProperty(_)&&void 0!==f&&!i.hasOwnProperty(_)&&Qu(t,e,_,void 0,i,f);for(h in i)f=i[h],p=n[h],!i.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||Qu(t,e,h,f,i,p);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!i.hasOwnProperty(y)&&$u(t,e,y,null,i,f);for(d in i)f=i[d],p=n[d],!i.hasOwnProperty(d)||f===p||null==f&&null==p||$u(t,e,d,f,i,p)}(i,t.type,n,e),i[zt]=e}catch(r){uu(t,t.return,r)}}function pl(t){return 5===t.tag||3===t.tag||26===t.tag||27===t.tag&&fh(t.type)||4===t.tag}function ml(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||pl(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(27===t.tag&&fh(t.type))continue t;if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function gl(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(t,e):((e=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Ju));else if(4!==i&&(27===i&&fh(t.type)&&(n=t.stateNode,e=null),null!==(t=t.child)))for(gl(t,e,n),t=t.sibling;null!==t;)gl(t,e,n),t=t.sibling}function _l(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&(27===i&&fh(t.type)&&(n=t.stateNode),null!==(t=t.child)))for(_l(t,e,n),t=t.sibling;null!==t;)_l(t,e,n),t=t.sibling}function yl(t){var e=t.stateNode,n=t.memoizedProps;try{for(var i=t.type,r=e.attributes;r.length;)e.removeAttributeNode(r[0]);th(e,i,n),e[Lt]=t,e[zt]=n}catch(a){uu(t,t.return,a)}}var vl=!1,bl=!1,xl=!1,wl="function"===typeof WeakSet?WeakSet:Set,Sl=null;function Pl(t,e,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Fl(t,n),4&i&&sl(5,n);break;case 1:if(Fl(t,n),4&i)if(t=n.stateNode,null===e)try{t.componentDidMount()}catch(s){uu(n,n.return,s)}else{var r=go(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(r,e,t.__reactInternalSnapshotBeforeUpdate)}catch(o){uu(n,n.return,o)}}64&i&&ll(n),512&i&&ul(n,n.return);break;case 3:if(Fl(t,n),64&i&&null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:e=n.child.stateNode}try{da(t,e)}catch(s){uu(n,n.return,s)}}break;case 27:null===e&&4&i&&yl(n);case 26:case 5:Fl(t,n),null===e&&4&i&&dl(n),512&i&&ul(n,n.return);break;case 12:Fl(t,n);break;case 13:Fl(t,n),4&i&&Cl(t,n),64&i&&(null!==(t=n.memoizedState)&&(null!==(t=t.dehydrated)&&function(t,e){var n=t.ownerDocument;if("$?"!==t.data||"complete"===n.readyState)e();else{var i=function(){e(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}(t,n=pu.bind(null,n))));break;case 22:if(!(i=null!==n.memoizedState||vl)){e=null!==e&&null!==e.memoizedState||bl,r=vl;var a=bl;vl=i,(bl=e)&&!a?Bl(t,n,0!==(8772&n.subtreeFlags)):Fl(t,n),vl=r,bl=a}break;case 30:break;default:Fl(t,n)}}function Ml(t){var e=t.alternate;null!==e&&(t.alternate=null,Ml(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&jt(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Al=null,kl=!1;function El(t,e,n){for(n=n.child;null!==n;)Tl(t,e,n),n=n.sibling}function Tl(t,e,n){if(ht&&"function"===typeof ht.onCommitFiberUnmount)try{ht.onCommitFiberUnmount(ut,n)}catch(a){}switch(n.tag){case 26:bl||hl(n,e),El(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:bl||hl(n,e);var i=Al,r=kl;fh(n.type)&&(Al=n.stateNode,kl=!1),El(t,e,n),xh(n.stateNode),Al=i,kl=r;break;case 5:bl||hl(n,e);case 6:if(i=Al,r=kl,Al=null,El(t,e,n),kl=r,null!==(Al=i))if(kl)try{(9===Al.nodeType?Al.body:"HTML"===Al.nodeName?Al.ownerDocument.body:Al).removeChild(n.stateNode)}catch(s){uu(n,e,s)}else try{Al.removeChild(n.stateNode)}catch(s){uu(n,e,s)}break;case 18:null!==Al&&(kl?(ph(9===(t=Al).nodeType?t.body:"HTML"===t.nodeName?t.ownerDocument.body:t,n.stateNode),kd(t)):ph(Al,n.stateNode));break;case 4:i=Al,r=kl,Al=n.stateNode.containerInfo,kl=!0,El(t,e,n),Al=i,kl=r;break;case 0:case 11:case 14:case 15:bl||ol(2,n,e),bl||ol(4,n,e),El(t,e,n);break;case 1:bl||(hl(n,e),"function"===typeof(i=n.stateNode).componentWillUnmount&&cl(n,e,i)),El(t,e,n);break;case 21:El(t,e,n);break;case 22:bl=(i=bl)||null!==n.memoizedState,El(t,e,n),bl=i;break;default:El(t,e,n)}}function Cl(t,e){if(null===e.memoizedState&&(null!==(t=e.alternate)&&(null!==(t=t.memoizedState)&&null!==(t=t.dehydrated))))try{kd(t)}catch(n){uu(e,e.return,n)}}function Il(t,e){var n=function(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return null===e&&(e=t.stateNode=new wl),e;case 22:return null===(e=(t=t.stateNode)._retryCache)&&(e=t._retryCache=new wl),e;default:throw Error(s(435,t.tag))}}(t);e.forEach(function(e){var i=mu.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))})}function Ll(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i],a=t,o=e,l=o;t:for(;null!==l;){switch(l.tag){case 27:if(fh(l.type)){Al=l.stateNode,kl=!1;break t}break;case 5:Al=l.stateNode,kl=!1;break t;case 3:case 4:Al=l.stateNode.containerInfo,kl=!0;break t}l=l.return}if(null===Al)throw Error(s(160));Tl(a,o,r),Al=null,kl=!1,null!==(a=r.alternate)&&(a.return=null),r.return=null}if(13878&e.subtreeFlags)for(e=e.child;null!==e;)Nl(e,t),e=e.sibling}var zl=null;function Nl(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Ll(e,t),Dl(t),4&i&&(ol(3,t,t.return),sl(3,t),ol(5,t,t.return));break;case 1:Ll(e,t),Dl(t),512&i&&(bl||null===n||hl(n,n.return)),64&i&&vl&&(null!==(t=t.updateQueue)&&(null!==(i=t.callbacks)&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=null===n?i:n.concat(i))));break;case 26:var r=zl;if(Ll(e,t),Dl(t),512&i&&(bl||null===n||hl(n,n.return)),4&i){var a=null!==n?n.memoizedState:null;if(i=t.memoizedState,null===n)if(null===i)if(null===t.stateNode){t:{i=t.type,n=t.memoizedProps,r=r.ownerDocument||r;e:switch(i){case"title":(!(a=r.getElementsByTagName("title")[0])||a[Bt]||a[Lt]||"http://www.w3.org/2000/svg"===a.namespaceURI||a.hasAttribute("itemprop"))&&(a=r.createElement(i),r.head.insertBefore(a,r.querySelector("head > title"))),th(a,i,n),a[Lt]=t,Zt(a),i=a;break t;case"link":var o=Bh("link","href",r).get(i+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((a=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&a.getAttribute("rel")===(null==n.rel?null:n.rel)&&a.getAttribute("title")===(null==n.title?null:n.title)&&a.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break e}th(a=r.createElement(i),i,n),r.head.appendChild(a);break;case"meta":if(o=Bh("meta","content",r).get(i+(n.content||"")))for(l=0;l<o.length;l++)if((a=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&a.getAttribute("name")===(null==n.name?null:n.name)&&a.getAttribute("property")===(null==n.property?null:n.property)&&a.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&a.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break e}th(a=r.createElement(i),i,n),r.head.appendChild(a);break;default:throw Error(s(468,i))}a[Lt]=t,Zt(a),i=a}t.stateNode=i}else jh(r,t.type,t.stateNode);else t.stateNode=Nh(r,i,t.memoizedProps);else a!==i?(null===a?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):a.count--,null===i?jh(r,t.type,t.stateNode):Nh(r,i,t.memoizedProps)):null===i&&null!==t.stateNode&&fl(t,t.memoizedProps,n.memoizedProps)}break;case 27:Ll(e,t),Dl(t),512&i&&(bl||null===n||hl(n,n.return)),null!==n&&4&i&&fl(t,t.memoizedProps,n.memoizedProps);break;case 5:if(Ll(e,t),Dl(t),512&i&&(bl||null===n||hl(n,n.return)),32&t.flags){r=t.stateNode;try{we(r,"")}catch(p){uu(t,t.return,p)}}4&i&&null!=t.stateNode&&fl(t,r=t.memoizedProps,null!==n?n.memoizedProps:r),1024&i&&(xl=!0);break;case 6:if(Ll(e,t),Dl(t),4&i){if(null===t.stateNode)throw Error(s(162));i=t.memoizedProps,n=t.stateNode;try{n.nodeValue=i}catch(p){uu(t,t.return,p)}}break;case 3:if(Oh=null,r=zl,zl=Ph(e.containerInfo),Ll(e,t),zl=r,Dl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{kd(e.containerInfo)}catch(p){uu(t,t.return,p)}xl&&(xl=!1,Rl(t));break;case 4:i=zl,zl=Ph(t.stateNode.containerInfo),Ll(e,t),Dl(t),zl=i;break;case 12:default:Ll(e,t),Dl(t);break;case 13:Ll(e,t),Dl(t),8192&t.child.flags&&null!==t.memoizedState!==(null!==n&&null!==n.memoizedState)&&(xc=et()),4&i&&(null!==(i=t.updateQueue)&&(t.updateQueue=null,Il(t,i)));break;case 22:r=null!==t.memoizedState;var c=null!==n&&null!==n.memoizedState,u=vl,h=bl;if(vl=u||r,bl=h||c,Ll(e,t),bl=h,vl=u,Dl(t),8192&i)t:for(e=t.stateNode,e._visibility=r?-2&e._visibility:1|e._visibility,r&&(null===n||c||vl||bl||Ol(t)),n=null,e=t;;){if(5===e.tag||26===e.tag){if(null===n){c=n=e;try{if(a=c.stateNode,r)"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,f=void 0!==d&&null!==d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){uu(c,c.return,p)}}}else if(6===e.tag){if(null===n){c=e;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(p){uu(c,c.return,p)}}}else if((22!==e.tag&&23!==e.tag||null===e.memoizedState||e===t)&&null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;null===e.sibling;){if(null===e.return||e.return===t)break t;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}4&i&&(null!==(i=t.updateQueue)&&(null!==(n=i.retryQueue)&&(i.retryQueue=null,Il(t,n))));break;case 19:Ll(e,t),Dl(t),4&i&&(null!==(i=t.updateQueue)&&(t.updateQueue=null,Il(t,i)));case 30:case 21:}}function Dl(t){var e=t.flags;if(2&e){try{for(var n,i=t.return;null!==i;){if(pl(i)){n=i;break}i=i.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var r=n.stateNode;_l(t,ml(t),r);break;case 5:var a=n.stateNode;32&n.flags&&(we(a,""),n.flags&=-33),_l(t,ml(t),a);break;case 3:case 4:var o=n.stateNode.containerInfo;gl(t,ml(t),o);break;default:throw Error(s(161))}}catch(l){uu(t,t.return,l)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function Rl(t){if(1024&t.subtreeFlags)for(t=t.child;null!==t;){var e=t;Rl(e),5===e.tag&&1024&e.flags&&e.stateNode.reset(),t=t.sibling}}function Fl(t,e){if(8772&e.subtreeFlags)for(e=e.child;null!==e;)Pl(t,e.alternate,e),e=e.sibling}function Ol(t){for(t=t.child;null!==t;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:ol(4,e,e.return),Ol(e);break;case 1:hl(e,e.return);var n=e.stateNode;"function"===typeof n.componentWillUnmount&&cl(e,e.return,n),Ol(e);break;case 27:xh(e.stateNode);case 26:case 5:hl(e,e.return),Ol(e);break;case 22:null===e.memoizedState&&Ol(e);break;default:Ol(e)}t=t.sibling}}function Bl(t,e,n){for(n=n&&0!==(8772&e.subtreeFlags),e=e.child;null!==e;){var i=e.alternate,r=t,a=e,s=a.flags;switch(a.tag){case 0:case 11:case 15:Bl(r,a,n),sl(4,a);break;case 1:if(Bl(r,a,n),"function"===typeof(r=(i=a).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){uu(i,i.return,c)}if(null!==(r=(i=a).updateQueue)){var o=i.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)ha(l[r],o)}catch(c){uu(i,i.return,c)}}n&&64&s&&ll(a),ul(a,a.return);break;case 27:yl(a);case 26:case 5:Bl(r,a,n),n&&null===i&&4&s&&dl(a),ul(a,a.return);break;case 12:Bl(r,a,n);break;case 13:Bl(r,a,n),n&&4&s&&Cl(r,a);break;case 22:null===a.memoizedState&&Bl(r,a,n),ul(a,a.return);break;case 30:break;default:Bl(r,a,n)}e=e.sibling}}function jl(t,e){var n=null;null!==t&&null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),t=null,null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(t=e.memoizedState.cachePool.pool),t!==n&&(null!=t&&t.refCount++,null!=n&&Nr(n))}function Ul(t,e){t=null,null!==e.alternate&&(t=e.alternate.memoizedState.cache),(e=e.memoizedState.cache)!==t&&(e.refCount++,null!=t&&Nr(t))}function Gl(t,e,n,i){if(10256&e.subtreeFlags)for(e=e.child;null!==e;)ql(t,e,n,i),e=e.sibling}function ql(t,e,n,i){var r=e.flags;switch(e.tag){case 0:case 11:case 15:Gl(t,e,n,i),2048&r&&sl(9,e);break;case 1:case 13:default:Gl(t,e,n,i);break;case 3:Gl(t,e,n,i),2048&r&&(t=null,null!==e.alternate&&(t=e.alternate.memoizedState.cache),(e=e.memoizedState.cache)!==t&&(e.refCount++,null!=t&&Nr(t)));break;case 12:if(2048&r){Gl(t,e,n,i),t=e.stateNode;try{var a=e.memoizedProps,s=a.id,o=a.onPostCommit;"function"===typeof o&&o(s,null===e.alternate?"mount":"update",t.passiveEffectDuration,-0)}catch(l){uu(e,e.return,l)}}else Gl(t,e,n,i);break;case 23:break;case 22:a=e.stateNode,s=e.alternate,null!==e.memoizedState?2&a._visibility?Gl(t,e,n,i):Zl(t,e):2&a._visibility?Gl(t,e,n,i):(a._visibility|=2,Vl(t,e,n,i,0!==(10256&e.subtreeFlags))),2048&r&&jl(s,e);break;case 24:Gl(t,e,n,i),2048&r&&Ul(e.alternate,e)}}function Vl(t,e,n,i,r){for(r=r&&0!==(10256&e.subtreeFlags),e=e.child;null!==e;){var a=t,s=e,o=n,l=i,c=s.flags;switch(s.tag){case 0:case 11:case 15:Vl(a,s,o,l,r),sl(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?Vl(a,s,o,l,r):Zl(a,s):(u._visibility|=2,Vl(a,s,o,l,r)),r&&2048&c&&jl(s.alternate,s);break;case 24:Vl(a,s,o,l,r),r&&2048&c&&Ul(s.alternate,s);break;default:Vl(a,s,o,l,r)}e=e.sibling}}function Zl(t,e){if(10256&e.subtreeFlags)for(e=e.child;null!==e;){var n=t,i=e,r=i.flags;switch(i.tag){case 22:Zl(n,i),2048&r&&jl(i.alternate,i);break;case 24:Zl(n,i),2048&r&&Ul(i.alternate,i);break;default:Zl(n,i)}e=e.sibling}}var Wl=8192;function Hl(t){if(t.subtreeFlags&Wl)for(t=t.child;null!==t;)Xl(t),t=t.sibling}function Xl(t){switch(t.tag){case 26:Hl(t),t.flags&Wl&&null!==t.memoizedState&&function(t,e,n){if(null===Gh)throw Error(s(475));var i=Gh;if("stylesheet"===e.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&e.state.loading)){if(null===e.instance){var r=Th(n.href),a=t.querySelector(Ch(r));if(a)return null!==(t=a._p)&&"object"===typeof t&&"function"===typeof t.then&&(i.count++,i=Vh.bind(i),t.then(i,i)),e.state.loading|=4,e.instance=a,void Zt(a);a=t.ownerDocument||t,n=Ih(n),(r=wh.get(r))&&Rh(n,r),Zt(a=a.createElement("link"));var o=a;o._p=new Promise(function(t,e){o.onload=t,o.onerror=e}),th(a,"link",n),e.instance=a}null===i.stylesheets&&(i.stylesheets=new Map),i.stylesheets.set(e,t),(t=e.state.preload)&&0===(3&e.state.loading)&&(i.count++,e=Vh.bind(i),t.addEventListener("load",e),t.addEventListener("error",e))}}(zl,t.memoizedState,t.memoizedProps);break;case 5:default:Hl(t);break;case 3:case 4:var e=zl;zl=Ph(t.stateNode.containerInfo),Hl(t),zl=e;break;case 22:null===t.memoizedState&&(null!==(e=t.alternate)&&null!==e.memoizedState?(e=Wl,Wl=16777216,Hl(t),Wl=e):Hl(t))}}function Yl(t){var e=t.alternate;if(null!==e&&null!==(t=e.child)){e.child=null;do{e=t.sibling,t.sibling=null,t=e}while(null!==t)}}function Kl(t){var e=t.deletions;if(0!==(16&t.flags)){if(null!==e)for(var n=0;n<e.length;n++){var i=e[n];Sl=i,Ql(i,t)}Yl(t)}if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Jl(t),t=t.sibling}function Jl(t){switch(t.tag){case 0:case 11:case 15:Kl(t),2048&t.flags&&ol(9,t,t.return);break;case 3:case 12:default:Kl(t);break;case 22:var e=t.stateNode;null!==t.memoizedState&&2&e._visibility&&(null===t.return||13!==t.return.tag)?(e._visibility&=-3,$l(t)):Kl(t)}}function $l(t){var e=t.deletions;if(0!==(16&t.flags)){if(null!==e)for(var n=0;n<e.length;n++){var i=e[n];Sl=i,Ql(i,t)}Yl(t)}for(t=t.child;null!==t;){switch((e=t).tag){case 0:case 11:case 15:ol(8,e,e.return),$l(e);break;case 22:2&(n=e.stateNode)._visibility&&(n._visibility&=-3,$l(e));break;default:$l(e)}t=t.sibling}}function Ql(t,e){for(;null!==Sl;){var n=Sl;switch(n.tag){case 0:case 11:case 15:ol(8,n,e);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:Nr(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,Sl=i;else t:for(n=t;null!==Sl;){var r=(i=Sl).sibling,a=i.return;if(Ml(i),i===n){Sl=null;break t}if(null!==r){r.return=a,Sl=r;break t}Sl=a}}}var tc={getCacheForType:function(t){var e=Ar(Lr),n=e.data.get(t);return void 0===n&&(n=t(),e.data.set(t,n)),n}},ec="function"===typeof WeakMap?WeakMap:Map,nc=0,ic=null,rc=null,ac=0,sc=0,oc=null,lc=!1,cc=!1,uc=!1,hc=0,dc=0,fc=0,pc=0,mc=0,gc=0,_c=0,yc=null,vc=null,bc=!1,xc=0,wc=1/0,Sc=null,Pc=null,Mc=0,Ac=null,kc=null,Ec=0,Tc=0,Cc=null,Ic=null,Lc=0,zc=null;function Nc(){if(0!==(2&nc)&&0!==ac)return ac&-ac;if(null!==N.T){return 0!==Fr?Fr:Tu()}return Ct()}function Dc(){0===gc&&(gc=0===(536870912&ac)||ar?wt():536870912);var t=io.current;return null!==t&&(t.flags|=32),gc}function Rc(t,e,n){(t!==ic||2!==sc&&9!==sc)&&null===t.cancelPendingCommit||(qc(t,0),jc(t,ac,gc,!1)),Mt(t,n),0!==(2&nc)&&t===ic||(t===ic&&(0===(2&nc)&&(pc|=n),4===dc&&jc(t,ac,gc,!1)),wu(t))}function Fc(t,e,n){if(0!==(6&nc))throw Error(s(327));for(var i=!n&&0===(124&e)&&0===(e&t.expiredLanes)||bt(t,e),r=i?function(t,e){var n=nc;nc|=2;var i=Zc(),r=Wc();ic!==t||ac!==e?(Sc=null,wc=et()+500,qc(t,e)):cc=bt(t,e);t:for(;;)try{if(0!==sc&&null!==rc){e=rc;var a=oc;e:switch(sc){case 1:sc=0,oc=null,Qc(t,e,a,1);break;case 2:case 9:if(Yr(a)){sc=0,oc=null,$c(e);break}e=function(){2!==sc&&9!==sc||ic!==t||(sc=7),wu(t)},a.then(e,e);break t;case 3:sc=7;break t;case 4:sc=5;break t;case 7:Yr(a)?(sc=0,oc=null,$c(e)):(sc=0,oc=null,Qc(t,e,a,7));break;case 5:var o=null;switch(rc.tag){case 26:o=rc.memoizedState;case 5:case 27:var l=rc;if(!o||Uh(o)){sc=0,oc=null;var c=l.sibling;if(null!==c)rc=c;else{var u=l.return;null!==u?(rc=u,tu(u)):rc=null}break e}}sc=0,oc=null,Qc(t,e,a,5);break;case 6:sc=0,oc=null,Qc(t,e,a,6);break;case 8:Gc(),dc=6;break t;default:throw Error(s(462))}}Kc();break}catch(h){Vc(t,h)}return yr=_r=null,N.H=i,N.A=r,nc=n,null!==rc?0:(ic=null,ac=0,Ei(),dc)}(t,e):Xc(t,e,!0),a=i;;){if(0===r){cc&&!i&&jc(t,e,0,!1);break}if(n=t.current.alternate,!a||Bc(n)){if(2===r){if(a=e,t.errorRecoveryDisabledLanes&a)var o=0;else o=0!==(o=-536870913&t.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){e=o;t:{var l=t;r=yc;var c=l.current.memoizedState.isDehydrated;if(c&&(qc(l,o).flags|=256),2!==(o=Xc(l,o,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=a,pc|=a,r=4;break t}a=vc,vc=r,null!==a&&(null===vc?vc=a:vc.push.apply(vc,a))}r=o}if(a=!1,2!==r)continue}}if(1===r){qc(t,0),jc(t,e,0,!0);break}t:{switch(i=t,a=r){case 0:case 1:throw Error(s(345));case 4:if((4194048&e)!==e)break;case 6:jc(i,e,gc,!lc);break t;case 2:vc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&e)===e&&10<(r=xc+300-et())){if(jc(i,e,gc,!lc),0!==vt(i,0,!0))break t;i.timeoutHandle=lh(Oc.bind(null,i,n,vc,Sc,bc,e,gc,pc,_c,lc,a,2,-0,0),r)}else Oc(i,n,vc,Sc,bc,e,gc,pc,_c,lc,a,0,-0,0)}break}r=Xc(t,e,!1),a=!1}wu(t)}function Oc(t,e,n,i,r,a,o,l,c,u,h,d,f,p){if(t.timeoutHandle=-1,(8192&(d=e.subtreeFlags)||16785408===(16785408&d))&&(Gh={stylesheets:null,count:0,unsuspend:qh},Xl(e),null!==(d=function(){if(null===Gh)throw Error(s(475));var t=Gh;return t.stylesheets&&0===t.count&&Wh(t,t.stylesheets),0<t.count?function(e){var n=setTimeout(function(){if(t.stylesheets&&Wh(t,t.stylesheets),t.unsuspend){var e=t.unsuspend;t.unsuspend=null,e()}},6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(n)}}:null}())))return t.cancelPendingCommit=d(nu.bind(null,t,e,a,n,i,r,o,l,c,h,1,f,p)),void jc(t,a,o,!u);nu(t,e,a,n,i,r,o,l,c)}function Bc(t){for(var e=t;;){var n=e.tag;if((0===n||11===n||15===n)&&16384&e.flags&&(null!==(n=e.updateQueue)&&null!==(n=n.stores)))for(var i=0;i<n.length;i++){var r=n[i],a=r.getSnapshot;r=r.value;try{if(!Yn(a(),r))return!1}catch(s){return!1}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jc(t,e,n,i){e&=~mc,e&=~pc,t.suspendedLanes|=e,t.pingedLanes&=~e,i&&(t.warmLanes|=e),i=t.expirationTimes;for(var r=e;0<r;){var a=31-ft(r),s=1<<a;i[a]=-1,r&=~s}0!==n&&At(t,n,e)}function Uc(){return 0!==(6&nc)||(Su(0,!1),!1)}function Gc(){if(null!==rc){if(0===sc)var t=rc.return;else yr=_r=null,Fa(t=rc),Xs=null,Ys=0,t=rc;for(;null!==t;)al(t.alternate,t),t=t.return;rc=null}}function qc(t,e){var n=t.timeoutHandle;-1!==n&&(t.timeoutHandle=-1,ch(n)),null!==(n=t.cancelPendingCommit)&&(t.cancelPendingCommit=null,n()),Gc(),ic=t,rc=n=Oi(t.current,null),ac=e,sc=0,oc=null,lc=!1,cc=bt(t,e),uc=!1,_c=gc=mc=pc=fc=dc=0,vc=yc=null,bc=!1,0!==(8&e)&&(e|=32&e);var i=t.entangledLanes;if(0!==i)for(t=t.entanglements,i&=e;0<i;){var r=31-ft(i),a=1<<r;e|=t[r],i&=~a}return hc=e,Ei(),n}function Vc(t,e){va=null,N.H=Vs,e===Zr||e===Hr?(e=Qr(),sc=3):e===Wr?(e=Qr(),sc=4):sc=e===Ao?8:null!==e&&"object"===typeof e&&"function"===typeof e.then?6:1,oc=e,null===rc&&(dc=1,xo(t,Pi(e,t.current)))}function Zc(){var t=N.H;return N.H=Vs,null===t?Vs:t}function Wc(){var t=N.A;return N.A=tc,t}function Hc(){dc=4,lc||(4194048&ac)!==ac&&null!==io.current||(cc=!0),0===(134217727&fc)&&0===(134217727&pc)||null===ic||jc(ic,ac,gc,!1)}function Xc(t,e,n){var i=nc;nc|=2;var r=Zc(),a=Wc();ic===t&&ac===e||(Sc=null,qc(t,e)),e=!1;var s=dc;t:for(;;)try{if(0!==sc&&null!==rc){var o=rc,l=oc;switch(sc){case 8:Gc(),s=6;break t;case 3:case 2:case 9:case 6:null===io.current&&(e=!0);var c=sc;if(sc=0,oc=null,Qc(t,o,l,c),n&&cc){s=0;break t}break;default:c=sc,sc=0,oc=null,Qc(t,o,l,c)}}Yc(),s=dc;break}catch(u){Vc(t,u)}return e&&t.shellSuspendCounter++,yr=_r=null,nc=i,N.H=r,N.A=a,null===rc&&(ic=null,ac=0,Ei()),s}function Yc(){for(;null!==rc;)Jc(rc)}function Kc(){for(;null!==rc&&!Q();)Jc(rc)}function Jc(t){var e=Jo(t.alternate,t,hc);t.memoizedProps=t.pendingProps,null===e?tu(t):rc=e}function $c(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=Ro(n,e,e.pendingProps,e.type,void 0,ac);break;case 11:e=Ro(n,e,e.pendingProps,e.type.render,e.ref,ac);break;case 5:Fa(e);default:al(n,e),e=Jo(n,e=rc=Bi(e,hc),hc)}t.memoizedProps=t.pendingProps,null===e?tu(t):rc=e}function Qc(t,e,n,i){yr=_r=null,Fa(e),Xs=null,Ys=0;var r=e.return;try{if(function(t,e,n,i,r){if(n.flags|=32768,null!==i&&"object"===typeof i&&"function"===typeof i.then){if(null!==(e=n.alternate)&&Sr(e,n,r,!0),null!==(n=io.current)){switch(n.tag){case 13:return null===ro?Hc():null===n.alternate&&0===dc&&(dc=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===Xr?n.flags|=16384:(null===(e=n.updateQueue)?n.updateQueue=new Set([i]):e.add(i),hu(t,i,r)),!1;case 22:return n.flags|=65536,i===Xr?n.flags|=16384:(null===(e=n.updateQueue)?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=e):null===(n=e.retryQueue)?e.retryQueue=new Set([i]):n.add(i),hu(t,i,r)),!1}throw Error(s(435,n.tag))}return hu(t,i,r),Hc(),!1}if(ar)return null!==(e=io.current)?(0===(65536&e.flags)&&(e.flags|=256),e.flags|=65536,e.lanes=r,i!==lr&&mr(Pi(t=Error(s(422),{cause:i}),n))):(i!==lr&&mr(Pi(e=Error(s(423),{cause:i}),n)),(t=t.current.alternate).flags|=65536,r&=-r,t.lanes|=r,i=Pi(i,n),oa(t,r=So(t.stateNode,i,r)),4!==dc&&(dc=2)),!1;var a=Error(s(520),{cause:i});if(a=Pi(a,n),null===yc?yc=[a]:yc.push(a),4!==dc&&(dc=2),null===e)return!0;i=Pi(i,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=r&-r,n.lanes|=t,oa(n,t=So(n.stateNode,i,t)),!1;case 1:if(e=n.type,a=n.stateNode,0===(128&n.flags)&&("function"===typeof e.getDerivedStateFromError||null!==a&&"function"===typeof a.componentDidCatch&&(null===Pc||!Pc.has(a))))return n.flags|=65536,r&=-r,n.lanes|=r,Mo(r=Po(r),t,n,i),oa(n,r),!1}n=n.return}while(null!==n);return!1}(t,r,e,n,ac))return dc=1,xo(t,Pi(n,t.current)),void(rc=null)}catch(a){if(null!==r)throw rc=r,a;return dc=1,xo(t,Pi(n,t.current)),void(rc=null)}32768&e.flags?(ar||1===i?t=!0:cc||0!==(536870912&ac)?t=!1:(lc=t=!0,(2===i||9===i||3===i||6===i)&&(null!==(i=io.current)&&13===i.tag&&(i.flags|=16384))),eu(e,t)):tu(e)}function tu(t){var e=t;do{if(0!==(32768&e.flags))return void eu(e,lc);t=e.return;var n=il(e.alternate,e,hc);if(null!==n)return void(rc=n);if(null!==(e=e.sibling))return void(rc=e);rc=e=t}while(null!==e);0===dc&&(dc=5)}function eu(t,e){do{var n=rl(t.alternate,t);if(null!==n)return n.flags&=32767,void(rc=n);if(null!==(n=t.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&null!==(t=t.sibling))return void(rc=t);rc=t=n}while(null!==t);dc=6,rc=null}function nu(t,e,n,i,r,a,o,l,c){t.cancelPendingCommit=null;do{ou()}while(0!==Mc);if(0!==(6&nc))throw Error(s(327));if(null!==e){if(e===t.current)throw Error(s(177));if(a=e.lanes|e.childLanes,function(t,e,n,i,r,a){var s=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,l=t.expirationTimes,c=t.hiddenUpdates;for(n=s&~n;0<n;){var u=31-ft(n),h=1<<u;o[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==i&&At(t,i,0),0!==a&&0===r&&0!==t.tag&&(t.suspendedLanes|=a&~(s&~e))}(t,n,a|=ki,o,l,c),t===ic&&(rc=ic=null,ac=0),kc=e,Ac=t,Ec=n,Tc=a,Cc=r,Ic=i,0!==(10256&e.subtreeFlags)||0!==(10256&e.flags)?(t.callbackNode=null,t.callbackPriority=0,J(at,function(){return lu(),null})):(t.callbackNode=null,t.callbackPriority=0),i=0!==(13878&e.flags),0!==(13878&e.subtreeFlags)||i){i=N.T,N.T=null,r=D.p,D.p=2,o=nc,nc|=4;try{!function(t,e){if(t=t.containerInfo,eh=nd,ei(t=ti(t))){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(g){n=null;break t}var o=0,l=-1,c=-1,u=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(l=o+r),d!==a||0!==i&&3!==d.nodeType||(c=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===n&&++u===r&&(l=o),f===a&&++h===i&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nh={focusedElem:t,selectionRange:n},nd=!1,Sl=e;null!==Sl;)if(t=(e=Sl).child,0!==(1024&e.subtreeFlags)&&null!==t)t.return=e,Sl=t;else for(;null!==Sl;){switch(a=(e=Sl).alternate,t=e.flags,e.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&t)&&null!==a){t=void 0,n=e,r=a.memoizedProps,a=a.memoizedState,i=n.stateNode;try{var m=go(n.type,r,(n.elementType,n.type));t=i.getSnapshotBeforeUpdate(m,a),i.__reactInternalSnapshotBeforeUpdate=t}catch(_){uu(n,n.return,_)}}break;case 3:if(0!==(1024&t))if(9===(n=(t=e.stateNode.containerInfo).nodeType))mh(t);else if(1===n)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":mh(t);break;default:t.textContent=""}break;default:if(0!==(1024&t))throw Error(s(163))}if(null!==(t=e.sibling)){t.return=e.return,Sl=t;break}Sl=e.return}}(t,e)}finally{nc=o,D.p=r,N.T=i}}Mc=1,iu(),ru(),au()}}function iu(){if(1===Mc){Mc=0;var t=Ac,e=kc,n=0!==(13878&e.flags);if(0!==(13878&e.subtreeFlags)||n){n=N.T,N.T=null;var i=D.p;D.p=2;var r=nc;nc|=4;try{Nl(e,t);var a=nh,s=ti(t.containerInfo),o=a.focusedElem,l=a.selectionRange;if(s!==o&&o&&o.ownerDocument&&Qn(o.ownerDocument.documentElement,o)){if(null!==l&&ei(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),p=o.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!f.extend&&m>g&&(s=g,g=m,m=s);var _=$n(o,m),y=$n(o,g);if(_&&y&&(1!==f.rangeCount||f.anchorNode!==_.node||f.anchorOffset!==_.offset||f.focusNode!==y.node||f.focusOffset!==y.offset)){var v=h.createRange();v.setStart(_.node,_.offset),f.removeAllRanges(),m>g?(f.addRange(v),f.extend(y.node,y.offset)):(v.setEnd(y.node,y.offset),f.addRange(v))}}}}for(h=[],f=o;f=f.parentNode;)1===f.nodeType&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<h.length;o++){var b=h[o];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}nd=!!eh,nh=eh=null}finally{nc=r,D.p=i,N.T=n}}t.current=e,Mc=2}}function ru(){if(2===Mc){Mc=0;var t=Ac,e=kc,n=0!==(8772&e.flags);if(0!==(8772&e.subtreeFlags)||n){n=N.T,N.T=null;var i=D.p;D.p=2;var r=nc;nc|=4;try{Pl(t,e.alternate,e)}finally{nc=r,D.p=i,N.T=n}}Mc=3}}function au(){if(4===Mc||3===Mc){Mc=0,tt();var t=Ac,e=kc,n=Ec,i=Ic;0!==(10256&e.subtreeFlags)||0!==(10256&e.flags)?Mc=5:(Mc=0,kc=Ac=null,su(t,t.pendingLanes));var r=t.pendingLanes;if(0===r&&(Pc=null),Tt(n),e=e.stateNode,ht&&"function"===typeof ht.onCommitFiberRoot)try{ht.onCommitFiberRoot(ut,e,void 0,128===(128&e.current.flags))}catch(l){}if(null!==i){e=N.T,r=D.p,D.p=2,N.T=null;try{for(var a=t.onRecoverableError,s=0;s<i.length;s++){var o=i[s];a(o.value,{componentStack:o.stack})}}finally{N.T=e,D.p=r}}0!==(3&Ec)&&ou(),wu(t),r=t.pendingLanes,0!==(4194090&n)&&0!==(42&r)?t===zc?Lc++:(Lc=0,zc=t):Lc=0,Su(0,!1)}}function su(t,e){0===(t.pooledCacheLanes&=e)&&(null!=(e=t.pooledCache)&&(t.pooledCache=null,Nr(e)))}function ou(t){return iu(),ru(),au(),lu()}function lu(){if(5!==Mc)return!1;var t=Ac,e=Tc;Tc=0;var n=Tt(Ec),i=N.T,r=D.p;try{D.p=32>n?32:n,N.T=null,n=Cc,Cc=null;var a=Ac,o=Ec;if(Mc=0,kc=Ac=null,Ec=0,0!==(6&nc))throw Error(s(331));var l=nc;if(nc|=4,Jl(a.current),ql(a,a.current,o,n),nc=l,Su(0,!1),ht&&"function"===typeof ht.onPostCommitFiberRoot)try{ht.onPostCommitFiberRoot(ut,a)}catch(c){}return!0}finally{D.p=r,N.T=i,su(t,e)}}function cu(t,e,n){e=Pi(n,e),null!==(t=aa(t,e=So(t.stateNode,e,2),2))&&(Mt(t,2),wu(t))}function uu(t,e,n){if(3===t.tag)cu(t,t,n);else for(;null!==e;){if(3===e.tag){cu(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Pc||!Pc.has(i))){t=Pi(n,t),null!==(i=aa(e,n=Po(2),2))&&(Mo(n,i,e,t),Mt(i,2),wu(i));break}}e=e.return}}function hu(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new ec;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(uc=!0,r.add(n),t=du.bind(null,t,e,n),e.then(t,t))}function du(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,ic===t&&(ac&n)===n&&(4===dc||3===dc&&(62914560&ac)===ac&&300>et()-xc?0===(2&nc)&&qc(t,0):mc|=n,_c===ac&&(_c=0)),wu(t)}function fu(t,e){0===e&&(e=St()),null!==(t=Ii(t,e))&&(Mt(t,e),wu(t))}function pu(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),fu(t,n)}function mu(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(s(314))}null!==i&&i.delete(e),fu(t,n)}var gu=null,_u=null,yu=!1,vu=!1,bu=!1,xu=0;function wu(t){t!==_u&&null===t.next&&(null===_u?gu=_u=t:_u=_u.next=t),vu=!0,yu||(yu=!0,hh(function(){0!==(6&nc)?J(it,Pu):Mu()}))}function Su(t,e){if(!bu&&vu){bu=!0;do{for(var n=!1,i=gu;null!==i;){if(!e)if(0!==t){var r=i.pendingLanes;if(0===r)var a=0;else{var s=i.suspendedLanes,o=i.pingedLanes;a=(1<<31-ft(42|t)+1)-1,a=201326741&(a&=r&~(s&~o))?201326741&a|1:a?2|a:0}0!==a&&(n=!0,Eu(i,a))}else a=ac,0===(3&(a=vt(i,i===ic?a:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||bt(i,a)||(n=!0,Eu(i,a));i=i.next}}while(n);bu=!1}}function Pu(){Mu()}function Mu(){vu=yu=!1;var t=0;0!==xu&&(function(){var t=window.event;if(t&&"popstate"===t.type)return t!==oh&&(oh=t,!0);return oh=null,!1}()&&(t=xu),xu=0);for(var e=et(),n=null,i=gu;null!==i;){var r=i.next,a=Au(i,e);0===a?(i.next=null,null===n?gu=r:n.next=r,null===r&&(_u=n)):(n=i,(0!==t||0!==(3&a))&&(vu=!0)),i=r}Su(t,!1)}function Au(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,a=-62914561&t.pendingLanes;0<a;){var s=31-ft(a),o=1<<s,l=r[s];-1===l?0!==(o&n)&&0===(o&i)||(r[s]=xt(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}if(n=ac,n=vt(t,t===(e=ic)?n:0,null!==t.cancelPendingCommit||-1!==t.timeoutHandle),i=t.callbackNode,0===n||t===e&&(2===sc||9===sc)||null!==t.cancelPendingCommit)return null!==i&&null!==i&&$(i),t.callbackNode=null,t.callbackPriority=0;if(0===(3&n)||bt(t,n)){if((e=n&-n)===t.callbackPriority)return e;switch(null!==i&&$(i),Tt(n)){case 2:case 8:n=rt;break;case 32:default:n=at;break;case 268435456:n=ot}return i=ku.bind(null,t),n=J(n,i),t.callbackPriority=e,t.callbackNode=n,e}return null!==i&&null!==i&&$(i),t.callbackPriority=2,t.callbackNode=null,2}function ku(t,e){if(0!==Mc&&5!==Mc)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(ou()&&t.callbackNode!==n)return null;var i=ac;return 0===(i=vt(t,t===ic?i:0,null!==t.cancelPendingCommit||-1!==t.timeoutHandle))?null:(Fc(t,i,e),Au(t,et()),null!=t.callbackNode&&t.callbackNode===n?ku.bind(null,t):null)}function Eu(t,e){if(ou())return null;Fc(t,e,!0)}function Tu(){return 0===xu&&(xu=wt()),xu}function Cu(t){return null==t||"symbol"===typeof t||"boolean"===typeof t?null:"function"===typeof t?t:Te(""+t)}function Iu(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}for(var Lu=0;Lu<xi.length;Lu++){var zu=xi[Lu];wi(zu.toLowerCase(),"on"+(zu[0].toUpperCase()+zu.slice(1)))}wi(fi,"onAnimationEnd"),wi(pi,"onAnimationIteration"),wi(mi,"onAnimationStart"),wi("dblclick","onDoubleClick"),wi("focusin","onFocus"),wi("focusout","onBlur"),wi(gi,"onTransitionRun"),wi(_i,"onTransitionStart"),wi(yi,"onTransitionCancel"),wi(vi,"onTransitionEnd"),Yt("onMouseEnter",["mouseout","mouseover"]),Yt("onMouseLeave",["mouseout","mouseover"]),Yt("onPointerEnter",["pointerout","pointerover"]),Yt("onPointerLeave",["pointerout","pointerover"]),Xt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Du=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Nu));function Ru(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var a=void 0;if(e)for(var s=i.length-1;0<=s;s--){var o=i[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&r.isPropagationStopped())break t;a=o,r.currentTarget=c;try{a(r)}catch(u){_o(u)}r.currentTarget=null,a=l}else for(s=0;s<i.length;s++){if(l=(o=i[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&r.isPropagationStopped())break t;a=o,r.currentTarget=c;try{a(r)}catch(u){_o(u)}r.currentTarget=null,a=l}}}}function Fu(t,e){var n=e[Dt];void 0===n&&(n=e[Dt]=new Set);var i=t+"__bubble";n.has(i)||(Uu(e,t,2,!1),n.add(i))}function Ou(t,e,n){var i=0;e&&(i|=4),Uu(n,t,i,e)}var Bu="_reactListening"+Math.random().toString(36).slice(2);function ju(t){if(!t[Bu]){t[Bu]=!0,Wt.forEach(function(e){"selectionchange"!==e&&(Du.has(e)||Ou(e,!1,t),Ou(e,!0,t))});var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Bu]||(e[Bu]=!0,Ou("selectionchange",!1,e))}}function Uu(t,e,n,i){switch(cd(e)){case 2:var r=id;break;case 8:r=rd;break;default:r=ad}n=r.bind(null,e,n,t),r=void 0,!Be||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Gu(t,e,n,i,r){var a=i;if(0===(1&e)&&0===(2&e)&&null!==i)t:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var o=i.stateNode.containerInfo;if(o===r)break;if(4===s)for(s=i.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===r)return;s=s.return}for(;null!==o;){if(null===(s=Ut(o)))return;if(5===(c=s.tag)||6===c||26===c||27===c){i=a=s;continue t}o=o.parentNode}}i=i.return}Re(function(){var i=a,r=Ie(n),s=[];t:{var o=bi.get(t);if(void 0!==o){var c=Qe,u=t;switch(t){case"keypress":if(0===Ze(n))break t;case"keydown":case"keyup":c=mn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=an;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=_n;break;case fi:case pi:case mi:c=on;break;case vi:c=yn;break;case"scroll":case"scrollend":c=en;break;case"wheel":c=vn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=gn;break;case"toggle":case"beforetoggle":c=bn}var h=0!==(4&e),d=!h&&("scroll"===t||"scrollend"===t),f=h?null!==o?o+"Capture":null:o;h=[];for(var p,m=i;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===f||null!=(g=Fe(m,f))&&h.push(qu(m,g,p)),d)break;m=m.return}0<h.length&&(o=new c(o,u,null,n,r),s.push({event:o,listeners:h}))}}if(0===(7&e)){if(c="mouseout"===t||"pointerout"===t,(!(o="mouseover"===t||"pointerover"===t)||n===Ce||!(u=n.relatedTarget||n.fromElement)||!Ut(u)&&!u[Nt])&&(c||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=i,null!==(u=(u=n.relatedTarget||n.toElement)?Ut(u):null)&&(d=l(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=i),c!==u)){if(h=rn,g="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==t&&"pointerover"!==t||(h=gn,g="onPointerLeave",f="onPointerEnter",m="pointer"),d=null==c?o:qt(c),p=null==u?o:qt(u),(o=new h(g,m+"leave",c,n,r)).target=d,o.relatedTarget=p,g=null,Ut(r)===i&&((h=new h(f,m+"enter",u,n,r)).target=p,h.relatedTarget=d,g=h),d=g,c&&u)t:{for(f=u,m=0,p=h=c;p;p=Zu(p))m++;for(p=0,g=f;g;g=Zu(g))p++;for(;0<m-p;)h=Zu(h),m--;for(;0<p-m;)f=Zu(f),p--;for(;m--;){if(h===f||null!==f&&h===f.alternate)break t;h=Zu(h),f=Zu(f)}h=null}else h=null;null!==c&&Wu(s,o,c,h,!1),null!==u&&null!==d&&Wu(s,d,u,h,!0)}if("select"===(c=(o=i?qt(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var _=On;else if(Ln(o))if(Bn)_=Xn;else{_=Wn;var y=Zn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?i&&Ae(i.elementType)&&(_=On):_=Hn;switch(_&&(_=_(t,i))?zn(s,_,n,r):(y&&y(t,o,i),"focusout"===t&&i&&"number"===o.type&&null!=i.memoizedProps.value&&ye(o,"number",o.value)),y=i?qt(i):window,t){case"focusin":(Ln(y)||"true"===y.contentEditable)&&(ii=y,ri=i,ai=null);break;case"focusout":ai=ri=ii=null;break;case"mousedown":si=!0;break;case"contextmenu":case"mouseup":case"dragend":si=!1,oi(s,n,r);break;case"selectionchange":if(ni)break;case"keydown":case"keyup":oi(s,n,r)}var v;if(wn)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Cn?En(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(Mn&&"ko"!==n.locale&&(Cn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Cn&&(v=Ve()):(Ge="value"in(Ue=r)?Ue.value:Ue.textContent,Cn=!0)),0<(y=Vu(i,b)).length&&(b=new cn(b,t,null,n,r),s.push({event:b,listeners:y}),v?b.data=v:null!==(v=Tn(n))&&(b.data=v))),(v=Pn?function(t,e){switch(t){case"compositionend":return Tn(e);case"keypress":return 32!==e.which?null:(kn=!0,An);case"textInput":return(t=e.data)===An&&kn?null:t;default:return null}}(t,n):function(t,e){if(Cn)return"compositionend"===t||!wn&&En(t,e)?(t=Ve(),qe=Ge=Ue=null,Cn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Mn&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(b=Vu(i,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,r),s.push({event:y,listeners:b}),y.data=v)),function(t,e,n,i,r){if("submit"===e&&n&&n.stateNode===r){var a=Cu((r[zt]||null).action),s=i.submitter;s&&null!==(e=(e=s[zt]||null)?Cu(e.formAction):s.getAttribute("formAction"))&&(a=e,s=null);var o=new Qe("action","action",null,i,r);t.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==xu){var t=s?Iu(r,s):new FormData(r);Cs(n,{pending:!0,data:t,method:r.method,action:a},null,t)}}else"function"===typeof a&&(o.preventDefault(),t=s?Iu(r,s):new FormData(r),Cs(n,{pending:!0,data:t,method:r.method,action:a},a,t))},currentTarget:r}]})}}(s,t,i,n,r)}Ru(s,e)})}function qu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vu(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,a=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===a||(null!=(r=Fe(t,n))&&i.unshift(qu(t,r,a)),null!=(r=Fe(t,e))&&i.push(qu(t,r,a))),3===t.tag)return i;t=t.return}return[]}function Zu(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag&&27!==t.tag);return t||null}function Wu(t,e,n,i,r){for(var a=e._reactName,s=[];null!==n&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===i)break;5!==o&&26!==o&&27!==o||null===c||(l=c,r?null!=(c=Fe(n,a))&&s.unshift(qu(n,c,l)):r||null!=(c=Fe(n,a))&&s.push(qu(n,c,l))),n=n.return}0!==s.length&&t.push({event:e,listeners:s})}var Hu=/\r\n?/g,Xu=/\u0000|\uFFFD/g;function Yu(t){return("string"===typeof t?t:""+t).replace(Hu,"\n").replace(Xu,"")}function Ku(t,e){return e=Yu(e),Yu(t)===e}function Ju(){}function $u(t,e,n,i,r,a){switch(n){case"children":"string"===typeof i?"body"===e||"textarea"===e&&""===i||we(t,i):("number"===typeof i||"bigint"===typeof i)&&"body"!==e&&we(t,""+i);break;case"className":ne(t,"class",i);break;case"tabIndex":ne(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":ne(t,n,i);break;case"style":Me(t,i,a);break;case"data":if("object"!==e){ne(t,"data",i);break}case"src":case"href":if(""===i&&("a"!==e||"href"!==n)){t.removeAttribute(n);break}if(null==i||"function"===typeof i||"symbol"===typeof i||"boolean"===typeof i){t.removeAttribute(n);break}i=Te(""+i),t.setAttribute(n,i);break;case"action":case"formAction":if("function"===typeof i){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof a&&("formAction"===n?("input"!==e&&$u(t,e,"name",r.name,r,null),$u(t,e,"formEncType",r.formEncType,r,null),$u(t,e,"formMethod",r.formMethod,r,null),$u(t,e,"formTarget",r.formTarget,r,null)):($u(t,e,"encType",r.encType,r,null),$u(t,e,"method",r.method,r,null),$u(t,e,"target",r.target,r,null))),null==i||"symbol"===typeof i||"boolean"===typeof i){t.removeAttribute(n);break}i=Te(""+i),t.setAttribute(n,i);break;case"onClick":null!=i&&(t.onclick=Ju);break;case"onScroll":null!=i&&Fu("scroll",t);break;case"onScrollEnd":null!=i&&Fu("scrollend",t);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(s(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(s(60));t.innerHTML=n}}break;case"multiple":t.multiple=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"muted":t.muted=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"===typeof i||"boolean"===typeof i||"symbol"===typeof i){t.removeAttribute("xlink:href");break}n=Te(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!==typeof i&&"symbol"!==typeof i?t.setAttribute(n,""+i):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!==typeof i&&"symbol"!==typeof i?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":!0===i?t.setAttribute(n,""):!1!==i&&null!=i&&"function"!==typeof i&&"symbol"!==typeof i?t.setAttribute(n,i):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&!isNaN(i)&&1<=i?t.setAttribute(n,i):t.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"===typeof i||"symbol"===typeof i||isNaN(i)?t.removeAttribute(n):t.setAttribute(n,i);break;case"popover":Fu("beforetoggle",t),Fu("toggle",t),ee(t,"popover",i);break;case"xlinkActuate":ie(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ie(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ie(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ie(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ie(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ie(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ie(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ie(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ie(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":ee(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ee(t,n=ke.get(n)||n,i)}}function Qu(t,e,n,i,r,a){switch(n){case"style":Me(t,i,a);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(s(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(s(60));t.innerHTML=n}}break;case"children":"string"===typeof i?we(t,i):("number"===typeof i||"bigint"===typeof i)&&we(t,""+i);break;case"onScroll":null!=i&&Fu("scroll",t);break;case"onScrollEnd":null!=i&&Fu("scrollend",t);break;case"onClick":null!=i&&(t.onclick=Ju);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ht.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),e=n.slice(2,r?n.length-7:void 0),"function"===typeof(a=null!=(a=t[zt]||null)?a[n]:null)&&t.removeEventListener(e,a,r),"function"!==typeof i)?n in t?t[n]=i:!0===i?t.setAttribute(n,""):ee(t,n,i):("function"!==typeof a&&null!==a&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,i,r)))}}function th(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fu("error",t),Fu("load",t);var i,r=!1,a=!1;for(i in n)if(n.hasOwnProperty(i)){var o=n[i];if(null!=o)switch(i){case"src":r=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,e));default:$u(t,e,i,o,n,null)}}return a&&$u(t,e,"srcSet",n.srcSet,n,null),void(r&&$u(t,e,"src",n.src,n,null));case"input":Fu("invalid",t);var l=i=o=a=null,c=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var h=n[r];if(null!=h)switch(r){case"name":a=h;break;case"type":o=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":i=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(s(137,e));break;default:$u(t,e,r,h,n,null)}}return _e(t,i,l,c,u,o,a,!1),void he(t);case"select":for(a in Fu("invalid",t),r=o=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":o=l;break;case"multiple":r=l;default:$u(t,e,a,l,n,null)}return e=i,n=o,t.multiple=!!r,void(null!=e?ve(t,!!r,e,!1):null!=n&&ve(t,!!r,n,!0));case"textarea":for(o in Fu("invalid",t),i=a=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":a=l;break;case"children":i=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:$u(t,e,o,l,n,null)}return xe(t,r,a,i),void he(t);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(r=n[c]))if("selected"===c)t.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else $u(t,e,c,r,n,null);return;case"dialog":Fu("beforetoggle",t),Fu("toggle",t),Fu("cancel",t),Fu("close",t);break;case"iframe":case"object":Fu("load",t);break;case"video":case"audio":for(r=0;r<Nu.length;r++)Fu(Nu[r],t);break;case"image":Fu("error",t),Fu("load",t);break;case"details":Fu("toggle",t);break;case"embed":case"source":case"link":Fu("error",t),Fu("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,e));default:$u(t,e,u,r,n,null)}return;default:if(Ae(e)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(r=n[h])&&Qu(t,e,h,r,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(r=n[l])&&$u(t,e,l,r,n,null))}var eh=null,nh=null;function ih(t){return 9===t.nodeType?t:t.ownerDocument}function rh(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ah(t,e){if(0===t)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return 1===t&&"foreignObject"===e?0:t}function sh(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"bigint"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var oh=null;var lh="function"===typeof setTimeout?setTimeout:void 0,ch="function"===typeof clearTimeout?clearTimeout:void 0,uh="function"===typeof Promise?Promise:void 0,hh="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof uh?function(t){return uh.resolve(null).then(t).catch(dh)}:lh;function dh(t){setTimeout(function(){throw t})}function fh(t){return"head"===t}function ph(t,e){var n=e,i=0,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0<i&&8>i){n=i;var s=t.ownerDocument;if(1&n&&xh(s.documentElement),2&n&&xh(s.body),4&n)for(xh(n=s.head),s=n.firstChild;s;){var o=s.nextSibling,l=s.nodeName;s[Bt]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=o}}if(0===r)return t.removeChild(a),void kd(e);r--}else"$"===n||"$?"===n||"$!"===n?r++:i=n.charCodeAt(0)-48;else i=0;n=a}while(n);kd(e)}function mh(t){var e=t.firstChild;for(e&&10===e.nodeType&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":mh(n),jt(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}t.removeChild(n)}}function gh(t){return"$!"===t.data||"$?"===t.data&&"complete"===t.ownerDocument.readyState}function _h(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e||"F!"===e||"F"===e)break;if("/$"===e)return null}}return t}var yh=null;function vh(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}function bh(t,e,n){switch(e=ih(n),t){case"html":if(!(t=e.documentElement))throw Error(s(452));return t;case"head":if(!(t=e.head))throw Error(s(453));return t;case"body":if(!(t=e.body))throw Error(s(454));return t;default:throw Error(s(451))}}function xh(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);jt(t)}var wh=new Map,Sh=new Set;function Ph(t){return"function"===typeof t.getRootNode?t.getRootNode():9===t.nodeType?t:t.ownerDocument}var Mh=D.d;D.d={f:function(){var t=Mh.f(),e=Uc();return t||e},r:function(t){var e=Gt(t);null!==e&&5===e.tag&&"form"===e.type?Ls(e):Mh.r(t)},D:function(t){Mh.D(t),kh("dns-prefetch",t,null)},C:function(t,e){Mh.C(t,e),kh("preconnect",t,e)},L:function(t,e,n){Mh.L(t,e,n);var i=Ah;if(i&&t&&e){var r='link[rel="preload"][as="'+me(e)+'"]';"image"===e&&n&&n.imageSrcSet?(r+='[imagesrcset="'+me(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+me(n.imageSizes)+'"]')):r+='[href="'+me(t)+'"]';var a=r;switch(e){case"style":a=Th(t);break;case"script":a=Lh(t)}wh.has(a)||(t=d({rel:"preload",href:"image"===e&&n&&n.imageSrcSet?void 0:t,as:e},n),wh.set(a,t),null!==i.querySelector(r)||"style"===e&&i.querySelector(Ch(a))||"script"===e&&i.querySelector(zh(a))||(th(e=i.createElement("link"),"link",t),Zt(e),i.head.appendChild(e)))}},m:function(t,e){Mh.m(t,e);var n=Ah;if(n&&t){var i=e&&"string"===typeof e.as?e.as:"script",r='link[rel="modulepreload"][as="'+me(i)+'"][href="'+me(t)+'"]',a=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Lh(t)}if(!wh.has(a)&&(t=d({rel:"modulepreload",href:t},e),wh.set(a,t),null===n.querySelector(r))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(zh(a)))return}th(i=n.createElement("link"),"link",t),Zt(i),n.head.appendChild(i)}}},X:function(t,e){Mh.X(t,e);var n=Ah;if(n&&t){var i=Vt(n).hoistableScripts,r=Lh(t),a=i.get(r);a||((a=n.querySelector(zh(r)))||(t=d({src:t,async:!0},e),(e=wh.get(r))&&Fh(t,e),Zt(a=n.createElement("script")),th(a,"link",t),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},i.set(r,a))}},S:function(t,e,n){Mh.S(t,e,n);var i=Ah;if(i&&t){var r=Vt(i).hoistableStyles,a=Th(t);e=e||"default";var s=r.get(a);if(!s){var o={loading:0,preload:null};if(s=i.querySelector(Ch(a)))o.loading=5;else{t=d({rel:"stylesheet",href:t,"data-precedence":e},n),(n=wh.get(a))&&Rh(t,n);var l=s=i.createElement("link");Zt(l),th(l,"link",t),l._p=new Promise(function(t,e){l.onload=t,l.onerror=e}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Dh(s,e,i)}s={type:"stylesheet",instance:s,count:1,state:o},r.set(a,s)}}},M:function(t,e){Mh.M(t,e);var n=Ah;if(n&&t){var i=Vt(n).hoistableScripts,r=Lh(t),a=i.get(r);a||((a=n.querySelector(zh(r)))||(t=d({src:t,async:!0,type:"module"},e),(e=wh.get(r))&&Fh(t,e),Zt(a=n.createElement("script")),th(a,"link",t),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},i.set(r,a))}}};var Ah="undefined"===typeof document?null:document;function kh(t,e,n){var i=Ah;if(i&&"string"===typeof e&&e){var r=me(e);r='link[rel="'+t+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),Sh.has(r)||(Sh.add(r),t={rel:t,crossOrigin:n,href:e},null===i.querySelector(r)&&(th(e=i.createElement("link"),"link",t),Zt(e),i.head.appendChild(e)))}}function Eh(t,e,n,i){var r,a,o,l,c=(c=V.current)?Ph(c):null;if(!c)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(e=Th(n.href),(i=(n=Vt(c).hoistableStyles).get(e))||(i={type:"style",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){t=Th(n.href);var u=Vt(c).hoistableStyles,h=u.get(t);if(h||(c=c.ownerDocument||c,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(t,h),(u=c.querySelector(Ch(t)))&&!u._p&&(h.instance=u,h.state.loading=5),wh.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},wh.set(t,n),u||(r=c,a=t,o=n,l=h.state,r.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=r.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),th(a,"link",o),Zt(a),r.head.appendChild(a))))),e&&null===i)throw Error(s(528,""));return h}if(e&&null!==i)throw Error(s(529,""));return null;case"script":return e=n.async,"string"===typeof(n=n.src)&&e&&"function"!==typeof e&&"symbol"!==typeof e?(e=Lh(n),(i=(n=Vt(c).hoistableScripts).get(e))||(i={type:"script",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function Th(t){return'href="'+me(t)+'"'}function Ch(t){return'link[rel="stylesheet"]['+t+"]"}function Ih(t){return d({},t,{"data-precedence":t.precedence,precedence:null})}function Lh(t){return'[src="'+me(t)+'"]'}function zh(t){return"script[async]"+t}function Nh(t,e,n){if(e.count++,null===e.instance)switch(e.type){case"style":var i=t.querySelector('style[data-href~="'+me(n.href)+'"]');if(i)return e.instance=i,Zt(i),i;var r=d({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Zt(i=(t.ownerDocument||t).createElement("style")),th(i,"style",r),Dh(i,n.precedence,t),e.instance=i;case"stylesheet":r=Th(n.href);var a=t.querySelector(Ch(r));if(a)return e.state.loading|=4,e.instance=a,Zt(a),a;i=Ih(n),(r=wh.get(r))&&Rh(i,r),Zt(a=(t.ownerDocument||t).createElement("link"));var o=a;return o._p=new Promise(function(t,e){o.onload=t,o.onerror=e}),th(a,"link",i),e.state.loading|=4,Dh(a,n.precedence,t),e.instance=a;case"script":return a=Lh(n.src),(r=t.querySelector(zh(a)))?(e.instance=r,Zt(r),r):(i=n,(r=wh.get(a))&&Fh(i=d({},n),r),Zt(r=(t=t.ownerDocument||t).createElement("script")),th(r,"link",i),t.head.appendChild(r),e.instance=r);case"void":return null;default:throw Error(s(443,e.type))}else"stylesheet"===e.type&&0===(4&e.state.loading)&&(i=e.instance,e.state.loading|=4,Dh(i,n.precedence,t));return e.instance}function Dh(t,e,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,a=r,s=0;s<i.length;s++){var o=i[s];if(o.dataset.precedence===e)a=o;else if(a!==r)break}a?a.parentNode.insertBefore(t,a.nextSibling):(e=9===n.nodeType?n.head:n).insertBefore(t,e.firstChild)}function Rh(t,e){null==t.crossOrigin&&(t.crossOrigin=e.crossOrigin),null==t.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),null==t.title&&(t.title=e.title)}function Fh(t,e){null==t.crossOrigin&&(t.crossOrigin=e.crossOrigin),null==t.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),null==t.integrity&&(t.integrity=e.integrity)}var Oh=null;function Bh(t,e,n){if(null===Oh){var i=new Map,r=Oh=new Map;r.set(n,i)}else(i=(r=Oh).get(n))||(i=new Map,r.set(n,i));if(i.has(t))return i;for(i.set(t,null),n=n.getElementsByTagName(t),r=0;r<n.length;r++){var a=n[r];if(!(a[Bt]||a[Lt]||"link"===t&&"stylesheet"===a.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==a.namespaceURI){var s=a.getAttribute(e)||"";s=t+s;var o=i.get(s);o?o.push(a):i.set(s,[a])}}return i}function jh(t,e,n){(t=t.ownerDocument||t).head.insertBefore(n,"title"===e?t.querySelector("head > title"):null)}function Uh(t){return"stylesheet"!==t.type||0!==(3&t.state.loading)}var Gh=null;function qh(){}function Vh(){if(this.count--,0===this.count)if(this.stylesheets)Wh(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}var Zh=null;function Wh(t,e){t.stylesheets=null,null!==t.unsuspend&&(t.count++,Zh=new Map,e.forEach(Hh,t),Zh=null,Vh.call(t))}function Hh(t,e){if(!(4&e.state.loading)){var n=Zh.get(t);if(n)var i=n.get(null);else{n=new Map,Zh.set(t,n);for(var r=t.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<r.length;a++){var s=r[a];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),i=s)}i&&n.set(null,i)}s=(r=e.instance).getAttribute("data-precedence"),(a=n.get(s)||i)===i&&n.set(null,r),n.set(s,r),this.count++,i=Vh.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),a?a.parentNode.insertBefore(r,a.nextSibling):(t=9===t.nodeType?t.head:t).insertBefore(r,t.firstChild),e.state.loading|=4}}var Xh={$$typeof:x,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function Yh(t,e,n,i,r,a,s,o){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pt(0),this.hiddenUpdates=Pt(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Kh(t,e,n,i,r,a,s,o,l,c,u,h){return t=new Yh(t,e,n,s,o,l,c,h),e=1,!0===a&&(e|=24),a=Ri(3,null,null,e),t.current=a,a.stateNode=t,(e=zr()).refCount++,t.pooledCache=e,e.refCount++,a.memoizedState={element:i,isDehydrated:n,cache:e},na(a),t}function Jh(t){return t?t=Ni:Ni}function $h(t,e,n,i,r,a){r=Jh(r),null===i.context?i.context=r:i.pendingContext=r,(i=ra(e)).payload={element:n},null!==(a=void 0===a?null:a)&&(i.callback=a),null!==(n=aa(t,i,e))&&(Rc(n,0,e),sa(n,t,e))}function Qh(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function td(t,e){Qh(t,e),(t=t.alternate)&&Qh(t,e)}function ed(t){if(13===t.tag){var e=Ii(t,67108864);null!==e&&Rc(e,0,67108864),td(t,67108864)}}var nd=!0;function id(t,e,n,i){var r=N.T;N.T=null;var a=D.p;try{D.p=2,ad(t,e,n,i)}finally{D.p=a,N.T=r}}function rd(t,e,n,i){var r=N.T;N.T=null;var a=D.p;try{D.p=8,ad(t,e,n,i)}finally{D.p=a,N.T=r}}function ad(t,e,n,i){if(nd){var r=sd(i);if(null===r)Gu(t,e,i,od,n),yd(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return hd=vd(hd,t,e,n,i,r),!0;case"dragenter":return dd=vd(dd,t,e,n,i,r),!0;case"mouseover":return fd=vd(fd,t,e,n,i,r),!0;case"pointerover":var a=r.pointerId;return pd.set(a,vd(pd.get(a)||null,t,e,n,i,r)),!0;case"gotpointercapture":return a=r.pointerId,md.set(a,vd(md.get(a)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(yd(t,i),4&e&&-1<_d.indexOf(t)){for(;null!==r;){var a=Gt(r);if(null!==a)switch(a.tag){case 3:if((a=a.stateNode).current.memoizedState.isDehydrated){var s=yt(a.pendingLanes);if(0!==s){var o=a;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-ft(s);o.entanglements[1]|=l,s&=~l}wu(a),0===(6&nc)&&(wc=et()+500,Su(0,!1))}}break;case 13:null!==(o=Ii(a,2))&&Rc(o,0,2),Uc(),td(a,2)}if(null===(a=sd(i))&&Gu(t,e,i,od,n),a===r)break;r=a}null!==r&&i.stopPropagation()}else Gu(t,e,i,null,n)}}function sd(t){return ld(t=Ie(t))}var od=null;function ld(t){if(od=null,null!==(t=Ut(t))){var e=l(t);if(null===e)t=null;else{var n=e.tag;if(13===n){if(null!==(t=c(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return od=t,null}function cd(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nt()){case it:return 2;case rt:return 8;case at:case st:return 32;case ot:return 268435456;default:return 32}default:return 32}}var ud=!1,hd=null,dd=null,fd=null,pd=new Map,md=new Map,gd=[],_d="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yd(t,e){switch(t){case"focusin":case"focusout":hd=null;break;case"dragenter":case"dragleave":dd=null;break;case"mouseover":case"mouseout":fd=null;break;case"pointerover":case"pointerout":pd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":md.delete(e.pointerId)}}function vd(t,e,n,i,r,a){return null===t||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[r]},null!==e&&(null!==(e=Gt(e))&&ed(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function bd(t){var e=Ut(t.target);if(null!==e){var n=l(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=c(n)))return t.blockedOn=e,void function(t,e){var n=D.p;try{return D.p=t,e()}finally{D.p=n}}(t.priority,function(){if(13===n.tag){var t=Nc();t=Et(t);var e=Ii(n,t);null!==e&&Rc(e,0,t),td(n,t)}})}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function xd(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=sd(t.nativeEvent);if(null!==n)return null!==(e=Gt(n))&&ed(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);Ce=i,n.target.dispatchEvent(i),Ce=null,e.shift()}return!0}function wd(t,e,n){xd(t)&&n.delete(e)}function Sd(){ud=!1,null!==hd&&xd(hd)&&(hd=null),null!==dd&&xd(dd)&&(dd=null),null!==fd&&xd(fd)&&(fd=null),pd.forEach(wd),md.forEach(wd)}function Pd(t,e){t.blockedOn===e&&(t.blockedOn=null,ud||(ud=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Sd)))}var Md=null;function Ad(t){Md!==t&&(Md=t,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Md===t&&(Md=null);for(var e=0;e<t.length;e+=3){var n=t[e],i=t[e+1],r=t[e+2];if("function"!==typeof i){if(null===ld(i||n))continue;break}var a=Gt(n);null!==a&&(t.splice(e,3),e-=3,Cs(a,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function kd(t){function e(e){return Pd(e,t)}null!==hd&&Pd(hd,t),null!==dd&&Pd(dd,t),null!==fd&&Pd(fd,t),pd.forEach(e),md.forEach(e);for(var n=0;n<gd.length;n++){var i=gd[n];i.blockedOn===t&&(i.blockedOn=null)}for(;0<gd.length&&null===(n=gd[0]).blockedOn;)bd(n),null===n.blockedOn&&gd.shift();if(null!=(n=(t.ownerDocument||t).$$reactFormReplay))for(i=0;i<n.length;i+=3){var r=n[i],a=n[i+1],s=r[zt]||null;if("function"===typeof a)s||Ad(n);else if(s){var o=null;if(a&&a.hasAttribute("formAction")){if(r=a,s=a[zt]||null)o=s.formAction;else if(null!==ld(r))continue}else o=s.action;"function"===typeof o?n[i+1]=o:(n.splice(i,3),i-=3),Ad(n)}}}function Ed(t){this._internalRoot=t}function Td(t){this._internalRoot=t}Td.prototype.render=Ed.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(s(409));$h(e.current,Nc(),t,e,null,null)},Td.prototype.unmount=Ed.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;$h(t.current,2,null,t,null,null),Uc(),e[Nt]=null}},Td.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ct();t={blockedOn:null,target:t,priority:e};for(var n=0;n<gd.length&&0!==e&&e<gd[n].priority;n++);gd.splice(n,0,t),0===n&&bd(t)}};var Cd=r.version;if("19.1.1"!==Cd)throw Error(s(527,Cd,"19.1.1"));D.findDOMNode=function(t){var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw t=Object.keys(t).join(","),Error(s(268,t))}return t=function(t){var e=t.alternate;if(!e){if(null===(e=l(t)))throw Error(s(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var a=r.alternate;if(null===a){if(null!==(i=r.return)){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return u(r),t;if(a===i)return u(r),e;a=a.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=a;else{for(var o=!1,c=r.child;c;){if(c===n){o=!0,n=r,i=a;break}if(c===i){o=!0,i=r,n=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===n){o=!0,n=a,i=r;break}if(c===i){o=!0,i=a,n=r;break}c=c.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?t:e}(e),t=null===(t=null!==t?h(t):null)?null:t.stateNode};var Id={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.1.1"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ld=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ld.isDisabled&&Ld.supportsFiber)try{ut=Ld.inject(Id),ht=Ld}catch(Nd){}}e.createRoot=function(t,e){if(!o(t))throw Error(s(299));var n=!1,i="",r=yo,a=vo,l=bo;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onUncaughtError&&(r=e.onUncaughtError),void 0!==e.onCaughtError&&(a=e.onCaughtError),void 0!==e.onRecoverableError&&(l=e.onRecoverableError),void 0!==e.unstable_transitionCallbacks&&e.unstable_transitionCallbacks),e=Kh(t,1,!1,null,0,n,i,r,a,l,0,null),t[Nt]=e.current,ju(t),new Ed(e)},e.hydrateRoot=function(t,e,n){if(!o(t))throw Error(s(299));var i=!1,r="",a=yo,l=vo,c=bo,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(a=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(e=Kh(t,1,!0,e,0,i,r,a,l,c,0,u)).context=Jh(null),n=e.current,(r=ra(i=Et(i=Nc()))).callback=null,aa(n,r,i),n=i,e.current.lanes=n,Mt(e,n),wu(e),t[Nt]=e.current,ju(t),new Td(e)},e.version="19.1.1"},7736:(t,e,n)=>{var i=n(3738).default,r=n(9045);t.exports=function(t){var e=r(t,"string");return"symbol"==i(e)?e:e+""},t.exports.__esModule=!0,t.exports.default=t.exports},7950:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(6672)},8853:(t,e,n)=>{"use strict";t.exports=n(5896)},9045:(t,e,n)=>{var i=n(3738).default;t.exports=function(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,n),a.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;n.t=function(i,r){if(1&r&&(i=this(i)),8&r)return i;if("object"===typeof i&&i){if(4&r&&i.__esModule)return i;if(16&r&&"function"===typeof i.then)return i}var a=Object.create(null);n.r(a);var s={};t=t||[null,e({}),e([]),e(e)];for(var o=2&r&&i;("object"==typeof o||"function"==typeof o)&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach(t=>s[t]=()=>i[t]);return s.default=()=>i,n.d(a,s),a}})(),n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce((e,i)=>(n.f[i](t,e),e),[])),n.u=t=>"static/js/"+t+"."+{239:"a3cf9850",453:"255dc8d6",455:"eea8b6f7",977:"23eaf12b"}[t]+".chunk.js",n.miniCssF=t=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="siteplan:";n.l=(i,r,a,s)=>{if(t[i])t[i].push(r);else{var o,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==e+a){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",e+a),o.src=i),t[i]=[r];var d=(e,n)=>{o.onerror=o.onload=null,clearTimeout(f);var r=t[i];if(delete t[i],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach(t=>t(n)),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/",(()=>{var t={792:0};n.f.j=(e,i)=>{var r=n.o(t,e)?t[e]:void 0;if(0!==r)if(r)i.push(r[2]);else{var a=new Promise((n,i)=>r=t[e]=[n,i]);i.push(r[2]=a);var s=n.p+n.u(e),o=new Error;n.l(s,i=>{if(n.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var a=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;o.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,r[1](o)}},"chunk-"+e,e)}};var e=(e,i)=>{var r,a,s=i[0],o=i[1],l=i[2],c=0;if(s.some(e=>0!==t[e])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(e&&e(i);c<s.length;c++)a=s[c],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0},i=self.webpackChunksiteplan=self.webpackChunksiteplan||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),(()=>{"use strict";var t={};n.r(t),n.d(t,{hasBrowserEnv:()=>St,hasStandardBrowserEnv:()=>Mt,hasStandardBrowserWebWorkerEnv:()=>At,navigator:()=>Pt,origin:()=>kt});var e=n(5043),i=n(4391),r=n(579);const a=[{label:"Water Bodies",value:"water"},{label:"Streets",value:"streets"},{label:"Buildings",value:"buildings"},{label:"Railways",value:"railways"}],s=t=>{let{selected:e,onChange:n}=t;return(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Select OSM Data Types"}),a.map(t=>(0,r.jsxs)("label",{style:{display:"block"},children:[(0,r.jsx)("input",{type:"checkbox",checked:e.includes(t.value),onChange:()=>{return i=t.value,void(e.includes(i)?n(e.filter(t=>t!==i)):n([...e,i]));var i}}),t.label]},t.value))]})};var o=n(4980);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach(function(e){(0,o.A)(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}const u=t=>{let{onExport:e,exportOptions:n,onExportOptionsChange:i}=t;const{scale:a,paperSize:s,orientation:o}=n;return(0,r.jsxs)("form",{style:{display:"flex",flexDirection:"column",gap:16},onSubmit:t=>{t.preventDefault(),e({scale:a,paperSize:s,orientation:o})},children:[(0,r.jsx)("div",{style:{fontWeight:600,fontSize:16,marginBottom:2,color:"#222"},children:"Export Map"}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,r.jsxs)("label",{style:{fontSize:14,color:"#333",fontWeight:500,marginBottom:2},children:["Scale",(0,r.jsx)("input",{type:"number",value:a,onChange:t=>i(c(c({},n),{},{scale:Number(t.target.value)})),style:{width:"100%",maxWidth:140,marginTop:4,padding:"8px 12px",borderRadius:8,border:"1.5px solid #e0e4ea",background:"rgba(255,255,255,0.7)",fontSize:15,fontWeight:500,outline:"none",boxShadow:"0 1px 4px rgba(0,0,0,0.03)",transition:"border 0.2s",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"}})]}),(0,r.jsxs)("label",{style:{fontSize:14,color:"#333",fontWeight:500,marginBottom:2},children:["Paper Size",(0,r.jsxs)("select",{value:s,onChange:t=>i(c(c({},n),{},{paperSize:t.target.value})),style:{width:"100%",marginTop:4,padding:"8px 12px",borderRadius:8,border:"1.5px solid #e0e4ea",background:"rgba(255,255,255,0.7)",fontSize:15,fontWeight:500,outline:"none",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",boxShadow:"0 1px 4px rgba(0,0,0,0.03)",transition:"border 0.2s"},children:[(0,r.jsx)("option",{value:"A4",children:"A4"}),(0,r.jsx)("option",{value:"A3",children:"A3"})]})]}),(0,r.jsxs)("label",{style:{fontSize:14,color:"#333",fontWeight:500,marginBottom:2},children:["Orientation",(0,r.jsxs)("select",{value:o,onChange:t=>i(c(c({},n),{},{orientation:t.target.value})),style:{width:"100%",marginTop:4,padding:"8px 12px",borderRadius:8,border:"1.5px solid #e0e4ea",background:"rgba(255,255,255,0.7)",fontSize:15,fontWeight:500,outline:"none",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",boxShadow:"0 1px 4px rgba(0,0,0,0.03)",transition:"border 0.2s"},children:[(0,r.jsx)("option",{value:"portrait",children:"Portrait"}),(0,r.jsx)("option",{value:"landscape",children:"Landscape"})]})]})]}),(0,r.jsx)("button",{type:"submit",style:{marginTop:8,width:"100%",padding:"12px 0",borderRadius:10,border:"none",background:"linear-gradient(90deg, #1976d2 0%, #21a1ff 100%)",color:"#fff",fontWeight:700,fontSize:16,letterSpacing:"0.03em",boxShadow:"0 2px 12px rgba(25,118,210,0.10)",cursor:"pointer",transition:"background 0.2s"},children:"Export as PDF"})]})},h=t=>{let{loading:n,error:i,selectedTypes:a,setSelectedTypes:o,exportOptions:l,setExportOptions:c,handleExport:h}=t;const[d,f]=(0,e.useState)(!0),[p,m]=(0,e.useState)(!0);return(0,r.jsxs)("div",{style:{position:"absolute",top:40,left:40,width:320,padding:32,background:"rgba(255,255,255,0.35)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.18)",backdropFilter:"blur(18px)",WebkitBackdropFilter:"blur(18px)",boxSizing:"border-box",overflowY:"auto",zIndex:20,display:"flex",flexDirection:"column",gap:0,transition:"width 0.3s cubic-bezier(.4,2,.6,1), padding 0.3s cubic-bezier(.4,2,.6,1)"},children:[(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:18},children:(0,r.jsx)("h2",{style:{fontWeight:700,fontSize:28,margin:0,letterSpacing:"-1px",color:"#222",textShadow:"0 1px 8px rgba(255,255,255,0.18)",flex:1,opacity:1,transition:"opacity 0.2s"},children:"Quick Site Plan"})}),(0,r.jsxs)("div",{style:{marginBottom:18},children:[(0,r.jsxs)("label",{style:{fontWeight:600,fontSize:15,color:"#222",marginBottom:8,display:"block",letterSpacing:"0.01em",cursor:"pointer"},onClick:()=>f(t=>!t),children:["Features",(0,r.jsx)("span",{style:{float:"right",fontSize:18,color:"#1976d2",transition:"transform 0.2s",transform:d?"rotate(90deg)":"rotate(0deg)"},children:"\u25b6"})]}),d&&(0,r.jsx)("div",{style:{background:"rgba(255,255,255,0.18)",borderRadius:12,padding:12,boxShadow:"0 1px 4px rgba(0,0,0,0.04)",transition:"max-height 0.3s",overflow:"hidden"},children:(0,r.jsx)(s,{selected:a,onChange:o})})]}),(0,r.jsx)("div",{style:{height:1,background:"rgba(0,0,0,0.07)",margin:"0 -32px 18px -32px"}}),(0,r.jsxs)("div",{style:{marginBottom:18},children:[(0,r.jsxs)("label",{style:{fontWeight:600,fontSize:15,color:"#222",marginBottom:8,display:"block",letterSpacing:"0.01em",cursor:"pointer"},onClick:()=>m(t=>!t),children:["Export",(0,r.jsx)("span",{style:{float:"right",fontSize:18,color:"#1976d2",transition:"transform 0.2s",transform:p?"rotate(90deg)":"rotate(0deg)"},children:"\u25b6"})]}),p&&(0,r.jsx)("div",{style:{background:"rgba(255,255,255,0.18)",borderRadius:12,padding:12,boxShadow:"0 1px 4px rgba(0,0,0,0.04)",transition:"max-height 0.3s",overflow:"hidden"},children:(0,r.jsx)(u,{onExport:t=>{let{scale:e,paperSize:n,orientation:i}=t;return h({scale:e,paperSize:n,orientation:i})},exportOptions:l,onExportOptionsChange:c})})]}),n&&(0,r.jsx)("div",{style:{color:"#333",fontWeight:500,marginTop:12,fontSize:15,letterSpacing:"0.01em"},children:"Loading OSM data..."}),i&&(0,r.jsx)("div",{style:{color:"#d32f2f",fontWeight:500,marginTop:12,fontSize:15,letterSpacing:"0.01em"},children:i})]})},d=t=>{let{size:e=28}=t;return(0,r.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,r.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,r.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})},f=t=>{let{size:e=28}=t;return(0,r.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,r.jsx)("line",{x1:"12",y1:"2",x2:"12",y2:"5"}),(0,r.jsx)("line",{x1:"12",y1:"19",x2:"12",y2:"22"}),(0,r.jsx)("line",{x1:"2",y1:"12",x2:"5",y2:"12"}),(0,r.jsx)("line",{x1:"19",y1:"12",x2:"22",y2:"12"})]})};var p=n(4066),m=n.n(p);const g=(0,e.forwardRef)((t,n)=>{let{styleUrl:i,bbox:a,onBboxChange:s,osmData:o,selectedTypes:l=["water","streets","buildings"]}=t;const c=(0,e.useRef)(null),u=(0,e.useRef)(null);(0,e.useEffect)(()=>{const t=u.current;if(!t)return;let e="frame-center-marker";function n(){if(!t||!t.isStyleLoaded())return;const n=t.getCenter();t&&(t.getSource(e)&&(t.removeLayer(e),t.removeSource(e)),t.addSource(e,{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[n.lng,n.lat]},properties:{}}}),t.addLayer({id:e,type:"circle",source:e,paint:{"circle-radius":7,"circle-color":"#1976d2","circle-stroke-width":2,"circle-stroke-color":"#fff"}}))}return t.isStyleLoaded()?n():t.once("styledata",n),t.on("move",n),()=>{t.off("move",n),t.getSource(e)&&(t.removeLayer(e),t.removeSource(e))}},[]),(0,e.useImperativeHandle)(n,()=>{var t;return null!==(t=u.current)&&void 0!==t?t:void 0},[u.current]);(0,e.useRef)(null);return(0,e.useEffect)(()=>(c.current&&!u.current&&(u.current=new(m().Map)({container:c.current,style:i,bounds:a,fitBoundsOptions:{padding:20}})),()=>{var t;null===(t=u.current)||void 0===t||t.remove(),u.current=null}),[i]),(0,e.useEffect)(()=>{if(!u.current)return;const t=u.current,[e,n,i,r]=a,s={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[[[e,n],[e,r],[i,r],[i,n],[e,n]]]},properties:{}}]};function o(){t.getSource("bbox")?t.getSource("bbox").setData(s):(t.addSource("bbox",{type:"geojson",data:s}),t.addLayer({id:"bbox-fill",type:"fill",source:"bbox",paint:{"fill-color":"#ff2222","fill-opacity":.08}}),t.addLayer({id:"bbox-visible",type:"line",source:"bbox",paint:{"line-color":"#ff2222","line-width":4,"line-dasharray":[2,2],"line-opacity":.9}}))}t.isStyleLoaded&&t.isStyleLoaded()?o():t.once("styledata",o)},[a]),(0,e.useEffect)(()=>{if(!u.current)return;const t=u.current;let e=!1;function n(){if(t&&!e&&(["osm-water","osm-streets","osm-buildings","osm-railways"].forEach(e=>{t.getLayer(e)&&t.removeLayer(e),t.getSource(e)&&t.removeSource(e)}),o&&o.elements)){const e=function(t){const e={};for(const i of t.elements)"node"===i.type&&(e[i.id]=[i.lon,i.lat]);const n=[];for(const i of t.elements)if("way"===i.type&&i.nodes){const t=i.nodes.map(t=>e[t]).filter(Boolean);t.length>1&&n.push({type:"Feature",geometry:{type:"LineString",coordinates:t},properties:i.tags||{}})}return{type:"FeatureCollection",features:n}}(o),n={type:"FeatureCollection",features:l&&l.includes("water")?e.features.filter(t=>t.properties&&(t.properties.waterway||"water"===t.properties.natural)):[]},i={type:"FeatureCollection",features:l&&l.includes("streets")?e.features.filter(t=>t.properties&&t.properties.highway):[]},r={type:"FeatureCollection",features:l&&l.includes("buildings")?e.features.filter(t=>t.properties&&t.properties.building):[]},a={type:"FeatureCollection",features:l&&l.includes("railways")?e.features.filter(t=>t.properties&&"rail"===t.properties.railway):[]};t.addSource("osm-water",{type:"geojson",data:n}),t.addSource("osm-streets",{type:"geojson",data:i}),t.addSource("osm-buildings",{type:"geojson",data:r}),t.addSource("osm-railways",{type:"geojson",data:a}),t.addLayer({id:"osm-water",type:"line",source:"osm-water",paint:{"line-color":"#3399ff","line-width":2}}),t.addLayer({id:"osm-railways",type:"line",source:"osm-railways",paint:{"line-color":"#444","line-width":2,"line-dasharray":[2,2]}}),t.addLayer({id:"osm-streets",type:"line",source:"osm-streets",paint:{"line-color":"#ff6600","line-width":2}}),t.addLayer({id:"osm-buildings",type:"line",source:"osm-buildings",paint:{"line-color":"#888888","line-width":2}})}}return t.isStyleLoaded&&t.isStyleLoaded()?n():t.once("styledata",n),()=>{e=!0}},[o,l]),(0,r.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[(0,r.jsx)("div",{ref:c,style:{width:"100%",height:"100%"}}),(0,r.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:100,pointerEvents:"none"},children:(0,r.jsxs)("svg",{width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",children:[(0,r.jsx)("circle",{cx:"14",cy:"14",r:"8",fill:"#fff",fillOpacity:"0.8"}),(0,r.jsx)("circle",{cx:"14",cy:"14",r:"7",fill:"#1976d2",fillOpacity:"0.9",stroke:"#fff",strokeWidth:"2"}),(0,r.jsx)("circle",{cx:"14",cy:"14",r:"3",fill:"#fff"})]})})]})}),_=g;function y(t,e){return function(){return t.apply(e,arguments)}}const{toString:v}=Object.prototype,{getPrototypeOf:b}=Object,{iterator:x,toStringTag:w}=Symbol,S=(P=Object.create(null),t=>{const e=v.call(t);return P[e]||(P[e]=e.slice(8,-1).toLowerCase())});var P;const M=t=>(t=t.toLowerCase(),e=>S(e)===t),A=t=>e=>typeof e===t,{isArray:k}=Array,E=A("undefined");function T(t){return null!==t&&!E(t)&&null!==t.constructor&&!E(t.constructor)&&L(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const C=M("ArrayBuffer");const I=A("string"),L=A("function"),z=A("number"),N=t=>null!==t&&"object"===typeof t,D=t=>{if("object"!==S(t))return!1;const e=b(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(w in t)&&!(x in t)},R=M("Date"),F=M("File"),O=M("Blob"),B=M("FileList"),j=M("URLSearchParams"),[U,G,q,V]=["ReadableStream","Request","Response","Headers"].map(M);function Z(t,e){let n,i,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),k(t))for(n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else{if(T(t))return;const i=r?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let s;for(n=0;n<a;n++)s=i[n],e.call(null,t[s],s,t)}}function W(t,e){if(T(t))return null;e=e.toLowerCase();const n=Object.keys(t);let i,r=n.length;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const H="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,X=t=>!E(t)&&t!==H;const Y=(K="undefined"!==typeof Uint8Array&&b(Uint8Array),t=>K&&t instanceof K);var K;const J=M("HTMLFormElement"),$=(t=>{let{hasOwnProperty:e}=t;return(t,n)=>e.call(t,n)})(Object.prototype),Q=M("RegExp"),tt=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};Z(n,(n,r)=>{let a;!1!==(a=e(n,r,t))&&(i[r]=a||n)}),Object.defineProperties(t,i)};const et=M("AsyncFunction"),nt=((t,e)=>{return t?setImmediate:e?(n="axios@".concat(Math.random()),i=[],H.addEventListener("message",t=>{let{source:e,data:r}=t;e===H&&r===n&&i.length&&i.shift()()},!1),t=>{i.push(t),H.postMessage(n,"*")}):t=>setTimeout(t);var n,i})("function"===typeof setImmediate,L(H.postMessage)),it="undefined"!==typeof queueMicrotask?queueMicrotask.bind(H):"undefined"!==typeof process&&process.nextTick||nt,rt={isArray:k,isArrayBuffer:C,isBuffer:T,isFormData:t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||L(t.append)&&("formdata"===(e=S(t))||"object"===e&&L(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&C(t.buffer),e},isString:I,isNumber:z,isBoolean:t=>!0===t||!1===t,isObject:N,isPlainObject:D,isEmptyObject:t=>{if(!N(t)||T(t))return!1;try{return 0===Object.keys(t).length&&Object.getPrototypeOf(t)===Object.prototype}catch(e){return!1}},isReadableStream:U,isRequest:G,isResponse:q,isHeaders:V,isUndefined:E,isDate:R,isFile:F,isBlob:O,isRegExp:Q,isFunction:L,isStream:t=>N(t)&&L(t.pipe),isURLSearchParams:j,isTypedArray:Y,isFileList:B,forEach:Z,merge:function t(){const{caseless:e,skipUndefined:n}=X(this)&&this||{},i={},r=(r,a)=>{const s=e&&W(i,a)||a;D(i[s])&&D(r)?i[s]=t(i[s],r):D(r)?i[s]=t({},r):k(r)?i[s]=r.slice():n&&E(r)||(i[s]=r)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&Z(arguments[a],r);return i},extend:function(t,e,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Z(e,(e,i)=>{n&&L(e)?t[i]=y(e,n):t[i]=e},{allOwnKeys:i}),t},trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,i)=>{let r,a,s;const o={};if(e=e||{},null==t)return e;do{for(r=Object.getOwnPropertyNames(t),a=r.length;a-- >0;)s=r[a],i&&!i(s,t,e)||o[s]||(e[s]=t[s],o[s]=!0);t=!1!==n&&b(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:S,kindOfTest:M,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return-1!==i&&i===n},toArray:t=>{if(!t)return null;if(k(t))return t;let e=t.length;if(!z(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[x]).call(t);let i;for(;(i=n.next())&&!i.done;){const n=i.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const i=[];for(;null!==(n=t.exec(e));)i.push(n);return i},isHTMLForm:J,hasOwnProperty:$,hasOwnProp:$,reduceDescriptors:tt,freezeMethods:t=>{tt(t,(e,n)=>{if(L(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=t[n];L(i)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(t,e)=>{const n={},i=t=>{t.forEach(t=>{n[t]=!0})};return k(t)?i(t):i(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,e,n){return e.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:W,global:H,isContextDefined:X,isSpecCompliantForm:function(t){return!!(t&&L(t.append)&&"FormData"===t[w]&&t[x])},toJSONObject:t=>{const e=new Array(10),n=(t,i)=>{if(N(t)){if(e.indexOf(t)>=0)return;if(T(t))return t;if(!("toJSON"in t)){e[i]=t;const r=k(t)?[]:{};return Z(t,(t,e)=>{const a=n(t,i+1);!E(a)&&(r[e]=a)}),e[i]=void 0,r}}return t};return n(t,0)},isAsyncFn:et,isThenable:t=>t&&(N(t)||L(t))&&L(t.then)&&L(t.catch),setImmediate:nt,asap:it,isIterable:t=>null!=t&&L(t[x])};function at(t,e,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}rt.inherits(at,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:rt.toJSONObject(this.config),code:this.code,status:this.status}}});const st=at.prototype,ot={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{ot[t]={value:t}}),Object.defineProperties(at,ot),Object.defineProperty(st,"isAxiosError",{value:!0}),at.from=(t,e,n,i,r,a)=>{const s=Object.create(st);rt.toFlatObject(t,s,function(t){return t!==Error.prototype},t=>"isAxiosError"!==t);const o=t&&t.message?t.message:"Error",l=null==e&&t?t.code:e;return at.call(s,o,l,n,i,r),t&&null==s.cause&&Object.defineProperty(s,"cause",{value:t,configurable:!0}),s.name=t&&t.name||"Error",a&&Object.assign(s,a),s};const lt=at;function ct(t){return rt.isPlainObject(t)||rt.isArray(t)}function ut(t){return rt.endsWith(t,"[]")?t.slice(0,-2):t}function ht(t,e,n){return t?t.concat(e).map(function(t,e){return t=ut(t),!n&&e?"["+t+"]":t}).join(n?".":""):e}const dt=rt.toFlatObject(rt,{},null,function(t){return/^is[A-Z]/.test(t)});const ft=function(t,e,n){if(!rt.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const i=(n=rt.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(t,e){return!rt.isUndefined(e[t])})).metaTokens,r=n.visitor||c,a=n.dots,s=n.indexes,o=(n.Blob||"undefined"!==typeof Blob&&Blob)&&rt.isSpecCompliantForm(e);if(!rt.isFunction(r))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(rt.isDate(t))return t.toISOString();if(rt.isBoolean(t))return t.toString();if(!o&&rt.isBlob(t))throw new lt("Blob is not supported. Use a Buffer instead.");return rt.isArrayBuffer(t)||rt.isTypedArray(t)?o&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,n,r){let o=t;if(t&&!r&&"object"===typeof t)if(rt.endsWith(n,"{}"))n=i?n:n.slice(0,-2),t=JSON.stringify(t);else if(rt.isArray(t)&&function(t){return rt.isArray(t)&&!t.some(ct)}(t)||(rt.isFileList(t)||rt.endsWith(n,"[]"))&&(o=rt.toArray(t)))return n=ut(n),o.forEach(function(t,i){!rt.isUndefined(t)&&null!==t&&e.append(!0===s?ht([n],i,a):null===s?n:n+"[]",l(t))}),!1;return!!ct(t)||(e.append(ht(r,n,a),l(t)),!1)}const u=[],h=Object.assign(dt,{defaultVisitor:c,convertValue:l,isVisitable:ct});if(!rt.isObject(t))throw new TypeError("data must be an object");return function t(n,i){if(!rt.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),rt.forEach(n,function(n,a){!0===(!(rt.isUndefined(n)||null===n)&&r.call(e,n,rt.isString(a)?a.trim():a,i,h))&&t(n,i?i.concat(a):[a])}),u.pop()}}(t),e};function pt(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function mt(t,e){this._pairs=[],t&&ft(t,this,e)}const gt=mt.prototype;gt.append=function(t,e){this._pairs.push([t,e])},gt.toString=function(t){const e=t?function(e){return t.call(this,e,pt)}:pt;return this._pairs.map(function(t){return e(t[0])+"="+e(t[1])},"").join("&")};const _t=mt;function yt(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function vt(t,e,n){if(!e)return t;const i=n&&n.encode||yt;rt.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let a;if(a=r?r(e,n):rt.isURLSearchParams(e)?e.toString():new _t(e,n).toString(i),a){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+a}return t}const bt=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){rt.forEach(this.handlers,function(e){null!==e&&t(e)})}},xt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wt={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:_t,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},St="undefined"!==typeof window&&"undefined"!==typeof document,Pt="object"===typeof navigator&&navigator||void 0,Mt=St&&(!Pt||["ReactNative","NativeScript","NS"].indexOf(Pt.product)<0),At="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,kt=St&&window.location.href||"http://localhost",Et=c(c({},t),wt);const Tt=function(t){function e(t,n,i,r){let a=t[r++];if("__proto__"===a)return!0;const s=Number.isFinite(+a),o=r>=t.length;if(a=!a&&rt.isArray(i)?i.length:a,o)return rt.hasOwnProp(i,a)?i[a]=[i[a],n]:i[a]=n,!s;i[a]&&rt.isObject(i[a])||(i[a]=[]);return e(t,n,i[a],r)&&rt.isArray(i[a])&&(i[a]=function(t){const e={},n=Object.keys(t);let i;const r=n.length;let a;for(i=0;i<r;i++)a=n[i],e[a]=t[a];return e}(i[a])),!s}if(rt.isFormData(t)&&rt.isFunction(t.entries)){const n={};return rt.forEachEntry(t,(t,i)=>{e(function(t){return rt.matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}(t),i,n,0)}),n}return null};const Ct={transitional:xt,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,r=rt.isObject(t);r&&rt.isHTMLForm(t)&&(t=new FormData(t));if(rt.isFormData(t))return i?JSON.stringify(Tt(t)):t;if(rt.isArrayBuffer(t)||rt.isBuffer(t)||rt.isStream(t)||rt.isFile(t)||rt.isBlob(t)||rt.isReadableStream(t))return t;if(rt.isArrayBufferView(t))return t.buffer;if(rt.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return ft(t,new Et.classes.URLSearchParams,c({visitor:function(t,e,n,i){return Et.isNode&&rt.isBuffer(t)?(this.append(e,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((a=rt.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return ft(a?{"files[]":t}:t,e&&new e,this.formSerializer)}}return r||i?(e.setContentType("application/json",!1),function(t,e,n){if(rt.isString(t))try{return(e||JSON.parse)(t),rt.trim(t)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||Ct.transitional,n=e&&e.forcedJSONParsing,i="json"===this.responseType;if(rt.isResponse(t)||rt.isReadableStream(t))return t;if(t&&rt.isString(t)&&(n&&!this.responseType||i)){const n=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(r){if(n){if("SyntaxError"===r.name)throw lt.from(r,lt.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Et.classes.FormData,Blob:Et.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};rt.forEach(["delete","get","head","post","put","patch"],t=>{Ct.headers[t]={}});const It=Ct,Lt=rt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),zt=Symbol("internals");function Nt(t){return t&&String(t).trim().toLowerCase()}function Dt(t){return!1===t||null==t?t:rt.isArray(t)?t.map(Dt):String(t)}function Rt(t,e,n,i,r){return rt.isFunction(i)?i.call(this,e,n):(r&&(e=n),rt.isString(e)?rt.isString(i)?-1!==e.indexOf(i):rt.isRegExp(i)?i.test(e):void 0:void 0)}class Ft{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function r(t,e,n){const r=Nt(e);if(!r)throw new Error("header name must be a non-empty string");const a=rt.findKey(i,r);(!a||void 0===i[a]||!0===n||void 0===n&&!1!==i[a])&&(i[a||e]=Dt(t))}const a=(t,e)=>rt.forEach(t,(t,n)=>r(t,n,e));if(rt.isPlainObject(t)||t instanceof this.constructor)a(t,e);else if(rt.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))a((t=>{const e={};let n,i,r;return t&&t.split("\n").forEach(function(t){r=t.indexOf(":"),n=t.substring(0,r).trim().toLowerCase(),i=t.substring(r+1).trim(),!n||e[n]&&Lt[n]||("set-cookie"===n?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)}),e})(t),e);else if(rt.isObject(t)&&rt.isIterable(t)){let n,i,r={};for(const e of t){if(!rt.isArray(e))throw TypeError("Object iterator must return a key-value pair");r[i=e[0]]=(n=r[i])?rt.isArray(n)?[...n,e[1]]:[n,e[1]]:e[1]}a(r,e)}else null!=t&&r(e,t,n);return this}get(t,e){if(t=Nt(t)){const n=rt.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}(t);if(rt.isFunction(e))return e.call(this,t,n);if(rt.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Nt(t)){const n=rt.findKey(this,t);return!(!n||void 0===this[n]||e&&!Rt(0,this[n],n,e))}return!1}delete(t,e){const n=this;let i=!1;function r(t){if(t=Nt(t)){const r=rt.findKey(n,t);!r||e&&!Rt(0,n[r],r,e)||(delete n[r],i=!0)}}return rt.isArray(t)?t.forEach(r):r(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;for(;n--;){const r=e[n];t&&!Rt(0,this[r],r,t,!0)||(delete this[r],i=!0)}return i}normalize(t){const e=this,n={};return rt.forEach(this,(i,r)=>{const a=rt.findKey(n,r);if(a)return e[a]=Dt(i),void delete e[r];const s=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}(r):String(r).trim();s!==r&&delete e[r],e[s]=Dt(i),n[s]=!0}),this}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return rt.forEach(this,(n,i)=>{null!=n&&!1!==n&&(e[i]=t&&rt.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(t=>{let[e,n]=t;return e+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.forEach(t=>e.set(t)),e}static accessor(t){const e=(this[zt]=this[zt]={accessors:{}}).accessors,n=this.prototype;function i(t){const i=Nt(t);e[i]||(!function(t,e){const n=rt.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+n,{value:function(t,n,r){return this[i].call(this,e,t,n,r)},configurable:!0})})}(n,t),e[i]=!0)}return rt.isArray(t)?t.forEach(i):i(t),this}}Ft.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),rt.reduceDescriptors(Ft.prototype,(t,e)=>{let{value:n}=t,i=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(t){this[i]=t}}}),rt.freezeMethods(Ft);const Ot=Ft;function Bt(t,e){const n=this||It,i=e||n,r=Ot.from(i.headers);let a=i.data;return rt.forEach(t,function(t){a=t.call(n,a,r.normalize(),e?e.status:void 0)}),r.normalize(),a}function jt(t){return!(!t||!t.__CANCEL__)}function Ut(t,e,n){lt.call(this,null==t?"canceled":t,lt.ERR_CANCELED,e,n),this.name="CanceledError"}rt.inherits(Ut,lt,{__CANCEL__:!0});const Gt=Ut;function qt(t,e,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(new lt("Request failed with status code "+n.status,[lt.ERR_BAD_REQUEST,lt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}const Vt=function(t,e){t=t||10;const n=new Array(t),i=new Array(t);let r,a=0,s=0;return e=void 0!==e?e:1e3,function(o){const l=Date.now(),c=i[s];r||(r=l),n[a]=o,i[a]=l;let u=s,h=0;for(;u!==a;)h+=n[u++],u%=t;if(a=(a+1)%t,a===s&&(s=(s+1)%t),l-r<e)return;const d=c&&l-c;return d?Math.round(1e3*h/d):void 0}};const Zt=function(t,e){let n,i,r=0,a=1e3/e;const s=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();r=a,n=null,i&&(clearTimeout(i),i=null),t(...e)};return[function(){const t=Date.now(),e=t-r;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];e>=a?s(l,t):(n=l,i||(i=setTimeout(()=>{i=null,s(n)},a-e)))},()=>n&&s(n)]},Wt=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0;const r=Vt(50,250);return Zt(n=>{const a=n.loaded,s=n.lengthComputable?n.total:void 0,o=a-i,l=r(o);i=a;t({loaded:a,total:s,progress:s?a/s:void 0,bytes:o,rate:l||void 0,estimated:l&&s&&a<=s?(s-a)/l:void 0,event:n,lengthComputable:null!=s,[e?"download":"upload"]:!0})},n)},Ht=(t,e)=>{const n=null!=t;return[i=>e[0]({lengthComputable:n,total:t,loaded:i}),e[1]]},Xt=t=>function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return rt.asap(()=>t(...n))},Yt=Et.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Et.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Et.origin),Et.navigator&&/(msie|trident)/i.test(Et.navigator.userAgent)):()=>!0,Kt=Et.hasStandardBrowserEnv?{write(t,e,n,i,r,a){const s=[t+"="+encodeURIComponent(e)];rt.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),rt.isString(i)&&s.push("path="+i),rt.isString(r)&&s.push("domain="+r),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Jt(t,e,n){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(i||0==n)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const $t=t=>t instanceof Ot?c({},t):t;function Qt(t,e){e=e||{};const n={};function i(t,e,n,i){return rt.isPlainObject(t)&&rt.isPlainObject(e)?rt.merge.call({caseless:i},t,e):rt.isPlainObject(e)?rt.merge({},e):rt.isArray(e)?e.slice():e}function r(t,e,n,r){return rt.isUndefined(e)?rt.isUndefined(t)?void 0:i(void 0,t,0,r):i(t,e,0,r)}function a(t,e){if(!rt.isUndefined(e))return i(void 0,e)}function s(t,e){return rt.isUndefined(e)?rt.isUndefined(t)?void 0:i(void 0,t):i(void 0,e)}function o(n,r,a){return a in e?i(n,r):a in t?i(void 0,n):void 0}const l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:o,headers:(t,e,n)=>r($t(t),$t(e),0,!0)};return rt.forEach(Object.keys(c(c({},t),e)),function(i){const a=l[i]||r,s=a(t[i],e[i],i);rt.isUndefined(s)&&a!==o||(n[i]=s)}),n}const te=t=>{const e=Qt({},t);let{data:n,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:a,headers:s,auth:o}=e;if(e.headers=s=Ot.from(s),e.url=vt(Jt(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&s.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),rt.isFormData(n))if(Et.hasStandardBrowserEnv||Et.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(rt.isFunction(n.getHeaders)){const t=n.getHeaders(),e=["content-type","content-length"];Object.entries(t).forEach(t=>{let[n,i]=t;e.includes(n.toLowerCase())&&s.set(n,i)})}if(Et.hasStandardBrowserEnv&&(i&&rt.isFunction(i)&&(i=i(e)),i||!1!==i&&Yt(e.url))){const t=r&&a&&Kt.read(a);t&&s.set(r,t)}return e},ee="undefined"!==typeof XMLHttpRequest&&function(t){return new Promise(function(e,n){const i=te(t);let r=i.data;const a=Ot.from(i.headers).normalize();let s,o,l,c,u,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=i;function p(){c&&c(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(s),i.signal&&i.signal.removeEventListener("abort",s)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=Ot.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());qt(function(t){e(t),p()},function(t){n(t),p()},{data:h&&"text"!==h&&"json"!==h?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:t,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new lt("Request aborted",lt.ECONNABORTED,t,m)),m=null)},m.onerror=function(e){const i=e&&e.message?e.message:"Network Error",r=new lt(i,lt.ERR_NETWORK,t,m);r.event=e||null,n(r),m=null},m.ontimeout=function(){let e=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||xt;i.timeoutErrorMessage&&(e=i.timeoutErrorMessage),n(new lt(e,r.clarifyTimeoutError?lt.ETIMEDOUT:lt.ECONNABORTED,t,m)),m=null},void 0===r&&a.setContentType(null),"setRequestHeader"in m&&rt.forEach(a.toJSON(),function(t,e){m.setRequestHeader(e,t)}),rt.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),h&&"json"!==h&&(m.responseType=i.responseType),f&&([l,u]=Wt(f,!0),m.addEventListener("progress",l)),d&&m.upload&&([o,c]=Wt(d),m.upload.addEventListener("progress",o),m.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(s=e=>{m&&(n(!e||e.type?new Gt(null,t,m):e),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(s),i.signal&&(i.signal.aborted?s():i.signal.addEventListener("abort",s)));const _=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(i.url);_&&-1===Et.protocols.indexOf(_)?n(new lt("Unsupported protocol "+_+":",lt.ERR_BAD_REQUEST,t)):m.send(r||null)})},ne=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let n,i=new AbortController;const r=function(t){if(!n){n=!0,s();const e=t instanceof Error?t:this.reason;i.abort(e instanceof lt?e:new Gt(e instanceof Error?e.message:e))}};let a=e&&setTimeout(()=>{a=null,r(new lt("timeout ".concat(e," of ms exceeded"),lt.ETIMEDOUT))},e);const s=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(t=>{t.unsubscribe?t.unsubscribe(r):t.removeEventListener("abort",r)}),t=null)};t.forEach(t=>t.addEventListener("abort",r));const{signal:o}=i;return o.unsubscribe=()=>rt.asap(s),o}};function ie(t,e){this.v=t,this.k=e}function re(t){return function(){return new ae(t.apply(this,arguments))}}function ae(t){var e,n;function i(e,n){try{var a=t[e](n),s=a.value,o=s instanceof ie;Promise.resolve(o?s.v:s).then(function(n){if(o){var l="return"===e?"return":"next";if(!s.k||n.done)return i(l,n);n=t[l](n).value}r(a.done?"return":"normal",n)},function(t){i("throw",t)})}catch(t){r("throw",t)}}function r(t,r){switch(t){case"return":e.resolve({value:r,done:!0});break;case"throw":e.reject(r);break;default:e.resolve({value:r,done:!1})}(e=e.next)?i(e.key,e.arg):n=null}this._invoke=function(t,r){return new Promise(function(a,s){var o={key:t,arg:r,resolve:a,reject:s,next:null};n?n=n.next=o:(e=n=o,i(t,r))})},"function"!=typeof t.return&&(this.return=void 0)}function se(t){return new ie(t,0)}function oe(t){var e={},n=!1;function i(e,i){return n=!0,i=new Promise(function(n){n(t[e](i))}),{done:!1,value:new ie(i,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(t){return n?(n=!1,t):i("next",t)},"function"==typeof t.throw&&(e.throw=function(t){if(n)throw n=!1,t;return i("throw",t)}),"function"==typeof t.return&&(e.return=function(t){return n?(n=!1,t):i("return",t)}),e}function le(t){var e,n,i,r=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(e=t[n]))return e.call(t);if(i&&null!=(e=t[i]))return new ce(e.call(t));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function ce(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then(function(t){return{value:t,done:e}})}return ce=function(t){this.s=t,this.n=t.next},ce.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var n=this.s.return;return void 0===n?Promise.resolve({value:t,done:!0}):e(n.apply(this.s,arguments))},throw:function(t){var n=this.s.return;return void 0===n?Promise.reject(t):e(n.apply(this.s,arguments))}},new ce(t)}ae.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},ae.prototype.next=function(t){return this._invoke("next",t)},ae.prototype.throw=function(t){return this._invoke("throw",t)},ae.prototype.return=function(t){return this._invoke("return",t)};const ue=function*(t,e){let n=t.byteLength;if(!e||n<e)return void(yield t);let i,r=0;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},he=function(){var t=re(function*(t,e){var n,i=!1,r=!1;try{for(var a,s=le(de(t));i=!(a=yield se(s.next())).done;i=!1){const t=a.value;yield*oe(le(ue(t,e)))}}catch(o){r=!0,n=o}finally{try{i&&null!=s.return&&(yield se(s.return()))}finally{if(r)throw n}}});return function(e,n){return t.apply(this,arguments)}}(),de=function(){var t=re(function*(t){if(t[Symbol.asyncIterator])return void(yield*oe(le(t)));const e=t.getReader();try{for(;;){const{done:t,value:n}=yield se(e.read());if(t)break;yield n}}finally{yield se(e.cancel())}});return function(e){return t.apply(this,arguments)}}(),fe=(t,e,n,i)=>{const r=he(t,e);let a,s=0,o=t=>{a||(a=!0,i&&i(t))};return new ReadableStream({async pull(t){try{const{done:e,value:i}=await r.next();if(e)return o(),void t.close();let a=i.byteLength;if(n){let t=s+=a;n(t)}t.enqueue(new Uint8Array(i))}catch(e){throw o(e),e}},cancel:t=>(o(t),r.return())},{highWaterMark:2})},{isFunction:pe}=rt,me=(t=>{let{Request:e,Response:n}=t;return{Request:e,Response:n}})(rt.global),{ReadableStream:ge,TextEncoder:_e}=rt.global,ye=function(t){try{for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return!!t(...n)}catch(r){return!1}},ve=t=>{t=rt.merge.call({skipUndefined:!0},me,t);const{fetch:e,Request:n,Response:i}=t,r=e?pe(e):"function"===typeof fetch,a=pe(n),s=pe(i);if(!r)return!1;const o=r&&pe(ge),l=r&&("function"===typeof _e?(t=>e=>t.encode(e))(new _e):async t=>new Uint8Array(await new n(t).arrayBuffer())),u=a&&o&&ye(()=>{let t=!1;const e=new n(Et.origin,{body:new ge,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),h=s&&o&&ye(()=>rt.isReadableStream(new i("").body)),d={stream:h&&(t=>t.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!d[t]&&(d[t]=(e,n)=>{let i=e&&e[t];if(i)return i.call(e);throw new lt("Response type '".concat(t,"' is not supported"),lt.ERR_NOT_SUPPORT,n)})});const f=async(t,e)=>{const i=rt.toFiniteNumber(t.getContentLength());return null==i?(async t=>{if(null==t)return 0;if(rt.isBlob(t))return t.size;if(rt.isSpecCompliantForm(t)){const e=new n(Et.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return rt.isArrayBufferView(t)||rt.isArrayBuffer(t)?t.byteLength:(rt.isURLSearchParams(t)&&(t+=""),rt.isString(t)?(await l(t)).byteLength:void 0)})(e):i};return async t=>{let{url:r,method:s,data:o,signal:l,cancelToken:p,timeout:m,onDownloadProgress:g,onUploadProgress:_,responseType:y,headers:v,withCredentials:b="same-origin",fetchOptions:x}=te(t),w=e||fetch;y=y?(y+"").toLowerCase():"text";let S=ne([l,p&&p.toAbortSignal()],m),P=null;const M=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let A;try{if(_&&u&&"get"!==s&&"head"!==s&&0!==(A=await f(v,o))){let t,e=new n(r,{method:"POST",body:o,duplex:"half"});if(rt.isFormData(o)&&(t=e.headers.get("content-type"))&&v.setContentType(t),e.body){const[t,n]=Ht(A,Wt(Xt(_)));o=fe(e.body,65536,t,n)}}rt.isString(b)||(b=b?"include":"omit");const e=a&&"credentials"in n.prototype,l=c(c({},x),{},{signal:S,method:s.toUpperCase(),headers:v.normalize().toJSON(),body:o,duplex:"half",credentials:e?b:void 0});P=a&&new n(r,l);let p=await(a?w(P,x):w(r,l));const m=h&&("stream"===y||"response"===y);if(h&&(g||m&&M)){const t={};["status","statusText","headers"].forEach(e=>{t[e]=p[e]});const e=rt.toFiniteNumber(p.headers.get("content-length")),[n,r]=g&&Ht(e,Wt(Xt(g),!0))||[];p=new i(fe(p.body,65536,n,()=>{r&&r(),M&&M()}),t)}y=y||"text";let k=await d[rt.findKey(d,y)||"text"](p,t);return!m&&M&&M(),await new Promise((e,n)=>{qt(e,n,{data:k,headers:Ot.from(p.headers),status:p.status,statusText:p.statusText,config:t,request:P})})}catch(k){if(M&&M(),k&&"TypeError"===k.name&&/Load failed|fetch/i.test(k.message))throw Object.assign(new lt("Network Error",lt.ERR_NETWORK,t,P),{cause:k.cause||k});throw lt.from(k,k&&k.code,t,P)}}},be=new Map,xe=t=>{let e=t?t.env:{};const{fetch:n,Request:i,Response:r}=e,a=[i,r,n];let s,o,l=a.length,c=be;for(;l--;)s=a[l],o=c.get(s),void 0===o&&c.set(s,o=l?new Map:ve(e)),c=o;return o},we=(xe(),{http:null,xhr:ee,fetch:{get:xe}});rt.forEach(we,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(n){}Object.defineProperty(t,"adapterName",{value:e})}});const Se=t=>"- ".concat(t),Pe=t=>rt.isFunction(t)||null===t||!1===t,Me=(t,e)=>{t=rt.isArray(t)?t:[t];const{length:n}=t;let i,r;const a={};for(let s=0;s<n;s++){let n;if(i=t[s],r=i,!Pe(i)&&(r=we[(n=String(i)).toLowerCase()],void 0===r))throw new lt("Unknown adapter '".concat(n,"'"));if(r&&(rt.isFunction(r)||(r=r.get(e))))break;a[n||"#"+s]=r}if(!r){const t=Object.entries(a).map(t=>{let[e,n]=t;return"adapter ".concat(e," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let e=n?t.length>1?"since :\n"+t.map(Se).join("\n"):" "+Se(t[0]):"as no adapter specified";throw new lt("There is no suitable adapter to dispatch the request "+e,"ERR_NOT_SUPPORT")}return r};function Ae(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Gt(null,t)}function ke(t){Ae(t),t.headers=Ot.from(t.headers),t.data=Bt.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return Me(t.adapter||It.adapter,t)(t).then(function(e){return Ae(t),e.data=Bt.call(t,t.transformResponse,e),e.headers=Ot.from(e.headers),e},function(e){return jt(e)||(Ae(t),e&&e.response&&(e.response.data=Bt.call(t,t.transformResponse,e.response),e.response.headers=Ot.from(e.response.headers))),Promise.reject(e)})}const Ee="1.12.2",Te={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Te[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const Ce={};Te.transitional=function(t,e,n){function i(t,e){return"[Axios v"+Ee+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,r,a)=>{if(!1===t)throw new lt(i(r," has been removed"+(e?" in "+e:"")),lt.ERR_DEPRECATED);return e&&!Ce[r]&&(Ce[r]=!0,console.warn(i(r," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,r,a)}},Te.spelling=function(t){return(e,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(t)),!0)};const Ie={assertOptions:function(t,e,n){if("object"!==typeof t)throw new lt("options must be an object",lt.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let r=i.length;for(;r-- >0;){const a=i[r],s=e[a];if(s){const e=t[a],n=void 0===e||s(e,a,t);if(!0!==n)throw new lt("option "+a+" must be "+n,lt.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new lt("Unknown option "+a,lt.ERR_BAD_OPTION)}},validators:Te},Le=Ie.validators;class ze{constructor(t){this.defaults=t||{},this.interceptors={request:new bt,response:new bt}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const e=t.stack?t.stack.replace(/^.+\n/,""):"";try{n.stack?e&&!String(n.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+e):n.stack=e}catch(i){}}throw n}}_request(t,e){"string"===typeof t?(e=e||{}).url=t:e=t||{},e=Qt(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:r}=e;void 0!==n&&Ie.assertOptions(n,{silentJSONParsing:Le.transitional(Le.boolean),forcedJSONParsing:Le.transitional(Le.boolean),clarifyTimeoutError:Le.transitional(Le.boolean)},!1),null!=i&&(rt.isFunction(i)?e.paramsSerializer={serialize:i}:Ie.assertOptions(i,{encode:Le.function,serialize:Le.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Ie.assertOptions(e,{baseUrl:Le.spelling("baseURL"),withXsrfToken:Le.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let a=r&&rt.merge(r.common,r[e.method]);r&&rt.forEach(["delete","get","head","post","put","patch","common"],t=>{delete r[t]}),e.headers=Ot.concat(a,r);const s=[];let o=!0;this.interceptors.request.forEach(function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,s.unshift(t.fulfilled,t.rejected))});const l=[];let c;this.interceptors.response.forEach(function(t){l.push(t.fulfilled,t.rejected)});let u,h=0;if(!o){const t=[ke.bind(this),void 0];for(t.unshift(...s),t.push(...l),u=t.length,c=Promise.resolve(e);h<u;)c=c.then(t[h++],t[h++]);return c}u=s.length;let d=e;for(;h<u;){const t=s[h++],e=s[h++];try{d=t(d)}catch(f){e.call(this,f);break}}try{c=ke.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(t){return vt(Jt((t=Qt(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}}rt.forEach(["delete","get","head","options"],function(t){ze.prototype[t]=function(e,n){return this.request(Qt(n||{},{method:t,url:e,data:(n||{}).data}))}}),rt.forEach(["post","put","patch"],function(t){function e(e){return function(n,i,r){return this.request(Qt(r||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}ze.prototype[t]=e(),ze.prototype[t+"Form"]=e(!0)});const Ne=ze;class De{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(t){e=t});const n=this;this.promise.then(t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null}),this.promise.then=t=>{let e;const i=new Promise(t=>{n.subscribe(t),e=t}).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t(function(t,i,r){n.reason||(n.reason=new Gt(t,i,r),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;const e=new De(function(e){t=e});return{token:e,cancel:t}}}const Re=De;const Fe={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Fe).forEach(t=>{let[e,n]=t;Fe[n]=e});const Oe=Fe;const Be=function t(e){const n=new Ne(e),i=y(Ne.prototype.request,n);return rt.extend(i,Ne.prototype,n,{allOwnKeys:!0}),rt.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return t(Qt(e,n))},i}(It);Be.Axios=Ne,Be.CanceledError=Gt,Be.CancelToken=Re,Be.isCancel=jt,Be.VERSION=Ee,Be.toFormData=ft,Be.AxiosError=lt,Be.Cancel=Be.CanceledError,Be.all=function(t){return Promise.all(t)},Be.spread=function(t){return function(e){return t.apply(null,e)}},Be.isAxiosError=function(t){return rt.isObject(t)&&!0===t.isAxiosError},Be.mergeConfig=Qt,Be.AxiosHeaders=Ot,Be.formToJSON=t=>Tt(rt.isHTMLForm(t)?new FormData(t):t),Be.getAdapter=Me,Be.HttpStatusCode=Oe,Be.default=Be;const je=Be,Ue={water:'way["natural"="water"]',streets:'way["highway"]',buildings:'way["building"]',railways:'way["railway"="rail"]'};var Ge=n(2284),qe=Uint8Array,Ve=Uint16Array,Ze=Int32Array,We=new qe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),He=new qe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Xe=new qe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ye=function(t,e){for(var n=new Ve(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var r=new Ze(n[30]);for(i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)r[a]=a-n[i]<<5|i;return{b:n,r:r}},Ke=Ye(We,2),Je=Ke.b,$e=Ke.r;Je[28]=258,$e[258]=28;for(var Qe=Ye(He,0),tn=(Qe.b,Qe.r),en=new Ve(32768),nn=0;nn<32768;++nn){var rn=(43690&nn)>>1|(21845&nn)<<1;rn=(61680&(rn=(52428&rn)>>2|(13107&rn)<<2))>>4|(3855&rn)<<4,en[nn]=((65280&rn)>>8|(255&rn)<<8)>>1}var an=function(t,e,n){for(var i=t.length,r=0,a=new Ve(e);r<i;++r)t[r]&&++a[t[r]-1];var s,o=new Ve(e);for(r=1;r<e;++r)o[r]=o[r-1]+a[r-1]<<1;if(n){s=new Ve(1<<e);var l=15-e;for(r=0;r<i;++r)if(t[r])for(var c=r<<4|t[r],u=e-t[r],h=o[t[r]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)s[en[h]>>l]=c}else for(s=new Ve(i),r=0;r<i;++r)t[r]&&(s[r]=en[o[t[r]-1]++]>>15-t[r]);return s},sn=new qe(288);for(nn=0;nn<144;++nn)sn[nn]=8;for(nn=144;nn<256;++nn)sn[nn]=9;for(nn=256;nn<280;++nn)sn[nn]=7;for(nn=280;nn<288;++nn)sn[nn]=8;var on=new qe(32);for(nn=0;nn<32;++nn)on[nn]=5;var ln=an(sn,9,0),cn=an(on,5,0),un=function(t){return(t+7)/8|0},hn=function(t,e,n){return(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length),new qe(t.subarray(e,n))},dn=function(t,e,n){n<<=7&e;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8},fn=function(t,e,n){n<<=7&e;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8,t[i+2]|=n>>16},pn=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var r=n.length,a=n.slice();if(!r)return{t:xn,l:0};if(1==r){var s=new qe(n[0].s+1);return s[n[0].s]=1,{t:s,l:1}}n.sort(function(t,e){return t.f-e.f}),n.push({s:-1,f:25001});var o=n[0],l=n[1],c=0,u=1,h=2;for(n[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=r-1;)o=n[n[c].f<n[h].f?c++:h++],l=n[c!=u&&n[c].f<n[h].f?c++:h++],n[u++]={s:-1,f:o.f+l.f,l:o,r:l};var d=a[0].s;for(i=1;i<r;++i)a[i].s>d&&(d=a[i].s);var f=new Ve(d+1),p=mn(n[u-1],f,0);if(p>e){i=0;var m=0,g=p-e,_=1<<g;for(a.sort(function(t,e){return f[e.s]-f[t.s]||t.f-e.f});i<r;++i){var y=a[i].s;if(!(f[y]>e))break;m+=_-(1<<p-f[y]),f[y]=e}for(m>>=g;m>0;){var v=a[i].s;f[v]<e?m-=1<<e-f[v]++-1:++i}for(;i>=0&&m;--i){var b=a[i].s;f[b]==e&&(--f[b],++m)}p=e}return{t:new qe(f),l:p}},mn=function(t,e,n){return-1==t.s?Math.max(mn(t.l,e,n+1),mn(t.r,e,n+1)):e[t.s]=n},gn=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new Ve(++e),i=0,r=t[0],a=1,s=function(t){n[i++]=t},o=1;o<=e;++o)if(t[o]==r&&o!=e)++a;else{if(!r&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(r),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(r);a=1,r=t[o]}return{c:n.subarray(0,i),n:e}},_n=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},yn=function(t,e,n){var i=n.length,r=un(e+2);t[r]=255&i,t[r+1]=i>>8,t[r+2]=255^t[r],t[r+3]=255^t[r+1];for(var a=0;a<i;++a)t[r+a+4]=n[a];return 8*(r+4+i)},vn=function(t,e,n,i,r,a,s,o,l,c,u){dn(e,u++,n),++r[256];for(var h=pn(r,15),d=h.t,f=h.l,p=pn(a,15),m=p.t,g=p.l,_=gn(d),y=_.c,v=_.n,b=gn(m),x=b.c,w=b.n,S=new Ve(19),P=0;P<y.length;++P)++S[31&y[P]];for(P=0;P<x.length;++P)++S[31&x[P]];for(var M=pn(S,7),A=M.t,k=M.l,E=19;E>4&&!A[Xe[E-1]];--E);var T,C,I,L,z=c+5<<3,N=_n(r,sn)+_n(a,on)+s,D=_n(r,d)+_n(a,m)+s+14+3*E+_n(S,A)+2*S[16]+3*S[17]+7*S[18];if(l>=0&&z<=N&&z<=D)return yn(e,u,t.subarray(l,l+c));if(dn(e,u,1+(D<N)),u+=2,D<N){T=an(d,f,0),C=d,I=an(m,g,0),L=m;var R=an(A,k,0);dn(e,u,v-257),dn(e,u+5,w-1),dn(e,u+10,E-4),u+=14;for(P=0;P<E;++P)dn(e,u+3*P,A[Xe[P]]);u+=3*E;for(var F=[y,x],O=0;O<2;++O){var B=F[O];for(P=0;P<B.length;++P){var j=31&B[P];dn(e,u,R[j]),u+=A[j],j>15&&(dn(e,u,B[P]>>5&127),u+=B[P]>>12)}}}else T=ln,C=sn,I=cn,L=on;for(P=0;P<o;++P){var U=i[P];if(U>255){fn(e,u,T[(j=U>>18&31)+257]),u+=C[j+257],j>7&&(dn(e,u,U>>23&31),u+=We[j]);var G=31&U;fn(e,u,I[G]),u+=L[G],G>3&&(fn(e,u,U>>5&8191),u+=He[G])}else fn(e,u,T[U]),u+=C[U]}return fn(e,u,T[256]),u+C[256]},bn=new Ze([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),xn=new qe(0),wn=function(t,e,n,i,r,a){var s=a.z||t.length,o=new qe(i+s+5*(1+Math.ceil(s/7e3))+r),l=o.subarray(i,o.length-r),c=a.l,u=7&(a.r||0);if(e){u&&(l[0]=a.r>>3);for(var h=bn[e-1],d=h>>13,f=8191&h,p=(1<<n)-1,m=a.p||new Ve(32768),g=a.h||new Ve(p+1),_=Math.ceil(n/3),y=2*_,v=function(e){return(t[e]^t[e+1]<<_^t[e+2]<<y)&p},b=new Ze(25e3),x=new Ve(288),w=new Ve(32),S=0,P=0,M=a.i||0,A=0,k=a.w||0,E=0;M+2<s;++M){var T=v(M),C=32767&M,I=g[T];if(m[C]=I,g[T]=C,k<=M){var L=s-M;if((S>7e3||A>24576)&&(L>423||!c)){u=vn(t,l,0,b,x,w,P,A,E,M-E,u),A=S=P=0,E=M;for(var z=0;z<286;++z)x[z]=0;for(z=0;z<30;++z)w[z]=0}var N=2,D=0,R=f,F=C-I&32767;if(L>2&&T==v(M-F))for(var O=Math.min(d,L)-1,B=Math.min(32767,M),j=Math.min(258,L);F<=B&&--R&&C!=I;){if(t[M+N]==t[M+N-F]){for(var U=0;U<j&&t[M+U]==t[M+U-F];++U);if(U>N){if(N=U,D=F,U>O)break;var G=Math.min(F,U-2),q=0;for(z=0;z<G;++z){var V=M-F+z&32767,Z=V-m[V]&32767;Z>q&&(q=Z,I=V)}}}F+=(C=I)-(I=m[C])&32767}if(D){b[A++]=268435456|$e[N]<<18|tn[D];var W=31&$e[N],H=31&tn[D];P+=We[W]+He[H],++x[257+W],++w[H],k=M+N,++S}else b[A++]=t[M],++x[t[M]]}}for(M=Math.max(M,k);M<s;++M)b[A++]=t[M],++x[t[M]];u=vn(t,l,c,b,x,w,P,A,E,M-E,u),c||(a.r=7&u|l[u/8|0]<<3,u-=7,a.h=g,a.p=m,a.i=M,a.w=k)}else{for(M=a.w||0;M<s+c;M+=65535){var X=M+65535;X>=s&&(l[u/8|0]=c,X=s),u=yn(l,u+1,t.subarray(M,X))}a.i=s}return hn(o,0,i+un(u)+r)},Sn=function(){var t=1,e=0;return{p:function(n){for(var i=t,r=e,a=0|n.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)r+=i+=n[s];i=(65535&i)+15*(i>>16),r=(65535&r)+15*(r>>16)}t=i,e=r},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(e%=65521))<<8|e>>8}}},Pn=function(t,e,n,i,r){if(!r&&(r={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),s=new qe(a.length+t.length);s.set(a),s.set(t,a.length),t=s,r.w=a.length}return wn(t,null==e.level?6:e.level,null==e.mem?r.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+e.mem,n,i,r)},Mn=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},An=function(t,e){var n=e.level,i=0==n?0:n<6?1:9==n?3:2;if(t[0]=120,t[1]=i<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var r=Sn();r.p(e.dictionary),Mn(t,2,r.d())}};function kn(t,e){e||(e={});var n=Sn();n.p(t);var i=Pn(t,e,e.dictionary?6:2,4);return An(i,e),Mn(i,i.length-4,n.d()),i}var En="undefined"!=typeof TextDecoder&&new TextDecoder;try{En.decode(xn,{stream:!0})}catch(Tf){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;function Tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Cn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a,s,o=[],l=!0,c=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=a.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Tn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(t){return new TextDecoder(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8").decode(t)}const Ln=new TextEncoder;const zn=(()=>{const t=new Uint8Array(4);return!((new Uint32Array(t.buffer)[0]=1)&t[0])})(),Nn={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Dn{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8192,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.A)(this,"buffer",void 0),(0,o.A)(this,"byteLength",void 0),(0,o.A)(this,"byteOffset",void 0),(0,o.A)(this,"length",void 0),(0,o.A)(this,"offset",void 0),(0,o.A)(this,"lastWrittenByte",void 0),(0,o.A)(this,"littleEndian",void 0),(0,o.A)(this,"_data",void 0),(0,o.A)(this,"_mark",void 0),(0,o.A)(this,"_marks",void 0);let n=!1;"number"===typeof t?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=e.offset?e.offset>>>0:0,r=t.byteLength-i;let a=i;(ArrayBuffer.isView(t)||t instanceof Dn)&&(t.byteLength!==t.buffer.byteLength&&(a=t.byteOffset+i),t=t.buffer),this.lastWrittenByte=n?r:0,this.buffer=t,this.length=r,this.byteLength=r,this.byteOffset=a,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,a,r),this._mark=0,this._marks=[]}available(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=t,this}back(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(t)){const e=2*(this.offset+t),n=new Uint8Array(e);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=e,this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(t,"uint8")}readArray(t,e){const n=Nn[e].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,r=this.buffer.slice(i,i+n);if(this.littleEndian===zn&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(i,i+n));t.reverse();const r=new Nn[e](t.buffer);return this.offset+=n,r.reverse(),r}const a=new Nn[e](r);return this.offset+=n,a}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e="";for(let n=0;n<t;n++)e+=this.readChar();return e}readUtf8(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return In(this.readBytes(t))}decodeText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return In(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(function(t){return Ln.encode(t)}(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Rn(t){let e=t.length;for(;--e>=0;)t[e]=0}const Fn=256,On=286,Bn=30,jn=15,Un=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Gn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),qn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Vn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Zn=new Array(576);Rn(Zn);const Wn=new Array(60);Rn(Wn);const Hn=new Array(512);Rn(Hn);const Xn=new Array(256);Rn(Xn);const Yn=new Array(29);Rn(Yn);const Kn=new Array(Bn);function Jn(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let $n,Qn,ti;function ei(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Rn(Kn);const ni=t=>t<256?Hn[t]:Hn[256+(t>>>7)],ii=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},ri=(t,e,n)=>{t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,ii(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},ai=(t,e,n)=>{ri(t,n[2*e],n[2*e+1])},si=(t,e)=>{let n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1},oi=(t,e,n)=>{const i=new Array(16);let r,a,s=0;for(r=1;r<=jn;r++)s=s+n[r-1]<<1,i[r]=s;for(a=0;a<=e;a++){let e=t[2*a+1];0!==e&&(t[2*a]=si(i[e]++,e))}},li=t=>{let e;for(e=0;e<On;e++)t.dyn_ltree[2*e]=0;for(e=0;e<Bn;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},ci=t=>{t.bi_valid>8?ii(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},ui=(t,e,n,i)=>{const r=2*e,a=2*n;return t[r]<t[a]||t[r]===t[a]&&i[e]<=i[n]},hi=(t,e,n)=>{const i=t.heap[n];let r=n<<1;for(;r<=t.heap_len&&(r<t.heap_len&&ui(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!ui(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i},di=(t,e,n)=>{let i,r,a,s,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,r=t.pending_buf[t.sym_buf+o++],0===i?ai(t,r,e):(a=Xn[r],ai(t,a+Fn+1,e),s=Un[a],0!==s&&(r-=Yn[a],ri(t,r,s)),i--,a=ni(i),ai(t,a,n),s=Gn[a],0!==s&&(i-=Kn[a],ri(t,i,s)))}while(o<t.sym_next);ai(t,256,e)},fi=(t,e)=>{const n=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.has_stree,a=e.stat_desc.elems;let s,o,l,c=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<a;s++)0!==n[2*s]?(t.heap[++t.heap_len]=c=s,t.depth[s]=0):n[2*s+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=c<2?++c:0,n[2*l]=1,t.depth[l]=0,t.opt_len--,r&&(t.static_len-=i[2*l+1]);for(e.max_code=c,s=t.heap_len>>1;s>=1;s--)hi(t,n,s);l=a;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],hi(t,n,1),o=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=o,n[2*l]=n[2*s]+n[2*o],t.depth[l]=(t.depth[s]>=t.depth[o]?t.depth[s]:t.depth[o])+1,n[2*s+1]=n[2*o+1]=l,t.heap[1]=l++,hi(t,n,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const n=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,a=e.stat_desc.has_stree,s=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length;let c,u,h,d,f,p,m=0;for(d=0;d<=jn;d++)t.bl_count[d]=0;for(n[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)u=t.heap[c],d=n[2*n[2*u+1]+1]+1,d>l&&(d=l,m++),n[2*u+1]=d,u>i||(t.bl_count[d]++,f=0,u>=o&&(f=s[u-o]),p=n[2*u],t.opt_len+=p*(d+f),a&&(t.static_len+=p*(r[2*u+1]+f)));if(0!==m){do{for(d=l-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[l]--,m-=2}while(m>0);for(d=l;0!==d;d--)for(u=t.bl_count[d];0!==u;)h=t.heap[--c],h>i||(n[2*h+1]!==d&&(t.opt_len+=(d-n[2*h+1])*n[2*h],n[2*h+1]=d),u--)}})(t,e),oi(n,c,t.bl_count)},pi=(t,e,n)=>{let i,r,a=-1,s=e[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=e[2*(i+1)+1],++o<l&&r===s||(o<c?t.bl_tree[2*r]+=o:0!==r?(r!==a&&t.bl_tree[2*r]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,a=r,0===s?(l=138,c=3):r===s?(l=6,c=3):(l=7,c=4))},mi=(t,e,n)=>{let i,r,a=-1,s=e[1],o=0,l=7,c=4;for(0===s&&(l=138,c=3),i=0;i<=n;i++)if(r=s,s=e[2*(i+1)+1],!(++o<l&&r===s)){if(o<c)do{ai(t,r,t.bl_tree)}while(0!==--o);else 0!==r?(r!==a&&(ai(t,r,t.bl_tree),o--),ai(t,16,t.bl_tree),ri(t,o-3,2)):o<=10?(ai(t,17,t.bl_tree),ri(t,o-3,3)):(ai(t,18,t.bl_tree),ri(t,o-11,7));o=0,a=r,0===s?(l=138,c=3):r===s?(l=6,c=3):(l=7,c=4)}};let gi=!1;const _i=(t,e,n,i)=>{ri(t,0+(i?1:0),3),ci(t),ii(t,n),ii(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n};var yi=t=>{gi||((()=>{let t,e,n,i,r;const a=new Array(16);for(n=0,i=0;i<28;i++)for(Yn[i]=n,t=0;t<1<<Un[i];t++)Xn[n++]=i;for(Xn[n-1]=i,r=0,i=0;i<16;i++)for(Kn[i]=r,t=0;t<1<<Gn[i];t++)Hn[r++]=i;for(r>>=7;i<Bn;i++)for(Kn[i]=r<<7,t=0;t<1<<Gn[i]-7;t++)Hn[256+r++]=i;for(e=0;e<=jn;e++)a[e]=0;for(t=0;t<=143;)Zn[2*t+1]=8,t++,a[8]++;for(;t<=255;)Zn[2*t+1]=9,t++,a[9]++;for(;t<=279;)Zn[2*t+1]=7,t++,a[7]++;for(;t<=287;)Zn[2*t+1]=8,t++,a[8]++;for(oi(Zn,287,a),t=0;t<Bn;t++)Wn[2*t+1]=5,Wn[2*t]=si(t,5);$n=new Jn(Zn,Un,257,On,jn),Qn=new Jn(Wn,Gn,0,Bn,jn),ti=new Jn(new Array(0),qn,0,19,7)})(),gi=!0),t.l_desc=new ei(t.dyn_ltree,$n),t.d_desc=new ei(t.dyn_dtree,Qn),t.bl_desc=new ei(t.bl_tree,ti),t.bi_buf=0,t.bi_valid=0,li(t)},vi=(t,e,n,i)=>{let r,a,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<Fn;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),fi(t,t.l_desc),fi(t,t.d_desc),s=(t=>{let e;for(pi(t,t.dyn_ltree,t.l_desc.max_code),pi(t,t.dyn_dtree,t.d_desc.max_code),fi(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*Vn[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),r=t.opt_len+3+7>>>3,a=t.static_len+3+7>>>3,a<=r&&(r=a)):r=a=n+5,n+4<=r&&-1!==e?_i(t,e,n,i):4===t.strategy||a===r?(ri(t,2+(i?1:0),3),di(t,Zn,Wn)):(ri(t,4+(i?1:0),3),((t,e,n,i)=>{let r;for(ri(t,e-257,5),ri(t,n-1,5),ri(t,i-4,4),r=0;r<i;r++)ri(t,t.bl_tree[2*Vn[r]+1],3);mi(t,t.dyn_ltree,e-1),mi(t,t.dyn_dtree,n-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),di(t,t.dyn_ltree,t.dyn_dtree)),li(t),i&&ci(t)},bi=(t,e,n)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(Xn[n]+Fn+1)]++,t.dyn_dtree[2*ni(e)]++),t.sym_next===t.sym_end),xi=t=>{ri(t,2,3),ai(t,256,Zn),(t=>{16===t.bi_valid?(ii(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)},wi={_tr_init:yi,_tr_stored_block:_i,_tr_flush_block:vi,_tr_tally:bi,_tr_align:xi};var Si=(t,e,n,i)=>{let r=65535&t,a=t>>>16&65535,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{r=r+e[i++]|0,a=a+r|0}while(--s);r%=65521,a%=65521}return r|a<<16};const Pi=new Uint32Array((()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e})());var Mi=(t,e,n,i)=>{const r=Pi,a=i+n;t^=-1;for(let s=i;s<a;s++)t=t>>>8^r[255&(t^e[s])];return-1^t},Ai={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ki={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ei,_tr_stored_block:Ti,_tr_flush_block:Ci,_tr_tally:Ii,_tr_align:Li}=wi,{Z_NO_FLUSH:zi,Z_PARTIAL_FLUSH:Ni,Z_FULL_FLUSH:Di,Z_FINISH:Ri,Z_BLOCK:Fi,Z_OK:Oi,Z_STREAM_END:Bi,Z_STREAM_ERROR:ji,Z_DATA_ERROR:Ui,Z_BUF_ERROR:Gi,Z_DEFAULT_COMPRESSION:qi,Z_FILTERED:Vi,Z_HUFFMAN_ONLY:Zi,Z_RLE:Wi,Z_FIXED:Hi,Z_DEFAULT_STRATEGY:Xi,Z_UNKNOWN:Yi,Z_DEFLATED:Ki}=ki,Ji=258,$i=262,Qi=42,tr=113,er=666,nr=(t,e)=>(t.msg=Ai[e],e),ir=t=>2*t-(t>4?9:0),rr=t=>{let e=t.length;for(;--e>=0;)t[e]=0},ar=t=>{let e,n,i,r=t.w_size;e=t.hash_size,i=e;do{n=t.head[--i],t.head[i]=n>=r?n-r:0}while(--e);e=r,i=e;do{n=t.prev[--i],t.prev[i]=n>=r?n-r:0}while(--e)};let sr=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask;const or=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))},lr=(t,e)=>{Ci(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,or(t.strm)},cr=(t,e)=>{t.pending_buf[t.pending++]=e},ur=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},hr=(t,e,n,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),n),1===t.state.wrap?t.adler=Si(t.adler,e,r,n):2===t.state.wrap&&(t.adler=Mi(t.adler,e,r,n)),t.next_in+=r,t.total_in+=r,r)},dr=(t,e)=>{let n,i,r=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match;const l=t.strstart>t.w_size-$i?t.strstart-(t.w_size-$i):0,c=t.window,u=t.w_mask,h=t.prev,d=t.strstart+Ji;let f=c[a+s-1],p=c[a+s];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do{if(n=e,c[n+s]===p&&c[n+s-1]===f&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<d);if(i=Ji-(d-a),a=d-Ji,i>s){if(t.match_start=e,s=i,i>=o)break;f=c[a+s-1],p=c[a+s]}}}while((e=h[e&u])>l&&0!==--r);return s<=t.lookahead?s:t.lookahead},fr=t=>{const e=t.w_size;let n,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-$i)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),ar(t),i+=e),0===t.strm.avail_in)break;if(n=hr(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=n,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=sr(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=sr(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<$i&&0!==t.strm.avail_in)},pr=(t,e)=>{let n,i,r,a=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,s=0,o=t.strm.avail_in;do{if(n=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r)break;if(r=t.strm.avail_out-r,i=t.strstart-t.block_start,n>i+t.strm.avail_in&&(n=i+t.strm.avail_in),n>r&&(n=r),n<a&&(0===n&&e!==Ri||e===zi||n!==i+t.strm.avail_in))break;s=e===Ri&&n===i+t.strm.avail_in?1:0,Ti(t,0,0,s),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,or(t.strm),i&&(i>n&&(i=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,n-=i),n&&(hr(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(0===s);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?4:e!==zi&&e!==Ri&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&(hr(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r,a=r>t.w_size?t.w_size:r,i=t.strstart-t.block_start,(i>=a||(i||e===Ri)&&e!==zi&&0===t.strm.avail_in&&i<=r)&&(n=i>r?r:i,s=e===Ri&&0===t.strm.avail_in&&n===i?1:0,Ti(t,t.block_start,n,s),t.block_start+=n,or(t.strm)),s?3:1)},mr=(t,e)=>{let n,i;for(;;){if(t.lookahead<$i){if(fr(t),t.lookahead<$i&&e===zi)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=sr(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-$i&&(t.match_length=dr(t,n)),t.match_length>=3)if(i=Ii(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=sr(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=sr(t,t.ins_h,t.window[t.strstart+1]);else i=Ii(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(lr(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===Ri?(lr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(lr(t,!1),0===t.strm.avail_out)?1:2},gr=(t,e)=>{let n,i,r;for(;;){if(t.lookahead<$i){if(fr(t),t.lookahead<$i&&e===zi)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=sr(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-$i&&(t.match_length=dr(t,n),t.match_length<=5&&(t.strategy===Vi||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=Ii(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=sr(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(lr(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=Ii(t,0,t.window[t.strstart-1]),i&&lr(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Ii(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===Ri?(lr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(lr(t,!1),0===t.strm.avail_out)?1:2};function _r(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}const yr=[new _r(0,0,0,0,pr),new _r(4,4,8,4,mr),new _r(4,5,16,8,mr),new _r(4,6,32,32,mr),new _r(4,4,16,16,gr),new _r(8,16,32,32,gr),new _r(8,16,128,128,gr),new _r(8,32,128,256,gr),new _r(32,128,258,1024,gr),new _r(32,258,258,4096,gr)];function vr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ki,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),rr(this.dyn_ltree),rr(this.dyn_dtree),rr(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),rr(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),rr(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const br=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Qi&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==tr&&e.status!==er?1:0},xr=t=>{if(br(t))return nr(t,ji);t.total_in=t.total_out=0,t.data_type=Yi;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?Qi:tr,t.adler=2===e.wrap?0:1,e.last_flush=-2,Ei(e),Oi},wr=t=>{const e=xr(t);return e===Oi&&(t=>{t.window_size=2*t.w_size,rr(t.head),t.max_lazy_match=yr[t.level].max_lazy,t.good_match=yr[t.level].good_length,t.nice_match=yr[t.level].nice_length,t.max_chain_length=yr[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),e},Sr=(t,e,n,i,r,a)=>{if(!t)return ji;let s=1;if(e===qi&&(e=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||n!==Ki||i<8||i>15||e<0||e>9||a<0||a>Hi||8===i&&1!==s)return nr(t,ji);8===i&&(i=9);const o=new vr;return t.state=o,o.strm=t,o.status=Qi,o.wrap=s,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=a,o.method=n,wr(t)};var Pr=(t,e)=>{if(br(t)||e>Fi||e<0)return t?nr(t,ji):ji;const n=t.state;if(!t.output||0!==t.avail_in&&!t.input||n.status===er&&e!==Ri)return nr(t,0===t.avail_out?Gi:ji);const i=n.last_flush;if(n.last_flush=e,0!==n.pending){if(or(t),0===t.avail_out)return n.last_flush=-1,Oi}else if(0===t.avail_in&&ir(e)<=ir(i)&&e!==Ri)return nr(t,Gi);if(n.status===er&&0!==t.avail_in)return nr(t,Gi);if(n.status===Qi&&0===n.wrap&&(n.status=tr),n.status===Qi){let e=Ki+(n.w_bits-8<<4)<<8,i=-1;if(i=n.strategy>=Zi||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=i<<6,0!==n.strstart&&(e|=32),e+=31-e%31,ur(n,e),0!==n.strstart&&(ur(n,t.adler>>>16),ur(n,65535&t.adler)),t.adler=1,n.status=tr,or(t),0!==n.pending)return n.last_flush=-1,Oi}if(57===n.status)if(t.adler=0,cr(n,31),cr(n,139),cr(n,8),n.gzhead)cr(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),cr(n,255&n.gzhead.time),cr(n,n.gzhead.time>>8&255),cr(n,n.gzhead.time>>16&255),cr(n,n.gzhead.time>>24&255),cr(n,9===n.level?2:n.strategy>=Zi||n.level<2?4:0),cr(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(cr(n,255&n.gzhead.extra.length),cr(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=Mi(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(cr(n,0),cr(n,0),cr(n,0),cr(n,0),cr(n,0),cr(n,9===n.level?2:n.strategy>=Zi||n.level<2?4:0),cr(n,3),n.status=tr,or(t),0!==n.pending)return n.last_flush=-1,Oi;if(69===n.status){if(n.gzhead.extra){let e=n.pending,i=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+i>n.pending_buf_size;){let r=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>e&&(t.adler=Mi(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex+=r,or(t),0!==n.pending)return n.last_flush=-1,Oi;e=0,i-=r}let r=new Uint8Array(n.gzhead.extra);n.pending_buf.set(r.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending+=i,n.gzhead.hcrc&&n.pending>e&&(t.adler=Mi(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let e,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(t.adler=Mi(t.adler,n.pending_buf,n.pending-i,i)),or(t),0!==n.pending)return n.last_flush=-1,Oi;i=0}e=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,cr(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>i&&(t.adler=Mi(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let e,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(t.adler=Mi(t.adler,n.pending_buf,n.pending-i,i)),or(t),0!==n.pending)return n.last_flush=-1,Oi;i=0}e=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,cr(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>i&&(t.adler=Mi(t.adler,n.pending_buf,n.pending-i,i))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(or(t),0!==n.pending))return n.last_flush=-1,Oi;cr(n,255&t.adler),cr(n,t.adler>>8&255),t.adler=0}if(n.status=tr,or(t),0!==n.pending)return n.last_flush=-1,Oi}if(0!==t.avail_in||0!==n.lookahead||e!==zi&&n.status!==er){let i=0===n.level?pr(n,e):n.strategy===Zi?((t,e)=>{let n;for(;;){if(0===t.lookahead&&(fr(t),0===t.lookahead)){if(e===zi)return 1;break}if(t.match_length=0,n=Ii(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(lr(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Ri?(lr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(lr(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===Wi?((t,e)=>{let n,i,r,a;const s=t.window;for(;;){if(t.lookahead<=Ji){if(fr(t),t.lookahead<=Ji&&e===zi)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){a=t.strstart+Ji;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<a);t.match_length=Ji-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=Ii(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Ii(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(lr(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Ri?(lr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(lr(t,!1),0===t.strm.avail_out)?1:2})(n,e):yr[n.level].func(n,e);if(3!==i&&4!==i||(n.status=er),1===i||3===i)return 0===t.avail_out&&(n.last_flush=-1),Oi;if(2===i&&(e===Ni?Li(n):e!==Fi&&(Ti(n,0,0,!1),e===Di&&(rr(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),or(t),0===t.avail_out))return n.last_flush=-1,Oi}return e!==Ri?Oi:n.wrap<=0?Bi:(2===n.wrap?(cr(n,255&t.adler),cr(n,t.adler>>8&255),cr(n,t.adler>>16&255),cr(n,t.adler>>24&255),cr(n,255&t.total_in),cr(n,t.total_in>>8&255),cr(n,t.total_in>>16&255),cr(n,t.total_in>>24&255)):(ur(n,t.adler>>>16),ur(n,65535&t.adler)),or(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Oi:Bi)},Mr=(t,e)=>{let n=e.length;if(br(t))return ji;const i=t.state,r=i.wrap;if(2===r||1===r&&i.status!==Qi||i.lookahead)return ji;if(1===r&&(t.adler=Si(t.adler,e,n,0)),i.wrap=0,n>=i.w_size){0===r&&(rr(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(n-i.w_size,n),0),e=t,n=i.w_size}const a=t.avail_in,s=t.next_in,o=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,fr(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=sr(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,fr(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=s,t.input=o,t.avail_in=a,i.wrap=r,Oi},Ar={deflateInit:(t,e)=>Sr(t,e,Ki,15,8,Xi),deflateInit2:Sr,deflateReset:wr,deflateResetKeep:xr,deflateSetHeader:(t,e)=>br(t)||2!==t.state.wrap?ji:(t.state.gzhead=e,Oi),deflate:Pr,deflateEnd:t=>{if(br(t))return ji;const e=t.state.status;return t.state=null,e===tr?nr(t,Ui):Oi},deflateSetDictionary:Mr,deflateInfo:"pako deflate (from Nodeca project)"};const kr=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Er=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if("object"!==typeof n)throw new TypeError(n+"must be non-object");for(const e in n)kr(n,e)&&(t[e]=n[e])}}return t},Tr=t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const n=new Uint8Array(e);for(let i=0,r=0,a=t.length;i<a;i++){let e=t[i];n.set(e,r),r+=e.length}return n};let Cr=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Cf){Cr=!1}const Ir=new Uint8Array(256);for(let n=0;n<256;n++)Ir[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Ir[254]=Ir[254]=1;var Lr=t=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,n,i,r,a,s=t.length,o=0;for(r=0;r<s;r++)n=t.charCodeAt(r),55296===(64512&n)&&r+1<s&&(i=t.charCodeAt(r+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(o),a=0,r=0;a<o;r++)n=t.charCodeAt(r),55296===(64512&n)&&r+1<s&&(i=t.charCodeAt(r+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},zr=(t,e)=>{const n=e||t.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,r;const a=new Array(2*n);for(r=0,i=0;i<n;){let e=t[i++];if(e<128){a[r++]=e;continue}let s=Ir[e];if(s>4)a[r++]=65533,i+=s-1;else{for(e&=2===s?31:3===s?15:7;s>1&&i<n;)e=e<<6|63&t[i++],s--;s>1?a[r++]=65533:e<65536?a[r++]=e:(e-=65536,a[r++]=55296|e>>10&1023,a[r++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Cr)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n})(a,r)},Nr=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128===(192&t[n]);)n--;return n<0||0===n?e:n+Ir[t[n]]>e?n:e};var Dr=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Rr=Object.prototype.toString,{Z_NO_FLUSH:Fr,Z_SYNC_FLUSH:Or,Z_FULL_FLUSH:Br,Z_FINISH:jr,Z_OK:Ur,Z_STREAM_END:Gr,Z_DEFAULT_COMPRESSION:qr,Z_DEFAULT_STRATEGY:Vr,Z_DEFLATED:Zr}=ki;function Wr(t){this.options=Er({level:qr,method:Zr,chunkSize:16384,windowBits:15,memLevel:8,strategy:Vr},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Dr,this.strm.avail_out=0;let n=Ar.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==Ur)throw new Error(Ai[n]);if(e.header&&Ar.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"===typeof e.dictionary?Lr(e.dictionary):"[object ArrayBuffer]"===Rr.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,n=Ar.deflateSetDictionary(this.strm,t),n!==Ur)throw new Error(Ai[n]);this._dict_set=!0}}function Hr(t,e){const n=new Wr(e);if(n.push(t,!0),n.err)throw n.msg||Ai[n.err];return n.result}Wr.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize;let r,a;if(this.ended)return!1;for(a=e===~~e?e:!0===e?jr:Fr,"string"===typeof t?n.input=Lr(t):"[object ArrayBuffer]"===Rr.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(a===Or||a===Br)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(r=Ar.deflate(n,a),r===Gr)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=Ar.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Ur;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Wr.prototype.onData=function(t){this.chunks.push(t)},Wr.prototype.onEnd=function(t){t===Ur&&(this.result=Tr(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Xr=function(t,e){return(e=e||{}).raw=!0,Hr(t,e)},Yr=function(t,e){return(e=e||{}).gzip=!0,Hr(t,e)},Kr={Deflate:Wr,deflate:Hr,deflateRaw:Xr,gzip:Yr,constants:ki};const Jr=16209;var $r=function(t,e){let n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b,x,w,S,P,M;const A=t.state;n=t.next_in,P=t.input,i=n+(t.avail_in-5),r=t.next_out,M=t.output,a=r-(e-t.avail_out),s=r+(t.avail_out-257),o=A.dmax,l=A.wsize,c=A.whave,u=A.wnext,h=A.window,d=A.hold,f=A.bits,p=A.lencode,m=A.distcode,g=(1<<A.lenbits)-1,_=(1<<A.distbits)-1;t:do{f<15&&(d+=P[n++]<<f,f+=8,d+=P[n++]<<f,f+=8),y=p[d&g];e:for(;;){if(v=y>>>24,d>>>=v,f-=v,v=y>>>16&255,0===v)M[r++]=65535&y;else{if(!(16&v)){if(0===(64&v)){y=p[(65535&y)+(d&(1<<v)-1)];continue e}if(32&v){A.mode=16191;break t}t.msg="invalid literal/length code",A.mode=Jr;break t}b=65535&y,v&=15,v&&(f<v&&(d+=P[n++]<<f,f+=8),b+=d&(1<<v)-1,d>>>=v,f-=v),f<15&&(d+=P[n++]<<f,f+=8,d+=P[n++]<<f,f+=8),y=m[d&_];n:for(;;){if(v=y>>>24,d>>>=v,f-=v,v=y>>>16&255,!(16&v)){if(0===(64&v)){y=m[(65535&y)+(d&(1<<v)-1)];continue n}t.msg="invalid distance code",A.mode=Jr;break t}if(x=65535&y,v&=15,f<v&&(d+=P[n++]<<f,f+=8,f<v&&(d+=P[n++]<<f,f+=8)),x+=d&(1<<v)-1,x>o){t.msg="invalid distance too far back",A.mode=Jr;break t}if(d>>>=v,f-=v,v=r-a,x>v){if(v=x-v,v>c&&A.sane){t.msg="invalid distance too far back",A.mode=Jr;break t}if(w=0,S=h,0===u){if(w+=l-v,v<b){b-=v;do{M[r++]=h[w++]}while(--v);w=r-x,S=M}}else if(u<v){if(w+=l+u-v,v-=u,v<b){b-=v;do{M[r++]=h[w++]}while(--v);if(w=0,u<b){v=u,b-=v;do{M[r++]=h[w++]}while(--v);w=r-x,S=M}}}else if(w+=u-v,v<b){b-=v;do{M[r++]=h[w++]}while(--v);w=r-x,S=M}for(;b>2;)M[r++]=S[w++],M[r++]=S[w++],M[r++]=S[w++],b-=3;b&&(M[r++]=S[w++],b>1&&(M[r++]=S[w++]))}else{w=r-x;do{M[r++]=M[w++],M[r++]=M[w++],M[r++]=M[w++],b-=3}while(b>2);b&&(M[r++]=M[w++],b>1&&(M[r++]=M[w++]))}break}}break}}while(n<i&&r<s);b=f>>3,n-=b,f-=b<<3,d&=(1<<f)-1,t.next_in=n,t.next_out=r,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=r<s?s-r+257:257-(r-s),A.hold=d,A.bits=f};const Qr=15,ta=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ea=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),na=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ia=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ra=(t,e,n,i,r,a,s,o)=>{const l=o.bits;let c,u,h,d,f,p,m=0,g=0,_=0,y=0,v=0,b=0,x=0,w=0,S=0,P=0,M=null;const A=new Uint16Array(16),k=new Uint16Array(16);let E,T,C,I=null;for(m=0;m<=Qr;m++)A[m]=0;for(g=0;g<i;g++)A[e[n+g]]++;for(v=l,y=Qr;y>=1&&0===A[y];y--);if(v>y&&(v=y),0===y)return r[a++]=20971520,r[a++]=20971520,o.bits=1,0;for(_=1;_<y&&0===A[_];_++);for(v<_&&(v=_),w=1,m=1;m<=Qr;m++)if(w<<=1,w-=A[m],w<0)return-1;if(w>0&&(0===t||1!==y))return-1;for(k[1]=0,m=1;m<Qr;m++)k[m+1]=k[m]+A[m];for(g=0;g<i;g++)0!==e[n+g]&&(s[k[e[n+g]]++]=g);if(0===t?(M=I=s,p=20):1===t?(M=ta,I=ea,p=257):(M=na,I=ia,p=0),P=0,g=0,m=_,f=a,b=v,x=0,h=-1,S=1<<v,d=S-1,1===t&&S>852||2===t&&S>592)return 1;for(;;){E=m-x,s[g]+1<p?(T=0,C=s[g]):s[g]>=p?(T=I[s[g]-p],C=M[s[g]-p]):(T=96,C=0),c=1<<m-x,u=1<<b,_=u;do{u-=c,r[f+(P>>x)+u]=E<<24|T<<16|C}while(0!==u);for(c=1<<m-1;P&c;)c>>=1;if(0!==c?(P&=c-1,P+=c):P=0,g++,0===--A[m]){if(m===y)break;m=e[n+s[g]]}if(m>v&&(P&d)!==h){for(0===x&&(x=v),f+=_,b=m-x,w=1<<b;b+x<y&&(w-=A[b+x],!(w<=0));)b++,w<<=1;if(S+=1<<b,1===t&&S>852||2===t&&S>592)return 1;h=P&d,r[h]=v<<24|b<<16|f-a}}return 0!==P&&(r[f+P]=m-x<<24|64<<16),o.bits=v,0};const{Z_FINISH:aa,Z_BLOCK:sa,Z_TREES:oa,Z_OK:la,Z_STREAM_END:ca,Z_NEED_DICT:ua,Z_STREAM_ERROR:ha,Z_DATA_ERROR:da,Z_MEM_ERROR:fa,Z_BUF_ERROR:pa,Z_DEFLATED:ma}=ki,ga=16180,_a=16190,ya=16191,va=16192,ba=16194,xa=16199,wa=16200,Sa=16206,Pa=16209,Ma=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Aa(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ka=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<ga||e.mode>16211?1:0},Ea=t=>{if(ka(t))return ha;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=ga,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,la},Ta=t=>{if(ka(t))return ha;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ea(t)},Ca=(t,e)=>{let n;if(ka(t))return ha;const i=t.state;return e<0?(n=0,e=-e):(n=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ha:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,Ta(t))},Ia=(t,e)=>{if(!t)return ha;const n=new Aa;t.state=n,n.strm=t,n.window=null,n.mode=ga;const i=Ca(t,e);return i!==la&&(t.state=null),i};let La,za,Na=!0;const Da=t=>{if(Na){La=new Int32Array(512),za=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ra(1,t.lens,0,288,La,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ra(2,t.lens,0,32,za,0,t.work,{bits:5}),Na=!1}t.lencode=La,t.lenbits=9,t.distcode=za,t.distbits=5},Ra=(t,e,n,i)=>{let r;const a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),i>=a.wsize?(a.window.set(e.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>i&&(r=i),a.window.set(e.subarray(n-i,n-i+r),a.wnext),(i-=r)?(a.window.set(e.subarray(n-i,n),0),a.wnext=i,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0};var Fa=(t,e)=>{let n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b,x,w,S,P=0;const M=new Uint8Array(4);let A,k;const E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ka(t)||!t.output||!t.input&&0!==t.avail_in)return ha;n=t.state,n.mode===ya&&(n.mode=va),s=t.next_out,r=t.output,l=t.avail_out,a=t.next_in,i=t.input,o=t.avail_in,c=n.hold,u=n.bits,h=o,d=l,S=la;t:for(;;)switch(n.mode){case ga:if(0===n.wrap){n.mode=va;break}for(;u<16;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,M[0]=255&c,M[1]=c>>>8&255,n.check=Mi(n.check,M,2,0),c=0,u=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",n.mode=Pa;break}if((15&c)!==ma){t.msg="unknown compression method",n.mode=Pa;break}if(c>>>=4,u-=4,w=8+(15&c),0===n.wbits&&(n.wbits=w),w>15||w>n.wbits){t.msg="invalid window size",n.mode=Pa;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=512&c?16189:ya,c=0,u=0;break;case 16181:for(;u<16;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(n.flags=c,(255&n.flags)!==ma){t.msg="unknown compression method",n.mode=Pa;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=Pa;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(M[0]=255&c,M[1]=c>>>8&255,n.check=Mi(n.check,M,2,0)),c=0,u=0,n.mode=16182;case 16182:for(;u<32;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(M[0]=255&c,M[1]=c>>>8&255,M[2]=c>>>16&255,M[3]=c>>>24&255,n.check=Mi(n.check,M,4,0)),c=0,u=0,n.mode=16183;case 16183:for(;u<16;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(M[0]=255&c,M[1]=c>>>8&255,n.check=Mi(n.check,M,2,0)),c=0,u=0,n.mode=16184;case 16184:if(1024&n.flags){for(;u<16;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(M[0]=255&c,M[1]=c>>>8&255,n.check=Mi(n.check,M,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>o&&(f=o),f&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(a,a+f),w)),512&n.flags&&4&n.wrap&&(n.check=Mi(n.check,i,f,a)),o-=f,a+=f,n.length-=f),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break t;f=0;do{w=i[a+f++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w))}while(w&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=Mi(n.check,i,f,a)),o-=f,a+=f,w)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break t;f=0;do{w=i[a+f++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w))}while(w&&f<o);if(512&n.flags&&4&n.wrap&&(n.check=Mi(n.check,i,f,a)),o-=f,a+=f,w)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;u<16;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(4&n.wrap&&c!==(65535&n.check)){t.msg="header crc mismatch",n.mode=Pa;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=ya;break;case 16189:for(;u<32;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}t.adler=n.check=Ma(c),c=0,u=0,n.mode=_a;case _a:if(0===n.havedict)return t.next_out=s,t.avail_out=l,t.next_in=a,t.avail_in=o,n.hold=c,n.bits=u,ua;t.adler=n.check=1,n.mode=ya;case ya:if(e===sa||e===oa)break t;case va:if(n.last){c>>>=7&u,u-=7&u,n.mode=Sa;break}for(;u<3;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}switch(n.last=1&c,c>>>=1,u-=1,3&c){case 0:n.mode=16193;break;case 1:if(Da(n),n.mode=xa,e===oa){c>>>=2,u-=2;break t}break;case 2:n.mode=16196;break;case 3:t.msg="invalid block type",n.mode=Pa}c>>>=2,u-=2;break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if((65535&c)!==(c>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Pa;break}if(n.length=65535&c,c=0,u=0,n.mode=ba,e===oa)break t;case ba:n.mode=16195;case 16195:if(f=n.length,f){if(f>o&&(f=o),f>l&&(f=l),0===f)break t;r.set(i.subarray(a,a+f),s),o-=f,a+=f,l-=f,s+=f,n.length-=f;break}n.mode=ya;break;case 16196:for(;u<14;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Pa;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;u<3;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}n.lens[E[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[E[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,A={bits:n.lenbits},S=ra(0,n.lens,0,19,n.lencode,0,n.work,A),n.lenbits=A.bits,S){t.msg="invalid code lengths set",n.mode=Pa;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;P=n.lencode[c&(1<<n.lenbits)-1],g=P>>>24,_=P>>>16&255,y=65535&P,!(g<=u);){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(y<16)c>>>=g,u-=g,n.lens[n.have++]=y;else{if(16===y){for(k=g+2;u<k;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(c>>>=g,u-=g,0===n.have){t.msg="invalid bit length repeat",n.mode=Pa;break}w=n.lens[n.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===y){for(k=g+3;u<k;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}c>>>=g,u-=g,w=0,f=3+(7&c),c>>>=3,u-=3}else{for(k=g+7;u<k;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}c>>>=g,u-=g,w=0,f=11+(127&c),c>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Pa;break}for(;f--;)n.lens[n.have++]=w}}if(n.mode===Pa)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=Pa;break}if(n.lenbits=9,A={bits:n.lenbits},S=ra(1,n.lens,0,n.nlen,n.lencode,0,n.work,A),n.lenbits=A.bits,S){t.msg="invalid literal/lengths set",n.mode=Pa;break}if(n.distbits=6,n.distcode=n.distdyn,A={bits:n.distbits},S=ra(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,A),n.distbits=A.bits,S){t.msg="invalid distances set",n.mode=Pa;break}if(n.mode=xa,e===oa)break t;case xa:n.mode=wa;case wa:if(o>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=a,t.avail_in=o,n.hold=c,n.bits=u,$r(t,d),s=t.next_out,r=t.output,l=t.avail_out,a=t.next_in,i=t.input,o=t.avail_in,c=n.hold,u=n.bits,n.mode===ya&&(n.back=-1);break}for(n.back=0;P=n.lencode[c&(1<<n.lenbits)-1],g=P>>>24,_=P>>>16&255,y=65535&P,!(g<=u);){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(_&&0===(240&_)){for(v=g,b=_,x=y;P=n.lencode[x+((c&(1<<v+b)-1)>>v)],g=P>>>24,_=P>>>16&255,y=65535&P,!(v+g<=u);){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}c>>>=v,u-=v,n.back+=v}if(c>>>=g,u-=g,n.back+=g,n.length=y,0===_){n.mode=16205;break}if(32&_){n.back=-1,n.mode=ya;break}if(64&_){t.msg="invalid literal/length code",n.mode=Pa;break}n.extra=15&_,n.mode=16201;case 16201:if(n.extra){for(k=n.extra;u<k;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;P=n.distcode[c&(1<<n.distbits)-1],g=P>>>24,_=P>>>16&255,y=65535&P,!(g<=u);){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(0===(240&_)){for(v=g,b=_,x=y;P=n.distcode[x+((c&(1<<v+b)-1)>>v)],g=P>>>24,_=P>>>16&255,y=65535&P,!(v+g<=u);){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}c>>>=v,u-=v,n.back+=v}if(c>>>=g,u-=g,n.back+=g,64&_){t.msg="invalid distance code",n.mode=Pa;break}n.offset=y,n.extra=15&_,n.mode=16203;case 16203:if(n.extra){for(k=n.extra;u<k;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Pa;break}n.mode=16204;case 16204:if(0===l)break t;if(f=d-l,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Pa;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),m=n.window}else m=r,p=s-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{r[s++]=m[p++]}while(--f);0===n.length&&(n.mode=wa);break;case 16205:if(0===l)break t;r[s++]=n.length,l--,n.mode=wa;break;case Sa:if(n.wrap){for(;u<32;){if(0===o)break t;o--,c|=i[a++]<<u,u+=8}if(d-=l,t.total_out+=d,n.total+=d,4&n.wrap&&d&&(t.adler=n.check=n.flags?Mi(n.check,r,d,s-d):Si(n.check,r,d,s-d)),d=l,4&n.wrap&&(n.flags?c:Ma(c))!==n.check){t.msg="incorrect data check",n.mode=Pa;break}c=0,u=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;u<32;){if(0===o)break t;o--,c+=i[a++]<<u,u+=8}if(4&n.wrap&&c!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=Pa;break}c=0,u=0}n.mode=16208;case 16208:S=ca;break t;case Pa:S=da;break t;case 16210:return fa;default:return ha}return t.next_out=s,t.avail_out=l,t.next_in=a,t.avail_in=o,n.hold=c,n.bits=u,(n.wsize||d!==t.avail_out&&n.mode<Pa&&(n.mode<Sa||e!==aa))&&Ra(t,t.output,t.next_out,d-t.avail_out),h-=t.avail_in,d-=t.avail_out,t.total_in+=h,t.total_out+=d,n.total+=d,4&n.wrap&&d&&(t.adler=n.check=n.flags?Mi(n.check,r,d,t.next_out-d):Si(n.check,r,d,t.next_out-d)),t.data_type=n.bits+(n.last?64:0)+(n.mode===ya?128:0)+(n.mode===xa||n.mode===ba?256:0),(0===h&&0===d||e===aa)&&S===la&&(S=pa),S},Oa={inflateReset:Ta,inflateReset2:Ca,inflateResetKeep:Ea,inflateInit:t=>Ia(t,15),inflateInit2:Ia,inflate:Fa,inflateEnd:t=>{if(ka(t))return ha;let e=t.state;return e.window&&(e.window=null),t.state=null,la},inflateGetHeader:(t,e)=>{if(ka(t))return ha;const n=t.state;return 0===(2&n.wrap)?ha:(n.head=e,e.done=!1,la)},inflateSetDictionary:(t,e)=>{const n=e.length;let i,r,a;return ka(t)?ha:(i=t.state,0!==i.wrap&&i.mode!==_a?ha:i.mode===_a&&(r=1,r=Si(r,e,n,0),r!==i.check)?da:(a=Ra(t,e,n,n),a?(i.mode=16210,fa):(i.havedict=1,la)))},inflateInfo:"pako inflate (from Nodeca project)"};var Ba=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ja=Object.prototype.toString,{Z_NO_FLUSH:Ua,Z_FINISH:Ga,Z_OK:qa,Z_STREAM_END:Va,Z_NEED_DICT:Za,Z_STREAM_ERROR:Wa,Z_DATA_ERROR:Ha,Z_MEM_ERROR:Xa}=ki;function Ya(t){this.options=Er({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Dr,this.strm.avail_out=0;let n=Oa.inflateInit2(this.strm,e.windowBits);if(n!==qa)throw new Error(Ai[n]);if(this.header=new Ba,Oa.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"===typeof e.dictionary?e.dictionary=Lr(e.dictionary):"[object ArrayBuffer]"===ja.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Oa.inflateSetDictionary(this.strm,e.dictionary),n!==qa)))throw new Error(Ai[n])}function Ka(t,e){const n=new Ya(e);if(n.push(t),n.err)throw n.msg||Ai[n.err];return n.result}Ya.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Ga:Ua,"[object ArrayBuffer]"===ja.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),a=Oa.inflate(n,s),a===Za&&r&&(a=Oa.inflateSetDictionary(n,r),a===qa?a=Oa.inflate(n,s):a===Ha&&(a=Za));n.avail_in>0&&a===Va&&n.state.wrap>0&&0!==t[n.next_in];)Oa.inflateReset(n),a=Oa.inflate(n,s);switch(a){case Wa:case Ha:case Za:case Xa:return this.onEnd(a),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(0===n.avail_out||a===Va))if("string"===this.options.to){let t=Nr(n.output,n.next_out),e=n.next_out-t,r=zr(n.output,t);n.next_out=e,n.avail_out=i-e,e&&n.output.set(n.output.subarray(t,t+e),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==qa||0!==o){if(a===Va)return a=Oa.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Ya.prototype.onData=function(t){this.chunks.push(t)},Ya.prototype.onEnd=function(t){t===qa&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Tr(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ja=function(t,e){return(e=e||{}).raw=!0,Ka(t,e)},$a={Inflate:Ya,inflate:Ka,inflateRaw:Ja,ungzip:Ka,constants:ki};const{Deflate:Qa,deflate:ts,deflateRaw:es,gzip:ns}=Kr,{Inflate:is,inflate:rs,inflateRaw:as,ungzip:ss}=$a;var os=is,ls=rs;const cs=[];for(let n=0;n<256;n++){let t=n;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;cs[n]=t}const us=4294967295;function hs(t,e){return(function(t,e,n){let i=t;for(let r=0;r<n;r++)i=cs[255&(i^e[r])]^i>>>8;return i}(us,t,e)^us)>>>0}function ds(t,e,n){const i=t.readUint32(),r=hs(new Uint8Array(t.buffer,t.byteOffset+t.offset-e-4,e),e);if(r!==i)throw new Error("CRC mismatch for chunk ".concat(n,". Expected ").concat(i,", found ").concat(r))}function fs(t,e,n){for(let i=0;i<n;i++)e[i]=t[i]}function ps(t,e,n,i){let r=0;for(;r<i;r++)e[r]=t[r];for(;r<n;r++)e[r]=t[r]+e[r-i]&255}function ms(t,e,n,i){let r=0;if(0===n.length)for(;r<i;r++)e[r]=t[r];else for(;r<i;r++)e[r]=t[r]+n[r]&255}function gs(t,e,n,i,r){let a=0;if(0===n.length){for(;a<r;a++)e[a]=t[a];for(;a<i;a++)e[a]=t[a]+(e[a-r]>>1)&255}else{for(;a<r;a++)e[a]=t[a]+(n[a]>>1)&255;for(;a<i;a++)e[a]=t[a]+(e[a-r]+n[a]>>1)&255}}function _s(t,e,n,i,r){let a=0;if(0===n.length){for(;a<r;a++)e[a]=t[a];for(;a<i;a++)e[a]=t[a]+e[a-r]&255}else{for(;a<r;a++)e[a]=t[a]+n[a]&255;for(;a<i;a++)e[a]=t[a]+ys(e[a-r],n[a],n[a-r])&255}}function ys(t,e,n){const i=t+e-n,r=Math.abs(i-t),a=Math.abs(i-e),s=Math.abs(i-n);return r<=a&&r<=s?t:a<=s?e:n}function vs(t,e,n,i,r,a){switch(t){case 0:fs(e,n,r);break;case 1:ps(e,n,r,a);break;case 2:ms(e,n,i,r);break;case 3:gs(e,n,i,r,a);break;case 4:_s(e,n,i,r,a);break;default:throw new Error("Unsupported filter: ".concat(t))}}const bs=new Uint16Array([255]),xs=255===new Uint8Array(bs.buffer)[0];function ws(t){return(255&t)<<8|t>>8&255}const Ss=new Uint16Array([255]),Ps=255===new Uint8Array(Ss.buffer)[0],Ms=new Uint8Array(0);function As(t){const{data:e,width:n,height:i,channels:r,depth:a}=t,s=Math.ceil(a/8)*r,o=Math.ceil(a/8*r*n),l=new Uint8Array(i*o);let c,u,h=Ms,d=0;for(let f=0;f<i;f++){switch(c=e.subarray(d+1,d+1+o),u=l.subarray(f*o,(f+1)*o),e[d]){case 0:fs(c,u,o);break;case 1:ps(c,u,o,s);break;case 2:ms(c,u,h,o);break;case 3:gs(c,u,h,o,s);break;case 4:_s(c,u,h,o,s);break;default:throw new Error("Unsupported filter: ".concat(e[d]))}h=u,d+=o+1}if(16===a){const t=new Uint16Array(l.buffer);if(Ps)for(let e=0;e<t.length;e++)t[e]=ks(t[e]);return t}return l}function ks(t){return(255&t)<<8|t>>8&255}const Es=Uint8Array.of(137,80,78,71,13,10,26,10);function Ts(t){if(!function(t){if(t.length<Es.length)return!1;for(let e=0;e<Es.length;e++)if(t[e]!==Es[e])return!1;return!0}(t.readBytes(Es.length)))throw new Error("wrong PNG signature")}const Cs="tEXt",Is=new TextDecoder("latin1");function Ls(t){if(Ns(t),0===t.length||t.length>79)throw new Error("keyword length must be between 1 and 79")}const zs=/^[\u0000-\u00FF]*$/;function Ns(t){if(!zs.test(t))throw new Error("invalid latin1 text")}function Ds(t,e,n){const i=Rs(e);t[i]=function(t,e){return Is.decode(t.readBytes(e))}(e,n-i.length-1)}function Rs(t){for(t.mark();0!==t.readByte(););const e=t.offset;t.reset();const n=Is.decode(t.readBytes(e-t.offset-1));return t.skip(1),Ls(n),n}const Fs=-1,Os=0,Bs=2,js=3,Us=4,Gs=6,qs=-1,Vs=0,Zs=-1,Ws=0,Hs=-1,Xs=0,Ys=1,Ks=0,Js=1,$s=2,Qs=0,to=1;class eo extends Dn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t),(0,o.A)(this,"_checkCrc",void 0),(0,o.A)(this,"_inflator",void 0),(0,o.A)(this,"_png",void 0),(0,o.A)(this,"_apng",void 0),(0,o.A)(this,"_end",void 0),(0,o.A)(this,"_hasPalette",void 0),(0,o.A)(this,"_palette",void 0),(0,o.A)(this,"_hasTransparency",void 0),(0,o.A)(this,"_transparency",void 0),(0,o.A)(this,"_compressionMethod",void 0),(0,o.A)(this,"_filterMethod",void 0),(0,o.A)(this,"_interlaceMethod",void 0),(0,o.A)(this,"_colorType",void 0),(0,o.A)(this,"_isAnimated",void 0),(0,o.A)(this,"_numberOfFrames",void 0),(0,o.A)(this,"_numberOfPlays",void 0),(0,o.A)(this,"_frames",void 0),(0,o.A)(this,"_writingDataChunks",void 0);const{checkCrc:n=!1}=e;this._checkCrc=n,this._inflator=new os,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=qs,this._filterMethod=Zs,this._interlaceMethod=Hs,this._colorType=Fs,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Ts(this);!this._end;){const t=this.readUint32(),e=this.readChars(4);this.decodeChunk(t,e)}return this.decodeImage(),this._png}decodeApng(){for(Ts(this);!this._end;){const t=this.readUint32(),e=this.readChars(4);this.decodeApngChunk(t,e)}return this.decodeApngImage(),this._apng}decodeChunk(t,e){const n=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case Cs:Ds(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t)}if(this.offset-n!==t)throw new Error("Length mismatch while decoding chunk ".concat(e));this._checkCrc?ds(this,t+4,e):this.skip(4)}decodeApngChunk(t,e){const n=this.offset;switch("fdAT"!==e&&"IDAT"!==e&&this._writingDataChunks&&this.pushDataToFrame(),e){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,e),this.offset=n+t}if(this.offset-n!==t)throw new Error("Length mismatch while decoding chunk ".concat(e));this._checkCrc?ds(this,t+4,e):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=function(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error("invalid bit depth: ".concat(t));return t}(this.readUint8());const e=this.readUint8();let n;switch(this._colorType=e,e){case Os:n=1;break;case Bs:n=3;break;case js:n=1;break;case Us:n=2;break;case Gs:n=4;break;default:throw new Error("Unknown color type: ".concat(e))}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==Vs)throw new Error("Unsupported compression method: ".concat(this._compressionMethod));this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError("PLTE field length must be a multiple of 3. Got ".concat(t));const e=t/3;this._hasPalette=!0;const n=[];this._palette=n;for(let i=0;i<e;i++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const e=t,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,e)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let e=t,n=this.offset+this.byteOffset;if(n+=4,e-=4,this._inflator.push(new Uint8Array(this.buffer,n,e)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(t)}decodetRNS(t){switch(this._colorType){case Os:case Bs:if(t%2!==0)throw new RangeError("tRNS chunk length must be a multiple of 2. Got ".concat(t));if(t/2>this._png.width*this._png.height)throw new Error("tRNS chunk contains more alpha values than there are pixels (".concat(t/2," vs ").concat(this._png.width*this._png.height,")"));this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case js:{if(t>this._palette.length)throw new Error("tRNS chunk contains more alpha values than there are palette colors (".concat(t," vs ").concat(this._palette.length,")"));let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error("tRNS chunk is not supported for color type ".concat(this._colorType))}}decodeiCCP(t){const e=Rs(this),n=this.readUint8();if(n!==Vs)throw new Error("Unsupported iCCP compression method: ".concat(n));const i=this.readBytes(t-e.length-2);this._png.iccEmbeddedProfile={name:e,profile:ls(i)}}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),n=this.readByte();this._png.resolution={x:t,y:e,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const e={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(t);if(n){if(n.data=As({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===t||0===n.xOffset&&0===n.yOffset&&n.width===this._png.width&&n.height===this._png.height)e.data=n.data;else{const i=this._apng.frames.at(t-1);this.disposeFrame(n,i,e),this.addFrameDataToCanvas(e,n)}this._apng.frames.push(e)}}return this._apng}disposeFrame(t,e,n){switch(t.disposeOp){case Ks:break;case Js:for(let e=0;e<this._png.height;e++)for(let i=0;i<this._png.width;i++){const r=(e*t.width+i)*this._png.channels;for(let t=0;t<this._png.channels;t++)n.data[r+t]=0}break;case $s:n.data.set(e.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,e){const n=1<<this._png.depth,i=(t,n)=>({index:((t+e.yOffset)*this._png.width+e.xOffset+n)*this._png.channels,frameIndex:(t*e.width+n)*this._png.channels});switch(e.blendOp){case Qs:for(let n=0;n<e.height;n++)for(let r=0;r<e.width;r++){const{index:a,frameIndex:s}=i(n,r);for(let n=0;n<this._png.channels;n++)t.data[a+n]=e.data[s+n]}break;case to:for(let r=0;r<e.height;r++)for(let a=0;a<e.width;a++){const{index:s,frameIndex:o}=i(r,a);for(let i=0;i<this._png.channels;i++){const r=e.data[o+this._png.channels-1]/n,a=i%(this._png.channels-1)===0?1:e.data[o+i],l=Math.floor(r*a+(1-r)*t.data[s+i]);t.data[s+i]+=l}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var t;if(this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));const e=this._isAnimated?(null===(t=this._frames)||void 0===t?void 0:t.at(0)).data:this._inflator.result;if(this._filterMethod!==Ws)throw new Error("Filter method ".concat(this._filterMethod," not supported"));if(this._interlaceMethod===Xs)this._png.data=As({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else{if(this._interlaceMethod!==Ys)throw new Error("Interlace method ".concat(this._interlaceMethod," not supported"));this._png.data=function(t){const{data:e,width:n,height:i,channels:r,depth:a}=t,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*r,l=new Uint8Array(i*n*o);let c=0;for(let u=0;u<7;u++){const t=s[u],r=Math.ceil((n-t.x)/t.xStep),a=Math.ceil((i-t.y)/t.yStep);if(r<=0||a<=0)continue;const h=r*o,d=new Uint8Array(h);for(let s=0;s<a;s++){const a=e[c++],u=e.subarray(c,c+h);c+=h;const f=new Uint8Array(h);vs(a,u,f,d,h,o),d.set(f);for(let e=0;e<r;e++){const r=t.x+e*t.xStep,a=t.y+s*t.yStep;if(!(r>=n||a>=i))for(let t=0;t<o;t++)l[(a*n+r)*o+t]=f[e*o+t]}}}if(16===a){const t=new Uint16Array(l.buffer);if(xs)for(let e=0;e<t.length;e++)t[e]=ws(t[e]);return t}return l}({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth})}this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,e=this._frames.at(-1);e?e.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Ks,blendOp:Qs,data:t}),this._inflator=new os,this._writingDataChunks=!1}}var no;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"}(no||(no={}));var io=function(){return"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:this}();function ro(){io.console&&"function"==typeof io.console.log&&io.console.log.apply(io.console,arguments)}var ao={log:ro,warn:function(t){io.console&&("function"==typeof io.console.warn?io.console.warn.apply(io.console,arguments):ro.call(null,arguments))},error:function(t){io.console&&("function"==typeof io.console.error?io.console.error.apply(io.console,arguments):ro(t))}};function so(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){co(i.response,e,n)},i.onerror=function(){ao.error("could not download file")},i.send()}function oo(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(n){}return e.status>=200&&e.status<=299}function lo(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var co=io.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,Ge.A)(window))||window!==io?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(t,e,n){var i=io.URL||io.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"==typeof t?(r.href=t,r.origin!==location.origin?oo(r.href)?so(t,e,n):lo(r,r.target="_blank"):lo(r)):(r.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){lo(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download","string"==typeof t)if(oo(t))so(t,e,n);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){lo(i)})}else navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!==(0,Ge.A)(e)&&(ao.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}(t,n),e)}:function(t,e,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return so(t,e,n);var r="application/octet-stream"===t.type,a=/constructor/i.test(io.HTMLElement)||io.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||r&&a)&&"object"===("undefined"==typeof FileReader?"undefined":(0,Ge.A)(FileReader))){var o=new FileReader;o.onloadend=function(){var t=o.result;t=s?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},o.readAsDataURL(t)}else{var l=io.URL||io.webkitURL,c=l.createObjectURL(t);i?i.location=c:location.href=c,i=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function uo(t){var e;t=t||"",this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<n.length;i++){var r=n[i].re,a=n[i].process,s=r.exec(t);s&&(e=a(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),n=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==n.length&&(n="0"+n),"#"+t+e+n}}var ho=io.atob.bind(io),fo=io.btoa.bind(io);function po(t,e){var n=t[0],i=t[1],r=t[2],a=t[3];n=go(n,i,r,a,e[0],7,-680876936),a=go(a,n,i,r,e[1],12,-389564586),r=go(r,a,n,i,e[2],17,606105819),i=go(i,r,a,n,e[3],22,-1044525330),n=go(n,i,r,a,e[4],7,-176418897),a=go(a,n,i,r,e[5],12,1200080426),r=go(r,a,n,i,e[6],17,-1473231341),i=go(i,r,a,n,e[7],22,-45705983),n=go(n,i,r,a,e[8],7,1770035416),a=go(a,n,i,r,e[9],12,-1958414417),r=go(r,a,n,i,e[10],17,-42063),i=go(i,r,a,n,e[11],22,-1990404162),n=go(n,i,r,a,e[12],7,1804603682),a=go(a,n,i,r,e[13],12,-40341101),r=go(r,a,n,i,e[14],17,-1502002290),n=_o(n,i=go(i,r,a,n,e[15],22,1236535329),r,a,e[1],5,-165796510),a=_o(a,n,i,r,e[6],9,-1069501632),r=_o(r,a,n,i,e[11],14,643717713),i=_o(i,r,a,n,e[0],20,-373897302),n=_o(n,i,r,a,e[5],5,-701558691),a=_o(a,n,i,r,e[10],9,38016083),r=_o(r,a,n,i,e[15],14,-660478335),i=_o(i,r,a,n,e[4],20,-405537848),n=_o(n,i,r,a,e[9],5,568446438),a=_o(a,n,i,r,e[14],9,-1019803690),r=_o(r,a,n,i,e[3],14,-187363961),i=_o(i,r,a,n,e[8],20,1163531501),n=_o(n,i,r,a,e[13],5,-1444681467),a=_o(a,n,i,r,e[2],9,-51403784),r=_o(r,a,n,i,e[7],14,1735328473),n=yo(n,i=_o(i,r,a,n,e[12],20,-1926607734),r,a,e[5],4,-378558),a=yo(a,n,i,r,e[8],11,-2022574463),r=yo(r,a,n,i,e[11],16,1839030562),i=yo(i,r,a,n,e[14],23,-35309556),n=yo(n,i,r,a,e[1],4,-1530992060),a=yo(a,n,i,r,e[4],11,1272893353),r=yo(r,a,n,i,e[7],16,-155497632),i=yo(i,r,a,n,e[10],23,-1094730640),n=yo(n,i,r,a,e[13],4,681279174),a=yo(a,n,i,r,e[0],11,-358537222),r=yo(r,a,n,i,e[3],16,-722521979),i=yo(i,r,a,n,e[6],23,76029189),n=yo(n,i,r,a,e[9],4,-640364487),a=yo(a,n,i,r,e[12],11,-421815835),r=yo(r,a,n,i,e[15],16,530742520),n=vo(n,i=yo(i,r,a,n,e[2],23,-995338651),r,a,e[0],6,-198630844),a=vo(a,n,i,r,e[7],10,1126891415),r=vo(r,a,n,i,e[14],15,-1416354905),i=vo(i,r,a,n,e[5],21,-57434055),n=vo(n,i,r,a,e[12],6,1700485571),a=vo(a,n,i,r,e[3],10,-1894986606),r=vo(r,a,n,i,e[10],15,-1051523),i=vo(i,r,a,n,e[1],21,-2054922799),n=vo(n,i,r,a,e[8],6,1873313359),a=vo(a,n,i,r,e[15],10,-30611744),r=vo(r,a,n,i,e[6],15,-1560198380),i=vo(i,r,a,n,e[13],21,1309151649),n=vo(n,i,r,a,e[4],6,-145523070),a=vo(a,n,i,r,e[11],10,-1120210379),r=vo(r,a,n,i,e[2],15,718787259),i=vo(i,r,a,n,e[9],21,-343485551),t[0]=ko(n,t[0]),t[1]=ko(i,t[1]),t[2]=ko(r,t[2]),t[3]=ko(a,t[3])}function mo(t,e,n,i,r,a){return e=ko(ko(e,t),ko(i,a)),ko(e<<r|e>>>32-r,n)}function go(t,e,n,i,r,a,s){return mo(e&n|~e&i,t,e,r,a,s)}function _o(t,e,n,i,r,a,s){return mo(e&i|n&~i,t,e,r,a,s)}function yo(t,e,n,i,r,a,s){return mo(e^n^i,t,e,r,a,s)}function vo(t,e,n,i,r,a,s){return mo(n^(e|~i),t,e,r,a,s)}function bo(t){var e,n=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)po(i,xo(t.substring(e-64,e)));t=t.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)r[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(po(i,r),e=0;e<16;e++)r[e]=0;return r[14]=8*n,po(i,r),i}function xo(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}var wo="0123456789abcdef".split("");function So(t){for(var e="",n=0;n<4;n++)e+=wo[t>>8*n+4&15]+wo[t>>8*n&15];return e}function Po(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Mo(t){return bo(t).map(Po).join("")}var Ao="5d41402abc4b2a76b9719d911017c592"!=function(t){for(var e=0;e<t.length;e++)t[e]=So(t[e]);return t.join("")}(bo("hello"));function ko(t,e){if(Ao){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}return t+e&4294967295}function Eo(t,e){var n,i,r,a;if(t!==n){for(var s=(r=t,a=1+(256/t.length|0),new Array(a+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}n=t,i=o}else o=i;var h=e.length,d=0,f=0,p="";for(l=0;l<h;l++)f=(f+(u=o[d=(d+1)%256]))%256,o[d]=o[f],o[f]=u,s=o[(o[d]+o[f])%256],p+=String.fromCharCode(e.charCodeAt(l)^s);return p}var To={print:4,modify:8,copy:16,"annot-forms":32};function Co(t,e,n,i){this.v=1,this.r=2;var r=192;t.forEach(function(t){if(void 0!==To.perm)throw new Error("Invalid permission: "+t);r+=To[t]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var a=(e+this.padding).substr(0,32),s=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^r)),this.encryptionKey=Mo(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=Eo(this.encryptionKey,this.padding)}function Io(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",n=t.length,i=0;i<n;i++){var r=t.charCodeAt(i);e+=r<33||35===r||37===r||40===r||41===r||47===r||60===r||62===r||91===r||93===r||123===r||125===r||r>126?"#"+("0"+r.toString(16)).slice(-2):t[i]}return e}function Lo(t){if("object"!==(0,Ge.A)(t))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,i){if(i=i||!1,"string"!=typeof t||"function"!=typeof n||"boolean"!=typeof i)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var r=Math.random().toString(35);return e[t][r]=[n,!!i],r},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],0===Object.keys(e[n]).length&&delete e[n],!0;return!1},this.publish=function(n){if(e.hasOwnProperty(n)){var i=Array.prototype.slice.call(arguments,1),r=[];for(var a in e[n]){var s=e[n][a];try{s[0].apply(t,i)}catch(lo){io.console&&ao.error("jsPDF PubSub Error",lo.message,lo)}s[1]&&r.push(a)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function zo(t){if(!(this instanceof zo))return new zo(t);var e="opacity,stroke-opacity".split(",");for(var n in t)t.hasOwnProperty(n)&&e.indexOf(n)>=0&&(this[n]=t[n]);this.id="",this.objectNumber=-1}function No(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Do(t,e,n,i,r){if(!(this instanceof Do))return new Do(t,e,n,i,r);this.type="axial"===t?2:3,this.coords=e,this.colors=n,No.call(this,i,r)}function Ro(t,e,n,i,r){if(!(this instanceof Ro))return new Ro(t,e,n,i,r);this.boundingBox=t,this.xStep=e,this.yStep=n,this.stream="",this.cloneIndex=0,No.call(this,i,r)}function Fo(t){var e,n="string"==typeof arguments[0]?arguments[0]:"p",i=arguments[1],r=arguments[2],a=arguments[3],s=[],o=1,l=16,c="S",u=null;"object"===(0,Ge.A)(t=t||{})&&(n=t.orientation,i=t.unit||i,r=t.format||r,a=t.compress||t.compressPdf||a,null!==(u=t.encryption||null)&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o="number"==typeof t.userUnit?Math.abs(t.userUnit):1,void 0!==t.precision&&(e=t.precision),void 0!==t.floatPrecision&&(l=t.floatPrecision),c=t.defaultPathOperation||"S"),s=t.filters||(!0===a?["FlateEncode"]:s),i=i||"mm",n=(""+(n||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,d={},f={internal:{},__private__:{}};f.__private__.PubSub=Lo;var p="1.3",m=f.__private__.getPdfVersion=function(){return p};f.__private__.setPdfVersion=function(t){p=t};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return g};var _=f.__private__.getPageFormat=function(t){return g[t]};r=r||"a4";var y="compat",v="advanced",b=y;function x(){this.saveGraphicsState(),J(new It(dt,0,0,-dt,0,pn()*dt).toString()+" cm"),this.setFontSize(this.getFontSize()/dt),c="n",b=v}function w(){this.restoreGraphicsState(),c="S",b=y}var S=f.__private__.combineFontStyleAndFontWeight=function(t,e){if("bold"==t&&"normal"==e||"bold"==t&&400==e||"normal"==t&&"italic"==e||"bold"==t&&"italic"==e)throw new Error("Invalid Combination of fontweight and fontstyle");return e&&(t=400==e||"normal"===e?"italic"===t?"italic":"normal":700!=e&&"bold"!==e||"normal"!==t?(700==e?"bold":e)+""+t:"bold"),t};f.advancedAPI=function(t){var e=b===y;return e&&x.call(this),"function"!=typeof t||(t(this),e&&w.call(this)),this},f.compatAPI=function(t){var e=b===v;return e&&w.call(this),"function"!=typeof t||(t(this),e&&x.call(this)),this},f.isAdvancedAPI=function(){return b===v};var P,M=function(t){if(b!==v)throw new Error(t+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},A=f.roundToPrecision=f.__private__.roundToPrecision=function(t,n){var i=e||n;if(isNaN(t)||isNaN(i))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return t.toFixed(i).replace(/0+$/,"")};P=f.hpf=f.__private__.hpf="number"==typeof l?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return A(t,l)}:"smart"===l?function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return A(t,t>-1&&t<1?16:5)}:function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.hpf");return A(t,16)};var k=f.f2=f.__private__.f2=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f2");return A(t,2)},E=f.__private__.f3=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.f3");return A(t,3)},T=f.scale=f.__private__.scale=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.scale");return b===y?t*dt:b===v?t:void 0},C=function(t){return T(function(t){return b===y?pn()-t:b===v?t:void 0}(t))};f.__private__.setPrecision=f.setPrecision=function(t){"number"==typeof parseInt(t,10)&&(e=parseInt(t,10))};var I,L="00000000000000000000000000000000",z=f.__private__.getFileId=function(){return L},N=f.__private__.setFileId=function(t){return L=void 0!==t&&/^[a-fA-F0-9]{32}$/.test(t)?t.toUpperCase():L.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==u&&(ye=new Co(u.userPermissions,u.userPassword,u.ownerPassword,L)),L};f.setFileId=function(t){return N(t),this},f.getFileId=function(){return z()};var D=f.__private__.convertDateToPDFDate=function(t){var e=t.getTimezoneOffset(),n=e<0?"+":"-",i=Math.floor(Math.abs(e/60)),r=Math.abs(e%60),a=[n,j(i),"'",j(r),"'"].join("");return["D:",t.getFullYear(),j(t.getMonth()+1),j(t.getDate()),j(t.getHours()),j(t.getMinutes()),j(t.getSeconds()),a].join("")},R=f.__private__.convertPDFDateToDate=function(t){var e=parseInt(t.substr(2,4),10),n=parseInt(t.substr(6,2),10)-1,i=parseInt(t.substr(8,2),10),r=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),s=parseInt(t.substr(14,2),10);return new Date(e,n,i,r,a,s,0)},F=f.__private__.setCreationDate=function(t){var e;if(void 0===t&&(t=new Date),t instanceof Date)e=D(t);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(t))throw new Error("Invalid argument passed to jsPDF.setCreationDate");e=t}return I=e},O=f.__private__.getCreationDate=function(t){var e=I;return"jsDate"===t&&(e=R(I)),e};f.setCreationDate=function(t){return F(t),this},f.getCreationDate=function(t){return O(t)};var B,j=f.__private__.padd2=function(t){return("0"+parseInt(t)).slice(-2)},U=f.__private__.padd2Hex=function(t){return("00"+(t=t.toString())).substr(t.length)},G=0,q=[],V=[],Z=0,W=[],H=[],X=!1,Y=V;f.__private__.setCustomOutputDestination=function(t){X=!0,Y=t};var K=function(t){X||(Y=t)};f.__private__.resetCustomOutputDestination=function(){X=!1,Y=V};var J=f.__private__.out=function(t){return t=t.toString(),Z+=t.length+1,Y.push(t),Y},$=f.__private__.write=function(t){return J(1===arguments.length?t.toString():Array.prototype.join.call(arguments," "))},Q=f.__private__.getArrayBuffer=function(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n);e--;)i[e]=t.charCodeAt(e);return n},tt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return tt};var et=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(t){return et=b===v?t/dt:t,this};var nt,it=f.__private__.getFontSize=f.getFontSize=function(){return b===y?et:et*dt},rt=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(t){return rt=t,this},f.__private__.getR2L=f.getR2L=function(){return rt};var at,st=f.__private__.setZoomMode=function(t){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(t))nt=t;else if(isNaN(t)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(t))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+t+'" is not recognized.');nt=t}else nt=parseInt(t,10)};f.__private__.getZoomMode=function(){return nt};var ot,lt=f.__private__.setPageMode=function(t){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(t))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+t+'" is not recognized.');at=t};f.__private__.getPageMode=function(){return at};var ct=f.__private__.setLayoutMode=function(t){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(t))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+t+'" is not recognized.');ot=t};f.__private__.getLayoutMode=function(){return ot},f.__private__.setDisplayMode=f.setDisplayMode=function(t,e,n){return st(t),ct(e),lt(n),this};var ut={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(t){if(-1===Object.keys(ut).indexOf(t))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ut[t]},f.__private__.getDocumentProperties=function(){return ut},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(t){for(var e in ut)ut.hasOwnProperty(e)&&t[e]&&(ut[e]=t[e]);return this},f.__private__.setDocumentProperty=function(t,e){if(-1===Object.keys(ut).indexOf(t))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ut[t]=e};var ht,dt,ft,pt,mt,gt={},_t={},yt=[],vt={},bt={},xt={},wt={},St=null,Pt=0,Mt=[],At=new Lo(f),kt=t.hotfixes||[],Et={},Tt={},Ct=[],It=function t(e,n,i,r,a,s){if(!(this instanceof t))return new t(e,n,i,r,a,s);isNaN(e)&&(e=1),isNaN(n)&&(n=0),isNaN(i)&&(i=0),isNaN(r)&&(r=1),isNaN(a)&&(a=0),isNaN(s)&&(s=0),this._matrix=[e,n,i,r,a,s]};Object.defineProperty(It.prototype,"sx",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(It.prototype,"shy",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(It.prototype,"shx",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(It.prototype,"sy",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(It.prototype,"tx",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(It.prototype,"ty",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(It.prototype,"a",{get:function(){return this._matrix[0]},set:function(t){this._matrix[0]=t}}),Object.defineProperty(It.prototype,"b",{get:function(){return this._matrix[1]},set:function(t){this._matrix[1]=t}}),Object.defineProperty(It.prototype,"c",{get:function(){return this._matrix[2]},set:function(t){this._matrix[2]=t}}),Object.defineProperty(It.prototype,"d",{get:function(){return this._matrix[3]},set:function(t){this._matrix[3]=t}}),Object.defineProperty(It.prototype,"e",{get:function(){return this._matrix[4]},set:function(t){this._matrix[4]=t}}),Object.defineProperty(It.prototype,"f",{get:function(){return this._matrix[5]},set:function(t){this._matrix[5]=t}}),Object.defineProperty(It.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(It.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(It.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(It.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),It.prototype.join=function(t){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(P).join(t)},It.prototype.multiply=function(t){var e=t.sx*this.sx+t.shy*this.shx,n=t.sx*this.shy+t.shy*this.sy,i=t.shx*this.sx+t.sy*this.shx,r=t.shx*this.shy+t.sy*this.sy,a=t.tx*this.sx+t.ty*this.shx+this.tx,s=t.tx*this.shy+t.ty*this.sy+this.ty;return new It(e,n,i,r,a,s)},It.prototype.decompose=function(){var t=this.sx,e=this.shy,n=this.shx,i=this.sy,r=this.tx,a=this.ty,s=Math.sqrt(t*t+e*e),o=(t/=s)*n+(e/=s)*i;n-=t*o,i-=e*o;var l=Math.sqrt(n*n+i*i);return o/=l,t*(i/=l)<e*(n/=l)&&(t=-t,e=-e,o=-o,s=-s),{scale:new It(s,0,0,l,0,0),translate:new It(1,0,0,1,r,a),rotate:new It(t,e,-e,t,0,0),skew:new It(1,0,o,1,0,0)}},It.prototype.toString=function(t){return this.join(" ")},It.prototype.inversed=function(){var t=this.sx,e=this.shy,n=this.shx,i=this.sy,r=this.tx,a=this.ty,s=1/(t*i-e*n),o=i*s,l=-e*s,c=-n*s,u=t*s;return new It(o,l,c,u,-o*r-c*a,-l*r-u*a)},It.prototype.applyToPoint=function(t){var e=t.x*this.sx+t.y*this.shx+this.tx,n=t.x*this.shy+t.y*this.sy+this.ty;return new nn(e,n)},It.prototype.applyToRectangle=function(t){var e=this.applyToPoint(t),n=this.applyToPoint(new nn(t.x+t.w,t.y+t.h));return new rn(e.x,e.y,n.x-e.x,n.y-e.y)},It.prototype.clone=function(){var t=this.sx,e=this.shy,n=this.shx,i=this.sy,r=this.tx,a=this.ty;return new It(t,e,n,i,r,a)},f.Matrix=It;var Lt=f.matrixMult=function(t,e){return e.multiply(t)},zt=new It(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=zt;var Nt=function(t,e){if(!bt[t]){var n=(e instanceof Do?"Sh":"P")+(Object.keys(vt).length+1).toString(10);e.id=n,bt[t]=n,vt[n]=e,At.publish("addPattern",e)}};f.ShadingPattern=Do,f.TilingPattern=Ro,f.addShadingPattern=function(t,e){return M("addShadingPattern()"),Nt(t,e),this},f.beginTilingPattern=function(t){M("beginTilingPattern()"),sn(t.boundingBox[0],t.boundingBox[1],t.boundingBox[2]-t.boundingBox[0],t.boundingBox[3]-t.boundingBox[1],t.matrix)},f.endTilingPattern=function(t,e){M("endTilingPattern()"),e.stream=H[B].join("\n"),Nt(t,e),At.publish("endTilingPattern",e),Ct.pop().restore()};var Dt,Rt=f.__private__.newObject=function(){var t=Ft();return Ot(t,!0),t},Ft=f.__private__.newObjectDeferred=function(){return G++,q[G]=function(){return Z},G},Ot=function(t,e){return e="boolean"==typeof e&&e,q[t]=Z,e&&J(t+" 0 obj"),t},Bt=f.__private__.newAdditionalObject=function(){var t={objId:Ft(),content:""};return W.push(t),t},jt=Ft(),Ut=Ft(),Gt=f.__private__.decodeColorString=function(t){var e=t.split(" ");if(2!==e.length||"g"!==e[1]&&"G"!==e[1])5!==e.length||"k"!==e[4]&&"K"!==e[4]||(e=[(1-e[0])*(1-e[3]),(1-e[1])*(1-e[3]),(1-e[2])*(1-e[3]),"r"]);else{var n=parseFloat(e[0]);e=[n,n,n,"r"]}for(var i="#",r=0;r<3;r++)i+=("0"+Math.floor(255*parseFloat(e[r])).toString(16)).slice(-2);return i},qt=f.__private__.encodeColorString=function(t){var e;"string"==typeof t&&(t={ch1:t});var n=t.ch1,i=t.ch2,r=t.ch3,a=t.ch4,s="draw"===t.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof n&&"#"!==n.charAt(0)){var o=new uo(n);if(o.ok)n=o.toHex();else if(!/^\d*\.?\d*$/.test(n))throw new Error('Invalid color "'+n+'" passed to jsPDF.encodeColorString.')}if("string"==typeof n&&/^#[0-9A-Fa-f]{3}$/.test(n)&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),"string"==typeof n&&/^#[0-9A-Fa-f]{6}$/.test(n)){var l=parseInt(n.substr(1),16);n=l>>16&255,i=l>>8&255,r=255&l}if(void 0===i||void 0===a&&n===i&&i===r)e="string"==typeof n?n+" "+s[0]:2===t.precision?k(n/255)+" "+s[0]:E(n/255)+" "+s[0];else if(void 0===a||"object"===(0,Ge.A)(a)){if(a&&!isNaN(a.a)&&0===a.a)return["1.","1.","1.",s[1]].join(" ");e="string"==typeof n?[n,i,r,s[1]].join(" "):2===t.precision?[k(n/255),k(i/255),k(r/255),s[1]].join(" "):[E(n/255),E(i/255),E(r/255),s[1]].join(" ")}else e="string"==typeof n?[n,i,r,a,s[2]].join(" "):2===t.precision?[k(n),k(i),k(r),k(a),s[2]].join(" "):[E(n),E(i),E(r),E(a),s[2]].join(" ");return e},Vt=f.__private__.getFilters=function(){return s},Zt=f.__private__.putStream=function(t){var e=(t=t||{}).data||"",n=t.filters||Vt(),i=t.alreadyAppliedFilters||[],r=t.addLength1||!1,a=e.length,s=t.objectId,o=function(t){return t};if(null!==u&&void 0===s)throw new Error("ObjectId must be passed to putStream for file encryption");null!==u&&(o=ye.encryptor(s,0));var l={};!0===n&&(n=["FlateEncode"]);var c=t.additionalKeyValues||[],h=(l=void 0!==Fo.API.processDataByFilters?Fo.API.processDataByFilters(e,n):{data:e,reverseChain:[]}).reverseChain+(Array.isArray(i)?i.join(" "):i.toString());if(0!==l.data.length&&(c.push({key:"Length",value:l.data.length}),!0===r&&c.push({key:"Length1",value:a})),0!=h.length)if(h.split("/").length-1==1)c.push({key:"Filter",value:h});else{c.push({key:"Filter",value:"["+h+"]"});for(var d=0;d<c.length;d+=1)if("DecodeParms"===c[d].key){for(var f=[],p=0;p<l.reverseChain.split("/").length-1;p+=1)f.push("null");f.push(c[d].value),c[d].value="["+f.join(" ")+"]"}}J("<<");for(var m=0;m<c.length;m++)J("/"+c[m].key+" "+c[m].value);J(">>"),0!==l.data.length&&(J("stream"),J(o(l.data)),J("endstream"))},Wt=f.__private__.putPage=function(t){var e=t.number,n=t.data,i=t.objId,r=t.contentsObjId;Ot(i,!0),J("<</Type /Page"),J("/Parent "+t.rootDictionaryObjId+" 0 R"),J("/Resources "+t.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(P(t.mediaBox.bottomLeftX))+" "+parseFloat(P(t.mediaBox.bottomLeftY))+" "+P(t.mediaBox.topRightX)+" "+P(t.mediaBox.topRightY)+"]"),null!==t.cropBox&&J("/CropBox ["+P(t.cropBox.bottomLeftX)+" "+P(t.cropBox.bottomLeftY)+" "+P(t.cropBox.topRightX)+" "+P(t.cropBox.topRightY)+"]"),null!==t.bleedBox&&J("/BleedBox ["+P(t.bleedBox.bottomLeftX)+" "+P(t.bleedBox.bottomLeftY)+" "+P(t.bleedBox.topRightX)+" "+P(t.bleedBox.topRightY)+"]"),null!==t.trimBox&&J("/TrimBox ["+P(t.trimBox.bottomLeftX)+" "+P(t.trimBox.bottomLeftY)+" "+P(t.trimBox.topRightX)+" "+P(t.trimBox.topRightY)+"]"),null!==t.artBox&&J("/ArtBox ["+P(t.artBox.bottomLeftX)+" "+P(t.artBox.bottomLeftY)+" "+P(t.artBox.topRightX)+" "+P(t.artBox.topRightY)+"]"),"number"==typeof t.userUnit&&1!==t.userUnit&&J("/UserUnit "+t.userUnit),At.publish("putPage",{objId:i,pageContext:Mt[e],pageNumber:e,page:n}),J("/Contents "+r+" 0 R"),J(">>"),J("endobj");var a=n.join("\n");return b===v&&(a+="\nQ"),Ot(r,!0),Zt({data:a,filters:Vt(),objectId:r}),J("endobj"),i},Ht=f.__private__.putPages=function(){var t,e,n=[];for(t=1;t<=Pt;t++)Mt[t].objId=Ft(),Mt[t].contentsObjId=Ft();for(t=1;t<=Pt;t++)n.push(Wt({number:t,data:H[t],objId:Mt[t].objId,contentsObjId:Mt[t].contentsObjId,mediaBox:Mt[t].mediaBox,cropBox:Mt[t].cropBox,bleedBox:Mt[t].bleedBox,trimBox:Mt[t].trimBox,artBox:Mt[t].artBox,userUnit:Mt[t].userUnit,rootDictionaryObjId:jt,resourceDictionaryObjId:Ut}));Ot(jt,!0),J("<</Type /Pages");var i="/Kids [";for(e=0;e<Pt;e++)i+=n[e]+" 0 R ";J(i+"]"),J("/Count "+Pt),J(">>"),J("endobj"),At.publish("postPutPages")},Xt=function(t){At.publish("putFont",{font:t,out:J,newObject:Rt,putStream:Zt}),!0!==t.isAlreadyPutted&&(t.objectNumber=Rt(),J("<<"),J("/Type /Font"),J("/BaseFont /"+Io(t.postScriptName)),J("/Subtype /Type1"),"string"==typeof t.encoding&&J("/Encoding /"+t.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},Yt=function(t){t.objectNumber=Rt();var e=[];e.push({key:"Type",value:"/XObject"}),e.push({key:"Subtype",value:"/Form"}),e.push({key:"BBox",value:"["+[P(t.x),P(t.y),P(t.x+t.width),P(t.y+t.height)].join(" ")+"]"}),e.push({key:"Matrix",value:"["+t.matrix.toString()+"]"});var n=t.pages[1].join("\n");Zt({data:n,additionalKeyValues:e,objectId:t.objectNumber}),J("endobj")},Kt=function(t,e){e||(e=21);var n=Rt(),i=function(t,e){var n,i=[],r=1/(e-1);for(n=0;n<1;n+=r)i.push(n);if(i.push(1),0!=t[0].offset){var a={offset:0,color:t[0].color};t.unshift(a)}if(1!=t[t.length-1].offset){var s={offset:1,color:t[t.length-1].color};t.push(s)}for(var o="",l=0,c=0;c<i.length;c++){for(n=i[c];n>t[l+1].offset;)l++;var u=t[l].offset,h=(n-u)/(t[l+1].offset-u),d=t[l].color,f=t[l+1].color;o+=U(Math.round((1-h)*d[0]+h*f[0]).toString(16))+U(Math.round((1-h)*d[1]+h*f[1]).toString(16))+U(Math.round((1-h)*d[2]+h*f[2]).toString(16))}return o.trim()}(t.colors,e),r=[];r.push({key:"FunctionType",value:"0"}),r.push({key:"Domain",value:"[0.0 1.0]"}),r.push({key:"Size",value:"["+e+"]"}),r.push({key:"BitsPerSample",value:"8"}),r.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),r.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zt({data:i,additionalKeyValues:r,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n}),J("endobj"),t.objectNumber=Rt(),J("<< /ShadingType "+t.type),J("/ColorSpace /DeviceRGB");var a="/Coords ["+P(parseFloat(t.coords[0]))+" "+P(parseFloat(t.coords[1]))+" ";2===t.type?a+=P(parseFloat(t.coords[2]))+" "+P(parseFloat(t.coords[3])):a+=P(parseFloat(t.coords[2]))+" "+P(parseFloat(t.coords[3]))+" "+P(parseFloat(t.coords[4]))+" "+P(parseFloat(t.coords[5])),J(a+="]"),t.matrix&&J("/Matrix ["+t.matrix.toString()+"]"),J("/Function "+n+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},Jt=function(t,e){var n=Ft(),i=Rt();e.push({resourcesOid:n,objectOid:i}),t.objectNumber=i;var r=[];r.push({key:"Type",value:"/Pattern"}),r.push({key:"PatternType",value:"1"}),r.push({key:"PaintType",value:"1"}),r.push({key:"TilingType",value:"1"}),r.push({key:"BBox",value:"["+t.boundingBox.map(P).join(" ")+"]"}),r.push({key:"XStep",value:P(t.xStep)}),r.push({key:"YStep",value:P(t.yStep)}),r.push({key:"Resources",value:n+" 0 R"}),t.matrix&&r.push({key:"Matrix",value:"["+t.matrix.toString()+"]"}),Zt({data:t.stream,additionalKeyValues:r,objectId:t.objectNumber}),J("endobj")},$t=function(t){for(var e in t.objectNumber=Rt(),J("<<"),t)switch(e){case"opacity":J("/ca "+k(t[e]));break;case"stroke-opacity":J("/CA "+k(t[e]))}J(">>"),J("endobj")},Qt=function(t){Ot(t.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var t in J("/Font <<"),gt)gt.hasOwnProperty(t)&&(!1===h||!0===h&&d.hasOwnProperty(t))&&J("/"+t+" "+gt[t].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(vt).length>0){for(var t in J("/Shading <<"),vt)vt.hasOwnProperty(t)&&vt[t]instanceof Do&&vt[t].objectNumber>=0&&J("/"+t+" "+vt[t].objectNumber+" 0 R");At.publish("putShadingPatternDict"),J(">>")}}(),function(t){if(Object.keys(vt).length>0){for(var e in J("/Pattern <<"),vt)vt.hasOwnProperty(e)&&vt[e]instanceof f.TilingPattern&&vt[e].objectNumber>=0&&vt[e].objectNumber<t&&J("/"+e+" "+vt[e].objectNumber+" 0 R");At.publish("putTilingPatternDict"),J(">>")}}(t.objectOid),function(){if(Object.keys(xt).length>0){var t;for(t in J("/ExtGState <<"),xt)xt.hasOwnProperty(t)&&xt[t].objectNumber>=0&&J("/"+t+" "+xt[t].objectNumber+" 0 R");At.publish("putGStateDict"),J(">>")}}(),function(){for(var t in J("/XObject <<"),Et)Et.hasOwnProperty(t)&&Et[t].objectNumber>=0&&J("/"+t+" "+Et[t].objectNumber+" 0 R");At.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},te=function(t){_t[t.fontName]=_t[t.fontName]||{},_t[t.fontName][t.fontStyle]=t.id},ee=function(t,e,n,i,r){var a={id:"F"+(Object.keys(gt).length+1).toString(10),postScriptName:t,fontName:e,fontStyle:n,encoding:i,isStandardFont:r||!1,metadata:{}};return At.publish("addFont",{font:a,instance:this}),gt[a.id]=a,te(a),a.id},ne=f.__private__.pdfEscape=f.pdfEscape=function(t,e){return function(t,e){var n,i,r,a,s,o,l,c,u;if(r=(e=e||{}).sourceEncoding||"Unicode",s=e.outputEncoding,(e.autoencode||s)&&gt[ht].metadata&&gt[ht].metadata[r]&&gt[ht].metadata[r].encoding&&(a=gt[ht].metadata[r].encoding,!s&&gt[ht].encoding&&(s=gt[ht].encoding),!s&&a.codePages&&(s=a.codePages[0]),"string"==typeof s&&(s=a[s]),s)){for(l=!1,o=[],n=0,i=t.length;n<i;n++)(c=s[t.charCodeAt(n)])?o.push(String.fromCharCode(c)):o.push(t[n]),o[n].charCodeAt(0)>>8&&(l=!0);t=o.join("")}for(n=t.length;void 0===l&&0!==n;)t.charCodeAt(n-1)>>8&&(l=!0),n--;if(!l)return t;for(o=e.noBOM?[]:[254,255],n=0,i=t.length;n<i;n++){if((u=(c=t.charCodeAt(n))>>8)>>8)throw new Error("Character at position "+n+" of string '"+t+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(u),o.push(c-(u<<8))}return String.fromCharCode.apply(void 0,o)}(t,e).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ie=f.__private__.beginPage=function(t){H[++Pt]=[],Mt[Pt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(t[0]),topRightY:Number(t[1])}},se(Pt),K(H[B])},re=function(t,e){var i,a,s;switch(n=e||n,"string"==typeof t&&(i=_(t.toLowerCase()),Array.isArray(i)&&(a=i[0],s=i[1])),Array.isArray(t)&&(a=t[0]*dt,s=t[1]*dt),isNaN(a)&&(a=r[0],s=r[1]),(a>14400||s>14400)&&(ao.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),a=Math.min(14400,a),s=Math.min(14400,s)),r=[a,s],n.substr(0,1)){case"l":s>a&&(r=[s,a]);break;case"p":a>s&&(r=[s,a])}ie(r),Oe(Re),J(He),0!==Qe&&J(Qe+" J"),0!==tn&&J(tn+" j"),At.publish("addPage",{pageNumber:Pt})},ae=function(t){t>0&&t<=Pt&&(H.splice(t,1),Mt.splice(t,1),Pt--,B>Pt&&(B=Pt),this.setPage(B))},se=function(t){t>0&&t<=Pt&&(B=t)},oe=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return H.length-1},le=function(t,e,n){var i,r=void 0;return n=n||{},t=void 0!==t?t:gt[ht].fontName,e=void 0!==e?e:gt[ht].fontStyle,i=t.toLowerCase(),void 0!==_t[i]&&void 0!==_t[i][e]?r=_t[i][e]:void 0!==_t[t]&&void 0!==_t[t][e]?r=_t[t][e]:!1===n.disableWarning&&ao.warn("Unable to look up font label for font '"+t+"', '"+e+"'. Refer to getFontList() for available fonts."),r||n.noFallback||null==(r=_t.times[e])&&(r=_t.times.normal),r},ce=f.__private__.putInfo=function(){var t=Rt(),e=function(t){return t};for(var n in null!==u&&(e=ye.encryptor(t,0)),J("<<"),J("/Producer ("+ne(e("jsPDF "+Fo.version))+")"),ut)ut.hasOwnProperty(n)&&ut[n]&&J("/"+n.substr(0,1).toUpperCase()+n.substr(1)+" ("+ne(e(ut[n]))+")");J("/CreationDate ("+ne(e(I))+")"),J(">>"),J("endobj")},ue=f.__private__.putCatalog=function(t){var e=(t=t||{}).rootDictionaryObjId||jt;switch(Rt(),J("<<"),J("/Type /Catalog"),J("/Pages "+e+" 0 R"),nt||(nt="fullwidth"),nt){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n=""+nt;"%"===n.substr(n.length-1)&&(nt=parseInt(nt)/100),"number"==typeof nt&&J("/OpenAction [3 0 R /XYZ null null "+k(nt)+"]")}switch(ot||(ot="continuous"),ot){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}at&&J("/PageMode /"+at),At.publish("putCatalog"),J(">>"),J("endobj")},he=f.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(G+1)),J("/Root "+G+" 0 R"),J("/Info "+(G-1)+" 0 R"),null!==u&&J("/Encrypt "+ye.oid+" 0 R"),J("/ID [ <"+L+"> <"+L+"> ]"),J(">>")},de=f.__private__.putHeader=function(){J("%PDF-"+p),J("%\xba\xdf\xac\xe0")},fe=f.__private__.putXRef=function(){var t="0000000000";J("xref"),J("0 "+(G+1)),J("0000000000 65535 f ");for(var e=1;e<=G;e++)"function"==typeof q[e]?J((t+q[e]()).slice(-10)+" 00000 n "):void 0!==q[e]?J((t+q[e]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},pe=f.__private__.buildDocument=function(){var t;G=0,Z=0,V=[],q=[],W=[],jt=Ft(),Ut=Ft(),K(V),At.publish("buildDocument"),de(),Ht(),function(){At.publish("putAdditionalObjects");for(var t=0;t<W.length;t++){var e=W[t];Ot(e.objId,!0),J(e.content),J("endobj")}At.publish("postPutAdditionalObjects")}(),t=[],function(){for(var t in gt)gt.hasOwnProperty(t)&&(!1===h||!0===h&&d.hasOwnProperty(t))&&Xt(gt[t])}(),function(){var t;for(t in xt)xt.hasOwnProperty(t)&&$t(xt[t])}(),function(){for(var t in Et)Et.hasOwnProperty(t)&&Yt(Et[t])}(),function(t){var e;for(e in vt)vt.hasOwnProperty(e)&&(vt[e]instanceof Do?Kt(vt[e]):vt[e]instanceof Ro&&Jt(vt[e],t))}(t),At.publish("putResources"),t.forEach(Qt),Qt({resourcesOid:Ut,objectOid:Number.MAX_SAFE_INTEGER}),At.publish("postPutResources"),null!==u&&(ye.oid=Rt(),J("<<"),J("/Filter /Standard"),J("/V "+ye.v),J("/R "+ye.r),J("/U <"+ye.toHexString(ye.U)+">"),J("/O <"+ye.toHexString(ye.O)+">"),J("/P "+ye.P),J(">>"),J("endobj")),ce(),ue();var e=Z;return fe(),he(),J("startxref"),J(""+e),J("%%EOF"),K(H[B]),V.join("\n")},me=f.__private__.getBlob=function(t){return new Blob([Q(t)],{type:"application/pdf"})},ge=f.output=f.__private__.output=(Dt=function(t,e){switch("string"==typeof(e=e||{})?e={filename:e}:e.filename=e.filename||"generated.pdf",t){case void 0:return pe();case"save":f.save(e.filename);break;case"arraybuffer":return Q(pe());case"blob":return me(pe());case"bloburi":case"bloburl":if(void 0!==io.URL&&"function"==typeof io.URL.createObjectURL)return io.URL&&io.URL.createObjectURL(me(pe()))||void 0;ao.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n="",i=pe();try{n=fo(i)}catch(u){n=fo(unescape(encodeURIComponent(i)))}return"data:application/pdf;filename="+e.filename+";base64,"+n;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(io)){var r="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",a=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';e.pdfObjectUrl&&(r=e.pdfObjectUrl,a="");var s='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+r+'"'+a+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(e)+");<\/script></body></html>",o=io.open();return null!==o&&o.document.write(s),o}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(io)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(e.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+e.filename+'" width="500px" height="400px" /></body></html>',c=io.open();if(null!==c){c.document.write(l);var h=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=e.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(h.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(io))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var d='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",e)+'"></iframe></body></html>',p=io.open();if(null!==p&&(p.document.write(d),p.document.title=e.filename),p||"undefined"==typeof safari)return p;break;case"datauri":case"dataurl":return io.document.location.href=this.output("datauristring",e);default:return null}},Dt.foo=function(){try{return Dt.apply(this,arguments)}catch(e){var t=e.stack||"";~t.indexOf(" at ")&&(t=t.split(" at ")[1]);var n="Error in function "+t.split("\n")[0].split("<")[0]+": "+e.message;if(!io.console)throw new Error(n);io.console.error(n,e),io.alert&&alert(n)}},Dt.foo.bar=Dt,Dt.foo),_e=function(t){return!0===Array.isArray(kt)&&kt.indexOf(t)>-1};switch(i){case"pt":dt=1;break;case"mm":dt=72/25.4;break;case"cm":dt=72/2.54;break;case"in":dt=72;break;case"px":dt=1==_e("px_scaling")?.75:96/72;break;case"pc":case"em":dt=12;break;case"ex":dt=6;break;default:if("number"!=typeof i)throw new Error("Invalid unit: "+i);dt=i}var ye=null;F(),N();var ve=f.__private__.getPageInfo=f.getPageInfo=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Mt[t].objId,pageNumber:t,pageContext:Mt[t]}},be=f.__private__.getPageInfoByObjId=function(t){if(isNaN(t)||t%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var e in Mt)if(Mt[e].objId===t)break;return ve(e)},xe=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Mt[B].objId,pageNumber:B,pageContext:Mt[B]}};f.addPage=function(){return re.apply(this,arguments),this},f.setPage=function(){return se.apply(this,arguments),K.call(this,H[B]),this},f.insertPage=function(t){return this.addPage(),this.movePage(B,t),this},f.movePage=function(t,e){var n,i;if(t>e){n=H[t],i=Mt[t];for(var r=t;r>e;r--)H[r]=H[r-1],Mt[r]=Mt[r-1];H[e]=n,Mt[e]=i,this.setPage(e)}else if(t<e){n=H[t],i=Mt[t];for(var a=t;a<e;a++)H[a]=H[a+1],Mt[a]=Mt[a+1];H[e]=n,Mt[e]=i,this.setPage(e)}return this},f.deletePage=function(){return ae.apply(this,arguments),this},f.__private__.text=f.text=function(t,e,n,i,r){var a,s,o,l,c,u,h,f,p,m=(i=i||{}).scope||this;if("number"==typeof t&&"number"==typeof e&&("string"==typeof n||Array.isArray(n))){var g=n;n=e,e=t,t=g}if(arguments[3]instanceof It==0?(o=arguments[4],l=arguments[5],"object"===(0,Ge.A)(h=arguments[3])&&null!==h||("string"==typeof o&&(l=o,o=null),"string"==typeof h&&(l=h,h=null),"number"==typeof h&&(o=h,h=null),i={flags:h,angle:o,align:l})):(M("The transform parameter of text() with a Matrix value"),p=r),isNaN(e)||isNaN(n)||null==t)throw new Error("Invalid arguments passed to jsPDF.text");if(0===t.length)return m;var _,y="",x="number"==typeof i.lineHeightFactor?i.lineHeightFactor:De,w=m.internal.scaleFactor;function S(t){return t=t.split("\t").join(Array(i.TabLen||9).join(" ")),ne(t,h)}function A(t){for(var e,n=t.concat(),i=[],r=n.length;r--;)"string"==typeof(e=n.shift())?i.push(e):Array.isArray(t)&&(1===e.length||void 0===e[1]&&void 0===e[2])?i.push(e[0]):i.push([e[0],e[1],e[2]]);return i}function k(t,e){var n;if("string"==typeof t)n=e(t)[0];else if(Array.isArray(t)){for(var i,r,a=t.concat(),s=[],o=a.length;o--;)"string"==typeof(i=a.shift())?s.push(e(i)[0]):Array.isArray(i)&&"string"==typeof i[0]&&(r=e(i[0],i[1],i[2]),s.push([r[0],r[1],r[2]]));n=s}return n}var E=!1,C=!0;if("string"==typeof t)E=!0;else if(Array.isArray(t)){var I=t.concat();s=[];for(var L,z=I.length;z--;)("string"!=typeof(L=I.shift())||Array.isArray(L)&&"string"!=typeof L[0])&&(C=!1);E=C}if(!1===E)throw new Error('Type of text must be string or Array. "'+t+'" is not recognized.');"string"==typeof t&&(t=t.match(/[\r?\n]/)?t.split(/\r\n|\r|\n/g):[t]);var N=et/m.internal.scaleFactor,D=N*(x-1);switch(i.baseline){case"bottom":n-=D;break;case"top":n+=N-D;break;case"hanging":n+=N-2*D;break;case"middle":n+=N/2-D}if((u=i.maxWidth||0)>0&&("string"==typeof t?t=m.splitTextToSize(t,u):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce(function(t,e){return t.concat(m.splitTextToSize(e,u))},[]))),a={text:t,x:e,y:n,options:i,mutex:{pdfEscape:ne,activeFontKey:ht,fonts:gt,activeFontSize:et}},At.publish("preProcessText",a),t=a.text,o=(i=a.options).angle,p instanceof It==0&&o&&"number"==typeof o){o*=Math.PI/180,0===i.rotationDirection&&(o=-o),b===v&&(o=-o);var R=Math.cos(o),F=Math.sin(o);p=new It(R,F,-F,R,0,0)}else o&&o instanceof It&&(p=o);b!==v||p||(p=zt),void 0!==(c=i.charSpace||Je)&&(y+=P(T(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(f=i.horizontalScale)&&(y+=P(100*f)+" Tz\n"),i.lang;var O=-1,B=void 0!==i.renderingMode?i.renderingMode:i.stroke,j=m.internal.getCurrentPageInfo().pageContext;switch(B){case 0:case!1:case"fill":O=0;break;case 1:case!0:case"stroke":O=1;break;case 2:case"fillThenStroke":O=2;break;case 3:case"invisible":O=3;break;case 4:case"fillAndAddForClipping":O=4;break;case 5:case"strokeAndAddPathForClipping":O=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":O=6;break;case 7:case"addToPathForClipping":O=7}var U=void 0!==j.usedRenderingMode?j.usedRenderingMode:-1;-1!==O?y+=O+" Tr\n":-1!==U&&(y+="0 Tr\n"),-1!==O&&(j.usedRenderingMode=O),l=i.align||"left";var G,q=et*x,V=m.internal.pageSize.getWidth(),Z=gt[ht];c=i.charSpace||Je,u=i.maxWidth||0,h=Object.assign({autoencode:!0,noBOM:!0},i.flags);var W=[],H=function(t){return m.getStringUnitWidth(t,{font:Z,charSpace:c,fontSize:et,doKerning:!1})*et/w};if("[object Array]"===Object.prototype.toString.call(t)){var X;s=A(t),"left"!==l&&(G=s.map(H));var Y,K=0;if("right"===l){e-=G[0],t=[],z=s.length;for(var $=0;$<z;$++)0===$?(Y=qe(e),X=Ve(n)):(Y=T(K-G[$]),X=-q),t.push([s[$],Y,X]),K=G[$]}else if("center"===l){e-=G[0]/2,t=[],z=s.length;for(var Q=0;Q<z;Q++)0===Q?(Y=qe(e),X=Ve(n)):(Y=T((K-G[Q])/2),X=-q),t.push([s[Q],Y,X]),K=G[Q]}else if("left"===l){t=[],z=s.length;for(var tt=0;tt<z;tt++)t.push(s[tt])}else if("justify"===l&&"Identity-H"===Z.encoding){t=[],z=s.length,u=0!==u?u:V;for(var nt=0,it=0;it<z;it++)if(X=0===it?Ve(n):-q,Y=0===it?qe(e):nt,it<z-1){var at=T((u-G[it])/(s[it].split(" ").length-1)),st=s[it].split(" ");t.push([st[0]+" ",Y,X]),nt=0;for(var ot=1;ot<st.length;ot++){var lt=(H(st[ot-1]+" "+st[ot])-H(st[ot]))*w+at;ot==st.length-1?t.push([st[ot],lt,0]):t.push([st[ot]+" ",lt,0]),nt-=lt}}else t.push([s[it],Y,X]);t.push(["",nt,0])}else{if("justify"!==l)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(t=[],z=s.length,u=0!==u?u:V,it=0;it<z;it++){X=0===it?Ve(n):-q,Y=0===it?qe(e):0;var ct=s[it].split(" ").length-1,ut=ct>0?(u-G[it])/ct:0;it<z-1?W.push(P(T(ut))):W.push(0),t.push([s[it],Y,X])}}}!0===("boolean"==typeof i.R2L?i.R2L:rt)&&(t=k(t,function(t,e,n){return[t.split("").reverse().join(""),e,n]})),a={text:t,x:e,y:n,options:i,mutex:{pdfEscape:ne,activeFontKey:ht,fonts:gt,activeFontSize:et}},At.publish("postProcessText",a),t=a.text,_=a.mutex.isHex||!1;var dt=gt[ht].encoding;"WinAnsiEncoding"!==dt&&"StandardEncoding"!==dt||(t=k(t,function(t,e,n){return[S(t),e,n]})),s=A(t),t=[];for(var ft,pt,mt,_t=Array.isArray(s[0])?1:0,yt="",vt=function(t,e,n){var r="";return n instanceof It?(n="number"==typeof i.angle?Lt(n,new It(1,0,0,1,t,e)):Lt(new It(1,0,0,1,t,e),n),b===v&&(n=Lt(new It(1,0,0,-1,0,0),n)),r=n.join(" ")+" Tm\n"):r=P(t)+" "+P(e)+" Td\n",r},bt=0;bt<s.length;bt++){switch(yt="",_t){case 1:mt=(_?"<":"(")+s[bt][0]+(_?">":")"),ft=parseFloat(s[bt][1]),pt=parseFloat(s[bt][2]);break;case 0:mt=(_?"<":"(")+s[bt]+(_?">":")"),ft=qe(e),pt=Ve(n)}void 0!==W&&void 0!==W[bt]&&(yt=W[bt]+" Tw\n"),0===bt?t.push(yt+vt(ft,pt,p)+mt):0===_t?t.push(yt+mt):1===_t&&t.push(yt+vt(ft,pt,p)+mt)}t=0===_t?t.join(" Tj\nT* "):t.join(" Tj\n"),t+=" Tj\n";var xt="BT\n/";return xt+=ht+" "+et+" Tf\n",xt+=P(et*x)+" TL\n",xt+=Ye+"\n",xt+=y,xt+=t,J(xt+="ET"),d[ht]=!0,m};var we=f.__private__.clip=f.clip=function(t){return J("evenodd"===t?"W*":"W"),this};f.clipEvenOdd=function(){return we("evenodd")},f.__private__.discardPath=f.discardPath=function(){return J("n"),this};var Se=f.__private__.isValidStyle=function(t){var e=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(t)&&(e=!0),e};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(t){return Se(t)&&(c=t),this};var Pe=f.__private__.getStyle=f.getStyle=function(t){var e=c;switch(t){case"D":case"S":e="S";break;case"F":e="f";break;case"FD":case"DF":e="B";break;case"f":case"f*":case"B":case"B*":e=t}return e},Me=f.close=function(){return J("h"),this};f.stroke=function(){return J("S"),this},f.fill=function(t){return Ae("f",t),this},f.fillEvenOdd=function(t){return Ae("f*",t),this},f.fillStroke=function(t){return Ae("B",t),this},f.fillStrokeEvenOdd=function(t){return Ae("B*",t),this};var Ae=function(t,e){"object"===(0,Ge.A)(e)?Te(e,t):J(t)},ke=function(t){null===t||b===v&&void 0===t||(t=Pe(t),J(t))};function Ee(t,e,n,i,r){var a=new Ro(e||this.boundingBox,n||this.xStep,i||this.yStep,this.gState,r||this.matrix);a.stream=this.stream;var s=t+"$$"+this.cloneIndex+++"$$";return Nt(s,a),a}var Te=function(t,e){var n=bt[t.key],i=vt[n];if(i instanceof Do)J("q"),J(Ce(e)),i.gState&&f.setGState(i.gState),J(t.matrix.toString()+" cm"),J("/"+n+" sh"),J("Q");else if(i instanceof Ro){var r=new It(1,0,0,-1,0,pn());t.matrix&&(r=r.multiply(t.matrix||zt),n=Ee.call(i,t.key,t.boundingBox,t.xStep,t.yStep,r).id),J("q"),J("/Pattern cs"),J("/"+n+" scn"),i.gState&&f.setGState(i.gState),J(e),J("Q")}},Ce=function(t){switch(t){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ie=f.moveTo=function(t,e){return J(P(T(t))+" "+P(C(e))+" m"),this},Le=f.lineTo=function(t,e){return J(P(T(t))+" "+P(C(e))+" l"),this},ze=f.curveTo=function(t,e,n,i,r,a){return J([P(T(t)),P(C(e)),P(T(n)),P(C(i)),P(T(r)),P(C(a)),"c"].join(" ")),this};f.__private__.line=f.line=function(t,e,n,i,r){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||!Se(r))throw new Error("Invalid arguments passed to jsPDF.line");return b===y?this.lines([[n-t,i-e]],t,e,[1,1],r||"S"):this.lines([[n-t,i-e]],t,e,[1,1]).stroke()},f.__private__.lines=f.lines=function(t,e,n,i,r,a){var s,o,l,c,u,h,d,f,p,m,g,_;if("number"==typeof t&&(_=n,n=e,e=t,t=_),i=i||[1,1],a=a||!1,isNaN(e)||isNaN(n)||!Array.isArray(t)||!Array.isArray(i)||!Se(r)||"boolean"!=typeof a)throw new Error("Invalid arguments passed to jsPDF.lines");for(Ie(e,n),s=i[0],o=i[1],c=t.length,m=e,g=n,l=0;l<c;l++)2===(u=t[l]).length?(m=u[0]*s+m,g=u[1]*o+g,Le(m,g)):(h=u[0]*s+m,d=u[1]*o+g,f=u[2]*s+m,p=u[3]*o+g,m=u[4]*s+m,g=u[5]*o+g,ze(h,d,f,p,m,g));return a&&Me(),ke(r),this},f.path=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=n.c;switch(n.op){case"m":Ie(i[0],i[1]);break;case"l":Le(i[0],i[1]);break;case"c":ze.apply(this,i);break;case"h":Me()}}return this},f.__private__.rect=f.rect=function(t,e,n,i,r){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||!Se(r))throw new Error("Invalid arguments passed to jsPDF.rect");return b===y&&(i=-i),J([P(T(t)),P(C(e)),P(T(n)),P(T(i)),"re"].join(" ")),ke(r),this},f.__private__.triangle=f.triangle=function(t,e,n,i,r,a,s){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||isNaN(r)||isNaN(a)||!Se(s))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n-t,i-e],[r-n,a-i],[t-r,e-a]],t,e,[1,1],s,!0),this},f.__private__.roundedRect=f.roundedRect=function(t,e,n,i,r,a,s){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||isNaN(r)||isNaN(a)||!Se(s))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return r=Math.min(r,.5*n),a=Math.min(a,.5*i),this.lines([[n-2*r,0],[r*o,0,r,a-a*o,r,a],[0,i-2*a],[0,a*o,-r*o,a,-r,a],[2*r-n,0],[-r*o,0,-r,-a*o,-r,-a],[0,2*a-i],[0,-a*o,r*o,-a,r,-a]],t+r,e,[1,1],s,!0),this},f.__private__.ellipse=f.ellipse=function(t,e,n,i,r){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||!Se(r))throw new Error("Invalid arguments passed to jsPDF.ellipse");var a=4/3*(Math.SQRT2-1)*n,s=4/3*(Math.SQRT2-1)*i;return Ie(t+n,e),ze(t+n,e-s,t+a,e-i,t,e-i),ze(t-a,e-i,t-n,e-s,t-n,e),ze(t-n,e+s,t-a,e+i,t,e+i),ze(t+a,e+i,t+n,e+s,t+n,e),ke(r),this},f.__private__.circle=f.circle=function(t,e,n,i){if(isNaN(t)||isNaN(e)||isNaN(n)||!Se(i))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(t,e,n,n,i)},f.setFont=function(t,e,n){return n&&(e=S(e,n)),ht=le(t,e,{disableWarning:!1}),this};var Ne=f.__private__.getFont=f.getFont=function(){return gt[le.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var t,e,n={};for(t in _t)if(_t.hasOwnProperty(t))for(e in n[t]=[],_t[t])_t[t].hasOwnProperty(e)&&n[t].push(e);return n},f.addFont=function(t,e,n,i,r){var a=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==a.indexOf(arguments[3])?r=arguments[3]:arguments[3]&&-1==a.indexOf(arguments[3])&&(n=S(n,i)),ee.call(this,t,e,n,r=r||"Identity-H")};var De,Re=t.lineWidth||.200025,Fe=f.__private__.getLineWidth=f.getLineWidth=function(){return Re},Oe=f.__private__.setLineWidth=f.setLineWidth=function(t){return Re=t,J(P(T(t))+" w"),this};f.__private__.setLineDash=Fo.API.setLineDash=Fo.API.setLineDashPattern=function(t,e){if(t=t||[],e=e||0,isNaN(e)||!Array.isArray(t))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return t=t.map(function(t){return P(T(t))}).join(" "),e=P(T(e)),J("["+t+"] "+e+" d"),this};var Be=f.__private__.getLineHeight=f.getLineHeight=function(){return et*De};f.__private__.getLineHeight=f.getLineHeight=function(){return et*De};var je=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(t){return"number"==typeof(t=t||1.15)&&(De=t),this},Ue=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return De};je(t.lineHeight);var qe=f.__private__.getHorizontalCoordinate=function(t){return T(t)},Ve=f.__private__.getVerticalCoordinate=function(t){return b===v?t:Mt[B].mediaBox.topRightY-Mt[B].mediaBox.bottomLeftY-T(t)},Ze=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(t){return P(qe(t))},We=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(t){return P(Ve(t))},He=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Gt(He)},f.__private__.setStrokeColor=f.setDrawColor=function(t,e,n,i){return He=qt({ch1:t,ch2:e,ch3:n,ch4:i,pdfColorType:"draw",precision:2}),J(He),this};var Xe=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Gt(Xe)},f.__private__.setFillColor=f.setFillColor=function(t,e,n,i){return Xe=qt({ch1:t,ch2:e,ch3:n,ch4:i,pdfColorType:"fill",precision:2}),J(Xe),this};var Ye=t.textColor||"0 g",Ke=f.__private__.getTextColor=f.getTextColor=function(){return Gt(Ye)};f.__private__.setTextColor=f.setTextColor=function(t,e,n,i){return Ye=qt({ch1:t,ch2:e,ch3:n,ch4:i,pdfColorType:"text",precision:3}),this};var Je=t.charSpace,$e=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Je||0)};f.__private__.setCharSpace=f.setCharSpace=function(t){if(isNaN(t))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Je=t,this};var Qe=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(t){var e=f.CapJoinStyles[t];if(void 0===e)throw new Error("Line cap style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qe=e,J(e+" J"),this};var tn=0;f.__private__.setLineJoin=f.setLineJoin=function(t){var e=f.CapJoinStyles[t];if(void 0===e)throw new Error("Line join style of '"+t+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return tn=e,J(e+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(t){if(t=t||0,isNaN(t))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(P(T(t))+" M"),this},f.GState=zo,f.setGState=function(t){(t="string"==typeof t?xt[wt[t]]:en(null,t)).equals(St)||(J("/"+t.id+" gs"),St=t)};var en=function(t,e){if(!t||!wt[t]){var n=!1;for(var i in xt)if(xt.hasOwnProperty(i)&&xt[i].equals(e)){n=!0;break}if(n)e=xt[i];else{var r="GS"+(Object.keys(xt).length+1).toString(10);xt[r]=e,e.id=r}return t&&(wt[t]=e.id),At.publish("addGState",e),e}};f.addGState=function(t,e){return en(t,e),this},f.saveGraphicsState=function(){return J("q"),yt.push({key:ht,size:et,color:Ye}),this},f.restoreGraphicsState=function(){J("Q");var t=yt.pop();return ht=t.key,et=t.size,Ye=t.color,St=null,this},f.setCurrentTransformationMatrix=function(t){return J(t.toString()+" cm"),this},f.comment=function(t){return J("#"+t),this};var nn=function(t,e){var n=t||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n},set:function(t){isNaN(t)||(n=parseFloat(t))}});var i=e||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return i},set:function(t){isNaN(t)||(i=parseFloat(t))}});var r="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return r},set:function(t){r=t.toString()}}),this},rn=function(t,e,n,i){nn.call(this,t,e),this.type="rect";var r=n||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return r},set:function(t){isNaN(t)||(r=parseFloat(t))}});var a=i||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return a},set:function(t){isNaN(t)||(a=parseFloat(t))}}),this},an=function(){this.page=Pt,this.currentPage=B,this.pages=H.slice(0),this.pagesContext=Mt.slice(0),this.x=ft,this.y=pt,this.matrix=mt,this.width=ln(B),this.height=un(B),this.outputDestination=Y,this.id="",this.objectNumber=-1};an.prototype.restore=function(){Pt=this.page,B=this.currentPage,Mt=this.pagesContext,H=this.pages,ft=this.x,pt=this.y,mt=this.matrix,cn(B,this.width),hn(B,this.height),Y=this.outputDestination};var sn=function(t,e,n,i,r){Ct.push(new an),Pt=B=0,H=[],ft=t,pt=e,mt=r,ie([n,i])};for(var on in f.beginFormObject=function(t,e,n,i,r){return sn(t,e,n,i,r),this},f.endFormObject=function(t){return function(t){if(Tt[t])Ct.pop().restore();else{var e=new an,n="Xo"+(Object.keys(Et).length+1).toString(10);e.id=n,Tt[t]=n,Et[n]=e,At.publish("addFormObject",e),Ct.pop().restore()}}(t),this},f.doFormObject=function(t,e){var n=Et[Tt[t]];return J("q"),J(e.toString()+" cm"),J("/"+n.id+" Do"),J("Q"),this},f.getFormObject=function(t){var e=Et[Tt[t]];return{x:e.x,y:e.y,width:e.width,height:e.height,matrix:e.matrix}},f.save=function(t,e){return t=t||"generated.pdf",(e=e||{}).returnPromise=e.returnPromise||!1,!1===e.returnPromise?(co(me(pe()),t),"function"==typeof co.unload&&io.setTimeout&&setTimeout(co.unload,911),this):new Promise(function(e,n){try{var r=co(me(pe()),t);"function"==typeof co.unload&&io.setTimeout&&setTimeout(co.unload,911),e(r)}catch(i){n(i.message)}})},Fo.API)Fo.API.hasOwnProperty(on)&&("events"===on&&Fo.API.events.length?function(t,e){var n,i,r;for(r=e.length-1;-1!==r;r--)n=e[r][0],i=e[r][1],t.subscribe.apply(t,[n].concat("function"==typeof i?[i]:i))}(At,Fo.API.events):f[on]=Fo.API[on]);function ln(t){return Mt[t].mediaBox.topRightX-Mt[t].mediaBox.bottomLeftX}function cn(t,e){Mt[t].mediaBox.topRightX=e+Mt[t].mediaBox.bottomLeftX}function un(t){return Mt[t].mediaBox.topRightY-Mt[t].mediaBox.bottomLeftY}function hn(t,e){Mt[t].mediaBox.topRightY=e+Mt[t].mediaBox.bottomLeftY}var dn=f.getPageWidth=function(t){return ln(t=t||B)/dt},fn=f.setPageWidth=function(t,e){cn(t,e*dt)},pn=f.getPageHeight=function(t){return un(t=t||B)/dt},mn=f.setPageHeight=function(t,e){hn(t,e*dt)};return f.internal={pdfEscape:ne,getStyle:Pe,getFont:Ne,getFontSize:it,getCharSpace:$e,getTextColor:Ke,getLineHeight:Be,getLineHeightFactor:Ue,getLineWidth:Fe,write:$,getHorizontalCoordinate:qe,getVerticalCoordinate:Ve,getCoordinateString:Ze,getVerticalCoordinateString:We,collections:{},newObject:Rt,newAdditionalObject:Bt,newObjectDeferred:Ft,newObjectDeferredBegin:Ot,getFilters:Vt,putStream:Zt,events:At,scaleFactor:dt,pageSize:{getWidth:function(){return dn(B)},setWidth:function(t){fn(B,t)},getHeight:function(){return pn(B)},setHeight:function(t){mn(B,t)}},encryptionOptions:u,encryption:ye,getEncryptor:function(t){return null!==u?ye.encryptor(t,0):function(t){return t}},output:ge,getNumberOfPages:oe,pages:H,out:J,f2:k,f3:E,getPageInfo:ve,getPageInfoByObjId:be,getCurrentPageInfo:xe,getPDFVersion:m,Point:nn,Rectangle:rn,Matrix:It,hasHotfix:_e},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return dn(B)},set:function(t){fn(B,t)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return pn(B)},set:function(t){mn(B,t)},enumerable:!0,configurable:!0}),function(t){for(var e=0,n=tt.length;e<n;e++){var i=ee.call(this,t[e][0],t[e][1],t[e][2],tt[e][3],!0);!1===h&&(d[i]=!0);var r=t[e][0].split("-");te({id:i,fontName:r[0],fontStyle:r[1]||""})}At.publish("addFonts",{fonts:gt,dictionary:_t})}.call(f,tt),ht="F1",re(r,n),At.publish("initialized"),f}Co.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Co.prototype.toHexString=function(t){return t.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Co.prototype.hexToBytes=function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(String.fromCharCode(parseInt(t.substr(n,2),16)));return e.join("")},Co.prototype.processOwnerPassword=function(t,e){return Eo(Mo(e).substr(0,5),t)},Co.prototype.encryptor=function(t,e){var n=Mo(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(t){return Eo(n,t)}},zo.prototype.equals=function(t){var e,n="id,objectNumber,equals";if(!t||(0,Ge.A)(t)!==(0,Ge.A)(this))return!1;var i=0;for(e in this)if(!(n.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e))return!1;if(this[e]!==t[e])return!1;i++}for(e in t)t.hasOwnProperty(e)&&n.indexOf(e)<0&&i--;return 0===i},Fo.API={events:[]},Fo.version="3.0.3";var Oo=Fo.API,Bo=1,jo=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Uo=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Go=function(t){return t.toFixed(2)},qo=function(t){return t.toFixed(5)};Oo.__acroform__={};var Vo=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Zo=function(t){return t*Bo},Wo=function(t){var e=new ll,n=wl.internal.getHeight(t)||0,i=wl.internal.getWidth(t)||0;return e.BBox=[0,0,Number(Go(i)),Number(Go(n))],e},Ho=Oo.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<e},Xo=Oo.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<e)},Yo=Oo.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<e?1:0},Ko=Oo.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Yo(t,e-1)},Jo=Oo.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Ho(t,e-1)},$o=Oo.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Xo(t,e-1)},Qo=Oo.__acroform__.calculateCoordinates=function(t,e){var n=e.internal.getHorizontalCoordinate,i=e.internal.getVerticalCoordinate,r=t[0],a=t[1],s=t[2],o=t[3],l={};return l.lowerLeft_X=n(r)||0,l.lowerLeft_Y=i(a+o)||0,l.upperRight_X=n(r+s)||0,l.upperRight_Y=i(a)||0,[Number(Go(l.lowerLeft_X)),Number(Go(l.lowerLeft_Y)),Number(Go(l.upperRight_X)),Number(Go(l.upperRight_Y))]},tl=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],n=t._V||t.DV,i=el(t,n),r=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+r+" "+Go(i.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=Wo(t);return a.scope=t.scope,a.stream=e.join("\n"),a}},el=function(t,e){var n=0===t.fontSize?t.maxFontSize:t.fontSize,i={text:"",fontSize:""},r=(e=")"==(e="("==e.substr(0,1)?e.substr(1):e).substr(e.length-1)?e.substr(0,e.length-1):e).split(" ");r=t.multiline?r.map(function(t){return t.split("\n")}):r.map(function(t){return[t]});var a=n,s=wl.internal.getHeight(t)||0;s=s<0?-s:s;var o=wl.internal.getWidth(t)||0;o=o<0?-o:o;var l=function(e,n,i){if(e+1<r.length){var a=n+" "+r[e+1][0];return nl(a,t,i).width<=o-4}return!1};a++;t:for(;a>0;){e="",a--;var c,u,h=nl("3",t,a).height,d=t.multiline?s-a:(s-h)/2,f=d+=2,p=0,m=0,g=0;if(a<=0){e="(...) Tj\n",e+="% Width of Text: "+nl(e,t,a=12).width+", FieldWidth:"+o+"\n";break}for(var _="",y=0,v=0;v<r.length;v++)if(r.hasOwnProperty(v)){var b=!1;if(1!==r[v].length&&g!==r[v].length-1){if((h+2)*(y+2)+2>s)continue t;_+=r[v][g],b=!0,m=v,v--}else{_=" "==(_+=r[v][g]+" ").substr(_.length-1)?_.substr(0,_.length-1):_;var x=parseInt(v),w=l(x,_,a),S=v>=r.length-1;if(w&&!S){_+=" ",g=0;continue}if(w||S){if(S)m=x;else if(t.multiline&&(h+2)*(y+2)+2>s)continue t}else{if(!t.multiline)continue t;if((h+2)*(y+2)+2>s)continue t;m=x}}for(var P="",M=p;M<=m;M++){var A=r[M];if(t.multiline){if(M===m){P+=A[g]+" ",g=(g+1)%A.length;continue}if(M===p){P+=A[A.length-1]+" ";continue}}P+=A[0]+" "}switch(P=" "==P.substr(P.length-1)?P.substr(0,P.length-1):P,u=nl(P,t,a).width,t.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}e+=Go(c)+" "+Go(f)+" Td\n",e+="("+jo(P)+") Tj\n",e+=-Go(c)+" 0 Td\n",f=-(a+2),u=0,p=b?m:m+1,y++,_=""}break}return i.text=e,i.fontSize=a,i},nl=function(t,e,n){var i=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(t,{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:e.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:r}},il={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},rl=function(t,e){var n={type:"reference",object:t};void 0===e.internal.getPageInfo(t.page).pageContext.annotations.find(function(t){return t.type===n.type&&t.object===n.object})&&e.internal.getPageInfo(t.page).pageContext.annotations.push(n)},al=Oo.__acroform__.arrayToPdfArray=function(t,e,n){var i=function(t){return t};if(Array.isArray(t)){for(var r="[",a=0;a<t.length;a++)switch(0!==a&&(r+=" "),(0,Ge.A)(t[a])){case"boolean":case"number":case"object":r+=t[a].toString();break;case"string":"/"!==t[a].substr(0,1)?(void 0!==e&&n&&(i=n.internal.getEncryptor(e)),r+="("+jo(i(t[a].toString()))+")"):r+=t[a].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},sl=function(t,e,n){var i=function(t){return t};return void 0!==e&&n&&(i=n.internal.getEncryptor(e)),(t=t||"").toString(),"("+jo(i(t))+")"},ol=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ol.prototype.toString=function(){return this.objId+" 0 R"},ol.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ol.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(t){return"content"!=t&&"appearanceStreamContent"!=t&&"scope"!=t&&"objId"!=t&&"_"!=t.substring(0,1)});for(var n in e)if(!1===Object.getOwnPropertyDescriptor(this,e[n]).configurable){var i=e[n],r=this[i];r&&(Array.isArray(r)?t.push({key:i,value:al(r,this.objId,this.scope)}):r instanceof ol?(r.scope=this.scope,t.push({key:i,value:r.objId+" 0 R"})):"function"!=typeof r&&t.push({key:i,value:r}))}return t};var ll=function(){ol.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};Vo(ll,ol);var cl=function(){ol.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(t){return t};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+jo(e(t))+")"}},set:function(e){t=e}})};Vo(cl,ol);var ul=function t(){ol.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute F supplied.');e=t}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(e,3))},set:function(t){!0===Boolean(t)?this.F=Jo(e,3):this.F=$o(e,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){if(isNaN(t))throw new Error('Invalid value "'+t+'" for attribute Ff supplied.');n=t}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==i.length)return i},set:function(t){i=void 0!==t?t:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(t){i[0]=t}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(t){i[1]=t}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(t){i[2]=t}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(t){i[3]=t}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){switch(t){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=t;break;default:throw new Error('Invalid value "'+t+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof yl)return;a="FieldObject"+t.FieldNum++}var e=function(t){return t};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+jo(e(a))+")"},set:function(t){a=t.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(t){a=t}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){s=t}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(t){o=t}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(t){l=t}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/Bo:c},set:function(t){c=t}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(t){u=t}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof yl||this instanceof bl))return sl(h,this.objId,this.scope)},set:function(t){t=t.toString(),h=t}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof ml==0?sl(d,this.objId,this.scope):d},set:function(t){t=t.toString(),d=this instanceof ml==0?"("===t.substr(0,1)?Uo(t.substr(1,t.length-2)):Uo(t):t}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ml==1?Uo(d.substr(1,d.length-1)):d},set:function(t){t=t.toString(),d=this instanceof ml==1?"/"+t:t}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(t){this.V=t}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof ml==0?sl(f,this.objId,this.scope):f},set:function(t){t=t.toString(),f=this instanceof ml==0?"("===t.substr(0,1)?Uo(t.substr(1,t.length-2)):Uo(t):t}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ml==1?Uo(f.substr(1,f.length-1)):f},set:function(t){t=t.toString(),f=this instanceof ml==1?"/"+t:t}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(t){t=Boolean(t),m=t}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(t){p=t}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,1))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,1):this.Ff=$o(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,2))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,2):this.Ff=$o(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,3))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,3):this.Ff=$o(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==g)return g},set:function(t){if(-1===[0,1,2].indexOf(t))throw new Error('Invalid value "'+t+'" for attribute Q supplied.');g=t}}),Object.defineProperty(this,"textAlign",{get:function(){var t;switch(g){case 0:default:t="left";break;case 1:t="center";break;case 2:t="right"}return t},configurable:!0,enumerable:!0,set:function(t){switch(t){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};Vo(ul,ol);var hl=function(){ul.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return al(e,this.objId,this.scope)},set:function(t){var n,i;i=[],"string"==typeof(n=t)&&(i=function(t,e,n){n||(n=1);for(var i,r=[];i=e.exec(t);)r.push(i[n]);return r}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();-1!==e.indexOf(t)&&(e.splice(e.indexOf(t),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,18))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,18):this.Ff=$o(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,19))},set:function(t){!0===this.combo&&(!0===Boolean(t)?this.Ff=Jo(this.Ff,19):this.Ff=$o(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,20))},set:function(t){!0===Boolean(t)?(this.Ff=Jo(this.Ff,20),e.sort()):this.Ff=$o(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,22))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,22):this.Ff=$o(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,23):this.Ff=$o(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,27))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,27):this.Ff=$o(this.Ff,27)}}),this.hasAppearanceStream=!1};Vo(hl,ul);var dl=function(){hl.call(this),this.fontName="helvetica",this.combo=!1};Vo(dl,hl);var fl=function(){dl.call(this),this.combo=!0};Vo(fl,dl);var pl=function(){fl.call(this),this.edit=!0};Vo(pl,fl);var ml=function(){ul.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,15))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,15):this.Ff=$o(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,16))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,16):this.Ff=$o(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,17))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,17):this.Ff=$o(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,26):this.Ff=$o(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(e).length){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+jo(t(e[n]))+")");return i.push(">>"),i.join("\n")}},set:function(t){"object"===(0,Ge.A)(t)&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){"string"==typeof t&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};Vo(ml,ul);var gl=function(){ml.call(this),this.pushButton=!0};Vo(gl,ml);var _l=function(){ml.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=void 0!==e?e:[]}})};Vo(_l,ml);var yl=function(){var t,e;ul.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(t){e=t}});var n,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(t){return t};this.scope&&(t=this.scope.internal.getEncryptor(this.objId));var e,n=[];for(e in n.push("<<"),i)n.push("/"+e+" ("+jo(t(i[e]))+")");return n.push(">>"),n.join("\n")},set:function(t){"object"===(0,Ge.A)(t)&&(i=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(t){"string"==typeof t&&(i.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=wl.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Vo(yl,ul),_l.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var n=this.Kids[e];n.appearanceStreamContent=t.createAppearanceStream(n.optionName),n.caption=t.getCA()}},_l.prototype.createOption=function(t){var e=new yl;return e.Parent=this,e.optionName=t,this.Kids.push(e),Sl.call(this.scope,e),e};var vl=function(){ml.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=wl.CheckBox.createAppearanceStream()};Vo(vl,ml);var bl=function(){ul.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,13))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,13):this.Ff=$o(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,21))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,21):this.Ff=$o(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,23))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,23):this.Ff=$o(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,24))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,24):this.Ff=$o(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,25))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,25):this.Ff=$o(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,26))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,26):this.Ff=$o(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Vo(bl,ul);var xl=function(){bl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(Ko(this.Ff,14))},set:function(t){!0===Boolean(t)?this.Ff=Jo(this.Ff,14):this.Ff=$o(this.Ff,14)}}),this.password=!0};Vo(xl,bl);var wl={CheckBox:{createAppearanceStream:function(){return{N:{On:wl.CheckBox.YesNormal},D:{On:wl.CheckBox.YesPushDown,Off:wl.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Wo(t);e.scope=t.scope;var n=[],i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color),a=el(t,t.caption);return n.push("0.749023 g"),n.push("0 0 "+Go(wl.internal.getWidth(t))+" "+Go(wl.internal.getHeight(t))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+i+" "+Go(a.fontSize)+" Tf "+r),n.push("BT"),n.push(a.text),n.push("ET"),n.push("Q"),n.push("EMC"),e.stream=n.join("\n"),e},YesNormal:function(t){var e=Wo(t);e.scope=t.scope;var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),r=[],a=wl.internal.getHeight(t),s=wl.internal.getWidth(t),o=el(t,t.caption);return r.push("1 g"),r.push("0 0 "+Go(s)+" "+Go(a)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+Go(s-1)+" "+Go(a-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+n+" "+Go(o.fontSize)+" Tf "+i),r.push(o.text),r.push("ET"),r.push("Q"),e.stream=r.join("\n"),e},OffPushDown:function(t){var e=Wo(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Go(wl.internal.getWidth(t))+" "+Go(wl.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join("\n"),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:wl.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=wl.RadioButton.Circle.YesNormal,e.D[t]=wl.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Wo(t);e.scope=t.scope;var n=[],i=wl.internal.getWidth(t)<=wl.internal.getHeight(t)?wl.internal.getWidth(t)/4:wl.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=wl.internal.Bezier_C,a=Number((i*r).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+qo(wl.internal.getWidth(t)/2)+" "+qo(wl.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),n.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),n.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),n.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join("\n"),e},YesPushDown:function(t){var e=Wo(t);e.scope=t.scope;var n=[],i=wl.internal.getWidth(t)<=wl.internal.getHeight(t)?wl.internal.getWidth(t)/4:wl.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),a=Number((r*wl.internal.Bezier_C).toFixed(5)),s=Number((i*wl.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+qo(wl.internal.getWidth(t)/2)+" "+qo(wl.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+qo(wl.internal.getWidth(t)/2)+" "+qo(wl.internal.getHeight(t)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join("\n"),e},OffPushDown:function(t){var e=Wo(t);e.scope=t.scope;var n=[],i=wl.internal.getWidth(t)<=wl.internal.getHeight(t)?wl.internal.getWidth(t)/4:wl.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var r=Number((2*i).toFixed(5)),a=Number((r*wl.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+qo(wl.internal.getWidth(t)/2)+" "+qo(wl.internal.getHeight(t)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),e.stream=n.join("\n"),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:wl.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=wl.RadioButton.Cross.YesNormal,e.D[t]=wl.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Wo(t);e.scope=t.scope;var n=[],i=wl.internal.calculateCross(t);return n.push("q"),n.push("1 1 "+Go(wl.internal.getWidth(t)-2)+" "+Go(wl.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(Go(i.x1.x)+" "+Go(i.x1.y)+" m"),n.push(Go(i.x2.x)+" "+Go(i.x2.y)+" l"),n.push(Go(i.x4.x)+" "+Go(i.x4.y)+" m"),n.push(Go(i.x3.x)+" "+Go(i.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join("\n"),e},YesPushDown:function(t){var e=Wo(t);e.scope=t.scope;var n=wl.internal.calculateCross(t),i=[];return i.push("0.749023 g"),i.push("0 0 "+Go(wl.internal.getWidth(t))+" "+Go(wl.internal.getHeight(t))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Go(wl.internal.getWidth(t)-2)+" "+Go(wl.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(Go(n.x1.x)+" "+Go(n.x1.y)+" m"),i.push(Go(n.x2.x)+" "+Go(n.x2.y)+" l"),i.push(Go(n.x4.x)+" "+Go(n.x4.y)+" m"),i.push(Go(n.x3.x)+" "+Go(n.x3.y)+" l"),i.push("s"),i.push("Q"),e.stream=i.join("\n"),e},OffPushDown:function(t){var e=Wo(t);e.scope=t.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+Go(wl.internal.getWidth(t))+" "+Go(wl.internal.getHeight(t))+" re"),n.push("f"),e.stream=n.join("\n"),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+n}};wl.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=wl.internal.getWidth(t),n=wl.internal.getHeight(t),i=Math.min(e,n);return{x1:{x:(e-i)/2,y:(n-i)/2+i},x2:{x:(e-i)/2+i,y:(n-i)/2},x3:{x:(e-i)/2,y:(n-i)/2},x4:{x:(e-i)/2+i,y:(n-i)/2+i}}}},wl.internal.getWidth=function(t){var e=0;return"object"===(0,Ge.A)(t)&&(e=Zo(t.Rect[2])),e},wl.internal.getHeight=function(t){var e=0;return"object"===(0,Ge.A)(t)&&(e=Zo(t.Rect[3])),e};var Sl=Oo.addField=function(t){if(function(t,e){if(e.scope=t,void 0!==t.internal&&(void 0===t.internal.acroformPlugin||!1===t.internal.acroformPlugin.isInitialized)){if(ul.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(il)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Bo=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new cl,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){var e;(e=t).internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0}),t.internal.events.subscribe("buildDocument",function(){!function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var e=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];i.objId=void 0,i.hasAnnotation&&rl(i,t)}}(t)}),t.internal.events.subscribe("putCatalog",function(){!function(t){if(void 0===t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(t)}),t.internal.events.subscribe("postPutPages",function(e){!function(t,e){var n=!t;for(var i in t||(e.internal.newObjectDeferredBegin(e.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),e.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),t=t||e.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(t.hasOwnProperty(i)){var r=t[i],a=[],s=r.Rect;if(r.Rect&&(r.Rect=Qo(r.Rect,e)),e.internal.newObjectDeferredBegin(r.objId,!0),r.DA=wl.createDefaultAppearanceStream(r),"object"===(0,Ge.A)(r)&&"function"==typeof r.getKeyValueListForStream&&(a=r.getKeyValueListForStream()),r.Rect=s,r.hasAppearanceStream&&!r.appearanceStreamContent){var o=tl(r);a.push({key:"AP",value:"<</N "+o+">>"}),e.internal.acroformPlugin.xForms.push(o)}if(r.appearanceStreamContent){var l="";for(var c in r.appearanceStreamContent)if(r.appearanceStreamContent.hasOwnProperty(c)){var u=r.appearanceStreamContent[c];if(l+="/"+c+" ",l+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var i in u)if(u.hasOwnProperty(i)){var h=u[i];"function"==typeof h&&(h=h.call(e,r)),l+="/"+i+" "+h+" ",e.internal.acroformPlugin.xForms.indexOf(h)>=0||e.internal.acroformPlugin.xForms.push(h)}}else"function"==typeof(h=u)&&(h=h.call(e,r)),l+="/"+i+" "+h,e.internal.acroformPlugin.xForms.indexOf(h)>=0||e.internal.acroformPlugin.xForms.push(h);l+=">>"}a.push({key:"AP",value:"<<\n"+l+">>"})}e.internal.putStream({additionalKeyValues:a,objectId:r.objId}),e.internal.out("endobj")}n&&function(t,e){for(var n in t)if(t.hasOwnProperty(n)){var i=n,r=t[n];e.internal.newObjectDeferredBegin(r.objId,!0),"object"===(0,Ge.A)(r)&&"function"==typeof r.putStream&&r.putStream(),delete t[i]}}(e.internal.acroformPlugin.xForms,e)}(e,t)}),t.internal.acroformPlugin.isInitialized=!0}}(this,t),!(t instanceof ul))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Oo.AcroFormChoiceField=hl,Oo.AcroFormListBox=dl,Oo.AcroFormComboBox=fl,Oo.AcroFormEditBox=pl,Oo.AcroFormButton=ml,Oo.AcroFormPushButton=gl,Oo.AcroFormRadioButton=_l,Oo.AcroFormCheckBox=vl,Oo.AcroFormTextField=bl,Oo.AcroFormPasswordField=xl,Oo.AcroFormAppearance=wl,Oo.AcroForm={ChoiceField:hl,ListBox:dl,ComboBox:fl,EditBox:pl,Button:ml,PushButton:gl,RadioButton:_l,CheckBox:vl,TextField:bl,PasswordField:xl,Appearance:wl},Fo.AcroForm={ChoiceField:hl,ListBox:dl,ComboBox:fl,EditBox:pl,Button:ml,PushButton:gl,RadioButton:_l,CheckBox:vl,TextField:bl,PasswordField:xl,Appearance:wl};Fo.AcroForm;function Pl(t){return t.reduce(function(t,e,n){return t[e]=n,t},{})}!function(t){var e="addImage_";t.__addimage__={};var n="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=t.__addimage__.getImageFileTypeByImageData=function(t,e){var r,a,s,o,l,c=n;if("RGBA"===(e=e||n)||void 0!==t.data&&t.data instanceof Uint8ClampedArray&&"height"in t&&"width"in t)return"RGBA";if(w(t))for(l in i)for(s=i[l],r=0;r<s.length;r+=1){for(o=!0,a=0;a<s[r].length;a+=1)if(void 0!==s[r][a]&&s[r][a]!==t[a]){o=!1;break}if(!0===o){c=l;break}}else for(l in i)for(s=i[l],r=0;r<s.length;r+=1){for(o=!0,a=0;a<s[r].length;a+=1)if(void 0!==s[r][a]&&s[r][a]!==t.charCodeAt(a)){o=!1;break}if(!0===o){c=l;break}}return c===n&&e!==n&&(c=e),c},a=function t(e){for(var n=this.internal.write,i=this.internal.putStream,r=(0,this.internal.getFilters)();-1!==r.indexOf("FlateEncode");)r.splice(r.indexOf("FlateEncode"),1);e.objectId=this.internal.newObject();var a=[];if(a.push({key:"Type",value:"/XObject"}),a.push({key:"Subtype",value:"/Image"}),a.push({key:"Width",value:e.width}),a.push({key:"Height",value:e.height}),e.colorSpace===_.INDEXED?a.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(e.palette.length/3-1)+" "+("sMask"in e&&void 0!==e.sMask?e.objectId+2:e.objectId+1)+" 0 R]"}):(a.push({key:"ColorSpace",value:"/"+e.colorSpace}),e.colorSpace===_.DEVICE_CMYK&&a.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),a.push({key:"BitsPerComponent",value:e.bitsPerComponent}),"decodeParameters"in e&&void 0!==e.decodeParameters&&a.push({key:"DecodeParms",value:"<<"+e.decodeParameters+">>"}),"transparency"in e&&Array.isArray(e.transparency)&&e.transparency.length>0){for(var s="",o=0,l=e.transparency.length;o<l;o++)s+=e.transparency[o]+" "+e.transparency[o]+" ";a.push({key:"Mask",value:"["+s+"]"})}void 0!==e.sMask&&a.push({key:"SMask",value:e.objectId+1+" 0 R"});var c=void 0!==e.filter?["/"+e.filter]:void 0;if(i({data:e.data,additionalKeyValues:a,alreadyAppliedFilters:c,objectId:e.objectId}),n("endobj"),"sMask"in e&&void 0!==e.sMask){var u,h=null!==(u=e.sMaskBitsPerComponent)&&void 0!==u?u:e.bitsPerComponent,d={width:e.width,height:e.height,colorSpace:"DeviceGray",bitsPerComponent:h,data:e.sMask};"filter"in e&&(d.decodeParameters="/Predictor ".concat(e.predictor," /Colors 1 /BitsPerComponent ").concat(h," /Columns ").concat(e.width),d.filter=e.filter),t.call(this,d)}if(e.colorSpace===_.INDEXED){var f=this.internal.newObject();i({data:P(new Uint8Array(e.palette)),objectId:f}),n("endobj")}},s=function(){var t=this.internal.collections[e+"images"];for(var n in t)a.call(this,t[n])},o=function(){var t,n=this.internal.collections[e+"images"],i=this.internal.write;for(var r in n)i("/I"+(t=n[r]).index,t.objectId,"0","R")},l=function(){this.internal.collections[e+"images"]||(this.internal.collections[e+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var t=this.internal.collections[e+"images"];return l.call(this),t},u=function(){return Object.keys(this.internal.collections[e+"images"]).length},h=function(e){return"function"==typeof t["process"+e.toUpperCase()]},d=function(t){return"object"===(0,Ge.A)(t)&&1===t.nodeType},f=function(e,n){if("IMG"===e.nodeName&&e.hasAttribute("src")){var i=""+e.getAttribute("src");if(0===i.indexOf("data:image/"))return ho(unescape(i).split("base64,").pop());var r=t.loadFile(i,!0);if(void 0!==r)return r}if("CANVAS"===e.nodeName){if(0===e.width||0===e.height)throw new Error("Given canvas must have data. Canvas width: "+e.width+", height: "+e.height);var a;switch(n){case"PNG":a="image/png";break;case"WEBP":a="image/webp";break;default:a="image/jpeg"}return ho(e.toDataURL(a,1).split("base64,").pop())}},p=function(t){var n=this.internal.collections[e+"images"];if(n)for(var i in n)if(t===n[i].alias)return n[i]},m=function(t,e,n){return t||e||(t=-96,e=-96),t<0&&(t=-1*n.width*72/t/this.internal.scaleFactor),e<0&&(e=-1*n.height*72/e/this.internal.scaleFactor),0===t&&(t=e*n.width/n.height),0===e&&(e=t*n.height/n.width),[t,e]},g=function(t,e,n,i,r,a){var s=m.call(this,n,i,r),o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,u=c.call(this);if(n=s[0],i=s[1],u[r.index]=r,a){a*=Math.PI/180;var h=Math.cos(a),d=Math.sin(a),f=function(t){return t.toFixed(4)},p=[f(h),f(d),f(-1*d),f(h),0,0,"cm"]}this.internal.write("q"),a?(this.internal.write([1,"0","0",1,o(t),l(e+i),"cm"].join(" ")),this.internal.write(p.join(" ")),this.internal.write([o(n),"0","0",o(i),"0","0","cm"].join(" "))):this.internal.write([o(n),"0","0",o(i),o(t),l(e+i),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+r.index+" Do"),this.internal.write("Q")},_=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=t.__addimage__.sHashCode=function(t){var e,n,i=0;if("string"==typeof t)for(n=t.length,e=0;e<n;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;else if(w(t))for(n=t.byteLength/2,e=0;e<n;e++)i=(i<<5)-i+t[e],i|=0;return i},b=t.__addimage__.validateStringAsBase64=function(t){(t=t||"").toString().trim();var e=!0;return 0===t.length&&(e=!1),t.length%4!=0&&(e=!1),!1===/^[A-Za-z0-9+/]+$/.test(t.substr(0,t.length-2))&&(e=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(t.substr(-2))&&(e=!1),e},x=t.__addimage__.extractImageFromDataUrl=function(t){if(null==t)return null;if(!(t=t.trim()).startsWith("data:"))return null;var e=t.indexOf(",");return e<0?null:t.substring(0,e).trim().endsWith("base64")?t.substring(e+1):null};t.__addimage__.isArrayBuffer=function(t){return t instanceof ArrayBuffer};var w=t.__addimage__.isArrayBufferView=function(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array},S=t.__addimage__.binaryStringToUint8Array=function(t){for(var e=t.length,n=new Uint8Array(e),i=0;i<e;i++)n[i]=t.charCodeAt(i);return n},P=t.__addimage__.arrayBufferToBinaryString=function(t){for(var e="",n=w(t)?t:new Uint8Array(t),i=0;i<n.length;i+=8192)e+=String.fromCharCode.apply(null,n.subarray(i,i+8192));return e};t.addImage=function(){var t,e,i,r,a,s,o,c,u;if("number"==typeof arguments[1]?(e=n,i=arguments[1],r=arguments[2],a=arguments[3],s=arguments[4],o=arguments[5],c=arguments[6],u=arguments[7]):(e=arguments[1],i=arguments[2],r=arguments[3],a=arguments[4],s=arguments[5],o=arguments[6],c=arguments[7],u=arguments[8]),"object"===(0,Ge.A)(t=arguments[0])&&!d(t)&&"imageData"in t){var h=t;t=h.imageData,e=h.format||e||n,i=h.x||i||0,r=h.y||r||0,a=h.w||h.width||a,s=h.h||h.height||s,o=h.alias||o,c=h.compression||c,u=h.rotation||h.angle||u}var f=this.internal.getFilters();if(void 0===c&&-1!==f.indexOf("FlateEncode")&&(c="SLOW"),isNaN(i)||isNaN(r))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var p=M.call(this,t,e,o,c);return g.call(this,i,r,a,s,p,u),this};var M=function(e,i,a,s){var o,l,c;if("string"==typeof e&&r(e)===n){e=unescape(e);var m=A(e,!1);(""!==m||void 0!==(m=t.loadFile(e,!0)))&&(e=m)}if(d(e)&&(e=f(e,i)),i=r(e,i),!h(i))throw new Error("addImage does not support files of type '"+i+"', please ensure that a plugin for '"+i+"' support is added.");if((null==(c=a)||0===c.length)&&(a=function(t){return"string"==typeof t||w(t)?v(t):w(t.data)?v(t.data):null}(e)),(o=p.call(this,a))||(e instanceof Uint8Array||"RGBA"===i||(l=e,e=S(e)),o=this["process"+i.toUpperCase()](e,u.call(this),a,function(e){return e&&"string"==typeof e&&(e=e.toUpperCase()),e in t.image_compression?e:y.NONE}(s),l)),!o)throw new Error("An unknown error occurred whilst processing the image.");return o},A=t.__addimage__.convertBase64ToBinaryString=function(t,e){e="boolean"!=typeof e||e;var n,i="";if("string"==typeof t){var a;n=null!==(a=x(t))&&void 0!==a?a:t;try{i=ho(n)}catch(r){if(e)throw b(n)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+r.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return i};t.getImageProperties=function(e){var i,a,s="";if(d(e)&&(e=f(e)),"string"==typeof e&&r(e)===n&&(""===(s=A(e,!1))&&(s=t.loadFile(e)||""),e=s),a=r(e),!h(a))throw new Error("addImage does not support files of type '"+a+"', please ensure that a plugin for '"+a+"' support is added.");if(e instanceof Uint8Array||(e=S(e)),!(i=this["process"+a.toUpperCase()](e)))throw new Error("An unknown error occurred whilst processing the image");return i.fileType=a,i}}(Fo.API),function(t){var e=function(t){if(void 0!==t&&""!=t)return!0};Fo.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(t){for(var n,i,r,a=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,o=this.internal.getPageInfoByObjId(t.objId),l=t.pageContext.annotations,c=!1,u=0;u<l.length&&!c;u++)switch((n=l[u]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var h=0;h<l.length;h++){n=l[h];var d=this.internal.pdfEscape,f=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),m=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(p.objId),_=n.title||"Note";r="<</Type /Annot /Subtype /Text "+(i="/Rect ["+a(n.bounds.x)+" "+s(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+s(n.bounds.y)+"] ")+"/Contents ("+d(g(n.contents))+")",r+=" /Popup "+m.objId+" 0 R",r+=" /P "+o.objId+" 0 R",r+=" /T ("+d(g(_))+") >>",p.content=r;var y=p.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+a(n.bounds.x+30)+" "+s(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+s(n.bounds.y)+"] ")+" /Parent "+y,n.open&&(r+=" /Open true"),r+=" >>",m.content=r,this.internal.write(p.objId,"0 R",m.objId,"0 R");break;case"freetext":i="/Rect ["+a(n.bounds.x)+" "+s(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+s(n.bounds.y+n.bounds.h)+"] ";var v=n.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+d(f(n.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(n.options.name){var b=this.annotations._nameMap[n.options.name];n.options.pageNumber=b.page,n.options.top=b.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",r="",n.options.url)r="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+d(f(n.options.url))+") >>";else if(n.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,r+=" /FitV "+n.options.left+"]";break;default:var x=s(n.options.top);n.options.left=n.options.left||0,void 0===n.options.zoom&&(n.options.zoom=0),r+=" /XYZ "+n.options.left+" "+x+" "+n.options.zoom+"]"}""!=r&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),t.createAnnotation=function(t){var e=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":e.pageContext.annotations.push(t)}},t.link=function(t,e,n,i,r){var a=this.internal.getCurrentPageInfo(),s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:s(t),y:o(e),w:s(t+n),h:o(e+i)},options:r,type:"link"})},t.textWithLink=function(t,e,n,i){var r,a,s=this.getTextWidth(t),o=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==i.maxWidth){a=i.maxWidth;var l=this.splitTextToSize(t,a).length;r=Math.ceil(o*l)}else a=s,r=o;return this.text(t,e,n,i),n+=.2*o,"center"===i.align&&(e-=s/2),"right"===i.align&&(e-=s),this.link(e,n-o,a,r,i),s},t.getTextWidth=function(t){var e=this.internal.getFontSize();return this.getStringUnitWidth(t)*e/this.internal.scaleFactor}}(Fo.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(t){return void 0!==e[t.charCodeAt(0)]},s=t.__arabicParser__.isArabicLetter=function(t){return"string"==typeof t&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(t)},o=t.__arabicParser__.isArabicEndLetter=function(t){return s(t)&&a(t)&&e[t.charCodeAt(0)].length<=2},l=t.__arabicParser__.isArabicAlfLetter=function(t){return s(t)&&r.indexOf(t.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(t){return s(t)&&a(t)&&e[t.charCodeAt(0)].length>=1};var c=t.__arabicParser__.arabicLetterHasFinalForm=function(t){return s(t)&&a(t)&&e[t.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(t){return s(t)&&a(t)&&e[t.charCodeAt(0)].length>=3};var u=t.__arabicParser__.arabicLetterHasMedialForm=function(t){return s(t)&&a(t)&&4==e[t.charCodeAt(0)].length},h=t.__arabicParser__.resolveLigatures=function(t){var e=0,i=n,r="",a=0;for(e=0;e<t.length;e+=1)void 0!==i[t.charCodeAt(e)]?(a++,"number"==typeof(i=i[t.charCodeAt(e)])&&(r+=String.fromCharCode(i),i=n,a=0),e===t.length-1&&(i=n,r+=t.charAt(e-(a-1)),e-=a-1,a=0)):(i=n,r+=t.charAt(e-a),e-=a,a=0);return r};t.__arabicParser__.isArabicDiacritic=function(t){return void 0!==t&&void 0!==i[t.charCodeAt(0)]};var d=t.__arabicParser__.getCorrectForm=function(t,e,n){return s(t)?!1===a(t)?-1:!c(t)||!s(e)&&!s(n)||!s(n)&&o(e)||o(t)&&!s(e)||o(t)&&l(e)||o(t)&&o(e)?0:u(t)&&s(e)&&!o(e)&&s(n)&&c(n)?3:o(t)||!s(n)?1:2:-1},f=function(t){var n=0,i=0,r=0,a="",o="",l="",c=(t=t||"").split("\\s+"),u=[];for(n=0;n<c.length;n+=1){for(u.push(""),i=0;i<c[n].length;i+=1)a=c[n][i],o=c[n][i-1],l=c[n][i+1],s(a)?(r=d(a,o,l),u[n]+=-1!==r?String.fromCharCode(e[a.charCodeAt(0)][r]):a):u[n]+=a;u[n]=h(u[n])}return u.join(" ")},p=t.__arabicParser__.processArabic=t.processArabic=function(){var t,e="string"==typeof arguments[0]?arguments[0]:arguments[0].text,n=[];if(Array.isArray(e)){var i=0;for(n=[],i=0;i<e.length;i+=1)Array.isArray(e[i])?n.push([f(e[i][0]),e[i][1],e[i][2]]):n.push([f(e[i])]);t=n}else t=f(e);return"string"==typeof arguments[0]?t:(arguments[0].text=t,arguments[0])};t.events.push(["preProcessText",p])}(Fo.API),Fo.API.autoPrint=function(t){var e;return(t=t||{}).variant=t.variant||"non-conform","javascript"===t.variant?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})),this},function(t){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(e){t=e}});var e=150;Object.defineProperty(this,"width",{get:function(){return e},set:function(t){e=isNaN(t)||!1===Number.isInteger(t)||t<0?150:t,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=e+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(t){n=isNaN(t)||!1===Number.isInteger(t)||t<0?300:t,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(t){i=t}});var r={};Object.defineProperty(this,"style",{get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,e){var n;if("2d"!==(t=t||"2d"))return null;for(n in e)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=e[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(Fo.API),function(t){var e={left:0,top:0,bottom:0,right:0},n=!1,i=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var t=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var e=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(t){n=t}});var i=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return i},set:function(t){i=t}});var r=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return r},set:function(t){r=t}});var a=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return a},set:function(t){a=t}});var s=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return s},set:function(t){s=t}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(t){return i.call(this),this.internal.__cell__.headerFunction="function"==typeof t?t:void 0,this},t.getTextDimensions=function(t,e){i.call(this);var n=(e=e||{}).fontSize||this.getFontSize(),r=e.font||this.getFont(),a=e.scaleFactor||this.internal.scaleFactor,s=0,o=0,l=0,c=this;if(!Array.isArray(t)&&"string"!=typeof t){if("number"!=typeof t)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");t=String(t)}var u=e.maxWidth;u>0?"string"==typeof t?t=this.splitTextToSize(t,u):"[object Array]"===Object.prototype.toString.call(t)&&(t=t.reduce(function(t,e){return t.concat(c.splitTextToSize(e,u))},[])):t=Array.isArray(t)?t:[t];for(var h=0;h<t.length;h++)s<(l=this.getStringUnitWidth(t[h],{font:r})*n)&&(s=l);return 0!==s&&(o=t.length),{w:s/=a,h:Math.max((o*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/a,0)}},t.cellAddPage=function(){i.call(this),this.addPage();var t=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(t.left,t.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var t;t=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var r=this.internal.__cell__.lastCell,s=this.internal.__cell__.padding,o=this.internal.__cell__.margins||e,l=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==r.lineNumber&&(r.lineNumber===t.lineNumber?(t.x=(r.x||0)+(r.width||0),t.y=r.y||0):r.y+r.height+t.height+o.bottom>this.getPageHeight()?(this.cellAddPage(),t.y=o.top,c&&l&&(this.printHeaderRow(t.lineNumber,!0),t.y+=l[0].height)):t.y=r.y+r.height||t.y),void 0!==t.text[0]&&(this.rect(t.x,t.y,t.width,t.height,!0===n?"FD":void 0),"right"===t.align?this.text(t.text,t.x+t.width-s,t.y+s,{align:"right",baseline:"top"}):"center"===t.align?this.text(t.text,t.x+t.width/2,t.y+s,{align:"center",baseline:"top",maxWidth:t.width-s-s}):this.text(t.text,t.x+s,t.y+s,{align:"left",baseline:"top",maxWidth:t.width-s-s})),this.internal.__cell__.lastCell=t,this};t.table=function(t,n,l,c,u){if(i.call(this),!l)throw new Error("No data for PDF table.");var h,d,f,p,m=[],g=[],_=[],y={},v={},b=[],x=[],w=(u=u||{}).autoSize||!1,S=!1!==u.printHeaders,P=u.css&&void 0!==u.css["font-size"]?16*u.css["font-size"]:u.fontSize||12,M=u.margins||Object.assign({width:this.getPageWidth()},e),A="number"==typeof u.padding?u.padding:3,k=u.headerBackgroundColor||"#c8c8c8",E=u.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=M,this.internal.__cell__.table_font_size=P,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=k,this.internal.__cell__.headerTextColor=E,this.setFontSize(P),null==c)g=m=Object.keys(l[0]),_=m.map(function(){return"left"});else if(Array.isArray(c)&&"object"===(0,Ge.A)(c[0]))for(m=c.map(function(t){return t.name}),g=c.map(function(t){return t.prompt||t.name||""}),_=c.map(function(t){return t.align||"left"}),h=0;h<c.length;h+=1)v[c[h].name]=.7499990551181103*c[h].width;else Array.isArray(c)&&"string"==typeof c[0]&&(g=m=c,_=m.map(function(){return"left"}));if(w||Array.isArray(c)&&"string"==typeof c[0])for(h=0;h<m.length;h+=1){for(y[p=m[h]]=l.map(function(t){return t[p]}),this.setFont(void 0,"bold"),b.push(this.getTextDimensions(g[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),d=y[p],this.setFont(void 0,"normal"),f=0;f<d.length;f+=1)b.push(this.getTextDimensions(d[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);v[p]=Math.max.apply(null,b)+A+A,b=[]}if(S){var T={};for(h=0;h<m.length;h+=1)T[m[h]]={},T[m[h]].text=g[h],T[m[h]].align=_[h];var C=o.call(this,T,v);x=m.map(function(e){return new a(t,n,v[e],C,T[e].text,void 0,T[e].align)}),this.setTableHeaderRow(x),this.printHeaderRow(1,!1)}var I=c.reduce(function(t,e){return t[e.name]=e.align,t},{});for(h=0;h<l.length;h+=1){"rowStart"in u&&u.rowStart instanceof Function&&u.rowStart({row:h,data:l[h]},this);var L=o.call(this,l[h],v);for(f=0;f<m.length;f+=1){var z=l[h][m[f]];"cellStart"in u&&u.cellStart instanceof Function&&u.cellStart({row:h,col:f,data:z},this),s.call(this,new a(t,n,v[m[f]],L,z,h+2,I[m[f]]))}}return this.internal.__cell__.table_x=t,this.internal.__cell__.table_y=n,this};var o=function(t,e){var n=this.internal.__cell__.padding,i=this.internal.__cell__.table_font_size,r=this.internal.scaleFactor;return Object.keys(t).map(function(i){var r=t[i];return this.splitTextToSize(r.hasOwnProperty("text")?r.text:r,e[i]-n-n)},this).map(function(t){return this.getLineHeightFactor()*t.length*i/r+n+n},this).reduce(function(t,e){return Math.max(t,e)},0)};t.setTableHeaderRow=function(t){i.call(this),this.internal.__cell__.tableHeaderRow=t},t.printHeaderRow=function(t,e){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var r;if(n=!0,"function"==typeof this.internal.__cell__.headerFunction){var o=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(o[0],o[1],o[2],o[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){r=this.internal.__cell__.tableHeaderRow[c].clone(),e&&(r.y=this.internal.__cell__.margins.top||0,l.push(r)),r.lineNumber=t;var u=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,r),this.setTextColor(u)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),n=!1}}(Fo.API);var Ml={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Al=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],kl=Pl(Al),El=[100,200,300,400,500,600,700,800,900],Tl=Pl(El);function Cl(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),n=function(t){return Ml[t=t||"normal"]?t:"normal"}(t.style),i=function(t){return t?"number"==typeof t?t>=100&&t<=900&&t%100==0?t:400:/^\d00$/.test(t)?parseInt(t):"bold"===t?700:400:400}(t.weight),r=function(t){return"number"==typeof kl[t=t||"normal"]?t:"normal"}(t.stretch);return{family:e,style:n,weight:i,stretch:r,src:t.src||[],ref:t.ref||{name:e,style:[r,n,i].join(" ")}}}function Il(t,e,n,i){var r;for(r=n;r>=0&&r<e.length;r+=i)if(t[e[r]])return t[e[r]];for(r=n;r>=0&&r<e.length;r-=i)if(t[e[r]])return t[e[r]]}var Ll={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},zl={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Nl(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Dl(t){return t.trimLeft()}function Rl(t,e){for(var n=0;n<t.length;){if(t.charAt(n)===e)return[t.substring(0,n),t.substring(n+1)];n+=1}return null}function Fl(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===e?null:[e[0],t.substring(e[0].length)]}var Ol,Bl,jl,Ul,Gl,ql,Vl,Zl,Wl,Hl=["times"];function Xl(t,e,n,i,r){var a=4,s=Jl;switch(r){case Fo.API.image_compression.FAST:a=1,s=Kl;break;case Fo.API.image_compression.MEDIUM:a=6,s=$l;break;case Fo.API.image_compression.SLOW:a=9,s=Ql}t=function(t,e,n,i){for(var r,a=t.length/e,s=new Uint8Array(t.length+a),o=[Yl,Kl,Jl,$l,Ql],l=0;l<a;l+=1){var c=l*e,u=t.subarray(c,c+e);if(i)s.set(i(u,n,r),c+l);else{for(var h=o.length,d=[],f=0;f<h;f+=1)d[f]=o[f](u,n,r);var p=ec(d.concat());s.set(d[p],c+l)}r=u}return s}(t,e,Math.ceil(n*i/8),s);var o=kn(t,{level:a});return Fo.API.__addimage__.arrayBufferToBinaryString(o)}function Yl(t){var e=Array.apply([],t);return e.unshift(0),e}function Kl(t,e){var n=t.length,i=[];i[0]=1;for(var r=0;r<n;r+=1){var a=t[r-e]||0;i[r+1]=t[r]-a+256&255}return i}function Jl(t,e,n){var i=t.length,r=[];r[0]=2;for(var a=0;a<i;a+=1){var s=n&&n[a]||0;r[a+1]=t[a]-s+256&255}return r}function $l(t,e,n){var i=t.length,r=[];r[0]=3;for(var a=0;a<i;a+=1){var s=t[a-e]||0,o=n&&n[a]||0;r[a+1]=t[a]+256-(s+o>>>1)&255}return r}function Ql(t,e,n){var i=t.length,r=[];r[0]=4;for(var a=0;a<i;a+=1){var s=tc(t[a-e]||0,n&&n[a]||0,n&&n[a-e]||0);r[a+1]=t[a]-s+256&255}return r}function tc(t,e,n){if(t===e&&e===n)return t;var i=Math.abs(e-n),r=Math.abs(t-n),a=Math.abs(t+e-n-n);return i<=r&&i<=a?t:r<=a?e:n}function ec(t){var e=t.map(function(t){return t.reduce(function(t,e){return t+Math.abs(e)},0)});return e.indexOf(Math.min.apply(null,e))}function nc(t,e,n){var i=e*n,r=Math.floor(i/8),a=16-(i-8*r+n),s=(1<<n)-1;return rc(t,r)>>a&s}function ic(t,e,n,i){var r=n*i,a=Math.floor(r/8),s=16-(r-8*a+i),o=(1<<i)-1,l=(e&o)<<s;!function(t,e,n){if(e+1<t.byteLength)t.setUint16(e,n,!1);else{var i=n>>8&255;t.setUint8(e,i)}}(t,a,rc(t,a)&~(o<<s)&65535|l)}function rc(t,e){return e+1<t.byteLength?t.getUint16(e,!1):t.getUint8(e)<<8}function ac(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,i=t[e++]|t[e++]<<8,r=t[e++],a=r>>7,s=1<<1+(7&r);t[e++],t[e++];var o=null,l=null;a&&(o=e,l=s,e+=3*s);var c=!0,u=[],h=0,d=null,f=0,p=null;for(this.width=n,this.height=i;c&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,p=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(0===k)break;e+=k}break;case 249:if(4!==t[e++]||0!==t[e+4])throw new Error("Invalid graphics extension block.");var m=t[e++];h=t[e++]|t[e++]<<8,d=t[e++],1&m||(d=null),f=m>>2&7,e++;break;case 254:for(;;){if(!((k=t[e++])>=0))throw Error("Invalid block size");if(0===k)break;e+=k}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var g=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,b=t[e++],x=b>>6&1,w=1<<1+(7&b),S=o,P=l,M=!1;b>>7&&(M=!0,S=e,P=w,e+=3*w);var A=e;for(e++;;){var k;if(!((k=t[e++])>=0))throw Error("Invalid block size");if(0===k)break;e+=k}u.push({x:g,y:_,width:y,height:v,has_local_palette:M,palette_offset:S,palette_size:P,data_offset:A,data_length:e-A,transparent_index:d,interlaced:!!x,delay:h,disposal:f});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(t){if(t<0||t>=u.length)throw new Error("Frame index out of range.");return u[t]},this.decodeAndBlitFrameBGRA=function(e,i){var r=this.frameInfo(e),a=r.width*r.height,s=new Uint8Array(a);sc(t,r.data_offset,s,a);var o=r.palette_offset,l=r.transparent_index;null===l&&(l=256);var c=r.width,u=n-c,h=c,d=4*(r.y*n+r.x),f=4*((r.y+r.height)*n+r.x),p=d,m=4*u;!0===r.interlaced&&(m+=4*n*7);for(var g=8,_=0,y=s.length;_<y;++_){var v=s[_];if(0===h&&(h=c,(p+=m)>=f&&(m=4*u+4*n*(g-1),p=d+(c+u)*(g<<1),g>>=1)),v===l)p+=4;else{var b=t[o+3*v],x=t[o+3*v+1],w=t[o+3*v+2];i[p++]=w,i[p++]=x,i[p++]=b,i[p++]=255}--h}},this.decodeAndBlitFrameRGBA=function(e,i){var r=this.frameInfo(e),a=r.width*r.height,s=new Uint8Array(a);sc(t,r.data_offset,s,a);var o=r.palette_offset,l=r.transparent_index;null===l&&(l=256);var c=r.width,u=n-c,h=c,d=4*(r.y*n+r.x),f=4*((r.y+r.height)*n+r.x),p=d,m=4*u;!0===r.interlaced&&(m+=4*n*7);for(var g=8,_=0,y=s.length;_<y;++_){var v=s[_];if(0===h&&(h=c,(p+=m)>=f&&(m=4*u+4*n*(g-1),p=d+(c+u)*(g<<1),g>>=1)),v===l)p+=4;else{var b=t[o+3*v],x=t[o+3*v+1],w=t[o+3*v+2];i[p++]=b,i[p++]=x,i[p++]=w,i[p++]=255}--h}}}function sc(t,e,n,i){for(var r=t[e++],a=1<<r,s=a+1,o=s+1,l=r+1,c=(1<<l)-1,u=0,h=0,d=0,f=t[e++],p=new Int32Array(4096),m=null;;){for(;u<16&&0!==f;)h|=t[e++]<<u,u+=8,1===f?f=t[e++]:--f;if(u<l)break;var g=h&c;if(h>>=l,u-=l,g!==a){if(g===s)break;for(var _=g<o?g:m,y=0,v=_;v>a;)v=p[v]>>8,++y;var b=v;if(d+y+(_!==g?1:0)>i)return void ao.log("Warning, gif stream longer than expected.");n[d++]=b;var x=d+=y;for(_!==g&&(n[d++]=b),v=_;y--;)v=p[v],n[--x]=255&v,v>>=8;null!==m&&o<4096&&(p[o++]=m<<8|b,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=g}else o=s+1,c=(1<<(l=r+1))-1,m=null}return d!==i&&ao.log("Warning, gif stream shorter than expected."),n}function oc(t){var e,n,i,r,a,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(65535),d=new Array(65535),f=new Array(64),p=new Array(64),m=[],g=0,_=7,y=new Array(64),v=new Array(64),b=new Array(64),x=new Array(256),w=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],E=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],I=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(t,e){for(var n=0,i=0,r=new Array,a=1;a<=16;a++){for(var s=1;s<=t[a];s++)r[e[i]]=[],r[e[i]][0]=n,r[e[i]][1]=a,i++,n++;n*=2}return r}function z(t){for(var e=t[0],n=t[1]-1;n>=0;)e&1<<n&&(g|=1<<_),n--,--_<0&&(255==g?(N(255),N(0)):N(g),_=7,g=0)}function N(t){m.push(t)}function D(t){N(t>>8&255),N(255&t)}function R(t,e,n,i,r){for(var a,s=r[0],o=r[240],l=function(t,e){var n,i,r,a,s,o,l,c,u,h,d=0;for(u=0;u<8;++u){n=t[d],i=t[d+1],r=t[d+2],a=t[d+3],s=t[d+4],o=t[d+5],l=t[d+6];var p=n+(c=t[d+7]),m=n-c,g=i+l,_=i-l,y=r+o,v=r-o,b=a+s,x=a-s,w=p+b,S=p-b,P=g+y,M=g-y;t[d]=w+P,t[d+4]=w-P;var A=.707106781*(M+S);t[d+2]=S+A,t[d+6]=S-A;var k=.382683433*((w=x+v)-(M=_+m)),E=.5411961*w+k,T=1.306562965*M+k,C=.707106781*(P=v+_),I=m+C,L=m-C;t[d+5]=L+E,t[d+3]=L-E,t[d+1]=I+T,t[d+7]=I-T,d+=8}for(d=0,u=0;u<8;++u){n=t[d],i=t[d+8],r=t[d+16],a=t[d+24],s=t[d+32],o=t[d+40],l=t[d+48];var z=n+(c=t[d+56]),N=n-c,D=i+l,R=i-l,F=r+o,O=r-o,B=a+s,j=a-s,U=z+B,G=z-B,q=D+F,V=D-F;t[d]=U+q,t[d+32]=U-q;var Z=.707106781*(V+G);t[d+16]=G+Z,t[d+48]=G-Z;var W=.382683433*((U=j+O)-(V=R+N)),H=.5411961*U+W,X=1.306562965*V+W,Y=.707106781*(q=O+R),K=N+Y,J=N-Y;t[d+40]=J+H,t[d+24]=J-H,t[d+8]=K+X,t[d+56]=K-X,d++}for(u=0;u<64;++u)h=t[u]*e[u],f[u]=h>0?h+.5|0:h-.5|0;return f}(t,e),c=0;c<64;++c)p[S[c]]=l[c];var u=p[0]-n;n=p[0],0==u?z(i[0]):(z(i[d[a=32767+u]]),z(h[a]));for(var m=63;m>0&&0==p[m];)m--;if(0==m)return z(s),n;for(var g,_=1;_<=m;){for(var y=_;0==p[_]&&_<=m;)++_;var v=_-y;if(v>=16){g=v>>4;for(var b=1;b<=g;++b)z(o);v&=15}a=32767+p[_],z(r[(v<<4)+d[a]]),z(h[a]),_++}return 63!=m&&z(s),n}function F(t){t=Math.min(Math.max(t,1),100),a!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var i=s((e[n]*t+50)/100);i=Math.min(Math.max(i,1),255),o[S[n]]=i}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var h=s((r[a]*t+50)/100);h=Math.min(Math.max(h,1),255),l[S[a]]=h}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,p=0;p<8;p++)for(var m=0;m<8;m++)c[f]=1/(o[S[f]]*d[p]*d[m]*8),u[f]=1/(l[S[f]]*d[p]*d[m]*8),f++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),a=t)}this.encode=function(t,a){a&&F(a),m=new Array,g=0,_=7,D(65496),D(65504),D(16),N(74),N(70),N(73),N(70),N(0),N(1),N(1),N(0),D(1),D(1),N(0),N(0),function(){D(65499),D(132),N(0);for(var t=0;t<64;t++)N(o[t]);N(1);for(var e=0;e<64;e++)N(l[e])}(),function(t,e){D(65472),D(17),N(8),D(e),D(t),N(3),N(1),N(17),N(0),N(2),N(17),N(1),N(3),N(17),N(1)}(t.width,t.height),function(){D(65476),D(418),N(0);for(var t=0;t<16;t++)N(P[t+1]);for(var e=0;e<=11;e++)N(M[e]);N(16);for(var n=0;n<16;n++)N(A[n+1]);for(var i=0;i<=161;i++)N(k[i]);N(1);for(var r=0;r<16;r++)N(E[r+1]);for(var a=0;a<=11;a++)N(T[a]);N(17);for(var s=0;s<16;s++)N(C[s+1]);for(var o=0;o<=161;o++)N(I[o])}(),D(65498),D(12),N(3),N(1),N(0),N(2),N(17),N(3),N(17),N(0),N(63),N(0);var s=0,h=0,d=0;g=0,_=7,this.encode.displayName="_encode_";for(var f,p,x,S,L,O,B,j,U,G=t.data,q=t.width,V=t.height,Z=4*q,W=0;W<V;){for(f=0;f<Z;){for(L=Z*W+f,B=-1,j=0,U=0;U<64;U++)O=L+(j=U>>3)*Z+(B=4*(7&U)),W+j>=V&&(O-=Z*(W+1+j-V)),f+B>=Z&&(O-=f+B-Z+4),p=G[O++],x=G[O++],S=G[O++],y[U]=(w[p]+w[x+256|0]+w[S+512|0]>>16)-128,v[U]=(w[p+768|0]+w[x+1024|0]+w[S+1280|0]>>16)-128,b[U]=(w[p+1280|0]+w[x+1536|0]+w[S+1792|0]>>16)-128;s=R(y,c,s,e,i),h=R(v,u,h,n,r),d=R(b,u,d,n,r),f+=32}W+=8}if(_>=0){var H=[];H[1]=_+1,H[0]=(1<<_+1)-1,z(H)}return D(65497),new Uint8Array(m)},t=t||50,function(){for(var t=String.fromCharCode,e=0;e<256;e++)x[e]=t(e)}(),e=L(P,M),n=L(E,T),i=L(A,k),r=L(C,I),function(){for(var t=1,e=2,n=1;n<=15;n++){for(var i=t;i<e;i++)d[32767+i]=n,h[32767+i]=[],h[32767+i][1]=n,h[32767+i][0]=i;for(var r=-(e-1);r<=-t;r++)d[32767+r]=n,h[32767+r]=[],h[32767+r][1]=n,h[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)w[t]=19595*t,w[t+256|0]=38470*t,w[t+512|0]=7471*t+32768,w[t+768|0]=-11059*t,w[t+1024|0]=-21709*t,w[t+1280|0]=32768*t+8421375,w[t+1536|0]=-27439*t,w[t+1792|0]=-5329*t}(),F(t)}function lc(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function cc(t){function e(t){if(!t)throw Error("assert :P")}function n(t,e,n){for(var i=0;4>i;i++)if(t[e+i]!=n.charCodeAt(i))return!0;return!1}function i(t,e,n,i,r){for(var a=0;a<r;a++)t[e+a]=n[i+a]}function r(t,e,n,i){for(var r=0;r<i;r++)t[e+r]=n}function a(t){return new Int32Array(t)}function s(t,e){for(var n=[],i=0;i<t;i++)n.push(new e);return n}function o(t,e){var n=[];return function t(n,i,r){for(var a=r[i],s=0;s<a&&(n.push(r.length>i+1?[]:new e),!(r.length<i+1));s++)t(n[s],i+1,r)}(n,0,t),n}var l=function(){var t=this;function l(t,e){for(var n=1<<e-1>>>0;t&n;)n>>>=1;return n?(t&n-1)+n:t}function c(t,n,i,r,a){e(!(r%i));do{t[n+(r-=i)]=a}while(0<r)}function u(t,n,i,r,s){if(e(2328>=s),512>=s)var o=a(512);else if(null==(o=a(s)))return 0;return function(t,n,i,r,s,o){var u,d,f=n,p=1<<i,m=a(16),g=a(16);for(e(0!=s),e(null!=r),e(null!=t),e(0<i),d=0;d<s;++d){if(15<r[d])return 0;++m[r[d]]}if(m[0]==s)return 0;for(g[1]=0,u=1;15>u;++u){if(m[u]>1<<u)return 0;g[u+1]=g[u]+m[u]}for(d=0;d<s;++d)u=r[d],0<r[d]&&(o[g[u]++]=d);if(1==g[15])return(r=new h).g=0,r.value=o[0],c(t,f,1,p,r),p;var _,y=-1,v=p-1,b=0,x=1,w=1,S=1<<i;for(d=0,u=1,s=2;u<=i;++u,s<<=1){if(x+=w<<=1,0>(w-=m[u]))return 0;for(;0<m[u];--m[u])(r=new h).g=u,r.value=o[d++],c(t,f+b,s,S,r),b=l(b,u)}for(u=i+1,s=2;15>=u;++u,s<<=1){if(x+=w<<=1,0>(w-=m[u]))return 0;for(;0<m[u];--m[u]){if(r=new h,(b&v)!=y){for(f+=S,_=1<<(y=u)-i;15>y&&!(0>=(_-=m[y]));)++y,_<<=1;p+=S=1<<(_=y-i),t[n+(y=b&v)].g=_+i,t[n+y].value=f-n-y}r.g=u-i,r.value=o[d++],c(t,f+(b>>i),s,S,r),b=l(b,u)}}return x!=2*g[15]-1?0:p}(t,n,i,r,s,o)}function h(){this.value=this.g=0}function d(){this.value=this.g=0}function f(){this.G=s(5,h),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(On,d)}function p(t,n,i,r){e(null!=t),e(null!=n),e(2147483648>r),t.Ca=254,t.I=0,t.b=-8,t.Ka=0,t.oa=n,t.pa=i,t.Jd=n,t.Yc=i+r,t.Zc=4<=r?i+r-4+1:i,A(t)}function m(t,e){for(var n=0;0<e--;)n|=E(t,128)<<e;return n}function g(t,e){var n=m(t,e);return k(t)?-n:n}function _(t,n,i,r){var a,s=0;for(e(null!=t),e(null!=n),e(4294967288>r),t.Sb=r,t.Ra=0,t.u=0,t.h=0,4<r&&(r=4),a=0;a<r;++a)s+=n[i+a]<<8*a;t.Ra=s,t.bb=r,t.oa=n,t.pa=i}function y(t){for(;8<=t.u&&t.bb<t.Sb;)t.Ra>>>=8,t.Ra+=t.oa[t.pa+t.bb]<<Un-8>>>0,++t.bb,t.u-=8;S(t)&&(t.h=1,t.u=0)}function v(t,n){if(e(0<=n),!t.h&&n<=jn){var i=w(t)&Bn[n];return t.u+=n,y(t),i}return t.h=1,t.u=0}function b(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function x(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function w(t){return t.Ra>>>(t.u&Un-1)>>>0}function S(t){return e(t.bb<=t.Sb),t.h||t.bb==t.Sb&&t.u>Un}function P(t,e){t.u=e,t.h=S(t)}function M(t){t.u>=Gn&&(e(t.u>=Gn),y(t))}function A(t){e(null!=t&&null!=t.oa),t.pa<t.Zc?(t.I=(t.oa[t.pa++]|t.I<<8)>>>0,t.b+=8):(e(null!=t&&null!=t.oa),t.pa<t.Yc?(t.b+=8,t.I=t.oa[t.pa++]|t.I<<8):t.Ka?t.b=0:(t.I<<=8,t.b+=8,t.Ka=1))}function k(t){return m(t,1)}function E(t,e){var n=t.Ca;0>t.b&&A(t);var i=t.b,r=n*e>>>8,a=(t.I>>>i>r)+0;for(a?(n-=r,t.I-=r+1<<i>>>0):n=r+1,i=n,r=0;256<=i;)r+=8,i>>=8;return i=7^r+qn[i],t.b-=i,t.Ca=(n<<i)-1,a}function T(t,e,n){t[e+0]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=255&n}function C(t,e){return t[e+0]|t[e+1]<<8}function I(t,e){return C(t,e)|t[e+2]<<16}function L(t,e){return C(t,e)|C(t,e+2)<<16}function z(t,n){var i=1<<n;return e(null!=t),e(0<n),t.X=a(i),null==t.X?0:(t.Mb=32-n,t.Xa=n,1)}function N(t,n){e(null!=t),e(null!=n),e(t.Xa==n.Xa),i(n.X,0,t.X,0,1<<n.Xa)}function D(){this.X=[],this.Xa=this.Mb=0}function R(t,n,i,r){e(null!=i),e(null!=r);var a=i[0],s=r[0];return 0==a&&(a=(t*s+n/2)/n),0==s&&(s=(n*a+t/2)/t),0>=a||0>=s?0:(i[0]=a,r[0]=s,1)}function F(t,e){return t+(1<<e)-1>>>e}function O(t,e){return((4278255360&t)+(4278255360&e)>>>0&4278255360)+((16711935&t)+(16711935&e)>>>0&16711935)>>>0}function B(e,n){t[n]=function(n,i,r,a,s,o,l){var c;for(c=0;c<s;++c){var u=t[e](o[l+c-1],r,a+c);o[l+c]=O(n[i+c],u)}}}function j(){this.ud=this.hd=this.jd=0}function U(t,e){return((4278124286&(t^e))>>>1)+(t&e)>>>0}function G(t){return 0<=t&&256>t?t:0>t?0:255<t?255:void 0}function q(t,e){return G(t+(t-e+.5>>1))}function V(t,e,n){return Math.abs(e-n)-Math.abs(t-n)}function Z(t,e,n,i,r,a,s){for(i=a[s-1],n=0;n<r;++n)a[s+n]=i=O(t[e+n],i)}function W(t,e,n,i,r){var a;for(a=0;a<n;++a){var s=t[e+a],o=s>>8&255,l=16711935&(l=(l=16711935&s)+((o<<16)+o));i[r+a]=(4278255360&s)+l>>>0}}function H(t,e){e.jd=255&t,e.hd=t>>8&255,e.ud=t>>16&255}function X(t,e,n,i,r,a){var s;for(s=0;s<i;++s){var o=e[n+s],l=o>>>8,c=o,u=255&(u=(u=o>>>16)+((t.jd<<24>>24)*(l<<24>>24)>>>5));c=255&(c=(c+=(t.hd<<24>>24)*(l<<24>>24)>>>5)+((t.ud<<24>>24)*(u<<24>>24)>>>5)),r[a+s]=(4278255360&o)+(u<<16)+c}}function Y(e,n,i,r,a){t[n]=function(t,e,n,i,s,o,l,c,u){for(i=l;i<c;++i)for(l=0;l<u;++l)s[o++]=a(n[r(t[e++])])},t[e]=function(e,n,s,o,l,c,u){var h=8>>e.b,d=e.Ea,f=e.K[0],p=e.w;if(8>h)for(e=(1<<e.b)-1,p=(1<<h)-1;n<s;++n){var m,g=0;for(m=0;m<d;++m)m&e||(g=r(o[l++])),c[u++]=a(f[g&p]),g>>=h}else t["VP8LMapColor"+i](o,l,f,p,c,u,n,s,d)}}function K(t,e,n,i,r){for(n=e+n;e<n;){var a=t[e++];i[r++]=a>>16&255,i[r++]=a>>8&255,i[r++]=255&a}}function J(t,e,n,i,r){for(n=e+n;e<n;){var a=t[e++];i[r++]=a>>16&255,i[r++]=a>>8&255,i[r++]=255&a,i[r++]=a>>24&255}}function $(t,e,n,i,r){for(n=e+n;e<n;){var a=(s=t[e++])>>16&240|s>>12&15,s=240&s|s>>28&15;i[r++]=a,i[r++]=s}}function Q(t,e,n,i,r){for(n=e+n;e<n;){var a=(s=t[e++])>>16&248|s>>13&7,s=s>>5&224|s>>3&31;i[r++]=a,i[r++]=s}}function tt(t,e,n,i,r){for(n=e+n;e<n;){var a=t[e++];i[r++]=255&a,i[r++]=a>>8&255,i[r++]=a>>16&255}}function et(t,e,n,r,a,s){if(0==s)for(n=e+n;e<n;)T(r,((s=t[e++])[0]>>24|s[1]>>8&65280|s[2]<<8&16711680|s[3]<<24)>>>0),a+=32;else i(r,a,t,e,n)}function nt(e,n){t[n][0]=t[e+"0"],t[n][1]=t[e+"1"],t[n][2]=t[e+"2"],t[n][3]=t[e+"3"],t[n][4]=t[e+"4"],t[n][5]=t[e+"5"],t[n][6]=t[e+"6"],t[n][7]=t[e+"7"],t[n][8]=t[e+"8"],t[n][9]=t[e+"9"],t[n][10]=t[e+"10"],t[n][11]=t[e+"11"],t[n][12]=t[e+"12"],t[n][13]=t[e+"13"],t[n][14]=t[e+"0"],t[n][15]=t[e+"0"]}function it(t){return t==Gi||t==qi||t==Vi||t==Zi}function rt(){this.eb=[],this.size=this.A=this.fb=0}function at(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function st(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new rt,this.f.kb=new at,this.sd=null}function ot(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function lt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ct(t){return alert("todo:WebPSamplerProcessPlane"),t.T}function ut(t,e){var n=t.T,r=e.ba.f.RGBA,a=r.eb,s=r.fb+t.ka*r.A,o=gr[e.ba.S],l=t.y,c=t.O,u=t.f,h=t.N,d=t.ea,f=t.W,p=e.cc,m=e.dc,g=e.Mc,_=e.Nc,y=t.ka,v=t.ka+t.T,b=t.U,x=b+1>>1;for(0==y?o(l,c,null,null,u,h,d,f,u,h,d,f,a,s,null,null,b):(o(e.ec,e.fc,l,c,p,m,g,_,u,h,d,f,a,s-r.A,a,s,b),++n);y+2<v;y+=2)p=u,m=h,g=d,_=f,h+=t.Rc,f+=t.Rc,s+=2*r.A,o(l,(c+=2*t.fa)-t.fa,l,c,p,m,g,_,u,h,d,f,a,s-r.A,a,s,b);return c+=t.fa,t.j+v<t.o?(i(e.ec,e.fc,l,c,b),i(e.cc,e.dc,u,h,x),i(e.Mc,e.Nc,d,f,x),n--):1&v||o(l,c,null,null,u,h,d,f,u,h,d,f,a,s+r.A,null,null,b),n}function ht(t,n,i){var r=t.F,a=[t.J];if(null!=r){var s=t.U,o=n.ba.S,l=o==Bi||o==Vi;n=n.ba.f.RGBA;var c=[0],u=t.ka;c[0]=t.T,t.Kb&&(0==u?--c[0]:(--u,a[0]-=t.width),t.j+t.ka+t.T==t.o&&(c[0]=t.o-t.j-u));var h=n.eb;u=n.fb+u*n.A,t=Pi(r,a[0],t.width,s,c,h,u+(l?0:3),n.A),e(i==c),t&&it(o)&&wi(h,u,l,s,c,n.A)}return 0}function dt(t){var e=t.ma,n=e.ba.S,i=11>n,r=n==Ri||n==Oi||n==Bi||n==ji||12==n||it(n);if(e.memory=null,e.Ib=null,e.Jb=null,e.Nd=null,!Dn(e.Oa,t,r?11:12))return 0;if(r&&it(n)&&yn(),t.da)alert("todo:use_scaling");else{if(i){if(e.Ib=ct,t.Kb){if(n=t.U+1>>1,e.memory=a(t.U+2*n),null==e.memory)return 0;e.ec=e.memory,e.fc=0,e.cc=e.ec,e.dc=e.fc+t.U,e.Mc=e.cc,e.Nc=e.dc+n,e.Ib=ut,yn()}}else alert("todo:EmitYUV");r&&(e.Jb=ht,i&&gn())}if(i&&!Cr){for(t=0;256>t;++t)Ir[t]=89858*(t-128)+Mr>>Pr,Nr[t]=-22014*(t-128)+Mr,zr[t]=-45773*(t-128),Lr[t]=113618*(t-128)+Mr>>Pr;for(t=Ar;t<kr;++t)e=76283*(t-16)+Mr>>Pr,Dr[t-Ar]=Zt(e,255),Rr[t-Ar]=Zt(e+8>>4,15);Cr=1}return 1}function ft(t){var n=t.ma,i=t.U,r=t.T;return e(!(1&t.ka)),0>=i||0>=r?0:(i=n.Ib(t,n),null!=n.Jb&&n.Jb(t,n,i),n.Dc+=i,1)}function pt(t){t.ma.memory=null}function mt(t,e,n,i){return 47!=v(t,8)?0:(e[0]=v(t,14)+1,n[0]=v(t,14)+1,i[0]=v(t,1),0!=v(t,3)?0:!t.h)}function gt(t,e){if(4>t)return t+1;var n=t-2>>1;return(2+(1&t)<<n)+v(e,n)+1}function _t(t,e){return 120<e?e-120:1<=(n=((n=Ji[e-1])>>4)*t+(8-(15&n)))?n:1;var n}function yt(t,e,n){var i=w(n),r=t[e+=255&i].g-8;return 0<r&&(P(n,n.u+8),i=w(n),e+=t[e].value,e+=i&(1<<r)-1),P(n,n.u+t[e].g),t[e].value}function vt(t,n,i){return i.g+=t.g,i.value+=t.value<<n>>>0,e(8>=i.g),t.g}function bt(t,n,i){var r=t.xc;return e((n=0==r?0:t.vc[t.md*(i>>r)+(n>>r)])<t.Wb),t.Ya[n]}function xt(t,n,r,a){var s=t.ab,o=t.c*n,l=t.C;n=l+n;var c=r,u=a;for(a=t.Ta,r=t.Ua;0<s--;){var h=t.gc[s],d=l,f=n,p=c,m=u,g=(u=a,c=r,h.Ea);switch(e(d<f),e(f<=h.nc),h.hc){case 2:Wn(p,m,(f-d)*g,u,c);break;case 0:var _=d,y=f,v=u,b=c,x=(A=h).Ea;0==_&&(Vn(p,m,null,null,1,v,b),Z(p,m+1,0,0,x-1,v,b+1),m+=x,b+=x,++_);for(var w=1<<A.b,S=w-1,P=F(x,A.b),M=A.K,A=A.w+(_>>A.b)*P;_<y;){var k=M,E=A,T=1;for(Zn(p,m,v,b-x,1,v,b);T<x;){var C=(T&~S)+w;C>x&&(C=x),(0,Jn[k[E++]>>8&15])(p,m+ +T,v,b+T-x,C-T,v,b+T),T=C}m+=x,b+=x,++_&S||(A+=P)}f!=h.nc&&i(u,c-g,u,c+(f-d-1)*g,g);break;case 1:for(g=p,y=m,x=(p=h.Ea)-(b=p&~(v=(m=1<<h.b)-1)),_=F(p,h.b),w=h.K,h=h.w+(d>>h.b)*_;d<f;){for(S=w,P=h,M=new j,A=y+b,k=y+p;y<A;)H(S[P++],M),$n(M,g,y,m,u,c),y+=m,c+=m;y<k&&(H(S[P++],M),$n(M,g,y,x,u,c),y+=x,c+=x),++d&v||(h+=_)}break;case 3:if(p==u&&m==c&&0<h.b){for(y=u,p=g=c+(f-d)*g-(b=(f-d)*F(h.Ea,h.b)),m=u,v=c,_=[],b=(x=b)-1;0<=b;--b)_[b]=m[v+b];for(b=x-1;0<=b;--b)y[p+b]=_[b];Hn(h,d,f,u,g,u,c)}else Hn(h,d,f,p,m,u,c)}c=a,u=r}u!=r&&i(a,r,c,u,o)}function wt(t,n){var i=t.V,r=t.Ba+t.c*t.C,a=n-t.C;if(e(n<=t.l.o),e(16>=a),0<a){var s=t.l,o=t.Ta,l=t.Ua,c=s.width;if(xt(t,a,i,r),a=l=[l],e((i=t.C)<(r=n)),e(s.v<s.va),r>s.o&&(r=s.o),i<s.j){var u=s.j-i;i=s.j,a[0]+=u*c}if(i>=r?i=0:(a[0]+=4*s.v,s.ka=i-s.j,s.U=s.va-s.v,s.T=r-i,i=1),i){if(l=l[0],11>(i=t.ca).S){var h=i.f.RGBA,d=(r=i.S,a=s.U,s=s.T,u=h.eb,h.A),f=s;for(h=h.fb+t.Ma*h.A;0<f--;){var p=o,m=l,g=a,_=u,y=h;switch(r){case Di:Qn(p,m,g,_,y);break;case Ri:ti(p,m,g,_,y);break;case Gi:ti(p,m,g,_,y),wi(_,y,0,g,1,0);break;case Fi:ii(p,m,g,_,y);break;case Oi:et(p,m,g,_,y,1);break;case qi:et(p,m,g,_,y,1),wi(_,y,0,g,1,0);break;case Bi:et(p,m,g,_,y,0);break;case Vi:et(p,m,g,_,y,0),wi(_,y,1,g,1,0);break;case ji:ei(p,m,g,_,y);break;case Zi:ei(p,m,g,_,y),Si(_,y,g,1,0);break;case Ui:ni(p,m,g,_,y);break;default:e(0)}l+=c,h+=d}t.Ma+=s}else alert("todo:EmitRescaledRowsYUVA");e(t.Ma<=i.height)}}t.C=n,e(t.C<=t.i)}function St(t){var e;if(0<t.ua)return 0;for(e=0;e<t.Wb;++e){var n=t.Ya[e].G,i=t.Ya[e].H;if(0<n[1][i[1]+0].g||0<n[2][i[2]+0].g||0<n[3][i[3]+0].g)return 0}return 1}function Pt(t,n,i,r,a,s){if(0!=t.Z){var o=t.qd,l=t.rd;for(e(null!=mr[t.Z]);n<i;++n)mr[t.Z](o,l,r,a,r,a,s),o=r,l=a,a+=s;t.qd=o,t.rd=l}}function Mt(t,n){var i=t.l.ma,r=0==i.Z||1==i.Z?t.l.j:t.C;if(r=t.C<r?r:t.C,e(n<=t.l.o),n>r){var a=t.l.width,s=i.ca,o=i.tb+a*r,l=t.V,c=t.Ba+t.c*r,u=t.gc;e(1==t.ab),e(3==u[0].hc),Yn(u[0],r,n,l,c,s,o),Pt(i,r,n,s,o,a)}t.C=t.Ma=n}function At(t,n,i,r,a,s,o){var l=t.$/r,c=t.$%r,u=t.m,h=t.s,d=i+t.$,f=d;a=i+r*a;var p=i+r*s,m=280+h.ua,g=t.Pb?l:16777216,_=0<h.ua?h.Wa:null,y=h.wc,v=d<p?bt(h,c,l):null;e(t.C<s),e(p<=a);var b=!1;t:for(;;){for(;b||d<p;){var x=0;if(l>=g){var A=d-i;e((g=t).Pb),g.wd=g.m,g.xd=A,0<g.s.ua&&N(g.s.Wa,g.s.vb),g=l+Qi}if(c&y||(v=bt(h,c,l)),e(null!=v),v.Qb&&(n[d]=v.qb,b=!0),!b)if(M(u),v.jc){x=u,A=n;var k=d,E=v.pd[w(x)&On-1];e(v.jc),256>E.g?(P(x,x.u+E.g),A[k]=E.value,x=0):(P(x,x.u+E.g-256),e(256<=E.value),x=E.value),0==x&&(b=!0)}else x=yt(v.G[0],v.H[0],u);if(u.h)break;if(b||256>x){if(!b)if(v.nd)n[d]=(v.qb|x<<8)>>>0;else{if(M(u),b=yt(v.G[1],v.H[1],u),M(u),A=yt(v.G[2],v.H[2],u),k=yt(v.G[3],v.H[3],u),u.h)break;n[d]=(k<<24|b<<16|x<<8|A)>>>0}if(b=!1,++d,++c>=r&&(c=0,++l,null!=o&&l<=s&&!(l%16)&&o(t,l),null!=_))for(;f<d;)x=n[f++],_.X[(506832829*x&4294967295)>>>_.Mb]=x}else if(280>x){if(x=gt(x-256,u),A=yt(v.G[4],v.H[4],u),M(u),A=_t(r,A=gt(A,u)),u.h)break;if(d-i<A||a-d<x)break t;for(k=0;k<x;++k)n[d+k]=n[d+k-A];for(d+=x,c+=x;c>=r;)c-=r,++l,null!=o&&l<=s&&!(l%16)&&o(t,l);if(e(d<=a),c&y&&(v=bt(h,c,l)),null!=_)for(;f<d;)x=n[f++],_.X[(506832829*x&4294967295)>>>_.Mb]=x}else{if(!(x<m))break t;for(b=x-280,e(null!=_);f<d;)x=n[f++],_.X[(506832829*x&4294967295)>>>_.Mb]=x;x=d,e(!(b>>>(A=_).Xa)),n[x]=A.X[b],b=!0}b||e(u.h==S(u))}if(t.Pb&&u.h&&d<a)e(t.m.h),t.a=5,t.m=t.wd,t.$=t.xd,0<t.s.ua&&N(t.s.vb,t.s.Wa);else{if(u.h)break t;null!=o&&o(t,l>s?s:l),t.a=0,t.$=d-i}return 1}return t.a=3,0}function kt(t){e(null!=t),t.vc=null,t.yc=null,t.Ya=null;var n=t.Wa;null!=n&&(n.X=null),t.vb=null,e(null!=t)}function Et(){var e=new sn;return null==e?null:(e.a=0,e.xb=pr,nt("Predictor","VP8LPredictors"),nt("Predictor","VP8LPredictors_C"),nt("PredictorAdd","VP8LPredictorsAdd"),nt("PredictorAdd","VP8LPredictorsAdd_C"),Wn=W,$n=X,Qn=K,ti=J,ei=$,ni=Q,ii=tt,t.VP8LMapColor32b=Xn,t.VP8LMapColor8b=Kn,e)}function Tt(t,n,i,o,l){var c=1,d=[t],p=[n],m=o.m,g=o.s,_=null,y=0;t:for(;;){if(i)for(;c&&v(m,1);){var b=d,x=p,S=o,A=1,k=S.m,E=S.gc[S.ab],T=v(k,2);if(S.Oc&1<<T)c=0;else{switch(S.Oc|=1<<T,E.hc=T,E.Ea=b[0],E.nc=x[0],E.K=[null],++S.ab,e(4>=S.ab),T){case 0:case 1:E.b=v(k,3)+2,A=Tt(F(E.Ea,E.b),F(E.nc,E.b),0,S,E.K),E.K=E.K[0];break;case 3:var C,I=v(k,8)+1,L=16<I?0:4<I?1:2<I?2:3;if(b[0]=F(E.Ea,L),E.b=L,C=A=Tt(I,1,0,S,E.K)){var N,D=I,R=E,B=1<<(8>>R.b),j=a(B);if(null==j)C=0;else{var U=R.K[0],G=R.w;for(j[0]=R.K[0][0],N=1;N<1*D;++N)j[N]=O(U[G+N],j[N-1]);for(;N<4*B;++N)j[N]=0;R.K[0]=null,R.K[0]=j,C=1}}A=C;break;case 2:break;default:e(0)}c=A}}if(d=d[0],p=p[0],c&&v(m,1)&&!(c=1<=(y=v(m,4))&&11>=y)){o.a=3;break t}var q;if(q=c)e:{var V,Z,W,H=o,X=d,Y=p,K=y,J=i,$=H.m,Q=H.s,tt=[null],et=1,nt=0,it=$i[K];n:for(;;){if(J&&v($,1)){var rt=v($,3)+2,at=F(X,rt),st=F(Y,rt),ot=at*st;if(!Tt(at,st,0,H,tt))break n;for(tt=tt[0],Q.xc=rt,V=0;V<ot;++V){var lt=tt[V]>>8&65535;tt[V]=lt,lt>=et&&(et=lt+1)}}if($.h)break n;for(Z=0;5>Z;++Z){var ct=Xi[Z];!Z&&0<K&&(ct+=1<<K),nt<ct&&(nt=ct)}var ut=s(et*it,h),ht=et,dt=s(ht,f);if(null==dt)var ft=null;else e(65536>=ht),ft=dt;var pt=a(nt);if(null==ft||null==pt||null==ut){H.a=1;break n}var mt=ut;for(V=W=0;V<et;++V){var gt=ft[V],_t=gt.G,yt=gt.H,bt=0,xt=1,wt=0;for(Z=0;5>Z;++Z){ct=Xi[Z],_t[Z]=mt,yt[Z]=W,!Z&&0<K&&(ct+=1<<K);i:{var St,Pt=ct,Mt=H,Et=pt,Ct=mt,It=W,Lt=0,zt=Mt.m,Nt=v(zt,1);if(r(Et,0,0,Pt),Nt){var Dt=v(zt,1)+1,Rt=v(zt,1),Ft=v(zt,0==Rt?1:8);Et[Ft]=1,2==Dt&&(Et[Ft=v(zt,8)]=1);var Ot=1}else{var Bt=a(19),jt=v(zt,4)+4;if(19<jt){Mt.a=3;var Ut=0;break i}for(St=0;St<jt;++St)Bt[Ki[St]]=v(zt,3);var Gt=void 0,qt=void 0,Vt=Mt,Zt=Bt,Wt=Pt,Ht=Et,Xt=0,Yt=Vt.m,Kt=8,Jt=s(128,h);r:for(;u(Jt,0,7,Zt,19);){if(v(Yt,1)){var $t=2+2*v(Yt,3);if((Gt=2+v(Yt,$t))>Wt)break r}else Gt=Wt;for(qt=0;qt<Wt&&Gt--;){M(Yt);var Qt=Jt[0+(127&w(Yt))];P(Yt,Yt.u+Qt.g);var te=Qt.value;if(16>te)Ht[qt++]=te,0!=te&&(Kt=te);else{var ee=16==te,ne=te-16,ie=Hi[ne],re=v(Yt,Wi[ne])+ie;if(qt+re>Wt)break r;for(var ae=ee?Kt:0;0<re--;)Ht[qt++]=ae}}Xt=1;break r}Xt||(Vt.a=3),Ot=Xt}(Ot=Ot&&!zt.h)&&(Lt=u(Ct,It,8,Et,Pt)),Ot&&0!=Lt?Ut=Lt:(Mt.a=3,Ut=0)}if(0==Ut)break n;if(xt&&1==Yi[Z]&&(xt=0==mt[W].g),bt+=mt[W].g,W+=Ut,3>=Z){var se,oe=pt[0];for(se=1;se<ct;++se)pt[se]>oe&&(oe=pt[se]);wt+=oe}}if(gt.nd=xt,gt.Qb=0,xt&&(gt.qb=(_t[3][yt[3]+0].value<<24|_t[1][yt[1]+0].value<<16|_t[2][yt[2]+0].value)>>>0,0==bt&&256>_t[0][yt[0]+0].value&&(gt.Qb=1,gt.qb+=_t[0][yt[0]+0].value<<8)),gt.jc=!gt.Qb&&6>wt,gt.jc){var le,ce=gt;for(le=0;le<On;++le){var ue=le,he=ce.pd[ue],de=ce.G[0][ce.H[0]+ue];256<=de.value?(he.g=de.g+256,he.value=de.value):(he.g=0,he.value=0,ue>>=vt(de,8,he),ue>>=vt(ce.G[1][ce.H[1]+ue],16,he),ue>>=vt(ce.G[2][ce.H[2]+ue],0,he),vt(ce.G[3][ce.H[3]+ue],24,he))}}}Q.vc=tt,Q.Wb=et,Q.Ya=ft,Q.yc=ut,q=1;break e}q=0}if(!(c=q)){o.a=3;break t}if(0<y){if(g.ua=1<<y,!z(g.Wa,y)){o.a=1,c=0;break t}}else g.ua=0;var fe=o,pe=d,me=p,ge=fe.s,_e=ge.xc;if(fe.c=pe,fe.i=me,ge.md=F(pe,_e),ge.wc=0==_e?-1:(1<<_e)-1,i){o.xb=fr;break t}if(null==(_=a(d*p))){o.a=1,c=0;break t}c=(c=At(o,_,0,d,p,p,null))&&!m.h;break t}return c?(null!=l?l[0]=_:(e(null==_),e(i)),o.$=0,i||kt(g)):kt(g),c}function Ct(t,n){var i=t.c*t.i,r=i+n+16*n;return e(t.c<=n),t.V=a(r),null==t.V?(t.Ta=null,t.Ua=0,t.a=1,0):(t.Ta=t.V,t.Ua=t.Ba+i+n,1)}function It(t,n){var i=t.C,r=n-i,a=t.V,s=t.Ba+t.c*i;for(e(n<=t.l.o);0<r;){var o=16<r?16:r,l=t.l.ma,c=t.l.width,u=c*o,h=l.ca,d=l.tb+c*i,f=t.Ta,p=t.Ua;xt(t,o,a,s),Mi(f,p,h,d,u),Pt(l,i,i+o,h,d,c),r-=o,a+=o*t.c,i+=o}e(i==n),t.C=t.Ma=n}function Lt(){this.ub=this.yd=this.td=this.Rb=0}function zt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Dt(){this.Yb=function(){var t=[];return function t(e,n,i){for(var r=i[n],a=0;a<r&&(e.push(i.length>n+1?[]:0),!(i.length<n+1));a++)t(e[a],n+1,i)}(t,0,[3,11]),t}()}function Rt(){this.jb=a(3),this.Wc=o([4,8],Dt),this.Xc=o([4,17],Dt)}function Ft(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Ot(){this.ld=this.La=this.dd=this.tc=0}function Bt(){this.Na=this.la=0}function jt(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ut(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Gt(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ot),this.Y=0,this.ya=Array(new Ut),this.aa=0,this.l=new Wt}function qt(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Vt(){this.cb=this.a=0,this.sc="",this.m=new b,this.Od=new Lt,this.Kc=new zt,this.ed=new Ft,this.Qa=new Nt,this.Ic=this.$c=this.Aa=0,this.D=new Gt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,b),this.ia=0,this.pb=s(4,jt),this.Pa=new Rt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new qt),this.Hd=0,this.rb=Array(new Bt),this.sb=0,this.wa=Array(new Ot),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ut),this.L=this.aa=0,this.gd=o([4,2],Ot),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Zt(t,e){return 0>t?0:t>e?e:t}function Wt(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ht(){var t=new Vt;return null!=t&&(t.a=0,t.sc="OK",t.cb=0,t.Xb=0,nr||(nr=Jt)),t}function Xt(t,e,n){return 0==t.a&&(t.a=e,t.sc=n,t.cb=0),0}function Yt(t,e,n){return 3<=n&&157==t[e+0]&&1==t[e+1]&&42==t[e+2]}function Kt(t,n){if(null==t)return 0;if(t.a=0,t.sc="OK",null==n)return Xt(t,2,"null VP8Io passed to VP8GetHeaders()");var i=n.data,a=n.w,s=n.ha;if(4>s)return Xt(t,7,"Truncated header.");var o=i[a+0]|i[a+1]<<8|i[a+2]<<16,l=t.Od;if(l.Rb=!(1&o),l.td=o>>1&7,l.yd=o>>4&1,l.ub=o>>5,3<l.td)return Xt(t,3,"Incorrect keyframe parameters.");if(!l.yd)return Xt(t,4,"Frame not displayable.");a+=3,s-=3;var c=t.Kc;if(l.Rb){if(7>s)return Xt(t,7,"cannot parse picture header");if(!Yt(i,a,s))return Xt(t,3,"Bad code word");c.c=16383&(i[a+4]<<8|i[a+3]),c.Td=i[a+4]>>6,c.i=16383&(i[a+6]<<8|i[a+5]),c.Ud=i[a+6]>>6,a+=7,s-=7,t.za=c.c+15>>4,t.Ub=c.i+15>>4,n.width=c.c,n.height=c.i,n.Da=0,n.j=0,n.v=0,n.va=n.width,n.o=n.height,n.da=0,n.ib=n.width,n.hb=n.height,n.U=n.width,n.T=n.height,r((o=t.Pa).jb,0,255,o.jb.length),e(null!=(o=t.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,r(o.Zb,0,0,o.Zb.length),r(o.Lb,0,0,o.Lb)}if(l.ub>s)return Xt(t,7,"bad partition length");p(o=t.m,i,a,l.ub),a+=l.ub,s-=l.ub,l.Rb&&(c.Ld=k(o),c.Kd=k(o)),c=t.Qa;var u,h=t.Pa;if(e(null!=o),e(null!=c),c.Cb=k(o),c.Cb){if(c.Bb=k(o),k(o)){for(c.Fb=k(o),u=0;4>u;++u)c.Zb[u]=k(o)?g(o,7):0;for(u=0;4>u;++u)c.Lb[u]=k(o)?g(o,6):0}if(c.Bb)for(u=0;3>u;++u)h.jb[u]=k(o)?m(o,8):255}else c.Bb=0;if(o.Ka)return Xt(t,3,"cannot parse segment header");if((c=t.ed).zd=k(o),c.Tb=m(o,6),c.wb=m(o,3),c.Pc=k(o),c.Pc&&k(o)){for(h=0;4>h;++h)k(o)&&(c.vd[h]=g(o,6));for(h=0;4>h;++h)k(o)&&(c.od[h]=g(o,6))}if(t.L=0==c.Tb?0:c.zd?1:2,o.Ka)return Xt(t,3,"cannot parse filter header");var d=s;if(s=u=a,a=u+d,c=d,t.Xb=(1<<m(t.m,2))-1,d<3*(h=t.Xb))i=7;else{for(u+=3*h,c-=3*h,d=0;d<h;++d){var f=i[s+0]|i[s+1]<<8|i[s+2]<<16;f>c&&(f=c),p(t.Jc[+d],i,u,f),u+=f,c-=f,s+=3}p(t.Jc[+h],i,u,c),i=u<a?0:5}if(0!=i)return Xt(t,i,"cannot parse partitions");for(i=m(u=t.m,7),s=k(u)?g(u,4):0,a=k(u)?g(u,4):0,c=k(u)?g(u,4):0,h=k(u)?g(u,4):0,u=k(u)?g(u,4):0,d=t.Qa,f=0;4>f;++f){if(d.Cb){var _=d.Zb[f];d.Fb||(_+=i)}else{if(0<f){t.pb[f]=t.pb[0];continue}_=i}var y=t.pb[f];y.Sc[0]=tr[Zt(_+s,127)],y.Sc[1]=er[Zt(_+0,127)],y.Eb[0]=2*tr[Zt(_+a,127)],y.Eb[1]=101581*er[Zt(_+c,127)]>>16,8>y.Eb[1]&&(y.Eb[1]=8),y.Qc[0]=tr[Zt(_+h,117)],y.Qc[1]=er[Zt(_+u,127)],y.lc=_+u}if(!l.Rb)return Xt(t,4,"Not a key frame.");for(k(o),l=t.Pa,i=0;4>i;++i){for(s=0;8>s;++s)for(a=0;3>a;++a)for(c=0;11>c;++c)h=E(o,lr[i][s][a][c])?m(o,8):sr[i][s][a][c],l.Wc[i][s].Yb[a][c]=h;for(s=0;17>s;++s)l.Xc[i][s]=l.Wc[i][cr[s]]}return t.kc=k(o),t.kc&&(t.Bd=m(o,8)),t.cb=1}function Jt(t,e,n,i,r,a,s){var o=e[r].Yb[n];for(n=0;16>r;++r){if(!E(t,o[n+0]))return r;for(;!E(t,o[n+1]);)if(o=e[++r].Yb[0],n=0,16==r)return 16;var l=e[r+1].Yb;if(E(t,o[n+2])){var c=t,u=0;if(E(c,(d=o)[(h=n)+3]))if(E(c,d[h+6])){for(o=0,h=2*(u=E(c,d[h+8]))+(d=E(c,d[h+9+u])),u=0,d=ir[h];d[o];++o)u+=u+E(c,d[o]);u+=3+(8<<h)}else E(c,d[h+7])?(u=7+2*E(c,165),u+=E(c,145)):u=5+E(c,159);else u=E(c,d[h+4])?3+E(c,d[h+5]):2;o=l[2]}else u=1,o=l[1];l=s+rr[r],0>(c=t).b&&A(c);var h,d=c.b,f=(h=c.Ca>>1)-(c.I>>d)>>31;--c.b,c.Ca+=f,c.Ca|=1,c.I-=(h+1&f)<<d,a[l]=((u^f)-f)*i[(0<r)+0]}return 16}function $t(t){var e=t.rb[t.sb-1];e.la=0,e.Na=0,r(t.zc,0,0,t.zc.length),t.ja=0}function Qt(t,e,n,i,r){r=t[e+n+32*i]+(r>>3),t[e+n+32*i]=-256&r?0>r?0:255:r}function te(t,e,n,i,r,a){Qt(t,e,0,n,i+r),Qt(t,e,1,n,i+a),Qt(t,e,2,n,i-a),Qt(t,e,3,n,i-r)}function ee(t){return(20091*t>>16)+t}function ne(t,e,n,i){var r,s=0,o=a(16);for(r=0;4>r;++r){var l=t[e+0]+t[e+8],c=t[e+0]-t[e+8],u=(35468*t[e+4]>>16)-ee(t[e+12]),h=ee(t[e+4])+(35468*t[e+12]>>16);o[s+0]=l+h,o[s+1]=c+u,o[s+2]=c-u,o[s+3]=l-h,s+=4,e++}for(r=s=0;4>r;++r)l=(t=o[s+0]+4)+o[s+8],c=t-o[s+8],u=(35468*o[s+4]>>16)-ee(o[s+12]),Qt(n,i,0,0,l+(h=ee(o[s+4])+(35468*o[s+12]>>16))),Qt(n,i,1,0,c+u),Qt(n,i,2,0,c-u),Qt(n,i,3,0,l-h),s++,i+=32}function ie(t,e,n,i){var r=t[e+0]+4,a=35468*t[e+4]>>16,s=ee(t[e+4]),o=35468*t[e+1]>>16;te(n,i,0,r+s,t=ee(t[e+1]),o),te(n,i,1,r+a,t,o),te(n,i,2,r-a,t,o),te(n,i,3,r-s,t,o)}function re(t,e,n,i,r){ne(t,e,n,i),r&&ne(t,e+16,n,i+4)}function ae(t,e,n,i){ai(t,e+0,n,i,1),ai(t,e+32,n,i+128,1)}function se(t,e,n,i){var r;for(t=t[e+0]+4,r=0;4>r;++r)for(e=0;4>e;++e)Qt(n,i,e,r,t)}function oe(t,e,n,i){t[e+0]&&li(t,e+0,n,i),t[e+16]&&li(t,e+16,n,i+4),t[e+32]&&li(t,e+32,n,i+128),t[e+48]&&li(t,e+48,n,i+128+4)}function le(t,e,n,i){var r,s=a(16);for(r=0;4>r;++r){var o=t[e+0+r]+t[e+12+r],l=t[e+4+r]+t[e+8+r],c=t[e+4+r]-t[e+8+r],u=t[e+0+r]-t[e+12+r];s[0+r]=o+l,s[8+r]=o-l,s[4+r]=u+c,s[12+r]=u-c}for(r=0;4>r;++r)o=(t=s[0+4*r]+3)+s[3+4*r],l=s[1+4*r]+s[2+4*r],c=s[1+4*r]-s[2+4*r],u=t-s[3+4*r],n[i+0]=o+l>>3,n[i+16]=u+c>>3,n[i+32]=o-l>>3,n[i+48]=u-c>>3,i+=64}function ce(t,e,n){var i,r=e-32,a=zi,s=255-t[r-1];for(i=0;i<n;++i){var o,l=a,c=s+t[e-1];for(o=0;o<n;++o)t[e+o]=l[c+t[r+o]];e+=32}}function ue(t,e){ce(t,e,4)}function he(t,e){ce(t,e,8)}function de(t,e){ce(t,e,16)}function fe(t,e){var n;for(n=0;16>n;++n)i(t,e+32*n,t,e-32,16)}function pe(t,e){var n;for(n=16;0<n;--n)r(t,e,t[e-1],16),e+=32}function me(t,e,n){var i;for(i=0;16>i;++i)r(e,n+32*i,t,16)}function ge(t,e){var n,i=16;for(n=0;16>n;++n)i+=t[e-1+32*n]+t[e+n-32];me(i>>5,t,e)}function _e(t,e){var n,i=8;for(n=0;16>n;++n)i+=t[e-1+32*n];me(i>>4,t,e)}function ye(t,e){var n,i=8;for(n=0;16>n;++n)i+=t[e+n-32];me(i>>4,t,e)}function ve(t,e){me(128,t,e)}function be(t,e,n){return t+2*e+n+2>>2}function xe(t,e){var n,r=e-32;for(r=new Uint8Array([be(t[r-1],t[r+0],t[r+1]),be(t[r+0],t[r+1],t[r+2]),be(t[r+1],t[r+2],t[r+3]),be(t[r+2],t[r+3],t[r+4])]),n=0;4>n;++n)i(t,e+32*n,r,0,r.length)}function we(t,e){var n=t[e-1],i=t[e-1+32],r=t[e-1+64],a=t[e-1+96];T(t,e+0,16843009*be(t[e-1-32],n,i)),T(t,e+32,16843009*be(n,i,r)),T(t,e+64,16843009*be(i,r,a)),T(t,e+96,16843009*be(r,a,a))}function Se(t,e){var n,i=4;for(n=0;4>n;++n)i+=t[e+n-32]+t[e-1+32*n];for(i>>=3,n=0;4>n;++n)r(t,e+32*n,i,4)}function Pe(t,e){var n=t[e-1+0],i=t[e-1+32],r=t[e-1+64],a=t[e-1-32],s=t[e+0-32],o=t[e+1-32],l=t[e+2-32],c=t[e+3-32];t[e+0+96]=be(i,r,t[e-1+96]),t[e+1+96]=t[e+0+64]=be(n,i,r),t[e+2+96]=t[e+1+64]=t[e+0+32]=be(a,n,i),t[e+3+96]=t[e+2+64]=t[e+1+32]=t[e+0+0]=be(s,a,n),t[e+3+64]=t[e+2+32]=t[e+1+0]=be(o,s,a),t[e+3+32]=t[e+2+0]=be(l,o,s),t[e+3+0]=be(c,l,o)}function Me(t,e){var n=t[e+1-32],i=t[e+2-32],r=t[e+3-32],a=t[e+4-32],s=t[e+5-32],o=t[e+6-32],l=t[e+7-32];t[e+0+0]=be(t[e+0-32],n,i),t[e+1+0]=t[e+0+32]=be(n,i,r),t[e+2+0]=t[e+1+32]=t[e+0+64]=be(i,r,a),t[e+3+0]=t[e+2+32]=t[e+1+64]=t[e+0+96]=be(r,a,s),t[e+3+32]=t[e+2+64]=t[e+1+96]=be(a,s,o),t[e+3+64]=t[e+2+96]=be(s,o,l),t[e+3+96]=be(o,l,l)}function Ae(t,e){var n=t[e-1+0],i=t[e-1+32],r=t[e-1+64],a=t[e-1-32],s=t[e+0-32],o=t[e+1-32],l=t[e+2-32],c=t[e+3-32];t[e+0+0]=t[e+1+64]=a+s+1>>1,t[e+1+0]=t[e+2+64]=s+o+1>>1,t[e+2+0]=t[e+3+64]=o+l+1>>1,t[e+3+0]=l+c+1>>1,t[e+0+96]=be(r,i,n),t[e+0+64]=be(i,n,a),t[e+0+32]=t[e+1+96]=be(n,a,s),t[e+1+32]=t[e+2+96]=be(a,s,o),t[e+2+32]=t[e+3+96]=be(s,o,l),t[e+3+32]=be(o,l,c)}function ke(t,e){var n=t[e+0-32],i=t[e+1-32],r=t[e+2-32],a=t[e+3-32],s=t[e+4-32],o=t[e+5-32],l=t[e+6-32],c=t[e+7-32];t[e+0+0]=n+i+1>>1,t[e+1+0]=t[e+0+64]=i+r+1>>1,t[e+2+0]=t[e+1+64]=r+a+1>>1,t[e+3+0]=t[e+2+64]=a+s+1>>1,t[e+0+32]=be(n,i,r),t[e+1+32]=t[e+0+96]=be(i,r,a),t[e+2+32]=t[e+1+96]=be(r,a,s),t[e+3+32]=t[e+2+96]=be(a,s,o),t[e+3+64]=be(s,o,l),t[e+3+96]=be(o,l,c)}function Ee(t,e){var n=t[e-1+0],i=t[e-1+32],r=t[e-1+64],a=t[e-1+96];t[e+0+0]=n+i+1>>1,t[e+2+0]=t[e+0+32]=i+r+1>>1,t[e+2+32]=t[e+0+64]=r+a+1>>1,t[e+1+0]=be(n,i,r),t[e+3+0]=t[e+1+32]=be(i,r,a),t[e+3+32]=t[e+1+64]=be(r,a,a),t[e+3+64]=t[e+2+64]=t[e+0+96]=t[e+1+96]=t[e+2+96]=t[e+3+96]=a}function Te(t,e){var n=t[e-1+0],i=t[e-1+32],r=t[e-1+64],a=t[e-1+96],s=t[e-1-32],o=t[e+0-32],l=t[e+1-32],c=t[e+2-32];t[e+0+0]=t[e+2+32]=n+s+1>>1,t[e+0+32]=t[e+2+64]=i+n+1>>1,t[e+0+64]=t[e+2+96]=r+i+1>>1,t[e+0+96]=a+r+1>>1,t[e+3+0]=be(o,l,c),t[e+2+0]=be(s,o,l),t[e+1+0]=t[e+3+32]=be(n,s,o),t[e+1+32]=t[e+3+64]=be(i,n,s),t[e+1+64]=t[e+3+96]=be(r,i,n),t[e+1+96]=be(a,r,i)}function Ce(t,e){var n;for(n=0;8>n;++n)i(t,e+32*n,t,e-32,8)}function Ie(t,e){var n;for(n=0;8>n;++n)r(t,e,t[e-1],8),e+=32}function Le(t,e,n){var i;for(i=0;8>i;++i)r(e,n+32*i,t,8)}function ze(t,e){var n,i=8;for(n=0;8>n;++n)i+=t[e+n-32]+t[e-1+32*n];Le(i>>4,t,e)}function Ne(t,e){var n,i=4;for(n=0;8>n;++n)i+=t[e+n-32];Le(i>>3,t,e)}function De(t,e){var n,i=4;for(n=0;8>n;++n)i+=t[e-1+32*n];Le(i>>3,t,e)}function Re(t,e){Le(128,t,e)}function Fe(t,e,n){var i=t[e-n],r=t[e+0],a=3*(r-i)+Ii[1020+t[e-2*n]-t[e+n]],s=Li[112+(a+4>>3)];t[e-n]=zi[255+i+Li[112+(a+3>>3)]],t[e+0]=zi[255+r-s]}function Oe(t,e,n,i){var r=t[e+0],a=t[e+n];return Ni[255+t[e-2*n]-t[e-n]]>i||Ni[255+a-r]>i}function Be(t,e,n,i){return 4*Ni[255+t[e-n]-t[e+0]]+Ni[255+t[e-2*n]-t[e+n]]<=i}function je(t,e,n,i,r){var a=t[e-3*n],s=t[e-2*n],o=t[e-n],l=t[e+0],c=t[e+n],u=t[e+2*n],h=t[e+3*n];return 4*Ni[255+o-l]+Ni[255+s-c]>i?0:Ni[255+t[e-4*n]-a]<=r&&Ni[255+a-s]<=r&&Ni[255+s-o]<=r&&Ni[255+h-u]<=r&&Ni[255+u-c]<=r&&Ni[255+c-l]<=r}function Ue(t,e,n,i){var r=2*i+1;for(i=0;16>i;++i)Be(t,e+i,n,r)&&Fe(t,e+i,n)}function Ge(t,e,n,i){var r=2*i+1;for(i=0;16>i;++i)Be(t,e+i*n,1,r)&&Fe(t,e+i*n,1)}function qe(t,e,n,i){var r;for(r=3;0<r;--r)Ue(t,e+=4*n,n,i)}function Ve(t,e,n,i){var r;for(r=3;0<r;--r)Ge(t,e+=4,n,i)}function Ze(t,e,n,i,r,a,s,o){for(a=2*a+1;0<r--;){if(je(t,e,n,a,s))if(Oe(t,e,n,o))Fe(t,e,n);else{var l=t,c=e,u=n,h=l[c-2*u],d=l[c-u],f=l[c+0],p=l[c+u],m=l[c+2*u],g=27*(y=Ii[1020+3*(f-d)+Ii[1020+h-p]])+63>>7,_=18*y+63>>7,y=9*y+63>>7;l[c-3*u]=zi[255+l[c-3*u]+y],l[c-2*u]=zi[255+h+_],l[c-u]=zi[255+d+g],l[c+0]=zi[255+f-g],l[c+u]=zi[255+p-_],l[c+2*u]=zi[255+m-y]}e+=i}}function We(t,e,n,i,r,a,s,o){for(a=2*a+1;0<r--;){if(je(t,e,n,a,s))if(Oe(t,e,n,o))Fe(t,e,n);else{var l=t,c=e,u=n,h=l[c-u],d=l[c+0],f=l[c+u],p=Li[112+(4+(m=3*(d-h))>>3)],m=Li[112+(m+3>>3)],g=p+1>>1;l[c-2*u]=zi[255+l[c-2*u]+g],l[c-u]=zi[255+h+m],l[c+0]=zi[255+d-p],l[c+u]=zi[255+f-g]}e+=i}}function He(t,e,n,i,r,a){Ze(t,e,n,1,16,i,r,a)}function Xe(t,e,n,i,r,a){Ze(t,e,1,n,16,i,r,a)}function Ye(t,e,n,i,r,a){var s;for(s=3;0<s;--s)We(t,e+=4*n,n,1,16,i,r,a)}function Ke(t,e,n,i,r,a){var s;for(s=3;0<s;--s)We(t,e+=4,1,n,16,i,r,a)}function Je(t,e,n,i,r,a,s,o){Ze(t,e,r,1,8,a,s,o),Ze(n,i,r,1,8,a,s,o)}function $e(t,e,n,i,r,a,s,o){Ze(t,e,1,r,8,a,s,o),Ze(n,i,1,r,8,a,s,o)}function Qe(t,e,n,i,r,a,s,o){We(t,e+4*r,r,1,8,a,s,o),We(n,i+4*r,r,1,8,a,s,o)}function tn(t,e,n,i,r,a,s,o){We(t,e+4,1,r,8,a,s,o),We(n,i+4,1,r,8,a,s,o)}function en(){this.ba=new st,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new lt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function nn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function rn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function an(){this.ua=0,this.Wa=new D,this.vb=new D,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new f,this.yc=new h}function sn(){this.xb=this.a=0,this.l=new Wt,this.ca=new st,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new x,this.Pb=0,this.wd=new x,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new an,this.ab=0,this.gc=s(4,rn),this.Oc=0}function on(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Wt,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ln(t,e,n,i,r,a,s){for(t=null==t?0:t[e+0],e=0;e<s;++e)r[a+e]=t+n[i+e]&255,t=r[a+e]}function cn(t,e,n,i,r,a,s){var o;if(null==t)ln(null,null,n,i,r,a,s);else for(o=0;o<s;++o)r[a+o]=t[e+o]+n[i+o]&255}function un(t,e,n,i,r,a,s){if(null==t)ln(null,null,n,i,r,a,s);else{var o,l=t[e+0],c=l,u=l;for(o=0;o<s;++o)c=u+(l=t[e+o])-c,u=n[i+o]+(-256&c?0>c?0:255:c)&255,c=l,r[a+o]=u}}function hn(t,n,r,s){var o=n.width,l=n.o;if(e(null!=t&&null!=n),0>r||0>=s||r+s>l)return null;if(!t.Cc){if(null==t.ga){var c;if(t.ga=new on,(c=null==t.ga)||(c=n.width*n.o,e(0==t.Gb.length),t.Gb=a(c),t.Uc=0,null==t.Gb?c=0:(t.mb=t.Gb,t.nb=t.Uc,t.rc=null,c=1),c=!c),!c){c=t.ga;var u=t.Fa,h=t.P,d=t.qc,f=t.mb,p=t.nb,m=h+1,g=d-1,y=c.l;if(e(null!=u&&null!=f&&null!=n),mr[0]=null,mr[1]=ln,mr[2]=cn,mr[3]=un,c.ca=f,c.tb=p,c.c=n.width,c.i=n.height,e(0<c.c&&0<c.i),1>=d)n=0;else if(c.$a=3&u[h+0],c.Z=u[h+0]>>2&3,c.Lc=u[h+0]>>4&3,h=u[h+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||h)n=0;else if(y.put=ft,y.ac=dt,y.bc=pt,y.ma=c,y.width=n.width,y.height=n.height,y.Da=n.Da,y.v=n.v,y.va=n.va,y.j=n.j,y.o=n.o,c.$a)t:{e(1==c.$a),n=Et();e:for(;;){if(null==n){n=0;break t}if(e(null!=c),c.mc=n,n.c=c.c,n.i=c.i,n.l=c.l,n.l.ma=c,n.l.width=c.c,n.l.height=c.i,n.a=0,_(n.m,u,m,g),!Tt(c.c,c.i,1,n,null))break e;if(1==n.ab&&3==n.gc[0].hc&&St(n.s)?(c.ic=1,u=n.c*n.i,n.Ta=null,n.Ua=0,n.V=a(u),n.Ba=0,null==n.V?(n.a=1,n=0):n=1):(c.ic=0,n=Ct(n,c.c)),!n)break e;n=1;break t}c.mc=null,n=0}else n=g>=c.c*c.i;c=!n}if(c)return null;1!=t.ga.Lc?t.Ga=0:s=l-r}e(null!=t.ga),e(r+s<=l);t:{if(n=(u=t.ga).c,l=u.l.o,0==u.$a){if(m=t.rc,g=t.Vc,y=t.Fa,h=t.P+1+r*n,d=t.mb,f=t.nb+r*n,e(h<=t.P+t.qc),0!=u.Z)for(e(null!=mr[u.Z]),c=0;c<s;++c)mr[u.Z](m,g,y,h,d,f,n),m=d,g=f,f+=n,h+=n;else for(c=0;c<s;++c)i(d,f,y,h,n),m=d,g=f,f+=n,h+=n;t.rc=m,t.Vc=g}else{if(e(null!=u.mc),n=r+s,e(null!=(c=u.mc)),e(n<=c.i),c.C>=n)n=1;else if(u.ic||gn(),u.ic){u=c.V,m=c.Ba,g=c.c;var v=c.i,b=(y=1,h=c.$/g,d=c.$%g,f=c.m,p=c.s,c.$),x=g*v,w=g*n,P=p.wc,A=b<w?bt(p,d,h):null;e(b<=x),e(n<=v),e(St(p));e:for(;;){for(;!f.h&&b<w;){if(d&P||(A=bt(p,d,h)),e(null!=A),M(f),256>(v=yt(A.G[0],A.H[0],f)))u[m+b]=v,++b,++d>=g&&(d=0,++h<=n&&!(h%16)&&Mt(c,h));else{if(!(280>v)){y=0;break e}v=gt(v-256,f);var k,E=yt(A.G[4],A.H[4],f);if(M(f),!(b>=(E=_t(g,E=gt(E,f)))&&x-b>=v)){y=0;break e}for(k=0;k<v;++k)u[m+b+k]=u[m+b+k-E];for(b+=v,d+=v;d>=g;)d-=g,++h<=n&&!(h%16)&&Mt(c,h);b<w&&d&P&&(A=bt(p,d,h))}e(f.h==S(f))}Mt(c,h>n?n:h);break e}!y||f.h&&b<x?(y=0,c.a=f.h?5:3):c.$=b,n=y}else n=At(c,c.V,c.Ba,c.c,c.i,n,It);if(!n){s=0;break t}}r+s>=l&&(t.Cc=1),s=1}if(!s)return null;if(t.Cc&&(null!=(s=t.ga)&&(s.mc=null),t.ga=null,0<t.Ga))return alert("todo:WebPDequantizeLevels"),null}return t.nb+r*o}function dn(t,e,n,i,r,a){for(;0<r--;){var s,o=t,l=e+(n?1:0),c=t,u=e+(n?0:3);for(s=0;s<i;++s){var h=c[u+4*s];255!=h&&(h*=32897,o[l+4*s+0]=o[l+4*s+0]*h>>23,o[l+4*s+1]=o[l+4*s+1]*h>>23,o[l+4*s+2]=o[l+4*s+2]*h>>23)}e+=a}}function fn(t,e,n,i,r){for(;0<i--;){var a;for(a=0;a<n;++a){var s=t[e+2*a+0],o=15&(c=t[e+2*a+1]),l=4369*o,c=(240&c|c>>4)*l>>16;t[e+2*a+0]=(240&s|s>>4)*l>>16&240|(15&s|s<<4)*l>>16>>4&15,t[e+2*a+1]=240&c|o}e+=r}}function pn(t,e,n,i,r,a,s,o){var l,c,u=255;for(c=0;c<r;++c){for(l=0;l<i;++l){var h=t[e+l];a[s+4*l]=h,u&=h}e+=n,s+=o}return 255!=u}function mn(t,e,n,i,r){var a;for(a=0;a<r;++a)n[i+a]=t[e+a]>>8}function gn(){wi=dn,Si=fn,Pi=pn,Mi=mn}function _n(n,i,r){t[n]=function(t,n,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v){var b,x=v-1>>1,w=o[l+0]|c[u+0]<<16,S=h[d+0]|f[p+0]<<16;e(null!=t);var P=3*w+S+131074>>2;for(i(t[n+0],255&P,P>>16,m,g),null!=a&&(P=3*S+w+131074>>2,i(a[s+0],255&P,P>>16,_,y)),b=1;b<=x;++b){var M=o[l+b]|c[u+b]<<16,A=h[d+b]|f[p+b]<<16,k=w+M+S+A+524296,E=k+2*(M+S)>>3;P=E+w>>1,w=(k=k+2*(w+A)>>3)+M>>1,i(t[n+2*b-1],255&P,P>>16,m,g+(2*b-1)*r),i(t[n+2*b-0],255&w,w>>16,m,g+(2*b-0)*r),null!=a&&(P=k+S>>1,w=E+A>>1,i(a[s+2*b-1],255&P,P>>16,_,y+(2*b-1)*r),i(a[s+2*b+0],255&w,w>>16,_,y+(2*b+0)*r)),w=M,S=A}1&v||(P=3*w+S+131074>>2,i(t[n+v-1],255&P,P>>16,m,g+(v-1)*r),null!=a&&(P=3*S+w+131074>>2,i(a[s+v-1],255&P,P>>16,_,y+(v-1)*r)))}}function yn(){gr[Di]=_r,gr[Ri]=vr,gr[Fi]=yr,gr[Oi]=br,gr[Bi]=xr,gr[ji]=wr,gr[Ui]=Sr,gr[Gi]=vr,gr[qi]=br,gr[Vi]=xr,gr[Zi]=wr}function vn(t){return t&~Tr?0>t?0:255:t>>Er}function bn(t,e){return vn((19077*t>>8)+(26149*e>>8)-14234)}function xn(t,e,n){return vn((19077*t>>8)-(6419*e>>8)-(13320*n>>8)+8708)}function wn(t,e){return vn((19077*t>>8)+(33050*e>>8)-17685)}function Sn(t,e,n,i,r){i[r+0]=bn(t,n),i[r+1]=xn(t,e,n),i[r+2]=wn(t,e)}function Pn(t,e,n,i,r){i[r+0]=wn(t,e),i[r+1]=xn(t,e,n),i[r+2]=bn(t,n)}function Mn(t,e,n,i,r){var a=xn(t,e,n);e=a<<3&224|wn(t,e)>>3,i[r+0]=248&bn(t,n)|a>>5,i[r+1]=e}function An(t,e,n,i,r){var a=240&wn(t,e)|15;i[r+0]=240&bn(t,n)|xn(t,e,n)>>4,i[r+1]=a}function kn(t,e,n,i,r){i[r+0]=255,Sn(t,e,n,i,r+1)}function En(t,e,n,i,r){Pn(t,e,n,i,r),i[r+3]=255}function Tn(t,e,n,i,r){Sn(t,e,n,i,r),i[r+3]=255}function Zt(t,e){return 0>t?0:t>e?e:t}function Cn(e,n,i){t[e]=function(t,e,r,a,s,o,l,c,u){for(var h=c+(-2&u)*i;c!=h;)n(t[e+0],r[a+0],s[o+0],l,c),n(t[e+1],r[a+0],s[o+0],l,c+i),e+=2,++a,++o,c+=2*i;1&u&&n(t[e+0],r[a+0],s[o+0],l,c)}}function In(t,e,n){return 0==n?0==t?0==e?6:5:0==e?4:0:n}function Ln(t,e,n,i,r){switch(t>>>30){case 3:ai(e,n,i,r,0);break;case 2:si(e,n,i,r);break;case 1:li(e,n,i,r)}}function zn(t,e){var n,a,s=e.M,o=e.Nb,l=t.oc,c=t.pc+40,u=t.oc,h=t.pc+584,d=t.oc,f=t.pc+600;for(n=0;16>n;++n)l[c+32*n-1]=129;for(n=0;8>n;++n)u[h+32*n-1]=129,d[f+32*n-1]=129;for(0<s?l[c-1-32]=u[h-1-32]=d[f-1-32]=129:(r(l,c-32-1,127,21),r(u,h-32-1,127,9),r(d,f-32-1,127,9)),a=0;a<t.za;++a){var p=e.ya[e.aa+a];if(0<a){for(n=-1;16>n;++n)i(l,c+32*n-4,l,c+32*n+12,4);for(n=-1;8>n;++n)i(u,h+32*n-4,u,h+32*n+4,4),i(d,f+32*n-4,d,f+32*n+4,4)}var m=t.Gd,g=t.Hd+a,_=p.ad,y=p.Hc;if(0<s&&(i(l,c-32,m[g].y,0,16),i(u,h-32,m[g].f,0,8),i(d,f-32,m[g].ea,0,8)),p.Za){var v=l,b=c-32+16;for(0<s&&(a>=t.za-1?r(v,b,m[g].y[15],4):i(v,b,m[g+1].y,0,4)),n=0;4>n;n++)v[b+128+n]=v[b+256+n]=v[b+384+n]=v[b+0+n];for(n=0;16>n;++n,y<<=2)v=l,b=c+Fr[n],hr[p.Ob[n]](v,b),Ln(y,_,16*+n,v,b)}else if(v=In(a,s,p.Ob[0]),ur[v](l,c),0!=y)for(n=0;16>n;++n,y<<=2)Ln(y,_,16*+n,l,c+Fr[n]);for(n=p.Gc,v=In(a,s,p.Dd),dr[v](u,h),dr[v](d,f),y=_,v=u,b=h,255&(p=0|n)&&(170&p?oi(y,256,v,b):ci(y,256,v,b)),p=d,y=f,255&(n>>=8)&&(170&n?oi(_,320,p,y):ci(_,320,p,y)),s<t.Ub-1&&(i(m[g].y,0,l,c+480,16),i(m[g].f,0,u,h+224,8),i(m[g].ea,0,d,f+224,8)),n=8*o*t.B,m=t.sa,g=t.ta+16*a+16*o*t.R,_=t.qa,p=t.ra+8*a+n,y=t.Ha,v=t.Ia+8*a+n,n=0;16>n;++n)i(m,g+n*t.R,l,c+32*n,16);for(n=0;8>n;++n)i(_,p+n*t.B,u,h+32*n,8),i(y,v+n*t.B,d,f+32*n,8)}}function Nn(t,i,r,a,s,o,l,c,u){var h=[0],d=[0],f=0,p=null!=u?u.kd:0,m=null!=u?u:new nn;if(null==t||12>r)return 7;m.data=t,m.w=i,m.ha=r,i=[i],r=[r],m.gb=[m.gb];t:{var g=i,y=r,v=m.gb;if(e(null!=t),e(null!=y),e(null!=v),v[0]=0,12<=y[0]&&!n(t,g[0],"RIFF")){if(n(t,g[0]+8,"WEBP")){v=3;break t}var b=L(t,g[0]+4);if(12>b||4294967286<b){v=3;break t}if(p&&b>y[0]-8){v=7;break t}v[0]=b,g[0]+=12,y[0]-=12}v=0}if(0!=v)return v;for(b=0<m.gb[0],r=r[0];;){t:{var w=t;y=i,v=r;var S=h,P=d,M=g=[0];if((E=f=[f])[0]=0,8>v[0])v=7;else{if(!n(w,y[0],"VP8X")){if(10!=L(w,y[0]+4)){v=3;break t}if(18>v[0]){v=7;break t}var A=L(w,y[0]+8),k=1+I(w,y[0]+12);if(2147483648<=k*(w=1+I(w,y[0]+15))){v=3;break t}null!=M&&(M[0]=A),null!=S&&(S[0]=k),null!=P&&(P[0]=w),y[0]+=18,v[0]-=18,E[0]=1}v=0}}if(f=f[0],g=g[0],0!=v)return v;if(y=!!(2&g),!b&&f)return 3;if(null!=o&&(o[0]=!!(16&g)),null!=l&&(l[0]=y),null!=c&&(c[0]=0),l=h[0],g=d[0],f&&y&&null==u){v=0;break}if(4>r){v=7;break}if(b&&f||!b&&!f&&!n(t,i[0],"ALPH")){r=[r],m.na=[m.na],m.P=[m.P],m.Sa=[m.Sa];t:{A=t,v=i,b=r;var E=m.gb;S=m.na,P=m.P,M=m.Sa,k=22,e(null!=A),e(null!=b),w=v[0];var T=b[0];for(e(null!=S),e(null!=M),S[0]=null,P[0]=null,M[0]=0;;){if(v[0]=w,b[0]=T,8>T){v=7;break t}var C=L(A,w+4);if(4294967286<C){v=3;break t}var z=8+C+1&-2;if(k+=z,0<E&&k>E){v=3;break t}if(!n(A,w,"VP8 ")||!n(A,w,"VP8L")){v=0;break t}if(T[0]<z){v=7;break t}n(A,w,"ALPH")||(S[0]=A,P[0]=w+8,M[0]=C),w+=z,T-=z}}if(r=r[0],m.na=m.na[0],m.P=m.P[0],m.Sa=m.Sa[0],0!=v)break}r=[r],m.Ja=[m.Ja],m.xa=[m.xa];t:if(E=t,v=i,b=r,S=m.gb[0],P=m.Ja,M=m.xa,A=v[0],w=!n(E,A,"VP8 "),k=!n(E,A,"VP8L"),e(null!=E),e(null!=b),e(null!=P),e(null!=M),8>b[0])v=7;else{if(w||k){if(E=L(E,A+4),12<=S&&E>S-12){v=3;break t}if(p&&E>b[0]-8){v=7;break t}P[0]=E,v[0]+=8,b[0]-=8,M[0]=k}else M[0]=5<=b[0]&&47==E[A+0]&&!(E[A+4]>>5),P[0]=b[0];v=0}if(r=r[0],m.Ja=m.Ja[0],m.xa=m.xa[0],i=i[0],0!=v)break;if(4294967286<m.Ja)return 3;if(null==c||y||(c[0]=m.xa?2:1),l=[l],g=[g],m.xa){if(5>r){v=7;break}c=l,p=g,y=o,null==t||5>r?t=0:5<=r&&47==t[i+0]&&!(t[i+4]>>5)?(b=[0],E=[0],S=[0],_(P=new x,t,i,r),mt(P,b,E,S)?(null!=c&&(c[0]=b[0]),null!=p&&(p[0]=E[0]),null!=y&&(y[0]=S[0]),t=1):t=0):t=0}else{if(10>r){v=7;break}c=g,null==t||10>r||!Yt(t,i+3,r-3)?t=0:(p=t[i+0]|t[i+1]<<8|t[i+2]<<16,y=16383&(t[i+7]<<8|t[i+6]),t=16383&(t[i+9]<<8|t[i+8]),1&p||3<(p>>1&7)||!(p>>4&1)||p>>5>=m.Ja||!y||!t?t=0:(l&&(l[0]=y),c&&(c[0]=t),t=1))}if(!t)return 3;if(l=l[0],g=g[0],f&&(h[0]!=l||d[0]!=g))return 3;null!=u&&(u[0]=m,u.offset=i-u.w,e(4294967286>i-u.w),e(u.offset==u.ha-r));break}return 0==v||7==v&&f&&null==u?(null!=o&&(o[0]|=null!=m.na&&0<m.na.length),null!=a&&(a[0]=l),null!=s&&(s[0]=g),0):v}function Dn(t,e,n){var i=e.width,r=e.height,a=0,s=0,o=i,l=r;if(e.Da=null!=t&&0<t.Da,e.Da&&(o=t.cd,l=t.bd,a=t.v,s=t.j,11>n||(a&=-2,s&=-2),0>a||0>s||0>=o||0>=l||a+o>i||s+l>r))return 0;if(e.v=a,e.j=s,e.va=a+o,e.o=s+l,e.U=o,e.T=l,e.da=null!=t&&0<t.da,e.da){if(!R(o,l,n=[t.ib],a=[t.hb]))return 0;e.ib=n[0],e.hb=a[0]}return e.ob=null!=t&&t.ob,e.Kb=null==t||!t.Sd,e.da&&(e.ob=e.ib<3*i/4&&e.hb<3*r/4,e.Kb=0),1}function Rn(t){if(null==t)return 2;if(11>t.S){var e=t.f.RGBA;e.fb+=(t.height-1)*e.A,e.A=-e.A}else e=t.f.kb,t=t.height,e.O+=(t-1)*e.fa,e.fa=-e.fa,e.N+=(t-1>>1)*e.Ab,e.Ab=-e.Ab,e.W+=(t-1>>1)*e.Db,e.Db=-e.Db,null!=e.F&&(e.J+=(t-1)*e.lb,e.lb=-e.lb);return 0}function Fn(t,e,n,i){if(null==i||0>=t||0>=e)return 2;if(null!=n){if(n.Da){var r=n.cd,s=n.bd,o=-2&n.v,l=-2&n.j;if(0>o||0>l||0>=r||0>=s||o+r>t||l+s>e)return 2;t=r,e=s}if(n.da){if(!R(t,e,r=[n.ib],s=[n.hb]))return 2;t=r[0],e=s[0]}}i.width=t,i.height=e;t:{var c=i.width,u=i.height;if(t=i.S,0>=c||0>=u||!(t>=Di&&13>t))t=2;else{if(0>=i.Rd&&null==i.sd){o=s=r=e=0;var h=(l=c*jr[t])*u;if(11>t||(s=(u+1)/2*(e=(c+1)/2),12==t&&(o=(r=c)*u)),null==(u=a(h+2*s+o))){t=1;break t}i.sd=u,11>t?((c=i.f.RGBA).eb=u,c.fb=0,c.A=l,c.size=h):((c=i.f.kb).y=u,c.O=0,c.fa=l,c.Fd=h,c.f=u,c.N=0+h,c.Ab=e,c.Cd=s,c.ea=u,c.W=0+h+s,c.Db=e,c.Ed=s,12==t&&(c.F=u,c.J=0+h+2*s),c.Tc=o,c.lb=r)}if(e=1,r=i.S,s=i.width,o=i.height,r>=Di&&13>r)if(11>r)t=i.f.RGBA,e&=(l=Math.abs(t.A))*(o-1)+s<=t.size,e&=l>=s*jr[r],e&=null!=t.eb;else{t=i.f.kb,l=(s+1)/2,h=(o+1)/2,c=Math.abs(t.fa),u=Math.abs(t.Ab);var d=Math.abs(t.Db),f=Math.abs(t.lb),p=f*(o-1)+s;e&=c*(o-1)+s<=t.Fd,e&=u*(h-1)+l<=t.Cd,e=(e&=d*(h-1)+l<=t.Ed)&c>=s&u>=l&d>=l,e&=null!=t.y,e&=null!=t.f,e&=null!=t.ea,12==r&&(e&=f>=s,e&=p<=t.Tc,e&=null!=t.F)}else e=0;t=e?0:2}}return 0!=t||null!=n&&n.fd&&(t=Rn(i)),t}var On=64,Bn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],jn=24,Un=32,Gn=8,qn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];B("Predictor0","PredictorAdd0"),t.Predictor0=function(){return 4278190080},t.Predictor1=function(t){return t},t.Predictor2=function(t,e,n){return e[n+0]},t.Predictor3=function(t,e,n){return e[n+1]},t.Predictor4=function(t,e,n){return e[n-1]},t.Predictor5=function(t,e,n){return U(U(t,e[n+1]),e[n+0])},t.Predictor6=function(t,e,n){return U(t,e[n-1])},t.Predictor7=function(t,e,n){return U(t,e[n+0])},t.Predictor8=function(t,e,n){return U(e[n-1],e[n+0])},t.Predictor9=function(t,e,n){return U(e[n+0],e[n+1])},t.Predictor10=function(t,e,n){return U(U(t,e[n-1]),U(e[n+0],e[n+1]))},t.Predictor11=function(t,e,n){var i=e[n+0];return 0>=V(i>>24&255,t>>24&255,(e=e[n-1])>>24&255)+V(i>>16&255,t>>16&255,e>>16&255)+V(i>>8&255,t>>8&255,e>>8&255)+V(255&i,255&t,255&e)?i:t},t.Predictor12=function(t,e,n){var i=e[n+0];return(G((t>>24&255)+(i>>24&255)-((e=e[n-1])>>24&255))<<24|G((t>>16&255)+(i>>16&255)-(e>>16&255))<<16|G((t>>8&255)+(i>>8&255)-(e>>8&255))<<8|G((255&t)+(255&i)-(255&e)))>>>0},t.Predictor13=function(t,e,n){var i=e[n-1];return(q((t=U(t,e[n+0]))>>24&255,i>>24&255)<<24|q(t>>16&255,i>>16&255)<<16|q(t>>8&255,i>>8&255)<<8|q(255&t,255&i))>>>0};var Vn=t.PredictorAdd0;t.PredictorAdd1=Z,B("Predictor2","PredictorAdd2"),B("Predictor3","PredictorAdd3"),B("Predictor4","PredictorAdd4"),B("Predictor5","PredictorAdd5"),B("Predictor6","PredictorAdd6"),B("Predictor7","PredictorAdd7"),B("Predictor8","PredictorAdd8"),B("Predictor9","PredictorAdd9"),B("Predictor10","PredictorAdd10"),B("Predictor11","PredictorAdd11"),B("Predictor12","PredictorAdd12"),B("Predictor13","PredictorAdd13");var Zn=t.PredictorAdd2;Y("ColorIndexInverseTransform","MapARGB","32b",function(t){return t>>8&255},function(t){return t}),Y("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(t){return t},function(t){return t>>8&255});var Wn,Hn=t.ColorIndexInverseTransform,Xn=t.MapARGB,Yn=t.VP8LColorIndexInverseTransformAlpha,Kn=t.MapAlpha,Jn=t.VP8LPredictorsAdd=[];Jn.length=16,(t.VP8LPredictors=[]).length=16,(t.VP8LPredictorsAdd_C=[]).length=16,(t.VP8LPredictors_C=[]).length=16;var $n,Qn,ti,ei,ni,ii,ri,ai,si,oi,li,ci,ui,hi,di,fi,pi,mi,gi,_i,yi,vi,bi,xi,wi,Si,Pi,Mi,Ai=a(511),ki=a(2041),Ei=a(225),Ti=a(767),Ci=0,Ii=ki,Li=Ei,zi=Ti,Ni=Ai,Di=0,Ri=1,Fi=2,Oi=3,Bi=4,ji=5,Ui=6,Gi=7,qi=8,Vi=9,Zi=10,Wi=[2,3,7],Hi=[3,3,11],Xi=[280,256,256,256,40],Yi=[0,1,1,1,0],Ki=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ji=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],$i=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Qi=8,tr=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],er=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],nr=null,ir=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],rr=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],ar=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sr=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],or=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],lr=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cr=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ur=[],hr=[],dr=[],fr=1,pr=2,mr=[],gr=[];_n("UpsampleRgbLinePair",Sn,3),_n("UpsampleBgrLinePair",Pn,3),_n("UpsampleRgbaLinePair",Tn,4),_n("UpsampleBgraLinePair",En,4),_n("UpsampleArgbLinePair",kn,4),_n("UpsampleRgba4444LinePair",An,2),_n("UpsampleRgb565LinePair",Mn,2);var _r=t.UpsampleRgbLinePair,yr=t.UpsampleBgrLinePair,vr=t.UpsampleRgbaLinePair,br=t.UpsampleBgraLinePair,xr=t.UpsampleArgbLinePair,wr=t.UpsampleRgba4444LinePair,Sr=t.UpsampleRgb565LinePair,Pr=16,Mr=1<<Pr-1,Ar=-227,kr=482,Er=6,Tr=(256<<Er)-1,Cr=0,Ir=a(256),Lr=a(256),zr=a(256),Nr=a(256),Dr=a(kr-Ar),Rr=a(kr-Ar);Cn("YuvToRgbRow",Sn,3),Cn("YuvToBgrRow",Pn,3),Cn("YuvToRgbaRow",Tn,4),Cn("YuvToBgraRow",En,4),Cn("YuvToArgbRow",kn,4),Cn("YuvToRgba4444Row",An,2),Cn("YuvToRgb565Row",Mn,2);var Fr=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Or=[0,2,8],Br=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(t,n,o,l,c){var u=Ri,h=new en,d=new st;h.ba=d,d.S=u,d.width=[d.width],d.height=[d.height];var f=d.width,p=d.height,m=new ot;if(null==m||null==t)var g=2;else e(null!=m),g=Nn(t,n,o,m.width,m.height,m.Pd,m.Qd,m.format,null);if(0!=g?f=0:(null!=f&&(f[0]=m.width[0]),null!=p&&(p[0]=m.height[0]),f=1),f){d.width=d.width[0],d.height=d.height[0],null!=l&&(l[0]=d.width),null!=c&&(c[0]=d.height);t:{if(l=new Wt,(c=new nn).data=t,c.w=n,c.ha=o,c.kd=1,n=[0],e(null!=c),(0==(t=Nn(c.data,c.w,c.ha,null,null,null,n,null,c))||7==t)&&n[0]&&(t=4),0==(n=t)){if(e(null!=h),l.data=c.data,l.w=c.w+c.offset,l.ha=c.ha-c.offset,l.put=ft,l.ac=dt,l.bc=pt,l.ma=h,c.xa){if(null==(t=Et())){h=1;break t}if(function(t,n){var i=[0],r=[0],a=[0];e:for(;;){if(null==t)return 0;if(null==n)return t.a=2,0;if(t.l=n,t.a=0,_(t.m,n.data,n.w,n.ha),!mt(t.m,i,r,a)){t.a=3;break e}if(t.xb=pr,n.width=i[0],n.height=r[0],!Tt(i[0],r[0],1,t,null))break e;return 1}return e(0!=t.a),0}(t,l)){if(l=0==(n=Fn(l.width,l.height,h.Oa,h.ba))){e:{l=t;n:for(;;){if(null==l){l=0;break e}if(e(null!=l.s.yc),e(null!=l.s.Ya),e(0<l.s.Wb),e(null!=(o=l.l)),e(null!=(c=o.ma)),0!=l.xb){if(l.ca=c.ba,l.tb=c.tb,e(null!=l.ca),!Dn(c.Oa,o,Oi)){l.a=2;break n}if(!Ct(l,o.width))break n;if(o.da)break n;if((o.da||it(l.ca.S))&&gn(),11>l.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=l.ca.f.kb.F&&gn()),l.Pb&&0<l.s.ua&&null==l.s.vb.X&&!z(l.s.vb,l.s.Wa.Xa)){l.a=1;break n}l.xb=0}if(!At(l,l.V,l.Ba,l.c,l.i,o.o,wt))break n;c.Dc=l.Ma,l=1;break e}e(0!=l.a),l=0}l=!l}l&&(n=t.a)}else n=t.a}else{if(null==(t=new Ht)){h=1;break t}if(t.Fa=c.na,t.P=c.P,t.qc=c.Sa,Kt(t,l)){if(0==(n=Fn(l.width,l.height,h.Oa,h.ba))){if(t.Aa=0,o=h.Oa,e(null!=(c=t)),null!=o){if(0<(f=0>(f=o.Md)?0:100<f?255:255*f/100)){for(p=m=0;4>p;++p)12>(g=c.pb[p]).lc&&(g.ia=f*Br[0>g.lc?0:g.lc]>>3),m|=g.ia;m&&(alert("todo:VP8InitRandom"),c.ia=1)}c.Ga=o.Id,100<c.Ga?c.Ga=100:0>c.Ga&&(c.Ga=0)}(function(t,n){if(null==t)return 0;if(null==n)return Xt(t,2,"NULL VP8Io parameter in VP8Decode().");if(!t.cb&&!Kt(t,n))return 0;if(e(t.cb),null==n.ac||n.ac(n)){n.ob&&(t.L=0);var o=Or[t.L];if(2==t.L?(t.yb=0,t.zb=0):(t.yb=n.v-o>>4,t.zb=n.j-o>>4,0>t.yb&&(t.yb=0),0>t.zb&&(t.zb=0)),t.Va=n.o+15+o>>4,t.Hb=n.va+15+o>>4,t.Hb>t.za&&(t.Hb=t.za),t.Va>t.Ub&&(t.Va=t.Ub),0<t.L){var l=t.ed;for(o=0;4>o;++o){var c;if(t.Qa.Cb){var u=t.Qa.Lb[o];t.Qa.Fb||(u+=l.Tb)}else u=l.Tb;for(c=0;1>=c;++c){var h=t.gd[o][c],d=u;if(l.Pc&&(d+=l.vd[0],c&&(d+=l.od[0])),0<(d=0>d?0:63<d?63:d)){var f=d;0<l.wb&&(f=4<l.wb?f>>2:f>>1)>9-l.wb&&(f=9-l.wb),1>f&&(f=1),h.dd=f,h.tc=2*d+f,h.ld=40<=d?2:15<=d?1:0}else h.tc=0;h.La=c}}}o=0}else Xt(t,6,"Frame setup failed"),o=t.a;if(o=0==o){if(o){t.$c=0,0<t.Aa||(t.Ic=1);e:{o=t.Ic,l=4*(f=t.za);var p=32*f,m=f+1,g=0<t.L?f*(0<t.Aa?2:1):0,_=(2==t.Aa?2:1)*f;if((h=l+832+(c=3*(16*o+Or[t.L])/2*p)+(u=null!=t.Fa&&0<t.Fa.length?t.Kc.c*t.Kc.i:0))!=h)o=0;else{if(h>t.Vb){if(t.Vb=0,t.Ec=a(h),t.Fc=0,null==t.Ec){o=Xt(t,1,"no memory during frame initialization.");break e}t.Vb=h}h=t.Ec,d=t.Fc,t.Ac=h,t.Bc=d,d+=l,t.Gd=s(p,qt),t.Hd=0,t.rb=s(m+1,Bt),t.sb=1,t.wa=g?s(g,Ot):null,t.Y=0,t.D.Nb=0,t.D.wa=t.wa,t.D.Y=t.Y,0<t.Aa&&(t.D.Y+=f),e(!0),t.oc=h,t.pc=d,d+=832,t.ya=s(_,Ut),t.aa=0,t.D.ya=t.ya,t.D.aa=t.aa,2==t.Aa&&(t.D.aa+=f),t.R=16*f,t.B=8*f,f=(p=Or[t.L])*t.R,p=p/2*t.B,t.sa=h,t.ta=d+f,t.qa=t.sa,t.ra=t.ta+16*o*t.R+p,t.Ha=t.qa,t.Ia=t.ra+8*o*t.B+p,t.$c=0,d+=c,t.mb=u?h:null,t.nb=u?d:null,e(d+u<=t.Fc+t.Vb),$t(t),r(t.Ac,t.Bc,0,l),o=1}}if(o){if(n.ka=0,n.y=t.sa,n.O=t.ta,n.f=t.qa,n.N=t.ra,n.ea=t.Ha,n.Vd=t.Ia,n.fa=t.R,n.Rc=t.B,n.F=null,n.J=0,!Ci){for(o=-255;255>=o;++o)Ai[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)ki[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)Ei[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)Ti[255+o]=0>o?0:255<o?255:o;Ci=1}ri=le,ai=re,oi=ae,li=se,ci=oe,si=ie,ui=He,hi=Xe,di=Je,fi=$e,pi=Ye,mi=Ke,gi=Qe,_i=tn,yi=Ue,vi=Ge,bi=qe,xi=Ve,hr[0]=Se,hr[1]=ue,hr[2]=xe,hr[3]=we,hr[4]=Pe,hr[5]=Ae,hr[6]=Me,hr[7]=ke,hr[8]=Te,hr[9]=Ee,ur[0]=ge,ur[1]=de,ur[2]=fe,ur[3]=pe,ur[4]=_e,ur[5]=ye,ur[6]=ve,dr[0]=ze,dr[1]=he,dr[2]=Ce,dr[3]=Ie,dr[4]=De,dr[5]=Ne,dr[6]=Re,o=1}else o=0}o&&(o=function(t,n){for(t.M=0;t.M<t.Va;++t.M){var s,o=t.Jc[t.M&t.Xb],l=t.m,c=t;for(s=0;s<c.za;++s){var u=l,h=c,d=h.Ac,f=h.Bc+4*s,p=h.zc,m=h.ya[h.aa+s];if(h.Qa.Bb?m.$b=E(u,h.Pa.jb[0])?2+E(u,h.Pa.jb[2]):E(u,h.Pa.jb[1]):m.$b=0,h.kc&&(m.Ad=E(u,h.Bd)),m.Za=!E(u,145)+0,m.Za){var g=m.Ob,_=0;for(h=0;4>h;++h){var y,v=p[0+h];for(y=0;4>y;++y){v=or[d[f+y]][v];for(var b=ar[E(u,v[0])];0<b;)b=ar[2*b+E(u,v[b])];v=-b,d[f+y]=v}i(g,_,d,f,4),_+=4,p[0+h]=v}}else v=E(u,156)?E(u,128)?1:3:E(u,163)?2:0,m.Ob[0]=v,r(d,f,v,4),r(p,0,v,4);m.Dd=E(u,142)?E(u,114)?E(u,183)?1:3:2:0}if(c.m.Ka)return Xt(t,7,"Premature end-of-partition0 encountered.");for(;t.ja<t.za;++t.ja){if(c=o,u=(l=t).rb[l.sb-1],d=l.rb[l.sb+l.ja],s=l.ya[l.aa+l.ja],f=l.kc?s.Ad:0)u.la=d.la=0,s.Za||(u.Na=d.Na=0),s.Hc=0,s.Gc=0,s.ia=0;else{var x,w;if(u=d,d=c,f=l.Pa.Xc,p=l.ya[l.aa+l.ja],m=l.pb[p.$b],h=p.ad,g=0,_=l.rb[l.sb-1],v=y=0,r(h,g,0,384),p.Za)var S=0,P=f[3];else{b=a(16);var M=u.Na+_.Na;if(M=nr(d,f[1],M,m.Eb,0,b,0),u.Na=_.Na=(0<M)+0,1<M)ri(b,0,h,g);else{var A=b[0]+3>>3;for(b=0;256>b;b+=16)h[g+b]=A}S=1,P=f[0]}var k=15&u.la,T=15&_.la;for(b=0;4>b;++b){var C=1&T;for(A=w=0;4>A;++A)k=k>>1|(C=(M=nr(d,P,M=C+(1&k),m.Sc,S,h,g))>S)<<7,w=w<<2|(3<M?3:1<M?2:0!=h[g+0]),g+=16;k>>=4,T=T>>1|C<<7,y=(y<<8|w)>>>0}for(P=k,S=T>>4,x=0;4>x;x+=2){for(w=0,k=u.la>>4+x,T=_.la>>4+x,b=0;2>b;++b){for(C=1&T,A=0;2>A;++A)M=C+(1&k),k=k>>1|(C=0<(M=nr(d,f[2],M,m.Qc,0,h,g)))<<3,w=w<<2|(3<M?3:1<M?2:0!=h[g+0]),g+=16;k>>=2,T=T>>1|C<<5}v|=w<<4*x,P|=k<<4<<x,S|=(240&T)<<x}u.la=P,_.la=S,p.Hc=y,p.Gc=v,p.ia=43690&v?0:m.ia,f=!(y|v)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[s.$b][s.Za],l.wa[l.Y+l.ja].La|=!f),c.Ka)return Xt(t,7,"Premature end-of-file encountered.")}if($t(t),l=n,c=1,s=(o=t).D,u=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)e:{if(s.M=o.M,s.uc=u,zn(o,s),c=1,s=(w=o.D).Nb,u=(v=Or[o.L])*o.R,d=v/2*o.B,b=16*s*o.R,A=8*s*o.B,f=o.sa,p=o.ta-u+b,m=o.qa,h=o.ra-d+A,g=o.Ha,_=o.Ia-d+A,T=0==(k=w.M),y=k>=o.Va-1,2==o.Aa&&zn(o,w),w.uc)for(C=(M=o).D.M,e(M.D.uc),w=M.yb;w<M.Hb;++w){S=w,P=C;var I=(L=(U=M).D).Nb;x=U.R;var L=L.wa[L.Y+S],z=U.sa,N=U.ta+16*I*x+16*S,D=L.dd,R=L.tc;if(0!=R)if(e(3<=R),1==U.L)0<S&&vi(z,N,x,R+4),L.La&&xi(z,N,x,R),0<P&&yi(z,N,x,R+4),L.La&&bi(z,N,x,R);else{var F=U.B,O=U.qa,B=U.ra+8*I*F+8*S,j=U.Ha,U=U.Ia+8*I*F+8*S;I=L.ld,0<S&&(hi(z,N,x,R+4,D,I),fi(O,B,j,U,F,R+4,D,I)),L.La&&(mi(z,N,x,R,D,I),_i(O,B,j,U,F,R,D,I)),0<P&&(ui(z,N,x,R+4,D,I),di(O,B,j,U,F,R+4,D,I)),L.La&&(pi(z,N,x,R,D,I),gi(O,B,j,U,F,R,D,I))}}if(o.ia&&alert("todo:DitherRow"),null!=l.put){if(w=16*k,k=16*(k+1),T?(l.y=o.sa,l.O=o.ta+b,l.f=o.qa,l.N=o.ra+A,l.ea=o.Ha,l.W=o.Ia+A):(w-=v,l.y=f,l.O=p,l.f=m,l.N=h,l.ea=g,l.W=_),y||(k-=v),k>l.o&&(k=l.o),l.F=null,l.J=null,null!=o.Fa&&0<o.Fa.length&&w<k&&(l.J=hn(o,l,w,k-w),l.F=o.mb,null==l.F&&0==l.F.length)){c=Xt(o,3,"Could not decode alpha data.");break e}w<l.j&&(v=l.j-w,w=l.j,e(!(1&v)),l.O+=o.R*v,l.N+=o.B*(v>>1),l.W+=o.B*(v>>1),null!=l.F&&(l.J+=l.width*v)),w<k&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=w-l.j,l.U=l.va-l.v,l.T=k-w,c=l.put(l))}s+1!=o.Ic||y||(i(o.sa,o.ta-u,f,p+16*o.R,u),i(o.qa,o.ra-d,m,h+8*o.B,d),i(o.Ha,o.Ia-d,g,_+8*o.B,d))}if(!c)return Xt(t,6,"Output aborted.")}return 1}(t,n)),null!=n.bc&&n.bc(n),o&=1}return o?(t.cb=0,o):0})(t,l)||(n=t.a)}}else n=t.a}0==n&&null!=h.Oa&&h.Oa.fd&&(n=Rn(h.ba))}h=n}u=0!=h?null:11>u?d.f.RGBA.eb:d.f.kb.y}else u=null;return u};var jr=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(t,e){for(var n="",i=0;i<4;i++)n+=String.fromCharCode(t[e++]);return n}function u(t,e){return t[e+0]|t[e+1]<<8}function h(t,e){return(t[e+0]|t[e+1]<<8|t[e+2]<<16)>>>0}function d(t,e){return(t[e+0]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}new l;var f=[0],p=[0],m=[],g=new l,_=t,y=function(t,e){var n={},i=0,r=!1,a=0,s=0;if(n.frames=[],!function(t,e){for(var n=0;n<4;n++)if(t[e+n]!="RIFF".charCodeAt(n))return!0;return!1}(t,e)){for(d(t,e+=4),e+=8;e<t.length;){var o=c(t,e),l=d(t,e+=4);e+=4;var f=l+(1&l);switch(o){case"VP8 ":case"VP8L":void 0===n.frames[i]&&(n.frames[i]={}),(g=n.frames[i]).src_off=r?s:e-8,g.src_size=a+l+8,i++,r&&(r=!1,a=0,s=0);break;case"VP8X":(g=n.header={}).feature_flags=t[e];var p=e+4;g.canvas_width=1+h(t,p),p+=3,g.canvas_height=1+h(t,p),p+=3;break;case"ALPH":r=!0,a=f+8,s=e-8;break;case"ANIM":(g=n.header).bgcolor=d(t,e),p=e+4,g.loop_count=u(t,p),p+=2;break;case"ANMF":var m,g;(g=n.frames[i]={}).offset_x=2*h(t,e),e+=3,g.offset_y=2*h(t,e),e+=3,g.width=1+h(t,e),e+=3,g.height=1+h(t,e),e+=3,g.duration=h(t,e),e+=3,m=t[e++],g.dispose=1&m,g.blend=m>>1&1}"ANMF"!=o&&(e+=f)}return n}}(_,0);y.response=_,y.rgbaoutput=!0,y.dataurl=!1;var v=y.header?y.header:null,b=y.frames?y.frames:null;if(v){v.loop_counter=v.loop_count,f=[v.canvas_height],p=[v.canvas_width];for(var x=0;x<b.length&&0!=b[x].blend;x++);}var w=b[0],S=g.WebPDecodeRGBA(_,w.src_off,w.src_size,p,f);w.rgba=S,w.imgwidth=p[0],w.imgheight=f[0];for(var P=0;P<p[0]*f[0]*4;P++)m[P]=S[P];return this.width=p,this.height=f,this.data=m,this}!function(t){var e,n,i,r,a,s,o,l,c,u=function(t){return t=t||{},this.isStrokeTransparent=t.isStrokeTransparent||!1,this.strokeOpacity=t.strokeOpacity||1,this.strokeStyle=t.strokeStyle||"#000000",this.fillStyle=t.fillStyle||"#000000",this.isFillTransparent=t.isFillTransparent||!1,this.fillOpacity=t.fillOpacity||1,this.font=t.font||"10px sans-serif",this.textBaseline=t.textBaseline||"alphabetic",this.textAlign=t.textAlign||"left",this.lineWidth=t.lineWidth||1,this.lineJoin=t.lineJoin||"miter",this.lineCap=t.lineCap||"butt",this.path=t.path||[],this.transform=void 0!==t.transform?t.transform.clone():new l,this.globalCompositeOperation=t.globalCompositeOperation||"normal",this.globalAlpha=t.globalAlpha||1,this.clip_path=t.clip_path||[],this.currentPoint=t.currentPoint||new s,this.miterLimit=t.miterLimit||10,this.lastPoint=t.lastPoint||new s,this.lineDashOffset=t.lineDashOffset||0,this.lineDash=t.lineDash||[],this.margin=t.margin||[0,0,0,0],this.prevPageLastElemOffset=t.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof t.ignoreClearRect||t.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),e=this.internal.f2,n=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var h=function(t){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var e=t;Object.defineProperty(this,"pdf",{get:function(){return e}});var n=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n},set:function(t){n=Boolean(t)}});var i=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return i},set:function(t){i=Boolean(t)}});var r=0;Object.defineProperty(this,"posX",{get:function(){return r},set:function(t){isNaN(t)||(r=t)}});var a=0;Object.defineProperty(this,"posY",{get:function(){return a},set:function(t){isNaN(t)||(a=t)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(t){var e;"number"==typeof t?e=[t,t,t,t]:((e=new Array(4))[0]=t[0],e[1]=t.length>=2?t[1]:e[0],e[2]=t.length>=3?t[2]:e[0],e[3]=t.length>=4?t[3]:e[1]),c.margin=e}});var s=!1;Object.defineProperty(this,"autoPaging",{get:function(){return s},set:function(t){s=t}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(t){o=t}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(t){l=t}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(t){t instanceof u&&(c=t)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(t){c.path=t}});var h=[];Object.defineProperty(this,"ctxStack",{get:function(){return h},set:function(t){h=t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(t){var e;e=d(t),this.ctx.fillStyle=e.style,this.ctx.isFillTransparent=0===e.a,this.ctx.fillOpacity=e.a,this.pdf.setFillColor(e.r,e.g,e.b,{a:e.a}),this.pdf.setTextColor(e.r,e.g,e.b,{a:e.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(t){var e=d(t);this.ctx.strokeStyle=e.style,this.ctx.isStrokeTransparent=0===e.a,this.ctx.strokeOpacity=e.a,0===e.a?this.pdf.setDrawColor(255,255,255):(e.a,this.pdf.setDrawColor(e.r,e.g,e.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(t){-1!==["butt","round","square"].indexOf(t)&&(this.ctx.lineCap=t,this.pdf.setLineCap(t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(t){isNaN(t)||(this.ctx.lineWidth=t,this.pdf.setLineWidth(t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(t){-1!==["bevel","round","miter"].indexOf(t)&&(this.ctx.lineJoin=t,this.pdf.setLineJoin(t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(t){isNaN(t)||(this.ctx.miterLimit=t,this.pdf.setMiterLimit(t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(t){this.ctx.textBaseline=t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(t){-1!==["right","end","center","left","start"].indexOf(t)&&(this.ctx.textAlign=t)}});var f=null,p=null;Object.defineProperty(this,"fontFaces",{get:function(){return p},set:function(t){f=null,p=t}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(t){var e;if(this.ctx.font=t,null!==(e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(t))){var n=e[1];e[2];var i=e[3],r=e[4];e[5];var a=e[6],s=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(r)[2];r="px"===s?Math.floor(parseFloat(r)*this.pdf.internal.scaleFactor):"em"===s?Math.floor(parseFloat(r)*this.pdf.getFontSize()):Math.floor(parseFloat(r)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(r);var o=function(t){var e,n,i=[],r=t.trim();if(""===r)return Hl;if(r in zl)return[zl[r]];for(;""!==r;){switch(n=null,e=(r=Dl(r)).charAt(0)){case'"':case"'":n=Rl(r.substring(1),e);break;default:n=Fl(r)}if(null===n)return Hl;if(i.push(n[0]),""!==(r=Dl(n[1]))&&","!==r.charAt(0))return Hl;r=r.replace(/^,/,"")}return i}(a);if(this.fontFaces){var l=function(t,e){if(null===f){var n=function(t){var e=[];return Object.keys(t).forEach(function(n){t[n].forEach(function(t){var i=null;switch(t){case"bold":i={family:n,weight:"bold"};break;case"italic":i={family:n,style:"italic"};break;case"bolditalic":i={family:n,weight:"bold",style:"italic"};break;case"":case"normal":i={family:n}}null!==i&&(i.ref={name:n,style:t},e.push(i))})}),e}(t.getFontList());f=function(t){for(var e={},n=0;n<t.length;++n){var i=Cl(t[n]),r=i.family,a=i.stretch,s=i.style,o=i.weight;e[r]=e[r]||{},e[r][a]=e[r][a]||{},e[r][a][s]=e[r][a][s]||{},e[r][a][s][o]=i}return e}(n.concat(e))}return f}(this.pdf,this.fontFaces),c=o.map(function(t){return{family:t,stretch:"normal",weight:i,style:n}}),u=function(t,e,n){for(var i=(n=n||{}).defaultFontFamily||"times",r=Object.assign({},Ll,n.genericFontFamilies||{}),a=null,s=null,o=0;o<e.length;++o)if(r[(a=Cl(e[o])).family]&&(a.family=r[a.family]),t.hasOwnProperty(a.family)){s=t[a.family];break}if(!(s=s||t[i]))throw new Error("Could not find a font-family for the rule '"+Nl(a)+"' and default family '"+i+"'.");if(s=function(t,e){if(e[t])return e[t];var n=kl[t],i=n<=kl.normal?-1:1,r=Il(e,Al,n,i);if(!r)throw new Error("Could not find a matching font-stretch value for "+t);return r}(a.stretch,s),s=function(t,e){if(e[t])return e[t];for(var n=Ml[t],i=0;i<n.length;++i)if(e[n[i]])return e[n[i]];throw new Error("Could not find a matching font-style for "+t)}(a.style,s),!(s=function(t,e){if(e[t])return e[t];if(400===t&&e[500])return e[500];if(500===t&&e[400])return e[400];var n=Tl[t],i=Il(e,El,n,t<400?-1:1);if(!i)throw new Error("Could not find a matching font-weight for value "+t);return i}(a.weight,s)))throw new Error("Failed to resolve a font for the rule '"+Nl(a)+"'.");return s}(l,c);this.pdf.setFont(u.ref.name,u.ref.style)}else{var h="";("bold"===i||parseInt(i,10)>=700||"bold"===n)&&(h="bold"),"italic"===n&&(h+="italic"),0===h.length&&(h="normal");for(var d="",p={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},m=0;m<o.length;m++){if(void 0!==this.pdf.internal.getFont(o[m],h,{noFallback:!0,disableWarning:!0})){d=o[m];break}if("bolditalic"===h&&void 0!==this.pdf.internal.getFont(o[m],"bold",{noFallback:!0,disableWarning:!0}))d=o[m],h="bold";else if(void 0!==this.pdf.internal.getFont(o[m],"normal",{noFallback:!0,disableWarning:!0})){d=o[m],h="normal";break}}if(""===d)for(var g=0;g<o.length;g++)if(p[o[g]]){d=p[o[g]];break}d=""===d?"Times":d,this.pdf.setFont(d,h)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(t){this.ctx.globalCompositeOperation=t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(t){this.ctx.globalAlpha=t}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(t){this.ctx.lineDashOffset=t,F.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(t){this.ctx.lineDash=t,F.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(t){this.ctx.ignoreClearRect=Boolean(t)}})};h.prototype.setLineDash=function(t){this.lineDash=t},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){b.call(this,"fill",!1)},h.prototype.stroke=function(){b.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(t,e){if(isNaN(t)||isNaN(e))throw ao.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n=this.ctx.transform.applyToPoint(new s(t,e));this.path.push({type:"mt",x:n.x,y:n.y}),this.ctx.lastPoint=new s(t,e)},h.prototype.closePath=function(){var t=new s(0,0),e=0;for(e=this.path.length-1;-1!==e;e--)if("begin"===this.path[e].type&&"object"===(0,Ge.A)(this.path[e+1])&&"number"==typeof this.path[e+1].x){t=new s(this.path[e+1].x,this.path[e+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(t.x,t.y)},h.prototype.lineTo=function(t,e){if(isNaN(t)||isNaN(e))throw ao.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n=this.ctx.transform.applyToPoint(new s(t,e));this.path.push({type:"lt",x:n.x,y:n.y}),this.ctx.lastPoint=new s(n.x,n.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),b.call(this,null,!0)},h.prototype.quadraticCurveTo=function(t,e,n,i){if(isNaN(n)||isNaN(i)||isNaN(t)||isNaN(e))throw ao.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var r=this.ctx.transform.applyToPoint(new s(n,i)),a=this.ctx.transform.applyToPoint(new s(t,e));this.path.push({type:"qct",x1:a.x,y1:a.y,x:r.x,y:r.y}),this.ctx.lastPoint=new s(r.x,r.y)},h.prototype.bezierCurveTo=function(t,e,n,i,r,a){if(isNaN(r)||isNaN(a)||isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i))throw ao.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new s(r,a)),l=this.ctx.transform.applyToPoint(new s(t,e)),c=this.ctx.transform.applyToPoint(new s(n,i));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new s(o.x,o.y)},h.prototype.arc=function(t,e,n,i,r,a){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||isNaN(r))throw ao.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(a=Boolean(a),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new s(t,e));t=o.x,e=o.y;var l=this.ctx.transform.applyToPoint(new s(0,n)),c=this.ctx.transform.applyToPoint(new s(0,0));n=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2))}Math.abs(r-i)>=2*Math.PI&&(i=0,r=2*Math.PI),this.path.push({type:"arc",x:t,y:e,radius:n,startAngle:i,endAngle:r,counterclockwise:a})},h.prototype.arcTo=function(t,e,n,i,r){throw new Error("arcTo not implemented.")},h.prototype.rect=function(t,e,n,i){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i))throw ao.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+i),this.lineTo(t,e+i),this.lineTo(t,e),this.lineTo(t+n,e),this.lineTo(t,e)},h.prototype.fillRect=function(t,e,n,i){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i))throw ao.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var r={};"butt"!==this.lineCap&&(r.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(r.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(t,e,n,i),this.fill(),r.hasOwnProperty("lineCap")&&(this.lineCap=r.lineCap),r.hasOwnProperty("lineJoin")&&(this.lineJoin=r.lineJoin)}},h.prototype.strokeRect=function(t,e,n,i){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i))throw ao.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(t,e,n,i),this.stroke())},h.prototype.clearRect=function(t,e,n,i){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i))throw ao.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(t,e,n,i))},h.prototype.save=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("q");if(this.pdf.setPage(e),t){this.ctx.fontSize=this.pdf.internal.getFontSize();var i=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=i}},h.prototype.restore=function(t){t="boolean"!=typeof t||t;for(var e=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("Q");this.pdf.setPage(e),t&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var d=function(t){var e,n,i,r;if(!0===t.isCanvasGradient&&(t=t.getColor()),!t)return{r:0,g:0,b:0,a:0,style:t};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(t))e=0,n=0,i=0,r=0;else{var a=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(t);if(null!==a)e=parseInt(a[1]),n=parseInt(a[2]),i=parseInt(a[3]),r=1;else if(null!==(a=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(t)))e=parseInt(a[1]),n=parseInt(a[2]),i=parseInt(a[3]),r=parseFloat(a[4]);else{if(r=1,"string"==typeof t&&"#"!==t.charAt(0)){var s=new uo(t);t=s.ok?s.toHex():"#000000"}4===t.length?(e=t.substring(1,2),e+=e,n=t.substring(2,3),n+=n,i=t.substring(3,4),i+=i):(e=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7)),e=parseInt(e,16),n=parseInt(n,16),i=parseInt(i,16)}}return{r:e,g:n,b:i,a:r,style:t}},f=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},p=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};h.prototype.fillText=function(t,e,n,i){if(isNaN(e)||isNaN(n)||"string"!=typeof t)throw ao.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(i=isNaN(i)?void 0:i,!f.call(this)){var r=N(this.ctx.transform.rotation),a=this.ctx.transform.scaleX;E.call(this,{text:t,x:e,y:n,scale:a,angle:r,align:this.textAlign,maxWidth:i})}},h.prototype.strokeText=function(t,e,n,i){if(isNaN(e)||isNaN(n)||"string"!=typeof t)throw ao.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){i=isNaN(i)?void 0:i;var r=N(this.ctx.transform.rotation),a=this.ctx.transform.scaleX;E.call(this,{text:t,x:e,y:n,scale:a,renderingMode:"stroke",angle:r,align:this.textAlign,maxWidth:i})}},h.prototype.measureText=function(t){if("string"!=typeof t)throw ao.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var e=this.pdf,n=this.pdf.internal.scaleFactor,i=e.internal.getFontSize(),r=e.getStringUnitWidth(t)*i/e.internal.scaleFactor;return new function(t){var e=(t=t||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return e}}),this}({width:r*=Math.round(96*n/72*1e4)/1e4})},h.prototype.scale=function(t,e){if(isNaN(t)||isNaN(e))throw ao.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n=new l(t,0,0,e,0,0);this.ctx.transform=this.ctx.transform.multiply(n)},h.prototype.rotate=function(t){if(isNaN(t))throw ao.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var e=new l(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0);this.ctx.transform=this.ctx.transform.multiply(e)},h.prototype.translate=function(t,e){if(isNaN(t)||isNaN(e))throw ao.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n=new l(1,0,0,1,t,e);this.ctx.transform=this.ctx.transform.multiply(n)},h.prototype.transform=function(t,e,n,i,r,a){if(isNaN(t)||isNaN(e)||isNaN(n)||isNaN(i)||isNaN(r)||isNaN(a))throw ao.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var s=new l(t,e,n,i,r,a);this.ctx.transform=this.ctx.transform.multiply(s)},h.prototype.setTransform=function(t,e,n,i,r,a){t=isNaN(t)?1:t,e=isNaN(e)?0:e,n=isNaN(n)?0:n,i=isNaN(i)?1:i,r=isNaN(r)?0:r,a=isNaN(a)?0:a,this.ctx.transform=new l(t,e,n,i,r,a)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(t,e,n,i,r,a,s,c,u){var h=this.pdf.getImageProperties(t),d=1,f=1,p=1,_=1;void 0!==i&&void 0!==c&&(p=c/i,_=u/r,d=h.width/i*c/i,f=h.height/r*u/r),void 0===a&&(a=e,s=n,e=0,n=0),void 0!==i&&void 0===c&&(c=i,u=r),void 0===i&&void 0===c&&(c=h.width,u=h.height);for(var b,w=this.ctx.transform.decompose(),S=N(w.rotate.shx),P=new l,M=(P=(P=(P=P.multiply(w.translate)).multiply(w.skew)).multiply(w.scale)).applyToRectangle(new o(a-e*p,s-n*_,i*d,r*f)),A=g.call(this,M),k=[],E=0;E<A.length;E+=1)-1===k.indexOf(A[E])&&k.push(A[E]);if(v(k),this.autoPaging)for(var T=k[0],C=k[k.length-1],I=T;I<C+1;I++){this.pdf.setPage(I);var L=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],z=1===I?this.posY+this.margin[0]:this.margin[0],D=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],R=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],F=1===I?0:D+(I-2)*R;if(0!==this.ctx.clip_path.length){var O=this.path;b=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(b,this.posX+this.margin[3],-F+z+this.ctx.prevPageLastElemOffset),x.call(this,"fill",!0),this.path=O}var B=JSON.parse(JSON.stringify(M));B=y([B],this.posX+this.margin[3],-F+z+this.ctx.prevPageLastElemOffset)[0];var j=(I>T||I<C)&&m.call(this);j&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],L,R,null).clip().discardPath()),this.pdf.addImage(t,"JPEG",B.x,B.y,B.w,B.h,null,null,S),j&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(t,"JPEG",M.x,M.y,M.w,M.h,null,null,S)};var g=function(t,e,n){var i=[];e=e||this.pdf.internal.pageSize.width,n=n||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var r=this.posY+this.ctx.prevPageLastElemOffset;switch(t.type){default:case"mt":case"lt":i.push(Math.floor((t.y+r)/n)+1);break;case"arc":i.push(Math.floor((t.y+r-t.radius)/n)+1),i.push(Math.floor((t.y+r+t.radius)/n)+1);break;case"qct":var a=D(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x,t.y);i.push(Math.floor((a.y+r)/n)+1),i.push(Math.floor((a.y+a.h+r)/n)+1);break;case"bct":var s=R(this.ctx.lastPoint.x,this.ctx.lastPoint.y,t.x1,t.y1,t.x2,t.y2,t.x,t.y);i.push(Math.floor((s.y+r)/n)+1),i.push(Math.floor((s.y+s.h+r)/n)+1);break;case"rect":i.push(Math.floor((t.y+r)/n)+1),i.push(Math.floor((t.y+t.h+r)/n)+1)}for(var o=0;o<i.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<i[o];)_.call(this);return i},_=function(){var t=this.fillStyle,e=this.strokeStyle,n=this.font,i=this.lineCap,r=this.lineWidth,a=this.lineJoin;this.pdf.addPage(),this.fillStyle=t,this.strokeStyle=e,this.font=n,this.lineCap=i,this.lineWidth=r,this.lineJoin=a},y=function(t,e,n){for(var i=0;i<t.length;i++)switch(t[i].type){case"bct":t[i].x2+=e,t[i].y2+=n;case"qct":t[i].x1+=e,t[i].y1+=n;default:t[i].x+=e,t[i].y+=n}return t},v=function(t){return t.sort(function(t,e){return t-e})},b=function(t,e){for(var n,i,r=this.fillStyle,a=this.strokeStyle,s=this.lineCap,o=this.lineWidth,l=Math.abs(o*this.ctx.transform.scaleX),c=this.lineJoin,u=JSON.parse(JSON.stringify(this.path)),h=JSON.parse(JSON.stringify(this.path)),d=[],f=0;f<h.length;f++)if(void 0!==h[f].x)for(var p=g.call(this,h[f]),b=0;b<p.length;b+=1)-1===d.indexOf(p[b])&&d.push(p[b]);for(var w=0;w<d.length;w++)for(;this.pdf.internal.getNumberOfPages()<d[w];)_.call(this);if(v(d),this.autoPaging)for(var S=d[0],P=d[d.length-1],M=S;M<P+1;M++){this.pdf.setPage(M),this.fillStyle=r,this.strokeStyle=a,this.lineCap=s,this.lineWidth=l,this.lineJoin=c;var A=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],k=1===M?this.posY+this.margin[0]:this.margin[0],E=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],C=1===M?0:E+(M-2)*T;if(0!==this.ctx.clip_path.length){var I=this.path;n=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(n,this.posX+this.margin[3],-C+k+this.ctx.prevPageLastElemOffset),x.call(this,t,!0),this.path=I}if(i=JSON.parse(JSON.stringify(u)),this.path=y(i,this.posX+this.margin[3],-C+k+this.ctx.prevPageLastElemOffset),!1===e||0===M){var L=(M>S||M<P)&&m.call(this);L&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],A,T,null).clip().discardPath()),x.call(this,t,e),L&&this.pdf.restoreGraphicsState()}this.lineWidth=o}else this.lineWidth=l,x.call(this,t,e),this.lineWidth=o;this.path=u},x=function(t,e){if(("stroke"!==t||e||!p.call(this))&&("stroke"===t||e||!f.call(this))){for(var n,i,r=[],a=this.path,s=0;s<a.length;s++){var o=a[s];switch(o.type){case"begin":r.push({begin:!0});break;case"close":r.push({close:!0});break;case"mt":r.push({start:o,deltas:[],abs:[]});break;case"lt":var l=r.length;if(a[s-1]&&!isNaN(a[s-1].x)&&(n=[o.x-a[s-1].x,o.y-a[s-1].y],l>0))for(;l>=0;l--)if(!0!==r[l-1].close&&!0!==r[l-1].begin){r[l-1].deltas.push(n),r[l-1].abs.push(o);break}break;case"bct":n=[o.x1-a[s-1].x,o.y1-a[s-1].y,o.x2-a[s-1].x,o.y2-a[s-1].y,o.x-a[s-1].x,o.y-a[s-1].y],r[r.length-1].deltas.push(n);break;case"qct":var c=a[s-1].x+2/3*(o.x1-a[s-1].x),u=a[s-1].y+2/3*(o.y1-a[s-1].y),h=o.x+2/3*(o.x1-o.x),d=o.y+2/3*(o.y1-o.y),m=o.x,g=o.y;n=[c-a[s-1].x,u-a[s-1].y,h-a[s-1].x,d-a[s-1].y,m-a[s-1].x,g-a[s-1].y],r[r.length-1].deltas.push(n);break;case"arc":r.push({deltas:[],abs:[],arc:!0}),Array.isArray(r[r.length-1].abs)&&r[r.length-1].abs.push(o)}}i=e?null:"stroke"===t?"stroke":"fill";for(var _=!1,y=0;y<r.length;y++)if(r[y].arc)for(var v=r[y].abs,b=0;b<v.length;b++){var x=v[b];"arc"===x.type?P.call(this,x.x,x.y,x.radius,x.startAngle,x.endAngle,x.counterclockwise,void 0,e,!_):T.call(this,x.x,x.y),_=!0}else if(!0===r[y].close)this.pdf.internal.out("h"),_=!1;else if(!0!==r[y].begin){var w=r[y].start.x,S=r[y].start.y;C.call(this,r[y].deltas,w,S),_=!0}i&&M.call(this,i),e&&A.call(this)}},w=function(t){var e=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n=e*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return t-n;case"top":return t+e-n;case"hanging":return t+e-2*n;case"middle":return t+e/2-n;default:return t}},S=function(t){return t+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var t=function(){};return t.colorStops=[],t.addColorStop=function(t,e){this.colorStops.push([t,e])},t.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},t.isCanvasGradient=!0,t},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(t,e,n,i,r,a,s,o,l){for(var c=L.call(this,n,i,r,a),u=0;u<c.length;u++){var h=c[u];0===u&&(l?k.call(this,h.x1+t,h.y1+e):T.call(this,h.x1+t,h.y1+e)),I.call(this,t,e,h.x2,h.y2,h.x3,h.y3,h.x4,h.y4)}o?A.call(this):M.call(this,s)},M=function(t){switch(t){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},A=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(t,e){this.pdf.internal.out(n(t)+" "+i(e)+" m")},E=function(t){var e;switch(t.align){case"right":case"end":e="right";break;case"center":e="center";break;default:e="left"}var n=this.pdf.getTextDimensions(t.text),i=w.call(this,t.y),r=S.call(this,i)-n.h,a=this.ctx.transform.applyToPoint(new s(t.x,i)),c=this.ctx.transform.decompose(),u=new l;u=(u=(u=u.multiply(c.translate)).multiply(c.skew)).multiply(c.scale);for(var h,d,f,p=this.ctx.transform.applyToRectangle(new o(t.x,i,n.w,n.h)),_=u.applyToRectangle(new o(t.x,r,n.w,n.h)),b=g.call(this,_),P=[],M=0;M<b.length;M+=1)-1===P.indexOf(b[M])&&P.push(b[M]);if(v(P),this.autoPaging)for(var A=P[0],k=P[P.length-1],E=A;E<k+1;E++){this.pdf.setPage(E);var T=1===E?this.posY+this.margin[0]:this.margin[0],C=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],I=this.pdf.internal.pageSize.height-this.margin[2],L=I-this.margin[0],z=this.pdf.internal.pageSize.width-this.margin[1],N=z-this.margin[3],D=1===E?0:C+(E-2)*L;if(0!==this.ctx.clip_path.length){var R=this.path;h=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(h,this.posX+this.margin[3],-1*D+T),x.call(this,"fill",!0),this.path=R}var F=y([JSON.parse(JSON.stringify(_))],this.posX+this.margin[3],-D+T+this.ctx.prevPageLastElemOffset)[0];t.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*t.scale),f=this.lineWidth,this.lineWidth=f*t.scale);var O="text"!==this.autoPaging;if(O||F.y+F.h<=I){if(O||F.y>=T&&F.x<=z){var B=O?t.text:this.pdf.splitTextToSize(t.text,t.maxWidth||z-F.x)[0],j=y([JSON.parse(JSON.stringify(p))],this.posX+this.margin[3],-D+T+this.ctx.prevPageLastElemOffset)[0],U=O&&(E>A||E<k)&&m.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],N,L,null).clip().discardPath()),this.pdf.text(B,j.x,j.y,{angle:t.angle,align:e,renderingMode:t.renderingMode}),U&&this.pdf.restoreGraphicsState()}}else F.y<I&&(this.ctx.prevPageLastElemOffset+=I-F.y);t.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=f)}else t.scale>=.01&&(d=this.pdf.internal.getFontSize(),this.pdf.setFontSize(d*t.scale),f=this.lineWidth,this.lineWidth=f*t.scale),this.pdf.text(t.text,a.x+this.posX,a.y+this.posY,{angle:t.angle,align:e,renderingMode:t.renderingMode,maxWidth:t.maxWidth}),t.scale>=.01&&(this.pdf.setFontSize(d),this.lineWidth=f)},T=function(t,e,r,a){r=r||0,a=a||0,this.pdf.internal.out(n(t+r)+" "+i(e+a)+" l")},C=function(t,e,n){return this.pdf.lines(t,e,n,null,null)},I=function(t,n,i,s,o,l,c,u){this.pdf.internal.out([e(r(i+t)),e(a(s+n)),e(r(o+t)),e(a(l+n)),e(r(c+t)),e(a(u+n)),"c"].join(" "))},L=function(t,e,n,i){for(var r=2*Math.PI,a=Math.PI/2;e>n;)e-=r;var s=Math.abs(n-e);s<r&&i&&(s=r-s);for(var o=[],l=i?-1:1,c=e;s>1e-5;){var u=c+l*Math.min(s,a);o.push(z.call(this,t,c,u)),s-=Math.abs(u-c),c=u}return o},z=function(t,e,n){var i=(n-e)/2,r=t*Math.cos(i),a=t*Math.sin(i),s=r,o=-a,l=s*s+o*o,c=l+s*r+o*a,u=4/3*(Math.sqrt(2*l*c)-c)/(s*a-o*r),h=s-u*o,d=o+u*s,f=h,p=-d,m=i+e,g=Math.cos(m),_=Math.sin(m);return{x1:t*Math.cos(e),y1:t*Math.sin(e),x2:h*g-d*_,y2:h*_+d*g,x3:f*g-p*_,y3:f*_+p*g,x4:t*Math.cos(n),y4:t*Math.sin(n)}},N=function(t){return 180*t/Math.PI},D=function(t,e,n,i,r,a){var s=t+.5*(n-t),l=e+.5*(i-e),c=r+.5*(n-r),u=a+.5*(i-a),h=Math.min(t,r,s,c),d=Math.max(t,r,s,c),f=Math.min(e,a,l,u),p=Math.max(e,a,l,u);return new o(h,f,d-h,p-f)},R=function(t,e,n,i,r,a,s,l){var c,u,h,d,f,p,m,g,_,y,v,b,x,w,S=n-t,P=i-e,M=r-n,A=a-i,k=s-r,E=l-a;for(u=0;u<41;u++)_=(m=(h=t+(c=u/40)*S)+c*((f=n+c*M)-h))+c*(f+c*(r+c*k-f)-m),y=(g=(d=e+c*P)+c*((p=i+c*A)-d))+c*(p+c*(a+c*E-p)-g),0==u?(v=_,b=y,x=_,w=y):(v=Math.min(v,_),b=Math.min(b,y),x=Math.max(x,_),w=Math.max(w,y));return new o(Math.round(v),Math.round(b),Math.round(x-v),Math.round(w-b))},F=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var t,e,n=(t=this.ctx.lineDash,e=this.ctx.lineDashOffset,JSON.stringify({lineDash:t,lineDashOffset:e}));this.prevLineDash!==n&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n)}}}(Fo.API),function(t){var e=function(t){var e,n,i,r,a,s,o,l,c,u;for(/[^\x00-\xFF]/.test(t),n=[],i=0,r=(t+=e="\0\0\0\0".slice(t.length%4||4)).length;r>i;i+=4)0!==(a=(t.charCodeAt(i)<<24)+(t.charCodeAt(i+1)<<16)+(t.charCodeAt(i+2)<<8)+t.charCodeAt(i+3))?(s=(a=((a=((a=((a=(a-(u=a%85))/85)-(c=a%85))/85)-(l=a%85))/85)-(o=a%85))/85)%85,n.push(s+33,o+33,l+33,c+33,u+33)):n.push(122);return function(t,e){for(var n=e;n>0;n--)t.pop()}(n,e.length),String.fromCharCode.apply(String,n)+"~>"},n=function(t){var e,n,i,r,a,s=String,o="length",l=255,c="charCodeAt",u="slice",h="replace";for(t[u](-2),t=t[u](0,-2)[h](/\s/g,"")[h]("z","!!!!!"),i=[],r=0,a=(t+=e="uuuuu"[u](t[o]%5||5))[o];a>r;r+=5)n=52200625*(t[c](r)-33)+614125*(t[c](r+1)-33)+7225*(t[c](r+2)-33)+85*(t[c](r+3)-33)+(t[c](r+4)-33),i.push(l&n>>24,l&n>>16,l&n>>8,l&n);return function(t,e){for(var n=e;n>0;n--)t.pop()}(i,e[o]),s.fromCharCode.apply(s,i)},i=function(t){return t.split("").map(function(t){return("0"+t.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(t){var e=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(t=t.replace(/\s/g,"")).indexOf(">")&&(t=t.substr(0,t.indexOf(">"))),t.length%2&&(t+="0"),!1===e.test(t))return"";for(var n="",i=0;i<t.length;i+=2)n+=String.fromCharCode("0x"+(t[i]+t[i+1]));return n},a=function(t){for(var e=new Uint8Array(t.length),n=t.length;n--;)e[n]=t.charCodeAt(n);return(e=kn(e)).reduce(function(t,e){return t+String.fromCharCode(e)},"")};t.processDataByFilters=function(t,s){var o=0,l=t||"",c=[];for("string"==typeof(s=s||[])&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":l=n(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=r(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=i(l),c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=a(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(Fo.API),(Wl=Fo.API).loadFile=function(t,e,n){return function(t,e,n){e=!1!==e,n="function"==typeof n?n:function(){};var i=void 0;try{i=function(t,e,n){var i=new XMLHttpRequest,r=0,a=function(t){var e=t.length,n=[],i=String.fromCharCode;for(r=0;r<e;r+=1)n.push(i(255&t.charCodeAt(r)));return n.join("")};if(i.open("GET",t,!e),i.overrideMimeType("text/plain; charset=x-user-defined"),!1===e&&(i.onload=function(){200===i.status?n(a(this.responseText)):n(void 0)}),i.send(null),e&&200===i.status)return a(i.responseText)}(t,e,n)}catch(nn){}return i}(t,e,n)},Wl.loadImageFile=Wl.loadFile,function(t){function e(){return(io.html2canvas?Promise.resolve(io.html2canvas):n.e(239).then(n.t.bind(n,5239,23))).catch(function(t){return Promise.reject(new Error("Could not load html2canvas: "+t))}).then(function(t){return t.default?t.default:t})}function i(){return(io.DOMPurify?Promise.resolve(io.DOMPurify):n.e(977).then(n.bind(n,7977))).catch(function(t){return Promise.reject(new Error("Could not load dompurify: "+t))}).then(function(t){return t.default?t.default:t})}var r=function(t){var e=(0,Ge.A)(t);return"undefined"===e?"undefined":"string"===e||t instanceof String?"string":"number"===e||t instanceof Number?"number":"function"===e||t instanceof Function?"function":t&&t.constructor===Array?"array":t&&1===t.nodeType?"element":"object"===e?"object":"unknown"},a=function(t,e){var n=document.createElement(t);for(var i in e.className&&(n.className=e.className),e.innerHTML&&e.dompurify&&(n.innerHTML=e.dompurify.sanitize(e.innerHTML)),e.style)n.style[i]=e.style[i];return n},s=function t(e,n){for(var i=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),r=e.firstChild;r;r=r.nextSibling)!0!==n&&1===r.nodeType&&"SCRIPT"===r.nodeName||i.appendChild(t(r,n));return 1===e.nodeType&&("CANVAS"===e.nodeName?(i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0)):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(i.value=e.value),i.addEventListener("load",function(){i.scrollTop=e.scrollTop,i.scrollLeft=e.scrollLeft},!0)),i},o=function t(e){var n=Object.assign(t.convert(Promise.resolve()),JSON.parse(JSON.stringify(t.template))),i=t.convert(Promise.resolve(),n);return(i=i.setProgress(1,t,1,[t])).set(e)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(t,e){return t.__proto__=e||o.prototype,t},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(t,e){return this.then(function(){switch(e=e||function(t){switch(r(t)){case"string":return"string";case"element":return"canvas"===t.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(t),e){case"string":return this.then(i).then(function(e){return this.set({src:a("div",{innerHTML:t,dompurify:e})})});case"element":return this.set({src:t});case"canvas":return this.set({canvas:t});case"img":return this.set({img:t});default:return this.error("Unknown source type.")}})},o.prototype.to=function(t){switch(t){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var t={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},e=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===e.tagName&&(t.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:t}),this.prop.container.appendChild(e),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(e).then(function(t){var e=Object.assign({},this.opt.html2canvas);return delete e.onrendered,t(this.prop.container,e)}).then(function(t){(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var t=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(t).then(e).then(function(t){var e=this.opt.jsPDF,n=this.opt.fontFaces,i="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,r=Object.assign({async:!0,allowTaint:!0,scale:i,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete r.onrendered,e.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,e.context2d.posX=this.opt.x,e.context2d.posY=this.opt.y,e.context2d.margin=this.opt.margin,e.context2d.fontFaces=n,n)for(var a=0;a<n.length;++a){var s=n[a],o=s.src.find(function(t){return"truetype"===t.format});o&&e.addFont(o.url,s.ref.name,s.ref.style)}return r.windowHeight=r.windowHeight||0,r.windowHeight=0==r.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):r.windowHeight,e.context2d.save(!0),t(this.prop.container,r)}).then(function(t){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(t),this.prop.canvas=t,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var t=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=t})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(t,e,n){return"img"===(n=n||"pdf").toLowerCase()||"image"===n.toLowerCase()?this.outputImg(t,e):this.outputPdf(t,e)},o.prototype.outputPdf=function(t,e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(t,e)})},o.prototype.outputImg=function(t){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(t){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+t+'" is not supported.'}})},o.prototype.save=function(t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(t?{filename:t}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(t){if("object"!==r(t))return this;var e=Object.keys(t||{}).map(function(e){if(e in o.template.prop)return function(){this.prop[e]=t[e]};switch(e){case"margin":return this.setMargin.bind(this,t.margin);case"jsPDF":return function(){return this.opt.jsPDF=t.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,t.pageSize);default:return function(){this.opt[e]=t[e]}}},this);return this.then(function(){return this.thenList(e)})},o.prototype.get=function(t,e){return this.then(function(){var n=t in o.template.prop?this.prop[t]:this.opt[t];return e?e(n):n})},o.prototype.setMargin=function(t){return this.then(function(){switch(r(t)){case"number":t=[t,t,t,t];case"array":if(2===t.length&&(t=[t[0],t[1],t[0],t[1]]),4===t.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=t}).then(this.setPageSize)},o.prototype.setPageSize=function(t){function e(t,e){return Math.floor(t*e/72*96)}return this.then(function(){(t=t||Fo.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(t.inner={width:t.width-this.opt.margin[1]-this.opt.margin[3],height:t.height-this.opt.margin[0]-this.opt.margin[2]},t.inner.px={width:e(t.inner.width,t.k),height:e(t.inner.height,t.k)},t.inner.ratio=t.inner.height/t.inner.width),this.prop.pageSize=t})},o.prototype.setProgress=function(t,e,n,i){return null!=t&&(this.progress.val=t),null!=e&&(this.progress.state=e),null!=n&&(this.progress.n=n),null!=i&&(this.progress.stack=i),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(t,e,n,i){return this.setProgress(t?this.progress.val+t:null,e||null,n?this.progress.n+n:null,i?this.progress.stack.concat(i):null)},o.prototype.then=function(t,e){var n=this;return this.thenCore(t,e,function(t,e){return n.updateProgress(null,null,1,[t]),Promise.prototype.then.call(this,function(e){return n.updateProgress(null,t),e}).then(t,e).then(function(t){return n.updateProgress(1),t})})},o.prototype.thenCore=function(t,e,n){n=n||Promise.prototype.then;var i=this;t&&(t=t.bind(i)),e&&(e=e.bind(i));var r=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?i:o.convert(Object.assign({},i),Promise.prototype),a=n.call(r,t,e);return o.convert(a,i.__proto__)},o.prototype.thenExternal=function(t,e){return Promise.prototype.then.call(this,t,e)},o.prototype.thenList=function(t){var e=this;return t.forEach(function(t){e=e.thenCore(t)}),e},o.prototype.catch=function(t){t&&(t=t.bind(this));var e=Promise.prototype.catch.call(this,t);return o.convert(e,this)},o.prototype.catchExternal=function(t){return Promise.prototype.catch.call(this,t)},o.prototype.error=function(t){return this.then(function(){throw new Error(t)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Fo.getPageSize=function(t,e,n){if("object"===(0,Ge.A)(t)){var i=t;t=i.orientation,e=i.unit||e,n=i.format||n}e=e||"mm",n=n||"a4",t=(""+(t||"P")).toLowerCase();var r,a=(""+n).toLowerCase(),s={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(e){case"pt":r=1;break;case"mm":r=72/25.4;break;case"cm":r=72/2.54;break;case"in":r=72;break;case"px":r=.75;break;case"pc":case"em":r=12;break;case"ex":r=6;break;default:throw"Invalid unit: "+e}var o,l=0,c=0;if(s.hasOwnProperty(a))l=s[a][1]/r,c=s[a][0]/r;else try{l=n[1],c=n[0]}catch(uo){throw new Error("Invalid format: "+n)}if("p"===t||"portrait"===t)t="p",c>l&&(o=c,c=l,l=o);else{if("l"!==t&&"landscape"!==t)throw"Invalid orientation: "+t;t="l",l>c&&(o=c,c=l,l=o)}return{width:c,height:l,unit:e,k:r,orientation:t}},t.html=function(t,e){(e=e||{}).callback=e.callback||function(){},e.html2canvas=e.html2canvas||{},e.html2canvas.canvas=e.html2canvas.canvas||this.canvas,e.jsPDF=e.jsPDF||this,e.fontFaces=e.fontFaces?e.fontFaces.map(Cl):null;var n=new o(e);return e.worker?n:n.from(t).doCallback()}}(Fo.API),Fo.API.addJS=function(t){return jl=t,this.internal.events.subscribe("postPutResources",function(){Ol=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ol+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Bl=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+jl+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==Ol&&void 0!==Bl&&this.internal.out("/Names <</JavaScript "+Ol+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=t.outline.render().split(/\r\n/),r=0;r<i.length;r++){var a=i[r],s=n.exec(a);if(null!=s){var o=s[1];t.internal.newObjectDeferredBegin(o,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,c=[];for(r=0;r<l;r++){var u=t.internal.newObject();c.push(u);var h=t.internal.getPageInfo(r+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var d=t.internal.newObject();for(t.internal.write("<< /Names [ "),r=0;r<c.length;r++)t.internal.write("(page_"+(r+1)+")"+c[r]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+d+" 0 R"),t.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(t,e,n){var i={title:e,options:n,children:[]};return null==t&&(t=this.root),t.children.push(i),i},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(e){e.id=t.internal.newObjectDeferred();for(var n=0;n<e.children.length;n++)this.genIds_r(e.children[n])},t.outline.renderRoot=function(t){this.objStart(t),this.line("/Type /Outlines"),t.children.length>0&&(this.line("/First "+this.makeRef(t.children[0])),this.line("/Last "+this.makeRef(t.children[t.children.length-1]))),this.line("/Count "+this.count_r({count:0},t)),this.objEnd()},t.outline.renderItems=function(e){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<e.children.length;i++){var r=e.children[i];this.objStart(r),this.line("/Title "+this.makeString(r.title)),this.line("/Parent "+this.makeRef(e)),i>0&&this.line("/Prev "+this.makeRef(e.children[i-1])),i<e.children.length-1&&this.line("/Next "+this.makeRef(e.children[i+1])),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1])));var a=this.count=this.count_r({count:0},r);if(a>0&&this.line("/Count "+a),r.options&&r.options.pageNumber){var s=t.internal.getPageInfo(r.options.pageNumber);this.line("/Dest ["+s.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var o=0;o<e.children.length;o++)this.renderItems(e.children[o])},t.outline.line=function(t){this.ctx.val+=t+"\r\n"},t.outline.makeRef=function(t){return t.id+" 0 R"},t.outline.makeString=function(e){return"("+t.internal.pdfEscape(e)+")"},t.outline.objStart=function(t){this.ctx.val+="\r\n"+t.id+" 0 obj\r\n<<\r\n"},t.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},t.outline.count_r=function(t,e){for(var n=0;n<e.children.length;n++)t.count++,this.count_r(t,e.children[n]);return t.count}}])}(Fo.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(t,n,i,r,a,s){var o,l=this.decode.DCT_DECODE,c=null;if("string"==typeof t||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,o=function(t){for(var n,i=256*t.charCodeAt(4)+t.charCodeAt(5),r=t.length,a={width:0,height:0,numcomponents:1},s=4;s<r;s+=2){if(s+=i,-1!==e.indexOf(t.charCodeAt(s+1))){n=256*t.charCodeAt(s+5)+t.charCodeAt(s+6),a={width:256*t.charCodeAt(s+7)+t.charCodeAt(s+8),height:n,numcomponents:t.charCodeAt(s+9)};break}i=256*t.charCodeAt(s+2)+t.charCodeAt(s+3)}return a}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),o.numcomponents){case 1:s=this.color_spaces.DEVICE_GRAY;break;case 4:s=this.color_spaces.DEVICE_CMYK;break;case 3:s=this.color_spaces.DEVICE_RGB}c={data:t,width:o.width,height:o.height,colorSpace:s,bitsPerComponent:8,filter:l,index:n,alias:i}}return c}}(Fo.API),Fo.API.processPNG=function(t,e,n,i){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var r,a=function(t,e){return new eo(t,e).decode()}(t,{checkCrc:!0}),s=a.width,o=a.height,l=a.channels,c=a.palette,u=a.depth;r=c&&1===l?function(t){for(var e=t.width,n=t.height,i=t.data,r=t.palette,a=t.depth,s=!1,o=[],l=[],c=void 0,u=!1,h=0,d=0;d<r.length;d++){var f=Cn(r[d],4),p=f[0],m=f[1],g=f[2],_=f[3];o.push(p,m,g),null!=_&&(0===_?(h++,l.length<1&&l.push(d)):_<255&&(u=!0))}if(u||h>1){s=!0,l=void 0;var y=e*n;c=new Uint8Array(y);for(var v=new DataView(i.buffer),b=0;b<y;b++){var x=Cn(r[nc(v,b,a)],4)[3];c[b]=x}}else 0===h&&(l=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:s?8:void 0,colorBytes:i,alphaBytes:c,needSMask:s,palette:o,mask:l}}(a):2===l||4===l?function(t){for(var e=t.data,n=t.width,i=t.height,r=t.channels,a=t.depth,s=2===r?"DeviceGray":"DeviceRGB",o=r-1,l=n*i,c=o,u=l*c,h=1*l,d=Math.ceil(u*a/8),f=Math.ceil(h*a/8),p=new Uint8Array(d),m=new Uint8Array(f),g=new DataView(e.buffer),_=new DataView(p.buffer),y=new DataView(m.buffer),v=!1,b=0;b<l;b++){for(var x=b*r,w=0;w<c;w++)ic(_,nc(g,x+w,a),b*c+w,a);var S=nc(g,x+c,a);S<(1<<a)-1&&(v=!0),ic(y,S,1*b,a)}return{colorSpace:s,colorsPerPixel:o,sMaskBitsPerComponent:v?a:void 0,colorBytes:p,alphaBytes:m,needSMask:v}}(a):function(t){var e=t.data,n=1===t.channels?"DeviceGray":"DeviceRGB";return{colorSpace:n,colorsPerPixel:"DeviceGray"===n?1:3,colorBytes:e instanceof Uint16Array?function(t){for(var e=t.length,n=new Uint8Array(2*e),i=new DataView(n.buffer,n.byteOffset,n.byteLength),r=0;r<e;r++)i.setUint16(2*r,t[r],!1);return n}(e):e,needSMask:!1}}(a);var h,d,f,p=r,m=p.colorSpace,g=p.colorsPerPixel,_=p.sMaskBitsPerComponent,y=p.colorBytes,v=p.alphaBytes,b=p.needSMask,x=p.palette,w=p.mask,S=null;return i!==Fo.API.image_compression.NONE?(S=function(t){var e;switch(t){case Fo.API.image_compression.FAST:e=11;break;case Fo.API.image_compression.MEDIUM:e=13;break;case Fo.API.image_compression.SLOW:e=14;break;default:e=12}return e}(i),h=this.decode.FLATE_DECODE,d="/Predictor ".concat(S," /Colors ").concat(g," /BitsPerComponent ").concat(u," /Columns ").concat(s),t=Xl(y,Math.ceil(s*g*u/8),g,u,i),b&&(f=Xl(v,Math.ceil(s*_/8),1,_,i))):(h=void 0,d=void 0,t=y,b&&(f=v)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(f&&this.__addimage__.isArrayBuffer(f)||this.__addimage__.isArrayBufferView(f))&&(f=this.__addimage__.arrayBufferToBinaryString(f)),{alias:n,data:t,index:e,filter:h,decodeParameters:d,transparency:w,palette:x,sMask:f,predictor:S,width:s,height:o,bitsPerComponent:u,sMaskBitsPerComponent:_,colorSpace:m}}},function(t){t.processGIF89A=function(e,n,i,r){var a=new ac(e),s=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new oc(100).encode(c,100);return t.processJPEG.call(this,u,n,i,r)},t.processGIF87A=t.processGIF89A}(Fo.API),lc.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:i,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},lc.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(n){ao.log("bit decode error:"+n)}},lc.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),n=e%4;for(t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,r=0;r<e;r++)for(var a=this.datav.getUint8(this.pos++,!0),s=i*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}0!==n&&(this.pos+=4-n)}},lc.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<t;r++){var a=this.datav.getUint8(this.pos++,!0),s=i*this.width*4+2*r*4,o=a>>4,l=15&a,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*r+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}0!==e&&(this.pos+=4-e)}},lc.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<this.width;i++){var r=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+4*i;if(r<this.palette.length){var s=this.palette[r];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}0!==t&&(this.pos+=4-t)}},lc.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,l=(a>>10&e)/e*255|0,c=a>>15?255:0,u=i*this.width*4+4*r;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=t}},lc.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),n=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&e)/e*255|0,l=(s>>5&n)/n*255|0,c=(s>>11)/e*255|0,u=r*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=t}},lc.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*n;this.data[s]=a,this.data[s+1]=r,this.data[s+2]=i,this.data[s+3]=255}this.pos+=this.width%4}},lc.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*n;this.data[o]=a,this.data[o+1]=r,this.data[o+2]=i,this.data[o+3]=s}},lc.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,n,i,r){var a=new lc(e,!1),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},c=new oc(100).encode(l,100);return t.processJPEG.call(this,c,n,i,r)}}(Fo.API),cc.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,n,i,r){var a=new cc(e),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},c=new oc(100).encode(l,100);return t.processJPEG.call(this,c,n,i,r)}}(Fo.API),Fo.API.processRGBA=function(t,e,n){for(var i=t.data,r=i.length,a=new Uint8Array(r/4*3),s=new Uint8Array(r/4),o=0,l=0,c=0;c<r;c+=4){var u=i[c],h=i[c+1],d=i[c+2],f=i[c+3];a[o++]=u,a[o++]=h,a[o++]=d,s[l++]=f}var p=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:p,index:e,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Fo.API.setLanguage=function(t){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ul=Fo.API,Gl=Ul.getCharWidthsArray=function(t,e){var n,i,r=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:r.metadata.Unicode.kerning,u=c.fof?c.fof:1,h=!1!==e.doKerning,d=0,f=t.length,p=0,m=o[0]||l,g=[];for(n=0;n<f;n++)i=t.charCodeAt(n),"function"==typeof r.metadata.widthOfString?g.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(i))+s*(1e3/a)||0)/1e3):(d=h&&"object"===(0,Ge.A)(c[i])&&!isNaN(parseInt(c[i][p],10))?c[i][p]/u:0,g.push((o[i]||m)/l+d)),p=i;return g},ql=Ul.getStringUnitWidth=function(t,e){var n=(e=e||{}).fontSize||this.internal.getFontSize(),i=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return Ul.processArabic&&(t=Ul.processArabic(t)),"function"==typeof i.metadata.widthOfString?i.metadata.widthOfString(t,n,r)/n:Gl.apply(this,arguments).reduce(function(t,e){return t+e},0)},Vl=function(t,e,n,i){for(var r=[],a=0,s=t.length,o=0;a!==s&&o+e[a]<n;)o+=e[a],a++;r.push(t.slice(0,a));var l=a;for(o=0;a!==s;)o+e[a]>i&&(r.push(t.slice(l,a)),o=0,l=a),o+=e[a],a++;return l!==a&&r.push(t.slice(l,a)),r},Zl=function(t,e,n){n||(n={});var i,r,a,s,o,l,c,u=[],h=[u],d=n.textIndent||0,f=0,p=0,m=t.split(" "),g=Gl.apply(this,[" ",n])[0];if(l=-1===n.lineIndent?m[0].length+2:n.lineIndent||0){var _=Array(l).join(" "),y=[];m.map(function(t){(t=t.split(/\s*\n/)).length>1?y=y.concat(t.map(function(t,e){return(e&&t.length?"\n":"")+t})):y.push(t[0])}),m=y,l=ql.apply(this,[_,n])}for(a=0,s=m.length;a<s;a++){var v=0;if(i=m[a],l&&"\n"==i[0]&&(i=i.substr(1),v=1),d+f+(p=(r=Gl.apply(this,[i,n])).reduce(function(t,e){return t+e},0))>e||v){if(p>e){for(o=Vl.apply(this,[i,r,e-(d+f),e]),u.push(o.shift()),u=[o.pop()];o.length;)h.push([o.shift()]);p=r.slice(i.length-(u[0]?u[0].length:0)).reduce(function(t,e){return t+e},0)}else u=[i];h.push(u),d=p+l,f=g}else u.push(i),d+=f+p,f=g}return c=l?function(t,e){return(e?_:"")+t.join(" ")}:function(t){return t.join(" ")},h.map(c)},Ul.splitTextToSize=function(t,e,n){var i,r=(n=n||{}).fontSize||this.internal.getFontSize(),a=function(t){if(t.widths&&t.kerning)return{widths:t.widths,kerning:t.kerning};var e=this.internal.getFont(t.fontName,t.fontStyle),n="Unicode";return e.metadata[n]?{widths:e.metadata[n].widths||{0:1},kerning:e.metadata[n].kerning||{}}:{font:e.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);i=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/r;a.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/r:0,a.lineIndent=n.lineIndent;var o,l,c=[];for(o=0,l=i.length;o<l;o++)c=c.concat(Zl.apply(this,[i[o],s,a]));return c},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="0123456789abcdef",n="klmnopqrstuvwxyz",i={},r={},a=0;a<16;a++)i[n[a]]=e[a],r[e[a]]=n[a];var s=function(t){return"0x"+parseInt(t,10).toString(16)},o=t.__fontmetrics__.compress=function(t){var e,n,i,a,l=["{"];for(var c in t){if(e=t[c],isNaN(parseInt(c,10))?n="'"+c+"'":(c=parseInt(c,10),n=(n=s(c).slice(2)).slice(0,-1)+r[n.slice(-1)]),"number"==typeof e)e<0?(i=s(e).slice(3),a="-"):(i=s(e).slice(2),a=""),i=a+i.slice(0,-1)+r[i.slice(-1)];else{if("object"!==(0,Ge.A)(e))throw new Error("Don't know what to do with value type "+(0,Ge.A)(e)+".");i=o(e)}l.push(n+i)}return l.push("}"),l.join("")},l=t.__fontmetrics__.uncompress=function(t){if("string"!=typeof t)throw new Error("Invalid argument passed to uncompress.");for(var e,n,r,a,s={},o=1,l=s,c=[],u="",h="",d=t.length-1,f=1;f<d;f+=1)"'"==(a=t[f])?e?(r=e.join(""),e=void 0):e=[]:e?e.push(a):"{"==a?(c.push([l,r]),l={},r=void 0):"}"==a?((n=c.pop())[0][n[1]]=l,r=void 0,l=n[0]):"-"==a?o=-1:void 0===r?i.hasOwnProperty(a)?(u+=i[a],r=parseInt(u,16)*o,o=1,u=""):u+=a:i.hasOwnProperty(a)?(h+=i[a],l[r]=parseInt(h,16)*o,o=1,r=void 0,h=""):h+=a;return s},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(t){var e=t.font,n=h.Unicode[e.postScriptName];n&&(e.metadata.Unicode={},e.metadata.Unicode.widths=n.widths,e.metadata.Unicode.kerning=n.kerning);var i=u.Unicode[e.postScriptName];i&&(e.metadata.Unicode.encoding=i,e.encoding=i.codePages[0])}])}(Fo.API),function(t){var e=function(t){for(var e=t.length,n=new Uint8Array(e),i=0;i<e;i++)n[i]=t.charCodeAt(i);return n};t.API.events.push(["addFont",function(n){var i=void 0,r=n.font,a=n.instance;if(!r.isStandardFont){if(void 0===a)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if("string"!=typeof(i=!1===a.existsFileInVFS(r.postScriptName)?a.loadFile(r.postScriptName):a.getFileFromVFS(r.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");!function(n,i){i=/^\x00\x01\x00\x00/.test(i)?e(i):e(ho(i)),n.metadata=t.API.TTFFont.open(i),n.metadata.Unicode=n.metadata.Unicode||{encoding:{},kerning:{},widths:[]},n.metadata.glyIdsUsed=[0]}(r,i)}}])}(Fo),Fo.API.addSvgAsImage=function(t,e,i,r,a,s,o,l){if(isNaN(e)||isNaN(i))throw ao.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(a))throw ao.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(io.canvg?Promise.resolve(io.canvg):n.e(455).then(n.bind(n,8455))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t}).then(function(e){return e.fromString(u,t,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(t){return t.render(h)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),e,i,r,a,o,l)})},Fo.API.putTotalPages=function(t){var e,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),n=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var r=0;r<this.internal.pages[i].length;r++)this.internal.pages[i][r]=this.internal.pages[i][r].replace(e,n);return this},Fo.API.viewerPreferences=function(t,e){var n;t=t||{},e=e||!1;var i,r,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,h=0;function d(t,e){var n,i=!1;for(n=0;n<t.length;n+=1)t[n]===e&&(i=!0);return i}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,"reset"===t||!0===e){var f=o.length;for(h=0;h<f;h+=1)n[o[h]].value=n[o[h]].defaultValue,n[o[h]].explicitSet=!1}if("object"===(0,Ge.A)(t))for(r in t)if(a=t[r],d(o,r)&&void 0!==a){if("boolean"===n[r].type&&"boolean"==typeof a)n[r].value=a;else if("name"===n[r].type&&d(n[r].valueSet,a))n[r].value=a;else if("integer"===n[r].type&&Number.isInteger(a))n[r].value=a;else if("array"===n[r].type){for(c=0;c<a.length;c+=1)if(i=!0,1===a[c].length&&"number"==typeof a[c][0])l.push(String(a[c]-1));else if(a[c].length>1){for(u=0;u<a[c].length;u+=1)"number"!=typeof a[c][u]&&(i=!1);!0===i&&l.push([a[c][0]-1,a[c][1]-1].join(" "))}n[r].value="["+l.join(" ")+"]"}else n[r].value=n[r].defaultValue;n[r].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var t,e=[];for(t in n)!0===n[t].explicitSet&&("name"===n[t].type?e.push("/"+t+" /"+n[t].value):e.push("/"+t+" "+n[t].value));0!==e.length&&this.internal.write("/ViewerPreferences\n<<\n"+e.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(t){var e=function(){var t='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',e=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(t)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),r=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),a=unescape(encodeURIComponent("</x:xmpmeta>")),s=n.length+i.length+r.length+e.length+a.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+s+" >>"),this.internal.write("stream"),this.internal.write(e+n+i+r+a),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(t,i){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:t,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",e)),this}}(Fo.API),function(t){var e=t.API,n=e.pdfEscape16=function(t,e){for(var n,i=e.metadata.Unicode.widths,r=["","0","00","000","0000"],a=[""],s=0,o=t.length;s<o;++s){if(n=e.metadata.characterToGlyph(t.charCodeAt(s)),e.metadata.glyIdsUsed.push(n),e.metadata.toUnicode[n]=t.charCodeAt(s),-1==i.indexOf(n)&&(i.push(n),i.push([parseInt(e.metadata.widthOfGlyph(n),10)])),"0"==n)return a.join("");n=n.toString(16),a.push(r[4-n.length],n)}return a.join("")},i=function(t){var e,n,i,r,a,s,o;for(a="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",i=[],s=0,o=(n=Object.keys(t).sort(function(t,e){return t-e})).length;s<o;s++)e=n[s],i.length>=100&&(a+="\n"+i.length+" beginbfchar\n"+i.join("\n")+"\nendbfchar",i=[]),void 0!==t[e]&&null!==t[e]&&"function"==typeof t[e].toString&&(r=("0000"+t[e].toString(16)).slice(-4),e=("0000"+(+e).toString(16)).slice(-4),i.push("<"+e+"><"+r+">"));return i.length&&(a+="\n"+i.length+" beginbfchar\n"+i.join("\n")+"\nendbfchar\n"),a+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};e.events.push(["putFont",function(e){!function(e){var n=e.font,r=e.out,a=e.newObject,s=e.putStream;if(n.metadata instanceof t.API.TTFFont&&"Identity-H"===n.encoding){for(var o=n.metadata.Unicode.widths,l=n.metadata.subset.encode(n.metadata.glyIdsUsed,1),c="",u=0;u<l.length;u++)c+=String.fromCharCode(l[u]);var h=a();s({data:c,addLength1:!0,objectId:h}),r("endobj");var d=a();s({data:i(n.metadata.toUnicode),addLength1:!0,objectId:d}),r("endobj");var f=a();r("<<"),r("/Type /FontDescriptor"),r("/FontName /"+Io(n.fontName)),r("/FontFile2 "+h+" 0 R"),r("/FontBBox "+t.API.PDFObject.convert(n.metadata.bbox)),r("/Flags "+n.metadata.flags),r("/StemV "+n.metadata.stemV),r("/ItalicAngle "+n.metadata.italicAngle),r("/Ascent "+n.metadata.ascender),r("/Descent "+n.metadata.decender),r("/CapHeight "+n.metadata.capHeight),r(">>"),r("endobj");var p=a();r("<<"),r("/Type /Font"),r("/BaseFont /"+Io(n.fontName)),r("/FontDescriptor "+f+" 0 R"),r("/W "+t.API.PDFObject.convert(o)),r("/CIDToGIDMap /Identity"),r("/DW 1000"),r("/Subtype /CIDFontType2"),r("/CIDSystemInfo"),r("<<"),r("/Supplement 0"),r("/Registry (Adobe)"),r("/Ordering ("+n.encoding+")"),r(">>"),r(">>"),r("endobj"),n.objectNumber=a(),r("<<"),r("/Type /Font"),r("/Subtype /Type0"),r("/ToUnicode "+d+" 0 R"),r("/BaseFont /"+Io(n.fontName)),r("/Encoding /"+n.encoding),r("/DescendantFonts ["+p+" 0 R]"),r(">>"),r("endobj"),n.isAlreadyPutted=!0}}(e)}]),e.events.push(["putFont",function(e){!function(e){var n=e.font,r=e.out,a=e.newObject,s=e.putStream;if(n.metadata instanceof t.API.TTFFont&&"WinAnsiEncoding"===n.encoding){for(var o=n.metadata.rawData,l="",c=0;c<o.length;c++)l+=String.fromCharCode(o[c]);var u=a();s({data:l,addLength1:!0,objectId:u}),r("endobj");var h=a();s({data:i(n.metadata.toUnicode),addLength1:!0,objectId:h}),r("endobj");var d=a();r("<<"),r("/Descent "+n.metadata.decender),r("/CapHeight "+n.metadata.capHeight),r("/StemV "+n.metadata.stemV),r("/Type /FontDescriptor"),r("/FontFile2 "+u+" 0 R"),r("/Flags 96"),r("/FontBBox "+t.API.PDFObject.convert(n.metadata.bbox)),r("/FontName /"+Io(n.fontName)),r("/ItalicAngle "+n.metadata.italicAngle),r("/Ascent "+n.metadata.ascender),r(">>"),r("endobj"),n.objectNumber=a();for(var f=0;f<n.metadata.hmtx.widths.length;f++)n.metadata.hmtx.widths[f]=parseInt(n.metadata.hmtx.widths[f]*(1e3/n.metadata.head.unitsPerEm));r("<</Subtype/TrueType/Type/Font/ToUnicode "+h+" 0 R/BaseFont/"+Io(n.fontName)+"/FontDescriptor "+d+" 0 R/Encoding/"+n.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(n.metadata.hmtx.widths)+">>"),r("endobj"),n.isAlreadyPutted=!0}}(e)}]);var r=function(t){var e,i=t.text||"",r=t.x,a=t.y,s=t.options||{},o=t.mutex||{},l=o.pdfEscape,c=o.activeFontKey,u=o.fonts,h=c,d="",f=0,p="",m=u[h].encoding;if("Identity-H"!==u[h].encoding)return{text:i,x:r,y:a,options:s,mutex:o};for(p=i,h=c,Array.isArray(i)&&(p=i[0]),f=0;f<p.length;f+=1)u[h].metadata.hasOwnProperty("cmap")&&(e=u[h].metadata.cmap.unicode.codeMap[p[f].charCodeAt(0)]),e||p[f].charCodeAt(0)<256&&u[h].metadata.hasOwnProperty("Unicode")?d+=p[f]:d+="";var g="";return parseInt(h.slice(1))<14||"WinAnsiEncoding"===m?g=l(d,h).split("").map(function(t){return t.charCodeAt(0).toString(16)}).join(""):"Identity-H"===m&&(g=n(d,u[h])),o.isHex=!0,{text:g,x:r,y:a,options:s,mutex:o}};e.events.push(["postProcessText",function(t){var e=t.text||"",n=[],i={text:e,x:t.x,y:t.y,options:t.options,mutex:t.mutex};if(Array.isArray(e)){var a=0;for(a=0;a<e.length;a+=1)Array.isArray(e[a])&&3===e[a].length?n.push([r(Object.assign({},i,{text:e[a][0]})).text,e[a][1],e[a][2]]):n.push(r(Object.assign({},i,{text:e[a]})).text);t.text=n}else t.text=r(Object.assign({},i,{text:e})).text}])}(Fo),function(t){var e=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(t){return e.call(this),void 0!==this.internal.vFS[t]},t.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},t.getFileFromVFS=function(t){return e.call(this),void 0!==this.internal.vFS[t]?this.internal.vFS[t]:null}}(Fo.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(t){var n,i,r,a,s,o,l,c=e,u=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],d={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},f={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,_=0;this.__bidiEngine__={};var y=function(t){var e=t.charCodeAt(),n=e>>8,i=f[n];return void 0!==i?c[256*i+(255&e)]:252===n||253===n?"AL":m.test(n)?"L":8===n?"R":"N"},v=function(t){for(var e,n=0;n<t.length;n++){if("L"===(e=y(t.charAt(n))))return!1;if("R"===e)return!0}return!1},b=function(t,e,s,o){var l,c,u,h,d=e[o];switch(d){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(d="AN");break;case"AL":g=!0,d="R";break;case"WS":case"BN":d="N";break;case"CS":o<1||o+1>=e.length||"EN"!==(l=s[o-1])&&"AN"!==l||"EN"!==(c=e[o+1])&&"AN"!==c?d="N":g&&(c="AN"),d=c===l?c:"N";break;case"ES":d="EN"===(l=o>0?s[o-1]:"B")&&o+1<e.length&&"EN"===e[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===s[o-1]){d="EN";break}if(g){d="N";break}for(u=o+1,h=e.length;u<h&&"ET"===e[u];)u++;d=u<h&&"EN"===e[u]?"EN":"N";break;case"NSM":if(r&&!a){for(h=e.length,u=o+1;u<h&&"NSM"===e[u];)u++;if(u<h){var f=t[o],p=f>=1425&&f<=2303||64286===f;if(l=e[u],p&&("R"===l||"AL"===l)){d="R";break}}}d=o<1||"B"===(l=e[o-1])?"N":s[o-1];break;case"B":g=!1,n=!0,d=_;break;case"S":i=!0,d="N"}return d},x=function(t,e,n){var i=t.split("");return n&&w(i,n,{hiLevel:_}),i.reverse(),e&&e.reverse(),i.join("")},w=function(t,e,r){var a,s,o,l,c,f=-1,p=t.length,m=0,v=[],x=_?h:u,w=[];for(g=!1,n=!1,i=!1,s=0;s<p;s++)w[s]=y(t[s]);for(o=0;o<p;o++){if(c=m,v[o]=b(t,w,v,o),a=240&(m=x[c][d[v[o]]]),m&=15,e[o]=l=x[m][5],a>0)if(16===a){for(s=f;s<o;s++)e[s]=1;f=-1}else f=-1;if(x[m][6])-1===f&&(f=o);else if(f>-1){for(s=f;s<o;s++)e[s]=l;f=-1}"B"===w[o]&&(e[o]=0),r.hiLevel|=l}i&&function(t,e,n){for(var i=0;i<n;i++)if("S"===t[i]){e[i]=_;for(var r=i-1;r>=0&&"WS"===t[r];r--)e[r]=_}}(w,e,p)},S=function(t,e,i,r,a){if(!(a.hiLevel<t)){if(1===t&&1===_&&!n)return e.reverse(),void(i&&i.reverse());for(var s,o,l,c,u=e.length,h=0;h<u;){if(r[h]>=t){for(l=h+1;l<u&&r[l]>=t;)l++;for(c=h,o=l-1;c<o;c++,o--)s=e[c],e[c]=e[o],e[o]=s,i&&(s=i[c],i[c]=i[o],i[o]=s);h=l}h++}}},P=function(t,e,n){var i=t.split(""),r={hiLevel:_};return n||(n=[]),w(i,n,r),function(t,e,n){if(0!==n.hiLevel&&l)for(var i,r=0;r<t.length;r++)1===e[r]&&(i=p.indexOf(t[r]))>=0&&(t[r]=p[i+1])}(i,n,r),S(2,i,e,n,r),S(1,i,e,n,r),i.join("")};return this.__bidiEngine__.doBidiReorder=function(t,e,n){if(function(t,e){if(e)for(var n=0;n<t.length;n++)e[n]=n;void 0===a&&(a=v(t)),void 0===o&&(o=v(t))}(t,e),r||!s||o)if(r&&s&&a^o)_=a?1:0,t=x(t,e,n);else if(!r&&s&&o)_=a?1:0,t=P(t,e,n),t=x(t,e);else if(!r||a||s||o){if(r&&!s&&a^o)t=x(t,e),a?(_=0,t=P(t,e,n)):(_=1,t=P(t,e,n),t=x(t,e));else if(r&&a&&!s&&o)_=1,t=P(t,e,n),t=x(t,e);else if(!r&&!s&&a^o){var i=l;a?(_=1,t=P(t,e,n),_=0,l=!1,t=P(t,e,n),l=i):(_=0,t=P(t,e,n),t=x(t,e),_=1,l=!1,t=P(t,e,n),l=i,t=x(t,e))}}else _=0,t=P(t,e,n);else _=a?1:0,t=P(t,e,n);return t},this.__bidiEngine__.setOptions=function(t){t&&(r=t.isInputVisual,s=t.isOutputVisual,a=t.isInputRtl,o=t.isOutputRtl,l=t.isSymmetricSwapping)},this.__bidiEngine__.setOptions(t),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(t){var e=t.text;t.x,t.y;var i=t.options||{};t.mutex,i.lang;var r=[];if(i.isInputVisual="boolean"!=typeof i.isInputVisual||i.isInputVisual,n.setOptions(i),"[object Array]"===Object.prototype.toString.call(e)){var a=0;for(r=[],a=0;a<e.length;a+=1)"[object Array]"===Object.prototype.toString.call(e[a])?r.push([n.doBidiReorder(e[a][0]),e[a][1],e[a][2]]):r.push([n.doBidiReorder(e[a])]);t.text=r}else t.text=n.doBidiReorder(e);n.setOptions({isInputVisual:!0})}])}(Fo),Fo.API.TTFFont=function(){function t(t){var e;if(this.rawData=t,e=this.contents=new hc(t),this.contents.pos=4,"ttcf"===e.readString(4))throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new Cc(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new dc(this.contents),this.head=new mc(this),this.name=new wc(this),this.cmap=new _c(this),this.toUnicode={},this.hhea=new yc(this),this.maxp=new Sc(this),this.hmtx=new Pc(this),this.post=new bc(this),this.os2=new vc(this),this.loca=new Tc(this),this.glyf=new Ac(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var t,e,n,i,r;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var e,n,i,r;for(r=[],e=0,n=(i=this.bbox).length;e<n;e++)t=i[e],r.push(Math.round(t*this.scaleFactor));return r}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(e=i>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(r=this.familyClass)||2===r||3===r||4===r||5===r||7===r,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(t){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[t]:void 0)||0},t.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},t.prototype.widthOfString=function(t,e,n){var i,r,a,s;for(a=0,r=0,s=(t=""+t).length;0<=s?r<s:r>s;r=0<=s?++r:--r)i=t.charCodeAt(r),a+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/e)||0;return a*(e/1e3)},t.prototype.lineHeight=function(t,e){var n;return null==e&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},t}();var uc,hc=function(){function t(t){this.data=null!=t?t:[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(t){return this.data[this.pos++]=t},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},t.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},t.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},t.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},t.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(t){var e,n,i;for(i=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)i.push(this.writeByte(t.charCodeAt(e)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(t){return this.writeInt16(t)},t.prototype.readLongLong=function(){var t,e,n,i,r,a,s,o;return t=this.readByte(),e=this.readByte(),n=this.readByte(),i=this.readByte(),r=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^r)+65536*(255^a)+256*(255^s)+(255^o)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*i+16777216*r+65536*a+256*s+o},t.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(t){return this.writeInt32(t)},t.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},t.prototype.write=function(t){var e,n,i,r;for(r=[],n=0,i=t.length;n<i;n++)e=t[n],r.push(this.writeByte(e));return r},t}(),dc=function(){var t;function e(t){var e,n,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)e={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[e.tag]=e}return e.prototype.encode=function(e){var n,i,r,a,s,o,l,c,u,h,d,f,p;for(p in d=Object.keys(e).length,o=Math.log(2),u=16*Math.floor(Math.log(d)/o),a=Math.floor(u/o),c=16*d-u,(i=new hc).writeInt(this.scalarType),i.writeShort(d),i.writeShort(u),i.writeShort(a),i.writeShort(c),r=16*d,l=i.pos+r,s=null,f=[],e)for(h=e[p],i.writeString(p),i.writeInt(t(h)),i.writeInt(l),i.writeInt(h.length),f=f.concat(h),"head"===p&&(s=l),l+=h.length;l%4;)f.push(0),l++;return i.write(f),n=2981146554-t(i.data),i.pos=s+8,i.writeUInt32(n),i.data},t=function(t){var e,n,i,r;for(t=Mc.call(t);t.length%4;)t.push(0);for(i=new hc(t),n=0,e=0,r=t.length;e<r;e=e+=4)n+=i.readUInt32();return 4294967295&n},e}(),fc={}.hasOwnProperty,pc=function(t,e){for(var n in e)fc.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};uc=function(){function t(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var mc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="head",t.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},t.prototype.encode=function(t){var e;return(e=new hc).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},t}(),gc=function(){function t(t,e){var n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),u=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=t.readByte();break;case 4:for(d=t.readUInt16(),h=d/2,t.pos+=6,r=function(){var e,n;for(n=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)n.push(t.readUInt16());return n}(),t.pos+=2,p=function(){var e,n;for(n=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)n.push(t.readUInt16());return n}(),l=function(){var e,n;for(n=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)n.push(t.readUInt16());return n}(),c=function(){var e,n;for(n=[],o=e=0;0<=h?e<h:e>h;o=0<=h?++e:--e)n.push(t.readUInt16());return n}(),i=(this.length-t.pos+this.offset)/2,s=function(){var e,n;for(n=[],o=e=0;0<=i?e<i:e>i;o=0<=i?++e:--e)n.push(t.readUInt16());return n}(),o=g=0,y=r.length;g<y;o=++g)for(m=r[o],n=_=f=p[o];f<=m?_<=m:_>=m;n=f<=m?++_:--_)0===c[o]?a=n+l[o]:0!==(a=s[c[o]/2+(n-f)-(h-o)]||0)&&(a+=l[o]),this.codeMap[n]=65535&a}t.pos=u}return t.encode=function(t,e){var n,i,r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v,b,x,w,S,P,M,A,k,E,T,C,I,L,z,N,D,R,F,O,B,j,U,G,q,V,Z,W,H;switch(T=new hc,a=Object.keys(t).sort(function(t,e){return t-e}),e){case"macroman":for(p=0,m=function(){var t=[];for(f=0;f<256;++f)t.push(0);return t}(),_={0:0},r={},C=0,N=a.length;C<N;C++)null==_[V=t[i=a[C]]]&&(_[V]=++p),r[i]={old:t[i],new:_[t[i]]},m[i]=_[t[i]];return T.writeUInt16(1),T.writeUInt16(0),T.writeUInt32(12),T.writeUInt16(0),T.writeUInt16(262),T.writeUInt16(0),T.write(m),{charMap:r,subtable:T.data,maxGlyphID:p+1};case"unicode":for(k=[],u=[],y=0,_={},n={},g=l=null,I=0,D=a.length;I<D;I++)null==_[b=t[i=a[I]]]&&(_[b]=++y),n[i]={old:b,new:_[b]},s=_[b]-i,null!=g&&s===l||(g&&u.push(g),k.push(i),l=s),g=i;for(g&&u.push(g),u.push(65535),k.push(65535),M=2*(P=k.length),S=2*Math.pow(Math.log(P)/Math.LN2,2),h=Math.log(S/2)/Math.LN2,w=2*P-S,o=[],x=[],d=[],f=L=0,R=k.length;L<R;f=++L){if(A=k[f],c=u[f],65535===A){o.push(0),x.push(0);break}if(A-(E=n[A].new)>=32768)for(o.push(0),x.push(2*(d.length+P-f)),i=z=A;A<=c?z<=c:z>=c;i=A<=c?++z:--z)d.push(n[i].new);else o.push(E-A),x.push(0)}for(T.writeUInt16(3),T.writeUInt16(1),T.writeUInt32(12),T.writeUInt16(4),T.writeUInt16(16+8*P+2*d.length),T.writeUInt16(0),T.writeUInt16(M),T.writeUInt16(S),T.writeUInt16(h),T.writeUInt16(w),G=0,F=u.length;G<F;G++)i=u[G],T.writeUInt16(i);for(T.writeUInt16(0),q=0,O=k.length;q<O;q++)i=k[q],T.writeUInt16(i);for(Z=0,B=o.length;Z<B;Z++)s=o[Z],T.writeUInt16(s);for(W=0,j=x.length;W<j;W++)v=x[W],T.writeUInt16(v);for(H=0,U=d.length;H<U;H++)p=d[H],T.writeUInt16(p);return{charMap:n,subtable:T.data,maxGlyphID:y+1}}},t}(),_c=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="cmap",t.prototype.parse=function(t){var e,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)e=new gc(t,this.offset),this.tables.push(e),e.isUnicode&&null==this.unicode&&(this.unicode=e);return!0},t.encode=function(t,e){var n,i;return null==e&&(e="macroman"),n=gc.encode(t,e),(i=new hc).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},t}(),yc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="hhea",t.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},t}(),vc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="OS/2",t.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var e,n;for(n=[],e=0;e<10;++e)n.push(t.readByte());return n}(),this.charRange=function(){var e,n;for(n=[],e=0;e<4;++e)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var e,n;for(n=[],e=0;e<2;e=++e)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},t}(),bc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="post",t.prototype.parse=function(t){var e,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var r;for(n=t.readUInt16(),this.glyphNameIndex=[],r=0;0<=n?r<n:r>n;r=0<=n?++r:--r)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)e=t.readByte(),i.push(this.names.push(t.readString(e)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var e,n,i;for(i=[],r=e=0,n=this.file.maxp.numGlyphs;0<=n?e<n:e>n;r=0<=n?++e:--e)i.push(t.readUInt32());return i}.call(this)}},t}(),xc=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},wc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="name",t.prototype.parse=function(t){var e,n,i,r,a,s,o,l,c,u,h;for(t.pos=this.offset,t.readShort(),e=t.readShort(),s=t.readShort(),n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+s+t.readShort()});for(o={},r=c=0,u=n.length;c<u;r=++c)i=n[r],t.pos=i.offset,l=t.readString(i.length),a=new xc(l,i),null==o[h=i.nameID]&&(o[h]=[]),o[i.nameID].push(a);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(ho){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},t}(),Sc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="maxp",t.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},t}(),Pc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="hmtx",t.prototype.parse=function(t){var e,n,i,r,a,s,o;for(t.pos=this.offset,this.metrics=[],e=0,s=this.file.hhea.numberOfMetrics;0<=s?e<s:e>s;e=0<=s?++e:--e)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var n,r;for(r=[],e=n=0;0<=i?n<i:n>i;e=0<=i?++n:--n)r.push(t.readInt16());return r}(),this.widths=function(){var t,e,n,i;for(i=[],t=0,e=(n=this.metrics).length;t<e;t++)r=n[t],i.push(r.advance);return i}.call(this),n=this.widths[this.widths.length-1],o=[],e=a=0;0<=i?a<i:a>i;e=0<=i?++a:--a)o.push(this.widths.push(n));return o},t.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},t}(),Mc=[].slice,Ac=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(t){var e,n,i,r,a,s,o,l,c,u;return t in this.cache?this.cache[t]:(r=this.file.loca,e=this.file.contents,n=r.indexOf(t),0===(i=r.lengthOf(t))?this.cache[t]=null:(e.pos=this.offset+n,a=(s=new hc(e.read(i))).readShort(),l=s.readShort(),u=s.readShort(),o=s.readShort(),c=s.readShort(),this.cache[t]=-1===a?new Ec(s,l,u,o,c):new kc(s,a,l,u,o,c),this.cache[t]))},t.prototype.encode=function(t,e,n){var i,r,a,s,o;for(a=[],r=[],s=0,o=e.length;s<o;s++)i=t[e[s]],r.push(a.length),i&&(a=a.concat(i.encode(n)));return r.push(a.length),{table:a,offsets:r}},t}(),kc=function(){function t(t,e,n,i,r,a){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=i,this.xMax=r,this.yMax=a,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),Ec=function(){function t(t,e,n,i,r){var a,s;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=i,this.yMax=r,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;s=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&s;)a.pos+=1&s?4:2,128&s?a.pos+=8:64&s?a.pos+=4:8&s&&(a.pos+=2)}return t.prototype.encode=function(){var t,e,n;for(e=new hc(Mc.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},t}(),Tc=function(){function t(){return t.__super__.constructor.apply(this,arguments)}return pc(t,uc),t.prototype.tag="loca",t.prototype.parse=function(t){var e,n;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=0===e?function(){var e,i;for(i=[],n=0,e=this.length;n<e;n+=2)i.push(2*t.readUInt16());return i}.call(this):function(){var e,i;for(i=[],n=0,e=this.length;n<e;n+=4)i.push(t.readUInt32());return i}.call(this)},t.prototype.indexOf=function(t){return this.offsets[t]},t.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},t.prototype.encode=function(t,e){for(var n=new Uint32Array(this.offsets.length),i=0,r=0,a=0;a<n.length;++a)if(n[a]=i,r<e.length&&e[r]==a){++r,n[a]=i;var s=this.offsets[a],o=this.offsets[a+1]-s;o>0&&(i+=o)}for(var l=new Array(4*n.length),c=0;c<n.length;++c)l[4*c+3]=255&n[c],l[4*c+2]=(65280&n[c])>>8,l[4*c+1]=(16711680&n[c])>>16,l[4*c]=(4278190080&n[c])>>24;return l},t}(),Cc=function(){function t(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var t,e,n,i,r;for(e in i=this.font.cmap.tables[0].codeMap,t={},r=this.subset)n=r[e],t[e]=i[n];return t},t.prototype.glyphsFor=function(t){var e,n,i,r,a,s,o;for(i={},a=0,s=t.length;a<s;a++)i[r=t[a]]=this.font.glyf.glyphFor(r);for(r in e=[],i)(null!=(n=i[r])?n.compound:void 0)&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(r in o=this.glyphsFor(e))n=o[r],i[r]=n;return i},t.prototype.encode=function(t,e){var n,i,r,a,s,o,l,c,u,h,d,f,p,m,g;for(i in n=_c.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(t),d={0:0},g=n.charMap)d[(o=g[i]).old]=o.new;for(f in h=n.maxGlyphID,a)f in d||(d[f]=h++);return c=function(t){var e,n;for(e in n={},t)n[t[e]]=e;return n}(d),u=Object.keys(c).sort(function(t,e){return t-e}),p=function(){var t,e,n;for(n=[],t=0,e=u.length;t<e;t++)s=u[t],n.push(c[s]);return n}(),r=this.font.glyf.encode(a,p,d),l=this.font.loca.encode(r.offsets,p),m={cmap:this.font.cmap.raw(),glyf:r.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(m["OS/2"]=this.font.os2.raw()),this.font.directory.encode(m)},t}();Fo.API.PDFObject=function(){var t;function e(){}return t=function(t,e){return(Array(e+1).join("0")+t).slice(-e)},e.convert=function(n){var i,r,a,s;if(Array.isArray(n))return"["+function(){var t,r,a;for(a=[],t=0,r=n.length;t<r;t++)i=n[t],a.push(e.convert(i));return a}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n?n.isString:void 0)return"("+n+")";if(n instanceof Date)return"(D:"+t(n.getUTCFullYear(),4)+t(n.getUTCMonth(),2)+t(n.getUTCDate(),2)+t(n.getUTCHours(),2)+t(n.getUTCMinutes(),2)+t(n.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(n)){for(r in a=["<<"],n)s=n[r],a.push("/"+r+" "+e.convert(s));return a.push(">>"),a.join("\n")}return""+n},e}();var Ic=6378137,Lc=.0066943799901413165,zc=484813681109536e-20,Nc=Math.PI/2,Dc=1e-10,Rc=.017453292519943295,Fc=57.29577951308232,Oc=Math.PI/4,Bc=2*Math.PI,jc=3.14159265359,Uc={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const Gc=Uc,qc={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var Vc=/[\s_\-\/\(\)]/g;function Zc(t,e){if(t[e])return t[e];for(var n,i=Object.keys(t),r=e.toLowerCase().replace(Vc,""),a=-1;++a<i.length;)if((n=i[a]).toLowerCase().replace(Vc,"")===r)return t[n]}function Wc(t){var e,n,i,r={},a=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var n=e.split("=");return n.push(!0),t[n[0].toLowerCase()]=n[1],t},{}),s={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*Rc},lat_1:function(t){r.lat1=t*Rc},lat_2:function(t){r.lat2=t*Rc},lat_ts:function(t){r.lat_ts=t*Rc},lon_0:function(t){r.long0=t*Rc},lon_1:function(t){r.long1=t*Rc},lon_2:function(t){r.long2=t*Rc},alpha:function(t){r.alpha=parseFloat(t)*Rc},gamma:function(t){r.rectified_grid_angle=parseFloat(t)*Rc},lonc:function(t){r.longc=t*Rc},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r:function(t){r.a=r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t;var e=Zc(qc,t);e&&(r.to_meter=e.to_meter)},from_greenwich:function(t){r.from_greenwich=t*Rc},pm:function(t){var e=Zc(Gc,t);r.from_greenwich=(e||parseFloat(t))*Rc},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)},approx:function(){r.approx=!0}};for(e in a)n=a[e],e in s?"function"===typeof(i=s[e])?i(n):r[i]=n:r[e]=n;return"string"===typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}const Hc=class{static getId(t){const e=t.find(t=>Array.isArray(t)&&"ID"===t[0]);return e&&e.length>=3?{authority:e[1],code:parseInt(e[2],10)}:null}static convertUnit(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unit";if(!t||t.length<3)return{type:e,name:"unknown",conversion_factor:null};const n=t[1],i=parseFloat(t[2])||null,r=t.find(t=>Array.isArray(t)&&"ID"===t[0]);return{type:e,name:n,conversion_factor:i,id:r?{authority:r[1],code:parseInt(r[2],10)}:null}}static convertAxis(t){const e=t[1]||"Unknown";let n;const i=e.match(/^\((.)\)$/);if(i){const t=i[1].toUpperCase();if("E"===t)n="east";else if("N"===t)n="north";else{if("U"!==t)throw new Error("Unknown axis abbreviation: ".concat(t));n="up"}}else n=t[2]?t[2].toLowerCase():"unknown";const r=t.find(t=>Array.isArray(t)&&"ORDER"===t[0]),a=r?parseInt(r[1],10):null,s=t.find(t=>Array.isArray(t)&&("LENGTHUNIT"===t[0]||"ANGLEUNIT"===t[0]||"SCALEUNIT"===t[0]));return{name:e,direction:n,unit:this.convertUnit(s),order:a}}static extractAxes(t){return t.filter(t=>Array.isArray(t)&&"AXIS"===t[0]).map(t=>this.convertAxis(t)).sort((t,e)=>(t.order||0)-(e.order||0))}static convert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t[0]){case"PROJCRS":e.type="ProjectedCRS",e.name=t[1],e.base_crs=t.find(t=>Array.isArray(t)&&"BASEGEOGCRS"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"BASEGEOGCRS"===t[0])):null,e.conversion=t.find(t=>Array.isArray(t)&&"CONVERSION"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"CONVERSION"===t[0])):null;const n=t.find(t=>Array.isArray(t)&&"CS"===t[0]);n&&(e.coordinate_system={type:n[1],axis:this.extractAxes(t)});const i=t.find(t=>Array.isArray(t)&&"LENGTHUNIT"===t[0]);if(i){const t=this.convertUnit(i);e.coordinate_system.unit=t}e.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":e.type="GeographicCRS",e.name=t[1];const r=t.find(t=>Array.isArray(t)&&("DATUM"===t[0]||"ENSEMBLE"===t[0]));if(r){const n=this.convert(r);"ENSEMBLE"===r[0]?e.datum_ensemble=n:e.datum=n;const i=t.find(t=>Array.isArray(t)&&"PRIMEM"===t[0]);i&&"Greenwich"!==i[1]&&(n.prime_meridian={name:i[1],longitude:parseFloat(i[2])})}e.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},e.id=this.getId(t);break;case"DATUM":e.type="GeodeticReferenceFrame",e.name=t[1],e.ellipsoid=t.find(t=>Array.isArray(t)&&"ELLIPSOID"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"ELLIPSOID"===t[0])):null;break;case"ENSEMBLE":e.type="DatumEnsemble",e.name=t[1],e.members=t.filter(t=>Array.isArray(t)&&"MEMBER"===t[0]).map(t=>({type:"DatumEnsembleMember",name:t[1],id:this.getId(t)}));const a=t.find(t=>Array.isArray(t)&&"ENSEMBLEACCURACY"===t[0]);a&&(e.accuracy=parseFloat(a[1]));const s=t.find(t=>Array.isArray(t)&&"ELLIPSOID"===t[0]);s&&(e.ellipsoid=this.convert(s)),e.id=this.getId(t);break;case"ELLIPSOID":e.type="Ellipsoid",e.name=t[1],e.semi_major_axis=parseFloat(t[2]),e.inverse_flattening=parseFloat(t[3]);t.find(t=>Array.isArray(t)&&"LENGTHUNIT"===t[0])&&this.convert(t.find(t=>Array.isArray(t)&&"LENGTHUNIT"===t[0]),e);break;case"CONVERSION":e.type="Conversion",e.name=t[1],e.method=t.find(t=>Array.isArray(t)&&"METHOD"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"METHOD"===t[0])):null,e.parameters=t.filter(t=>Array.isArray(t)&&"PARAMETER"===t[0]).map(t=>this.convert(t));break;case"METHOD":e.type="Method",e.name=t[1],e.id=this.getId(t);break;case"PARAMETER":e.type="Parameter",e.name=t[1],e.value=parseFloat(t[2]),e.unit=this.convertUnit(t.find(t=>Array.isArray(t)&&("LENGTHUNIT"===t[0]||"ANGLEUNIT"===t[0]||"SCALEUNIT"===t[0]))),e.id=this.getId(t);break;case"BOUNDCRS":e.type="BoundCRS";const o=t.find(t=>Array.isArray(t)&&"SOURCECRS"===t[0]);if(o){const t=o.find(t=>Array.isArray(t));e.source_crs=t?this.convert(t):null}const l=t.find(t=>Array.isArray(t)&&"TARGETCRS"===t[0]);if(l){const t=l.find(t=>Array.isArray(t));e.target_crs=t?this.convert(t):null}const c=t.find(t=>Array.isArray(t)&&"ABRIDGEDTRANSFORMATION"===t[0]);e.transformation=c?this.convert(c):null;break;case"ABRIDGEDTRANSFORMATION":if(e.type="Transformation",e.name=t[1],e.method=t.find(t=>Array.isArray(t)&&"METHOD"===t[0])?this.convert(t.find(t=>Array.isArray(t)&&"METHOD"===t[0])):null,e.parameters=t.filter(t=>Array.isArray(t)&&("PARAMETER"===t[0]||"PARAMETERFILE"===t[0])).map(t=>"PARAMETER"===t[0]?this.convert(t):"PARAMETERFILE"===t[0]?{name:t[1],value:t[2],id:{authority:"EPSG",code:8656}}:void 0),7===e.parameters.length){const t=e.parameters[6];"Scale difference"===t.name&&(t.value=Math.round(1e12*(t.value-1))/1e6)}e.id=this.getId(t);break;case"AXIS":e.coordinate_system||(e.coordinate_system={type:"unspecified",axis:[]}),e.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":const u=this.convertUnit(t,"LinearUnit");e.coordinate_system&&e.coordinate_system.axis&&e.coordinate_system.axis.forEach(t=>{t.unit||(t.unit=u)}),u.conversion_factor&&1!==u.conversion_factor&&e.semi_major_axis&&(e.semi_major_axis={value:e.semi_major_axis,unit:u});break;default:e.keyword=t[0]}return e}};const Xc=class extends Hc{static convert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.convert(t,e),e.coordinate_system&&"Cartesian"===e.coordinate_system.subtype&&delete e.coordinate_system,e.usage&&delete e.usage,e}};const Yc=class extends Hc{static convert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super.convert(t,e);const n=t.find(t=>Array.isArray(t)&&"CS"===t[0]);n&&(e.coordinate_system={subtype:n[1],axis:this.extractAxes(t)});const i=t.find(t=>Array.isArray(t)&&"USAGE"===t[0]);if(i){const t=i.find(t=>Array.isArray(t)&&"SCOPE"===t[0]),n=i.find(t=>Array.isArray(t)&&"AREA"===t[0]),r=i.find(t=>Array.isArray(t)&&"BBOX"===t[0]);e.usage={},t&&(e.usage.scope=t[1]),n&&(e.usage.area=n[1]),r&&(e.usage.bbox=r.slice(1))}return e}};function Kc(t){const e=function(t){return t.find(t=>Array.isArray(t)&&"USAGE"===t[0])?"2019":(t.find(t=>Array.isArray(t)&&"CS"===t[0])||"BOUNDCRS"===t[0]||"PROJCRS"===t[0]||t[0],"2015")}(t);return("2019"===e?Yc:Xc).convert(t)}const Jc=function(t){var e=new ru(t);return e.output()};var $c=1,Qc=/\s/,tu=/[A-Za-z]/,eu=/[A-Za-z84_]/,nu=/[,\]]/,iu=/[\d\.E\-\+]/;function ru(t){if("string"!==typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=$c}function au(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var i=e?{}:t,r=n.reduce(function(t,e){return su(e,t),t},i);e&&(t[e]=r)}function su(t,e){if(Array.isArray(t)){var n=t.shift();if("PARAMETER"===n&&(n=t.shift()),1===t.length)return Array.isArray(t[0])?(e[n]={},void su(t[0],e[n])):void(e[n]=t[0]);if(t.length)if("TOWGS84"!==n){if("AXIS"===n)return n in e||(e[n]=[]),void e[n].push(t);var i;switch(Array.isArray(n)||(e[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[n]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&su(t[2],e[n]));case"SPHEROID":case"ELLIPSOID":return e[n]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&su(t[3],e[n]));case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":return t[0]=["name",t[0]],void au(e,n,t);case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":return t[0]=["name",t[0]],au(e,n,t),void(e[n].type=n);default:for(i=-1;++i<t.length;)if(!Array.isArray(t[i]))return su(t,e[n]);return au(e,n,t)}}else e[n]=t;else e[n]=!0}else e[t]=!0}ru.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;Qc.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case $c:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},ru.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(nu.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},ru.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=$c)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=$c,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},ru.prototype.number=function(t){if(!iu.test(t)){if(nu.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},ru.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},ru.prototype.keyword=function(t){if(eu.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=$c)}if(!nu.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},ru.prototype.neutral=function(t){if(tu.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(iu.test(t))return this.word=t,void(this.state=3);if(!nu.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},ru.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function ou(t){return.017453292519943295*t}function lu(t){const e=(t.projName||"").toLowerCase().replace(/_/g," ");t.long0||!t.longc||"albers conic equal area"!==e&&"lambert azimuthal equal area"!==e||(t.long0=t.longc),t.lat_ts||!t.lat1||"stereographic south pole"!==e&&"polar stereographic (variant b)"!==e?t.lat_ts||!t.lat0||"polar stereographic"!==e&&"polar stereographic (variant a)"!==e||(t.lat_ts=t.lat0,t.lat0=ou(t.lat0>0?90:-90),delete t.lat1):(t.lat0=ou(t.lat1>0?90:-90),t.lat_ts=t.lat1,delete t.lat1)}function cu(t){let e={units:null,to_meter:void 0};return"string"===typeof t?(e.units=t.toLowerCase(),"metre"===e.units&&(e.units="meter"),"meter"===e.units&&(e.to_meter=1)):t&&t.name&&(e.units=t.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.to_meter=t.conversion_factor),e}function uu(t){return"object"===typeof t?t.value*t.unit.conversion_factor:t}function hu(t,e){t.ellipsoid.radius?(e.a=t.ellipsoid.radius,e.rf=0):(e.a=uu(t.ellipsoid.semi_major_axis),void 0!==t.ellipsoid.inverse_flattening?e.rf=t.ellipsoid.inverse_flattening:void 0!==t.ellipsoid.semi_major_axis&&void 0!==t.ellipsoid.semi_minor_axis&&(e.rf=e.a/(e.a-uu(t.ellipsoid.semi_minor_axis))))}function du(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&"object"===typeof t?"BoundCRS"===t.type?(du(t.source_crs,e),t.transformation&&(t.transformation.method&&"NTv2"===t.transformation.method.name?e.nadgrids=t.transformation.parameters[0].value:e.datum_params=t.transformation.parameters.map(t=>t.value)),e):(Object.keys(t).forEach(n=>{const i=t[n];if(null!==i)switch(n){case"name":if(e.srsCode)break;e.name=i,e.srsCode=i;break;case"type":"GeographicCRS"===i?e.projName="longlat":"ProjectedCRS"===i&&t.conversion&&t.conversion.method&&(e.projName=t.conversion.method.name);break;case"datum":case"datum_ensemble":i.ellipsoid&&(e.ellps=i.ellipsoid.name,hu(i,e)),i.prime_meridian&&(e.from_greenwich=i.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=i.name,hu(i,e);break;case"prime_meridian":e.long0=(i.longitude||0)*Math.PI/180;break;case"coordinate_system":if(i.axis)if(e.axis=i.axis.map(t=>{const e=t.direction;if("east"===e)return"e";if("north"===e)return"n";if("west"===e)return"w";if("south"===e)return"s";throw new Error("Unknown axis direction: ".concat(e))}).join("")+"u",i.unit){const{units:t,to_meter:n}=cu(i.unit);e.units=t,e.to_meter=n}else if(i.axis[0]&&i.axis[0].unit){const{units:t,to_meter:n}=cu(i.axis[0].unit);e.units=t,e.to_meter=n}break;case"id":i.authority&&i.code&&(e.title=i.authority+":"+i.code);break;case"conversion":i.method&&i.method.name&&(e.projName=i.method.name),i.parameters&&i.parameters.forEach(t=>{const n=t.name.toLowerCase().replace(/\s+/g,"_"),i=t.value;t.unit&&t.unit.conversion_factor?e[n]=i*t.unit.conversion_factor:"degree"===t.unit?e[n]=i*Math.PI/180:e[n]=i});break;case"unit":i.name&&(e.units=i.name.toLowerCase(),"metre"===e.units&&(e.units="meter")),i.conversion_factor&&(e.to_meter=i.conversion_factor);break;case"base_crs":du(i,e),e.datumCode=i.id?i.id.authority+"_"+i.id.code:i.name}}),void 0!==e.latitude_of_false_origin&&(e.lat0=e.latitude_of_false_origin),void 0!==e.longitude_of_false_origin&&(e.long0=e.longitude_of_false_origin),void 0!==e.latitude_of_standard_parallel&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),void 0!==e.latitude_of_1st_standard_parallel&&(e.lat1=e.latitude_of_1st_standard_parallel),void 0!==e.latitude_of_2nd_standard_parallel&&(e.lat2=e.latitude_of_2nd_standard_parallel),void 0!==e.latitude_of_projection_centre&&(e.lat0=e.latitude_of_projection_centre),void 0!==e.longitude_of_projection_centre&&(e.longc=e.longitude_of_projection_centre),void 0!==e.easting_at_false_origin&&(e.x0=e.easting_at_false_origin),void 0!==e.northing_at_false_origin&&(e.y0=e.northing_at_false_origin),void 0!==e.latitude_of_natural_origin&&(e.lat0=e.latitude_of_natural_origin),void 0!==e.longitude_of_natural_origin&&(e.long0=e.longitude_of_natural_origin),void 0!==e.longitude_of_origin&&(e.long0=e.longitude_of_origin),void 0!==e.false_easting&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),void 0!==e.false_northing&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),void 0!==e.standard_parallel_1&&(e.lat1=e.standard_parallel_1),void 0!==e.standard_parallel_2&&(e.lat2=e.standard_parallel_2),void 0!==e.scale_factor_at_natural_origin&&(e.k0=e.scale_factor_at_natural_origin),void 0!==e.scale_factor_at_projection_centre&&(e.k0=e.scale_factor_at_projection_centre),void 0!==e.scale_factor_on_pseudo_standard_parallel&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),void 0!==e.azimuth&&(e.alpha=e.azimuth),void 0!==e.azimuth_at_projection_centre&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),lu(e),e):t}var fu=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function pu(t){for(var e=Object.keys(t),n=0,i=e.length;n<i;++n){var r=e[n];-1!==fu.indexOf(r)&&mu(t[r]),"object"===typeof t[r]&&pu(t[r])}}function mu(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if("GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"===typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",i=0,r=t.AXIS.length;i<r;++i){var a=[t.AXIS[i][0].toLowerCase(),t.AXIS[i][1].toLowerCase()];-1!==a[0].indexOf("north")||("y"===a[0]||"lat"===a[0])&&"north"===a[1]?n+="n":-1!==a[0].indexOf("south")||("y"===a[0]||"lat"===a[0])&&"south"===a[1]?n+="s":-1!==a[0].indexOf("east")||("x"===a[0]||"lon"===a[0])&&"east"===a[1]?n+="e":-1===a[0].indexOf("west")&&("x"!==a[0]&&"lon"!==a[0]||"west"!==a[1])||(n+="w")}2===n.length&&(n+="u"),3===n.length&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var s=t.GEOGCS;function o(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(s=t),s&&(s.DATUM?t.datumCode=s.DATUM.name.toLowerCase():t.datumCode=s.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_1949"===t.datumCode&&(t.datumCode="nzgd49"),"wgs_1984"!==t.datumCode&&"world_geodetic_system_1984"!==t.datumCode||("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"belge_1972"===t.datumCode&&(t.datumCode="rnb72"),s.DATUM&&s.DATUM.SPHEROID&&(t.ellps=s.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=s.DATUM.SPHEROID.a,t.rf=parseFloat(s.DATUM.SPHEROID.rf,10)),s.DATUM&&s.DATUM.TOWGS84&&(t.datum_params=s.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),t.rectified_grid_angle&&(t.rectified_grid_angle=ou(t.rectified_grid_angle));[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",ou],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",ou],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",ou],["lat0","latitude_of_origin",ou],["lat0","standard_parallel_1",ou],["lat1","standard_parallel_1",ou],["lat2","standard_parallel_2",ou],["azimuth","Azimuth"],["alpha","azimuth",ou],["srsCode","name"]].forEach(function(e){return function(t,e){var n=e[0],i=e[1];!(n in t)&&i in t&&(t[n]=t[i],3===e.length&&(t[n]=e[2](t[n])))}(t,e)}),lu(t)}function gu(t){if("object"===typeof t)return du(t);const e=function(t){const e=t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}(t);var n=Jc(t);if("WKT2"===e){return du(Kc(n))}var i=n[0],r={};return su(n,r),pu(r),r[i]}function _u(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"===typeof n?"+"===n.charAt(0)?_u[t]=Wc(arguments[1]):_u[t]=gu(arguments[1]):_u[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){return Array.isArray(t)?_u.apply(e,t):_u(t)});if("string"===typeof t){if(t in _u)return _u[t]}else"EPSG"in t?_u["EPSG:"+t.EPSG]=t:"ESRI"in t?_u["ESRI:"+t.ESRI]=t:"IAU2000"in t?_u["IAU2000:"+t.IAU2000]=t:console.log(t);return}}!function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}(_u);const yu=_u;var vu=["3857","900913","3785","102113"];const bu=function(t){if(!function(t){return"string"===typeof t}(t))return"projName"in t?t:gu(t);if(function(t){return t in yu}(t))return yu[t];if(function(t){return 0!==t.indexOf("+")&&-1!==t.indexOf("[")||"object"===typeof t&&!("srsCode"in t)}(t)){var e=gu(t);if(function(t){var e=Zc(t,"authority");if(e){var n=Zc(e,"epsg");return n&&vu.indexOf(n)>-1}}(e))return yu["EPSG:3857"];var n=function(t){var e=Zc(t,"extension");if(e)return Zc(e,"proj4")}(e);return n?Wc(n):e}return function(t){return"+"===t[0]}(t)?Wc(t):void 0};function xu(t,e){var n,i;if(t=t||{},!e)return t;for(i in e)void 0!==(n=e[i])&&(t[i]=n);return t}function wu(t,e,n){var i=t*e;return n/Math.sqrt(1-i*i)}function Su(t){return t<0?-1:1}function Pu(t){return Math.abs(t)<=jc?t:t-Su(t)*Bc}function Mu(t,e,n){var i=t*n,r=.5*t;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(Nc-e))/i}function Au(t,e){for(var n,i,r=.5*t,a=Nc-2*Math.atan(e),s=0;s<=15;s++)if(n=t*Math.sin(a),a+=i=Nc-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-a,Math.abs(i)<=1e-10)return a;return-9999}const ku={init:function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=wu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(t){var e,n,i=t.x,r=t.y;if(r*Fc>90&&r*Fc<-90&&i*Fc>180&&i*Fc<-180)return null;if(Math.abs(Math.abs(r)-Nc)<=Dc)return null;if(this.sphere)e=this.x0+this.a*this.k0*Pu(i-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(Oc+.5*r));else{var a=Math.sin(r),s=Mu(this.e,r,a);e=this.x0+this.a*this.k0*Pu(i-this.long0),n=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i=t.x-this.x0,r=t.y-this.y0;if(this.sphere)n=Nc-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var a=Math.exp(-r/(this.a*this.k0));if(-9999===(n=Au(this.e,a)))return null}return e=Pu(this.long0+i/(this.a*this.k0)),t.x=e,t.y=n,t},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"]};function Eu(t){return t}var Tu=[ku,{init:function(){},forward:Eu,inverse:Eu,names:["longlat","identity"]}],Cu={},Iu=[];function Lu(t,e){var n=Iu.length;return t.names?(Iu[n]=t,t.names.forEach(function(t){Cu[t.toLowerCase()]=n}),this):(console.log(e),!0)}function zu(t){return t.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}const Nu={start:function(){Tu.forEach(Lu)},add:Lu,get:function(t){if(!t)return!1;var e=t.toLowerCase();return"undefined"!==typeof Cu[e]&&Iu[Cu[e]]||(e=zu(e))in Cu&&Iu[Cu[e]]?Iu[Cu[e]]:void 0}};const Du={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},Ru=Du.WGS84;var Fu={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var Ou in Fu){var Bu=Fu[Ou];Bu.datumName&&(Fu[Bu.datumName]=Bu)}const ju=Fu;const Uu=function(t,e,n,i,r,a,s){var o={};return o.datum_type=void 0===t||"none"===t?5:4,e&&(o.datum_params=e.map(parseFloat),0===o.datum_params[0]&&0===o.datum_params[1]&&0===o.datum_params[2]||(o.datum_type=1),o.datum_params.length>3&&(0===o.datum_params[3]&&0===o.datum_params[4]&&0===o.datum_params[5]&&0===o.datum_params[6]||(o.datum_type=2,o.datum_params[3]*=zc,o.datum_params[4]*=zc,o.datum_params[5]*=zc,o.datum_params[6]=o.datum_params[6]/1e6+1))),s&&(o.datum_type=3,o.grids=s),o.a=n,o.b=i,o.es=r,o.ep2=a,o};var Gu={};async function qu(t,e){for(var n=[],i=await e.getImageCount(),r=i-1;r>=0;r--){var a=await e.getImage(r),s=await a.readRasters(),o=[a.getWidth(),a.getHeight()],l=a.getBoundingBox().map(Zu),c=[a.fileDirectory.ModelPixelScale[0],a.fileDirectory.ModelPixelScale[1]].map(Zu),u=l[0]+(o[0]-1)*c[0],h=l[3]-(o[1]-1)*c[1],d=s[0],f=s[1],p=[];for(let t=o[1]-1;t>=0;t--)for(let e=o[0]-1;e>=0;e--){var m=t*o[0]+e;p.push([-Wu(f[m]),Wu(d[m])])}n.push({del:c,lim:o,ll:[-u,h],cvs:p})}var g={header:{nSubgrids:i},subgrids:n};return Gu[t]=g,g}function Vu(t){if(0===t.length)return null;var e="@"===t[0];return e&&(t=t.slice(1)),"null"===t?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:Gu[t]||null,isNull:!1}}function Zu(t){return t*Math.PI/180}function Wu(t){return t/3600*Math.PI/180}function Hu(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Xu(t){return t.map(function(t){return[Wu(t.longitudeShift),Wu(t.latitudeShift)]})}function Yu(t,e,n){return{name:Hu(t,e+8,e+16).trim(),parent:Hu(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Ku(t,e,n,i,r){var a=e+176,s=16;!1===r&&(s=8);for(var o=[],l=0;l<n.gridNodeCount;l++){var c={latitudeShift:t.getFloat32(a+l*s,i),longitudeShift:t.getFloat32(a+l*s+4,i)};!1!==r&&(c.latitudeAccuracy=t.getFloat32(a+l*s+8,i),c.longitudeAccuracy=t.getFloat32(a+l*s+12,i)),o.push(c)}return o}function Ju(t,e){if(!(this instanceof Ju))return new Ju(t);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(t){if(t)throw t};var n=bu(t);if("object"===typeof n){var i=Ju.projections.get(n.projName);if(i){if(n.datumCode&&"none"!==n.datumCode){var r=Zc(ju,n.datumCode);r&&(n.datum_params=n.datum_params||(r.towgs84?r.towgs84.split(","):null),n.ellps=r.ellipse,n.datumName=r.datumName?r.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var a=function(t,e,n,i,r){if(!t){var a=Zc(Du,i);a||(a=Ru),t=a.a,e=a.b,n=a.rf}return n&&!e&&(e=(1-1/n)*t),(0===n||Math.abs(t-e)<Dc)&&(r=!0,e=t),{a:t,b:e,rf:n,sphere:r}}(n.a,n.b,n.rf,n.ellps,n.sphere),s=function(t,e,n,i){var r=t*t,a=e*e,s=(r-a)/r,o=0;return i?(r=(t*=1-s*(.16666666666666666+s*(.04722222222222222+.022156084656084655*s)))*t,s=0):o=Math.sqrt(s),{es:s,e:o,ep2:(r-a)/a}}(a.a,a.b,a.rf,n.R_A),o=function(t){return void 0===t?null:t.split(",").map(Vu)}(n.nadgrids),l=n.datum||Uu(n.datumCode,n.datum_params,a.a,a.b,s.es,s.ep2,o);xu(this,n),xu(this,i),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=l,"init"in this&&"function"===typeof this.init&&this.init(),e(null,this)}else e("Could not get projection name from: "+t)}else e("Could not parse to valid json: "+t)}Ju.projections=Nu,Ju.projections.start();const $u=Ju;function Qu(t,e,n){var i,r,a,s,o=t.x,l=t.y,c=t.z?t.z:0;if(l<-Nc&&l>-1.001*Nc)l=-Nc;else if(l>Nc&&l<1.001*Nc)l=Nc;else{if(l<-Nc)return{x:-1/0,y:-1/0,z:t.z};if(l>Nc)return{x:1/0,y:1/0,z:t.z}}return o>Math.PI&&(o-=2*Math.PI),r=Math.sin(l),s=Math.cos(l),a=r*r,{x:((i=n/Math.sqrt(1-e*a))+c)*s*Math.cos(o),y:(i+c)*s*Math.sin(o),z:(i*(1-e)+c)*r}}function th(t,e,n,i){var r,a,s,o,l,c,u,h,d,f,p,m,g,_,y,v=1e-12,b=t.x,x=t.y,w=t.z?t.z:0;if(r=Math.sqrt(b*b+x*x),a=Math.sqrt(b*b+x*x+w*w),r/n<v){if(_=0,a/n<v)return y=-i,{x:t.x,y:t.y,z:t.z}}else _=Math.atan2(x,b);s=w/a,h=(o=r/a)*(1-e)*(l=1/Math.sqrt(1-e*(2-e)*o*o)),d=s*l,g=0;do{g++,c=e*(u=n/Math.sqrt(1-e*d*d))/(u+(y=r*h+w*d-u*(1-e*d*d))),m=(p=s*(l=1/Math.sqrt(1-c*(2-c)*o*o)))*h-(f=o*(1-c)*l)*d,h=f,d=p}while(m*m>1e-24&&g<30);return{x:_,y:Math.atan(p/Math.abs(f)),z:y}}function eh(t){return 1===t||2===t}function nh(t,e,n){if(function(t,e){return t.datum_type===e.datum_type&&!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(1===t.datum_type?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:2!==t.datum_type||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}(t,e))return n;if(5===t.datum_type||5===e.datum_type)return n;var i=t.a,r=t.es;if(3===t.datum_type){if(0!==ih(t,!1,n))return;i=Ic,r=Lc}var a=e.a,s=e.b,o=e.es;if(3===e.datum_type&&(a=Ic,s=6356752.314,o=Lc),r===o&&i===a&&!eh(t.datum_type)&&!eh(e.datum_type))return n;if((n=Qu(n,r,i),eh(t.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(2===e){var i=n[0],r=n[1],a=n[2],s=n[3],o=n[4],l=n[5],c=n[6];return{x:c*(t.x-l*t.y+o*t.z)+i,y:c*(l*t.x+t.y-s*t.z)+r,z:c*(-o*t.x+s*t.y+t.z)+a}}}(n,t.datum_type,t.datum_params)),eh(e.datum_type)&&(n=function(t,e,n){if(1===e)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(2===e){var i=n[0],r=n[1],a=n[2],s=n[3],o=n[4],l=n[5],c=n[6],u=(t.x-i)/c,h=(t.y-r)/c,d=(t.z-a)/c;return{x:u+l*h-o*d,y:-l*u+h+s*d,z:o*u-s*h+d}}}(n,e.datum_type,e.datum_params)),n=th(n,o,a,s),3===e.datum_type)&&0!==ih(e,!0,n))return;return n}function ih(t,e,n){if(null===t.grids||0===t.grids.length)return console.log("Grid shift grids not found"),-1;var i={x:-n.x,y:n.y},r={x:Number.NaN,y:Number.NaN},a=[];t:for(var s=0;s<t.grids.length;s++){var o=t.grids[s];if(a.push(o.name),o.isNull){r=i;break}if(null!==o.grid)for(var l=o.grid.subgrids,c=0,u=l.length;c<u;c++){var h=l[c],d=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,f=h.ll[0]-d,p=h.ll[1]-d,m=h.ll[0]+(h.lim[0]-1)*h.del[0]+d,g=h.ll[1]+(h.lim[1]-1)*h.del[1]+d;if(!(p>i.y||f>i.x||g<i.y||m<i.x)&&(r=rh(i,e,h),!isNaN(r.x)))break t}else if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*Fc+" "+i.y*Fc+" tried: '"+a+"'"),-1):(n.x=-r.x,n.y=r.y,0)}function rh(t,e,n){var i={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return i;var r={x:t.x,y:t.y};r.x-=n.ll[0],r.y-=n.ll[1],r.x=Pu(r.x-Math.PI)+Math.PI;var a=ah(r,n);if(e){if(isNaN(a.x))return i;a.x=r.x-a.x,a.y=r.y-a.y;var s,o,l=9;do{if(o=ah(a,n),isNaN(o.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}s={x:r.x-(o.x+a.x),y:r.y-(o.y+a.y)},a.x+=s.x,a.y+=s.y}while(l--&&Math.abs(s.x)>1e-12&&Math.abs(s.y)>1e-12);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=Pu(a.x+n.ll[0]),i.y=a.y+n.ll[1]}else isNaN(a.x)||(i.x=t.x+a.x,i.y=t.y+a.y);return i}function ah(t,e){var n,i={x:t.x/e.del[0],y:t.y/e.del[1]},r=Math.floor(i.x),a=Math.floor(i.y),s=i.x-1*r,o=i.y-1*a,l={x:Number.NaN,y:Number.NaN};if(r<0||r>=e.lim[0])return l;if(a<0||a>=e.lim[1])return l;n=a*e.lim[0]+r;var c=e.cvs[n][0],u=e.cvs[n][1];n++;var h=e.cvs[n][0],d=e.cvs[n][1];n+=e.lim[0];var f=e.cvs[n][0],p=e.cvs[n][1];n--;var m=e.cvs[n][0],g=e.cvs[n][1],_=s*o,y=s*(1-o),v=(1-s)*(1-o),b=(1-s)*o;return l.x=v*c+y*h+b*m+_*f,l.y=v*u+y*d+b*g+_*p,l}function sh(t,e,n){var i,r,a,s=n.x,o=n.y,l=n.z||0,c={};for(a=0;a<3;a++)if(!e||2!==a||void 0!==n.z)switch(0===a?(i=s,r=-1!=="ew".indexOf(t.axis[a])?"x":"y"):1===a?(i=o,r=-1!=="ns".indexOf(t.axis[a])?"y":"x"):(i=l,r="z"),t.axis[a]){case"e":case"n":c[r]=i;break;case"w":case"s":c[r]=-i;break;case"u":void 0!==n[r]&&(c.z=i);break;case"d":void 0!==n[r]&&(c.z=-i);break;default:return null}return c}function oh(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function lh(t){if("function"===typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!==typeof t||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function ch(t,e,n,i){var r,a=void 0!==(n=Array.isArray(n)?oh(n):{x:n.x,y:n.y,z:n.z,m:n.m}).z;if(function(t){lh(t.x),lh(t.y)}(n),t.datum&&e.datum&&function(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type||3===t.datum.datum_type)&&"WGS84"!==e.datumCode||(1===e.datum.datum_type||2===e.datum.datum_type||3===e.datum.datum_type)&&"WGS84"!==t.datumCode}(t,e)&&(n=ch(t,r=new $u("WGS84"),n,i),t=r),i&&"enu"!==t.axis&&(n=sh(t,!1,n)),"longlat"===t.projName)n={x:n.x*Rc,y:n.y*Rc,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),!(n=t.inverse(n)))return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=nh(t.datum,e.datum,n))return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),"longlat"===e.projName?n={x:n.x*Fc,y:n.y*Fc,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),i&&"enu"!==e.axis?sh(e,!0,n):(n&&!a&&delete n.z,n)}var uh=$u("WGS84");function hh(t,e,n,i){var r,a,s;return Array.isArray(n)?(r=ch(t,e,n,i)||{x:NaN,y:NaN},n.length>2?"undefined"!==typeof t.name&&"geocent"===t.name||"undefined"!==typeof e.name&&"geocent"===e.name?"number"===typeof r.z?[r.x,r.y,r.z].concat(n.slice(3)):[r.x,r.y,n[2]].concat(n.slice(3)):[r.x,r.y].concat(n.slice(2)):[r.x,r.y]):(a=ch(t,e,n,i),2===(s=Object.keys(n)).length||s.forEach(function(i){if("undefined"!==typeof t.name&&"geocent"===t.name||"undefined"!==typeof e.name&&"geocent"===e.name){if("x"===i||"y"===i||"z"===i)return}else if("x"===i||"y"===i)return;a[i]=n[i]}),a)}function dh(t){return t instanceof $u?t:"object"===typeof t&&"oProj"in t?t.oProj:$u(t)}const fh=function(t,e,n){var i,r,a,s=!1;return"undefined"===typeof e?(r=dh(t),i=uh,s=!0):("undefined"!==typeof e.x||Array.isArray(e))&&(n=e,r=dh(t),i=uh,s=!0),i||(i=dh(t)),r||(r=dh(e)),n?hh(i,r,n):(a={forward:function(t,e){return hh(i,r,t,e)},inverse:function(t,e){return hh(r,i,t,e)}},s&&(a.oProj=r),a)};var ph="AJSAJS",mh="AFAFAF",gh=65,_h=73,yh=79,vh=86,bh=90;const xh={forward:wh,inverse:function(t){var e=Ah(Th(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:Sh};function wh(t,e){return e=e||5,function(t,e){var n="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+function(t,e,n){var i=Eh(n),r=Math.floor(t/1e5),a=Math.floor(e/1e5)%20;return function(t,e,n){var i=n-1,r=ph.charCodeAt(i),a=mh.charCodeAt(i),s=r+t-1,o=a+e,l=!1;s>bh&&(s=s-bh+gh-1,l=!0);(s===_h||r<_h&&s>_h||(s>_h||r<_h)&&l)&&s++;(s===yh||r<yh&&s>yh||(s>yh||r<yh)&&l)&&++s===_h&&s++;s>bh&&(s=s-bh+gh-1);o>vh?(o=o-vh+gh-1,l=!0):l=!1;(o===_h||a<_h&&o>_h||(o>_h||a<_h)&&l)&&o++;(o===yh||a<yh&&o>yh||(o>yh||a<yh)&&l)&&++o===_h&&o++;o>vh&&(o=o-vh+gh-1);return String.fromCharCode(s)+String.fromCharCode(o)}(r,a,i)}(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+i.substr(i.length-5,e)}(function(t){var e,n,i,r,a,s,o,l,c=t.lat,u=t.lon,h=6378137,d=.00669438,f=.9996,p=Ph(c),m=Ph(u);l=Math.floor((u+180)/6)+1,180===u&&(l=60);c>=56&&c<64&&u>=3&&u<12&&(l=32);c>=72&&c<84&&(u>=0&&u<9?l=31:u>=9&&u<21?l=33:u>=21&&u<33?l=35:u>=33&&u<42&&(l=37));o=Ph(6*(l-1)-180+3),e=d/(1-d),n=h/Math.sqrt(1-d*Math.sin(p)*Math.sin(p)),i=Math.tan(p)*Math.tan(p),r=e*Math.cos(p)*Math.cos(p),a=Math.cos(p)*(m-o),s=h*((1-d/4-3*d*d/64-5*d*d*d/256)*p-(3*d/8+3*d*d/32+45*d*d*d/1024)*Math.sin(2*p)+(15*d*d/256+45*d*d*d/1024)*Math.sin(4*p)-35*d*d*d/3072*Math.sin(6*p));var g=f*n*(a+(1-i+r)*a*a*a/6+(5-18*i+i*i+72*r-58*e)*a*a*a*a*a/120)+5e5,_=f*(s+n*Math.tan(p)*(a*a/2+(5-i+9*r+4*r*r)*a*a*a*a/24+(61-58*i+i*i+600*r-330*e)*a*a*a*a*a*a/720));c<0&&(_+=1e7);return{northing:Math.round(_),easting:Math.round(g),zoneNumber:l,zoneLetter:kh(c)}}({lat:t[1],lon:t[0]}),e)}function Sh(t){var e=Ah(Th(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Ph(t){return t*(Math.PI/180)}function Mh(t){return t/Math.PI*180}function Ah(t){var e=t.northing,n=t.easting,i=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var a,s,o,l,c,u,h,d,f,p=.9996,m=6378137,g=.00669438,_=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),y=n-5e5,v=e;i<"N"&&(v-=1e7),h=6*(r-1)-180+3,a=.006739496752268451,f=(d=v/p/6367449.145945056)+(3*_/2-27*_*_*_/32)*Math.sin(2*d)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*d)+151*_*_*_/96*Math.sin(6*d),s=m/Math.sqrt(1-g*Math.sin(f)*Math.sin(f)),o=Math.tan(f)*Math.tan(f),l=a*Math.cos(f)*Math.cos(f),c=.99330562*m/Math.pow(1-g*Math.sin(f)*Math.sin(f),1.5),u=y/(s*p);var b=f-s*Math.tan(f)/c*(u*u/2-(5+3*o+10*l-4*l*l-9*a)*u*u*u*u/24+(61+90*o+298*l+45*o*o-1.6983531815716497-3*l*l)*u*u*u*u*u*u/720);b=Mh(b);var x,w=(u-(1+2*o+l)*u*u*u/6+(5-2*l+28*o-3*l*l+8*a+24*o*o)*u*u*u*u*u/120)/Math.cos(f);if(w=h+Mh(w),t.accuracy){var S=Ah({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});x={top:S.lat,right:S.lon,bottom:b,left:w}}else x={lat:b,lon:w};return x}function kh(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Eh(t){var e=t%6;return 0===e&&(e=6),e}function Th(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,i=null,r="",a=0;!/[A-Z]/.test(e=t.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+t;r+=e,a++}var s=parseInt(r,10);if(0===a||a+3>n)throw"MGRSPoint bad conversion from: "+t;var o=t.charAt(a++);if(o<="A"||"B"===o||"Y"===o||o>="Z"||"I"===o||"O"===o)throw"MGRSPoint zone letter "+o+" not handled: "+t;i=t.substring(a,a+=2);for(var l=Eh(s),c=function(t,e){var n=ph.charCodeAt(e-1),i=1e5,r=!1;for(;n!==t.charCodeAt(0);){if(++n===_h&&n++,n===yh&&n++,n>bh){if(r)throw"Bad character: "+t;n=gh,r=!0}i+=1e5}return i}(i.charAt(0),l),u=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var n=mh.charCodeAt(e-1),i=0,r=!1;for(;n!==t.charCodeAt(0);){if(++n===_h&&n++,n===yh&&n++,n>vh){if(r)throw"Bad character: "+t;n=gh,r=!0}i+=1e5}return i}(i.charAt(1),l);u<Ch(o);)u+=2e6;var h=n-a;if(h%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var d,f,p,m=h/2,g=0,_=0;return m>0&&(d=1e5/Math.pow(10,m),f=t.substring(a,a+m),g=parseFloat(f)*d,p=t.substring(a+m),_=parseFloat(p)*d),{easting:g+c,northing:_+u,zoneLetter:o,zoneNumber:s,accuracy:d}}function Ch(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Ih(t,e,n){if(!(this instanceof Ih))return new Ih(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"===typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"===typeof t&&"undefined"===typeof e){var i=t.split(",");this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.z=parseFloat(i[2])||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ih.fromMGRS=function(t){return new Ih(Sh(t))},Ih.prototype.toMGRS=function(t){return wh([this.x,this.y],t)};const Lh=Ih;var zh=.046875,Nh=.01953125,Dh=.01068115234375;function Rh(t){var e=[];e[0]=1-t*(.25+t*(zh+t*(Nh+t*Dh))),e[1]=t*(.75-t*(zh+t*(Nh+t*Dh)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e}function Fh(t,e,n,i){return n*=e,e*=e,i[0]*t-n*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}function Oh(t,e,n){for(var i=1/(1-e),r=t,a=20;a;--a){var s=Math.sin(r),o=1-e*s*s;if(r-=o=(Fh(r,s,Math.cos(r),n)-t)*(o*Math.sqrt(o))*i,Math.abs(o)<Dc)return r}return r}const Bh={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Rh(this.es),this.ml0=Fh(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(t){var e,n,i,r=t.x,a=t.y,s=Pu(r-this.long0),o=Math.sin(a),l=Math.cos(a);if(this.es){var c=l*s,u=Math.pow(c,2),h=this.ep2*Math.pow(l,2),d=Math.pow(h,2),f=Math.abs(l)>Dc?Math.tan(a):0,p=Math.pow(f,2),m=Math.pow(p,2);e=1-this.es*Math.pow(o,2),c/=Math.sqrt(e);var g=Fh(a,o,l,this.en);n=this.a*(this.k0*c*(1+u/6*(1-p+h+u/20*(5-18*p+m+14*h-58*p*h+u/42*(61+179*m-m*p-479*p)))))+this.x0,i=this.a*(this.k0*(g-this.ml0+o*s*c/2*(1+u/12*(5-p+9*h+4*d+u/30*(61+m-58*p+270*h-330*p*h+u/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var _=l*Math.sin(s);if(Math.abs(Math.abs(_)-1)<Dc)return 93;if(n=.5*this.a*this.k0*Math.log((1+_)/(1-_))+this.x0,i=l*Math.cos(s)/Math.sqrt(1-Math.pow(_,2)),(_=Math.abs(i))>=1){if(_-1>Dc)return 93;i=0}else i=Math.acos(i);a<0&&(i=-i),i=this.a*this.k0*(i-this.lat0)+this.y0}return t.x=n,t.y=i,t},inverse:function(t){var e,n,i,r,a=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(this.es)if(n=Oh(e=this.ml0+s/this.k0,this.es,this.en),Math.abs(n)<Nc){var o=Math.sin(n),l=Math.cos(n),c=Math.abs(l)>Dc?Math.tan(n):0,u=this.ep2*Math.pow(l,2),h=Math.pow(u,2),d=Math.pow(c,2),f=Math.pow(d,2);e=1-this.es*Math.pow(o,2);var p=a*Math.sqrt(e)/this.k0,m=Math.pow(p,2);i=n-(e*=c)*m/(1-this.es)*.5*(1-m/12*(5+3*d-9*u*d+u-4*h-m/30*(61+90*d-252*u*d+45*f+46*u-m/56*(1385+3633*d+4095*f+1574*f*d)))),r=Pu(this.long0+p*(1-m/6*(1+2*d+u-m/20*(5+28*d+24*f+8*u*d+6*u-m/42*(61+662*d+1320*f+720*f*d))))/l)}else i=Nc*Su(s),r=0;else{var g=Math.exp(a/this.k0),_=.5*(g-1/g),y=this.lat0+s/this.k0,v=Math.cos(y);e=Math.sqrt((1-Math.pow(v,2))/(1+Math.pow(_,2))),i=Math.asin(e),s<0&&(i=-i),r=0===_&&0===v?0:Pu(Math.atan2(_,v)+this.long0)}return t.x=r,t.y=i,t},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function jh(t){var e=Math.exp(t);return e=(e-1/e)/2}function Uh(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),i=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(i,2))}function Gh(t){var e=Math.abs(t);return e=function(t){var e=1+t,n=e-1;return 0===n?t:t*Math.log(e)/n}(e*(1+e/(Uh(1,e)+1))),t<0?-e:e}function qh(t,e){for(var n,i=2*Math.cos(2*e),r=t.length-1,a=t[r],s=0;--r>=0;)n=i*a-s+t[r],s=a,a=n;return e+n*Math.sin(2*e)}function Vh(t,e,n){for(var i,r,a=Math.sin(e),s=Math.cos(e),o=jh(n),l=function(t){var e=Math.exp(t);return(e+1/e)/2}(n),c=2*s*l,u=-2*a*o,h=t.length-1,d=t[h],f=0,p=0,m=0;--h>=0;)i=p,r=f,d=c*(p=d)-i-u*(f=m)+t[h],m=u*p-r+c*f;return[(c=a*l)*d-(u=s*o)*m,c*m+u*d]}const Zh={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Bh.init.apply(this),this.forward=Bh.forward,this.inverse=Bh.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),n*=e,this.cgb[1]=n*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n*=e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),n*=e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(e*(-24832/14175)-2.4)),n*=e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n*=e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),n*=e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n*=e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n*=e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n*=e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=.6650675310896665*n;var i=qh(this.cbg,this.lat0);this.Zb=-this.Qn*(i+function(t,e){for(var n,i=2*Math.cos(e),r=t.length-1,a=t[r],s=0;--r>=0;)n=i*a-s+t[r],s=a,a=n;return Math.sin(e)*n}(this.gtu,2*i))},forward:function(t){var e=Pu(t.x-this.long0),n=t.y;n=qh(this.cbg,n);var i=Math.sin(n),r=Math.cos(n),a=Math.sin(e),s=Math.cos(e);n=Math.atan2(i,s*r),e=Math.atan2(a*r,Uh(i,r*s)),e=Gh(Math.tan(e));var o,l,c=Vh(this.gtu,2*n,2*e);return n+=c[0],e+=c[1],Math.abs(e)<=2.623395162778?(o=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*n+this.Zb)+this.y0):(o=1/0,l=1/0),t.x=o,t.y=l,t},inverse:function(t){var e,n,i=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(r=(r-this.Zb)/this.Qn,i/=this.Qn,Math.abs(i)<=2.623395162778){var a=Vh(this.utg,2*r,2*i);r+=a[0],i+=a[1],i=Math.atan(jh(i));var s=Math.sin(r),o=Math.cos(r),l=Math.sin(i),c=Math.cos(i);r=Math.atan2(s*c,Uh(l,c*o)),e=Pu((i=Math.atan2(l,c*o))+this.long0),n=qh(this.cgb,r)}else e=1/0,n=1/0;return t.x=e,t.y=n,t},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]};const Wh={init:function(){var t=function(t,e){if(void 0===t){if((t=Math.floor(30*(Pu(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Rc,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Zh.init.apply(this),this.forward=Zh.forward,this.inverse=Zh.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function Hh(t,e){return Math.pow((1-t)/(1+t),e)}const Xh={init:function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Oc)/(Math.pow(Math.tan(.5*this.lat0+Oc),this.C)*Hh(this.e*t,this.ratexp))},forward:function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Oc),this.C)*Hh(this.e*Math.sin(n),this.ratexp))-Nc,t.x=this.C*e,t},inverse:function(t){for(var e=t.x/this.C,n=t.y,i=Math.pow(Math.tan(.5*n+Oc)/this.K,1/this.C),r=20;r>0&&(n=2*Math.atan(i*Hh(this.e*Math.sin(t.y),-.5*this.e))-Nc,!(Math.abs(n-t.y)<1e-14));--r)t.y=n;return r?(t.x=e,t.y=n,t):null},names:["gauss"]};const Yh={init:function(){Xh.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(t){var e,n,i,r;return t.x=Pu(t.x-this.long0),Xh.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),i=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*i),t.x=r*n*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*n*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){var e,n,i,r,a;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,a=Uh(t.x,t.y)){var s=2*Math.atan2(a,this.R2);e=Math.sin(s),n=Math.cos(s),r=Math.asin(n*this.sinc0+t.y*e*this.cosc0/a),i=Math.atan2(t.x*e,a*this.cosc0*n-t.y*this.sinc0*e)}else r=this.phic0,i=0;return t.x=i,t.y=r,Xh.inverse.apply(this,[t]),t.x=Pu(t.x+this.long0),t},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};function Kh(t,e,n){return e*=n,Math.tan(.5*(Nc+t))*Math.pow((1-e)/(1+e),.5*n)}const Jh={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Dc&&(this.k0=.5*(1+Su(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Dc&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Dc&&Math.abs(Math.cos(this.lat_ts))>Dc&&(this.k0=.5*this.cons*wu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Mu(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=wu(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(Kh(this.lat0,this.sinlat0,this.e))-Nc,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(t){var e,n,i,r,a,s,o=t.x,l=t.y,c=Math.sin(l),u=Math.cos(l),h=Pu(o-this.long0);return Math.abs(Math.abs(o-this.long0)-Math.PI)<=Dc&&Math.abs(l+this.lat0)<=Dc?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*c+this.coslat0*u*Math.cos(h)),t.x=this.a*e*u*Math.sin(h)+this.x0,t.y=this.a*e*(this.coslat0*c-this.sinlat0*u*Math.cos(h))+this.y0,t):(n=2*Math.atan(Kh(l,c,this.e))-Nc,r=Math.cos(n),i=Math.sin(n),Math.abs(this.coslat0)<=Dc?(a=Mu(this.e,l*this.con,this.con*c),s=2*this.a*this.k0*a/this.cons,t.x=this.x0+s*Math.sin(o-this.long0),t.y=this.y0-this.con*s*Math.cos(o-this.long0),t):(Math.abs(this.sinlat0)<Dc?(e=2*this.a*this.k0/(1+r*Math.cos(h)),t.y=e*i):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*i+this.cosX0*r*Math.cos(h))),t.y=e*(this.cosX0*i-this.sinX0*r*Math.cos(h))+this.y0),t.x=e*r*Math.sin(h)+this.x0,t))},inverse:function(t){var e,n,i,r,a;t.x-=this.x0,t.y-=this.y0;var s=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var o=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,n=this.lat0,s<=Dc?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(o)*this.sinlat0+t.y*Math.sin(o)*this.coslat0/s),e=Math.abs(this.coslat0)<Dc?this.lat0>0?Pu(this.long0+Math.atan2(t.x,-1*t.y)):Pu(this.long0+Math.atan2(t.x,t.y)):Pu(this.long0+Math.atan2(t.x*Math.sin(o),s*this.coslat0*Math.cos(o)-t.y*this.sinlat0*Math.sin(o))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=Dc){if(s<=Dc)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,i=s*this.cons/(2*this.a*this.k0),n=this.con*Au(this.e,i),e=this.con*Pu(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=Dc?a=this.X0:(a=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/s),e=Pu(this.long0+Math.atan2(t.x*Math.sin(r),s*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),n=-1*Au(this.e,Math.tan(.5*(Nc+a)));return t.x=e,t.y=n,t},names:["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"],ssfn_:Kh};const $h={init:function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,i=1/this.rf,r=2*i-Math.pow(i,2),a=this.e=Math.sqrt(r);this.R=this.k0*n*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),o=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+a*e)/(1-a*e));this.K=s-this.alpha*o+this.alpha*a/2*l},forward:function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+n)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),a=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(a))),o=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(a));return t.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,t.x=this.R*s+this.x0,t},inverse:function(t){for(var e=t.x-this.x0,n=t.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),s=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),o=this.lambda0+s/this.alpha,l=0,c=a,u=-1e3,h=0;Math.abs(c-u)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),u=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=o,t.y=c,t},names:["somerc"]};var Qh=1e-7;const td={init:function(){var t,e,n,i,r,a,s,o,l,c,u,h=0,d=0,f=0,p=0,m=0,g=0,_=0;this.no_off=function(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n="object"===typeof t.projName?Object.keys(t.projName)[0]:t.projName;return"no_uoff"in t||"no_off"in t||-1!==e.indexOf(n)||-1!==e.indexOf(zu(n))}(this),this.no_rot="no_rot"in this;var y=!1;"alpha"in this&&(y=!0);var v=!1;if("rectified_grid_angle"in this&&(v=!0),y&&(_=this.alpha),v&&(h=this.rectified_grid_angle),y||v)d=this.longc;else if(f=this.long1,m=this.lat1,p=this.long2,g=this.lat2,Math.abs(m-g)<=Qh||(t=Math.abs(m))<=Qh||Math.abs(t-Nc)<=Qh||Math.abs(Math.abs(this.lat0)-Nc)<=Qh||Math.abs(Math.abs(g)-Nc)<=Qh)throw new Error;var b=1-this.es;e=Math.sqrt(b),Math.abs(this.lat0)>Dc?(o=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*o*o,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/b),this.A=this.B*this.k0*e/t,(r=(i=this.B*e/(n*Math.sqrt(t)))*i-1)<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(Mu(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),y||v?(y?(u=Math.asin(Math.sin(_)/i),v||(h=_)):(u=h,_=Math.asin(i*Math.sin(u))),this.lam0=d-Math.asin(.5*(r-1/r)*Math.tan(u))/this.B):(a=Math.pow(Mu(this.e,m,Math.sin(m)),this.B),s=Math.pow(Mu(this.e,g,Math.sin(g)),this.B),r=this.E/a,l=(s-a)/(s+a),c=((c=this.E*this.E)-s*a)/(c+s*a),(t=f-p)<-Math.PI?p-=Bc:t>Math.PI&&(p+=Bc),this.lam0=Pu(.5*(f+p)-Math.atan(c*Math.tan(.5*this.B*(f-p))/l)/this.B),u=Math.atan(2*Math.sin(this.B*Pu(f-this.lam0))/(r-1/r)),h=_=Math.asin(i*Math.sin(u))),this.singam=Math.sin(u),this.cosgam=Math.cos(u),this.sinrot=Math.sin(h),this.cosrot=Math.cos(h),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(_))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*u,this.v_pole_n=this.ArB*Math.log(Math.tan(Oc-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(Oc+r))},forward:function(t){var e,n,i,r,a,s,o,l,c={};if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-Nc)>Dc){if(e=.5*((a=this.E/Math.pow(Mu(this.e,t.y,Math.sin(t.y)),this.B))-(s=1/a)),n=.5*(a+s),r=Math.sin(this.B*t.x),i=(e*this.singam-r*this.cosgam)/n,Math.abs(Math.abs(i)-1)<Dc)throw new Error;l=.5*this.ArB*Math.log((1-i)/(1+i)),s=Math.cos(this.B*t.x),o=Math.abs(s)<Qh?this.A*t.x:this.ArB*Math.atan2(e*this.cosgam+r*this.singam,s)}else l=t.y>0?this.v_pole_n:this.v_pole_s,o=this.ArB*t.y;return this.no_rot?(c.x=o,c.y=l):(o-=this.u_0,c.x=l*this.cosrot+o*this.sinrot,c.y=o*this.cosrot-l*this.sinrot),c.x=this.a*c.x+this.x0,c.y=this.a*c.y+this.y0,c},inverse:function(t){var e,n,i,r,a,s,o,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=.5*((i=Math.exp(-this.BrA*n))-1/i),a=.5*(i+1/i),o=((s=Math.sin(this.BrA*e))*this.cosgam+r*this.singam)/a,Math.abs(Math.abs(o)-1)<Dc)l.x=0,l.y=o<0?-Nc:Nc;else{if(l.y=this.E/Math.sqrt((1+o)/(1-o)),l.y=Au(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(r*this.cosgam-s*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};const ed={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Dc)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),i=wu(this.e,e,n),r=Mu(this.e,this.lat1,e),a=Math.sin(this.lat2),s=Math.cos(this.lat2),o=wu(this.e,a,s),l=Mu(this.e,this.lat2,a),c=Math.abs(Math.abs(this.lat0)-Nc)<Dc?0:Mu(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Dc?this.ns=Math.log(i/o)/Math.log(r/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=Dc&&(n=Su(n)*(Nc-2e-10));var i,r,a=Math.abs(Math.abs(n)-Nc);if(a>Dc)i=Mu(this.e,n,Math.sin(n)),r=this.a*this.f0*Math.pow(i,this.ns);else{if((a=n*this.ns)<=0)return null;r=0}var s=this.ns*Pu(e-this.long0);return t.x=this.k0*(r*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(s))+this.y0,t},inverse:function(t){var e,n,i,r,a,s=(t.x-this.x0)/this.k0,o=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+o*o),n=1):(e=-Math.sqrt(s*s+o*o),n=-1);var l=0;if(0!==e&&(l=Math.atan2(n*s,n*o)),0!==e||this.ns>0){if(n=1/this.ns,i=Math.pow(e/(this.a*this.f0),n),-9999===(r=Au(this.e,i)))return null}else r=-Nc;return a=Pu(l/this.ns+this.long0),t.x=a,t.y=r,t},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};const nd={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(t){var e,n,i,r,a,s,o,l=t.x,c=t.y,u=Pu(l-this.long0);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),i=-u*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),a=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(r)),s=this.n*a,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=o*Math.cos(s)/1,t.x=o*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},inverse:function(t){var e,n,i,r,a,s,o,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),a=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),n=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),t.x=this.long0-n/this.alfa,s=e,o=0;var c=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(o=1),s=t.y,c+=1}while(0===o&&c<15);return c>=15?null:t},names:["Krovak","krovak"]};function id(t,e,n,i,r){return t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-i*Math.sin(6*r)}function rd(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function ad(t){return.375*t*(1+.25*t*(1+.46875*t))}function sd(t){return.05859375*t*t*(1+.75*t)}function od(t){return t*t*t*(35/3072)}function ld(t,e,n){var i=e*n;return t/Math.sqrt(1-i*i)}function cd(t){return Math.abs(t)<Nc?t:t-Su(t)*Math.PI}function ud(t,e,n,i,r){var a,s;a=t/e;for(var o=0;o<15;o++)if(a+=s=(t-(e*a-n*Math.sin(2*a)+i*Math.sin(4*a)-r*Math.sin(6*a)))/(e-2*n*Math.cos(2*a)+4*i*Math.cos(4*a)-6*r*Math.cos(6*a)),Math.abs(s)<=1e-10)return a;return NaN}const hd={init:function(){this.sphere||(this.e0=rd(this.es),this.e1=ad(this.es),this.e2=sd(this.es),this.e3=od(this.es),this.ml0=this.a*id(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(t){var e,n,i=t.x,r=t.y;if(i=Pu(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),n=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var a=Math.sin(r),s=Math.cos(r),o=ld(this.a,this.e,a),l=Math.tan(r)*Math.tan(r),c=i*Math.cos(r),u=c*c,h=this.es*s*s/(1-this.es);e=o*c*(1-u*l*(1/6-(8-l+8*h)*u/120)),n=this.a*id(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+o*a/s*u*(.5+(5-l+6*h)*u/24)}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i=t.x/this.a,r=t.y/this.a;if(this.sphere){var a=r+this.lat0;e=Math.asin(Math.sin(a)*Math.cos(i)),n=Math.atan2(Math.tan(i),Math.cos(a))}else{var s=ud(this.ml0/this.a+r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-Nc)<=Dc)return t.x=this.long0,t.y=Nc,r<0&&(t.y*=-1),t;var o=ld(this.a,this.e,Math.sin(s)),l=o*o*o/this.a/this.a*(1-this.es),c=Math.pow(Math.tan(s),2),u=i*this.a/o,h=u*u;e=s-o*Math.tan(s)/l*u*u*(.5-(1+3*c)*u*u/24),n=u*(1-h*(c/3+(1+3*c)*c*h/15))/Math.cos(s)}return t.x=Pu(n+this.long0),t.y=cd(e),t},names:["Cassini","Cassini_Soldner","cass"]};function dd(t,e){var n;return t>1e-7?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e}var fd=.3333333333333333,pd=.17222222222222222,md=.10257936507936508,gd=.06388888888888888,_d=.0664021164021164,yd=.016415012942191543;const vd={init:function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-Nc)<Dc?this.mode=this.lat0<0?1:2:Math.abs(e)<Dc?this.mode=3:this.mode=4,this.es>0)switch(this.qp=dd(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,n=[];return n[0]=t*fd,e=t*t,n[0]+=e*pd,n[1]=e*gd,e*=t,n[0]+=e*md,n[1]+=e*_d,n[2]=e*yd,n}(this.es),this.mode){case 2:case 1:this.dd=1;break;case 3:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case 4:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=dd(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else 4===this.mode&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(t){var e,n,i,r,a,s,o,l,c,u,h=t.x,d=t.y;if(h=Pu(h-this.long0),this.sphere){if(a=Math.sin(d),u=Math.cos(d),i=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+u*i:1+this.sinph0*a+this.cosph0*u*i)<=Dc)return null;e=(n=Math.sqrt(2/n))*u*Math.sin(h),n*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*u*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(d+this.lat0)<Dc)return null;n=Oc-.5*d,e=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(h),n*=i}}else{switch(o=0,l=0,c=0,i=Math.cos(h),r=Math.sin(h),a=Math.sin(d),s=dd(this.e,a),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(o=s/this.qp,l=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:c=1+this.sinb1*o+this.cosb1*l*i;break;case this.EQUIT:c=1+l*i;break;case this.N_POLE:c=Nc+d,s=this.qp-s;break;case this.S_POLE:c=d-Nc,s=this.qp+s}if(Math.abs(c)<Dc)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),n=this.mode===this.OBLIQ?this.ymf*c*(this.cosb1*o-this.sinb1*l*i):(c=Math.sqrt(2/(1+l*i)))*o*this.ymf,e=this.xmf*c*l*r;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(c=Math.sqrt(s))*r,n=i*(this.mode===this.S_POLE?c:-c)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i,r,a,s,o,l=t.x/this.a,c=t.y/this.a;if(this.sphere){var u,h=0,d=0;if((n=.5*(u=Math.sqrt(l*l+c*c)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(d=Math.sin(n),h=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(u)<=Dc?0:Math.asin(c*d/u),l*=d,c=h*u;break;case this.OBLIQ:n=Math.abs(u)<=Dc?this.lat0:Math.asin(h*this.sinph0+c*d*this.cosph0/u),l*=d*this.cosph0,c=(h-Math.sin(n)*this.sinph0)*u;break;case this.N_POLE:c=-c,n=Nc-n;break;case this.S_POLE:n-=Nc}e=0!==c||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,c):0}else{if(o=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,c*=this.dd,(s=Math.sqrt(l*l+c*c))<Dc)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*s/this.rq),i=Math.cos(r),l*=r=Math.sin(r),this.mode===this.OBLIQ?(o=i*this.sinb1+c*r*this.cosb1/s,a=this.qp*o,c=s*this.cosb1*i-c*this.sinb1*r):(o=c*r/s,a=this.qp*o,c=s*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(c=-c),!(a=l*l+c*c))return t.x=this.long0,t.y=this.lat0,t;o=1-a/this.qp,this.mode===this.S_POLE&&(o=-o)}e=Math.atan2(l,c),n=function(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}(Math.asin(o),this.apa)}return t.x=Pu(this.long0+e),t.y=n,t},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function bd(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}const xd={init:function(){Math.abs(this.lat1+this.lat2)<Dc||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=wu(this.e3,this.sin_po,this.cos_po),this.qs1=dd(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=wu(this.e3,this.sin_po,this.cos_po),this.qs2=dd(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=dd(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Dc?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var i=dd(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,a=this.ns0*Pu(e-this.long0),s=r*Math.sin(a)+this.x0,o=this.rh-r*Math.cos(a)+this.y0;return t.x=s,t.y=o,t},inverse:function(t){var e,n,i,r,a,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),r=0,0!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-i*i)/(2*this.ns0)):(n=(this.c-i*i)/this.ns0,s=this.phi1z(this.e3,n)),a=Pu(r/this.ns0+this.long0),t.x=a,t.y=s,t},names:["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"],phi1z:function(t,e){var n,i,r,a,s=bd(.5*e);if(t<Dc)return s;for(var o=t*t,l=1;l<=25;l++)if(s+=a=.5*(r=1-(i=t*(n=Math.sin(s)))*i)*r/Math.cos(s)*(e/(1-o)-n/r+.5/t*Math.log((1-i)/(1+i))),Math.abs(a)<=1e-7)return s;return null}};const wd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(t){var e,n,i,r,a,s,o,l=t.x,c=t.y;return i=Pu(l-this.long0),e=Math.sin(c),n=Math.cos(c),r=Math.cos(i),(a=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(a)<=Dc?(s=this.x0+1*this.a*n*Math.sin(i)/a,o=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)/a):(s=this.x0+this.infinity_dist*n*Math.sin(i),o=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*r)),t.x=s,t.y=o,t},inverse:function(t){var e,n,i,r,a,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),n=Math.sin(r),s=bd((i=Math.cos(r))*this.sin_p14+t.y*n*this.cos_p14/e),a=Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n),a=Pu(this.long0+a)):(s=this.phic0,a=0),t.x=a,t.y=s,t},names:["gnom"]};const Sd={init:function(){this.sphere||(this.k0=wu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(t){var e,n,i=t.x,r=t.y,a=Pu(i-this.long0);if(this.sphere)e=this.x0+this.a*a*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var s=dd(this.e,Math.sin(r));e=this.x0+this.a*this.k0*a,n=this.y0+this.a*s*.5/this.k0}return t.x=e,t.y=n,t},inverse:function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Pu(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*Nc:Nc;for(var i,r,a,s,o=Math.asin(.5*e),l=0;l<30;l++)if(r=Math.sin(o),a=Math.cos(o),s=t*r,o+=i=Math.pow(1-s*s,2)/(2*a)*(e/(1-t*t)-r/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),Math.abs(i)<=1e-10)return o;return NaN}(this.e,2*t.y*this.k0/this.a),e=Pu(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},names:["cea"]};const Pd={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(t){var e=t.x,n=t.y,i=Pu(e-this.long0),r=cd(n-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*r,t},inverse:function(t){var e=t.x,n=t.y;return t.x=Pu(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=cd(this.lat0+(n-this.y0)/this.a),t},names:["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"]};const Md={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=rd(this.es),this.e1=ad(this.es),this.e2=sd(this.es),this.e3=od(this.es),this.ml0=this.a*id(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(t){var e,n,i,r=t.x,a=t.y,s=Pu(r-this.long0);if(i=s*Math.sin(a),this.sphere)Math.abs(a)<=Dc?(e=this.a*s,n=-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(a),n=this.a*(cd(a-this.lat0)+(1-Math.cos(i))/Math.tan(a)));else if(Math.abs(a)<=Dc)e=this.a*s,n=-1*this.ml0;else{var o=ld(this.a,this.e,Math.sin(a))/Math.tan(a);e=o*Math.sin(i),n=this.a*id(this.e0,this.e1,this.e2,this.e3,a)-this.ml0+o*(1-Math.cos(i))}return t.x=e+this.x0,t.y=n+this.y0,t},inverse:function(t){var e,n,i,r,a,s,o,l,c;if(i=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=Dc)e=Pu(i/this.a+this.long0),n=0;else{var u;for(s=this.lat0+r/this.a,o=i*i/this.a/this.a+s*s,l=s,a=20;a;--a)if(l+=c=-1*(s*(l*(u=Math.tan(l))+1)-l-.5*(l*l+o)*u)/((l-s)/u-1),Math.abs(c)<=Dc){n=l;break}e=Pu(this.long0+Math.asin(i*Math.tan(l)/this.a)/Math.sin(n))}else if(Math.abs(r+this.ml0)<=Dc)n=0,e=Pu(this.long0+i/this.a);else{var h,d,f,p,m;for(s=(this.ml0+r)/this.a,o=i*i/this.a/this.a+s*s,l=s,a=20;a;--a)if(m=this.e*Math.sin(l),h=Math.sqrt(1-m*m)*Math.tan(l),d=this.a*id(this.e0,this.e1,this.e2,this.e3,l),f=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),l-=c=(s*(h*(p=d/this.a)+1)-p-.5*h*(p*p+o))/(this.es*Math.sin(2*l)*(p*p+o-2*s*p)/(4*h)+(s-p)*(h*f-2/Math.sin(2*l))-f),Math.abs(c)<=Dc){n=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Pu(this.long0+Math.asin(i*h/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},names:["Polyconic","American_Polyconic","poly"]};const Ad={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(t){var e,n=t.x,i=t.y-this.lat0,r=n-this.long0,a=i/zc*1e-5,s=r,o=1,l=0;for(e=1;e<=10;e++)o*=a,l+=this.A[e]*o;var c,u=l,h=s,d=1,f=0,p=0,m=0;for(e=1;e<=6;e++)c=f*u+d*h,d=d*u-f*h,f=c,p=p+this.B_re[e]*d-this.B_im[e]*f,m=m+this.B_im[e]*d+this.B_re[e]*f;return t.x=m*this.a+this.x0,t.y=p*this.a+this.y0,t},inverse:function(t){var e,n,i=t.x,r=t.y,a=i-this.x0,s=(r-this.y0)/this.a,o=a/this.a,l=1,c=0,u=0,h=0;for(e=1;e<=6;e++)n=c*s+l*o,l=l*s-c*o,c=n,u=u+this.C_re[e]*l-this.C_im[e]*c,h=h+this.C_im[e]*l+this.C_re[e]*c;for(var d=0;d<this.iterations;d++){var f,p=u,m=h,g=s,_=o;for(e=2;e<=6;e++)f=m*u+p*h,p=p*u-m*h,m=f,g+=(e-1)*(this.B_re[e]*p-this.B_im[e]*m),_+=(e-1)*(this.B_im[e]*p+this.B_re[e]*m);p=1,m=0;var y=this.B_re[1],v=this.B_im[1];for(e=2;e<=6;e++)f=m*u+p*h,p=p*u-m*h,m=f,y+=e*(this.B_re[e]*p-this.B_im[e]*m),v+=e*(this.B_im[e]*p+this.B_re[e]*m);var b=y*y+v*v;u=(g*y+_*v)/b,h=(_*y-g*v)/b}var x=u,w=h,S=1,P=0;for(e=1;e<=9;e++)S*=x,P+=this.D[e]*S;var M=this.lat0+P*zc*1e5,A=this.long0+w;return t.x=A,t.y=M,t},names:["New_Zealand_Map_Grid","nzmg"]};const kd={init:function(){},forward:function(t){var e=t.x,n=t.y,i=Pu(e-this.long0),r=this.x0+this.a*i,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=r,t.y=a,t},inverse:function(t){t.x-=this.x0,t.y-=this.y0;var e=Pu(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},names:["Miller_Cylindrical","mill"]};const Ed={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Rh(this.es)},forward:function(t){var e,n,i=t.x,r=t.y;if(i=Pu(i-this.long0),this.sphere){if(this.m)for(var a=this.n*Math.sin(r),s=20;s;--s){var o=(this.m*r+Math.sin(r)-a)/(this.m+Math.cos(r));if(r-=o,Math.abs(o)<Dc)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*i*(this.m+Math.cos(r)),n=this.a*this.C_y*r}else{var l=Math.sin(r),c=Math.cos(r);n=this.a*Fh(r,l,c,this.en),e=this.a*i*c/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t},inverse:function(t){var e,n,i;return t.x-=this.x0,n=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,n/=this.C_x*(this.m+Math.cos(e)),this.m?e=bd((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=bd(Math.sin(e)/this.n)),n=Pu(n+this.long0),e=cd(e)):(e=Oh(t.y/this.a,this.es,this.en),(i=Math.abs(e))<Nc?(i=Math.sin(e),n=Pu(this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)))):i-Dc<Nc&&(n=this.long0)),t.x=n,t.y=e,t},names:["Sinusoidal","sinu"]};const Td={init:function(){},forward:function(t){for(var e=t.x,n=t.y,i=Pu(e-this.long0),r=n,a=Math.PI*Math.sin(n);;){var s=-(r+Math.sin(r)-a)/(1+Math.cos(r));if(r+=s,Math.abs(s)<Dc)break}r/=2,Math.PI/2-Math.abs(n)<Dc&&(i=0);var o=.900316316158*this.a*i*Math.cos(r)+this.x0,l=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=o,t.y=l,t},inverse:function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var i=Pu(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var r=Math.asin(n);return t.x=i,t.y=r,t},names:["Mollweide","moll"]};const Cd={init:function(){Math.abs(this.lat1+this.lat2)<Dc||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=rd(this.es),this.e1=ad(this.es),this.e2=sd(this.es),this.e3=od(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=wu(this.e,this.sin_phi,this.cos_phi),this.ml1=id(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Dc?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=wu(this.e,this.sin_phi,this.cos_phi),this.ml2=id(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=id(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(t){var e,n=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var r=id(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-r)}var a=this.ns*Pu(n-this.long0),s=this.x0+e*Math.sin(a),o=this.y0+this.rh-e*Math.cos(a);return t.x=s,t.y=o,t},inverse:function(t){var e,n,i,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var a=0;return 0!==n&&(a=Math.atan2(e*t.x,e*t.y)),this.sphere?(r=Pu(this.long0+a/this.ns),i=cd(this.g-n/this.a),t.x=r,t.y=i,t):(i=ud(this.g-n/this.a,this.e0,this.e1,this.e2,this.e3),r=Pu(this.long0+a/this.ns),t.x=r,t.y=i,t)},names:["Equidistant_Conic","eqdc"]};const Id={init:function(){this.R=this.a},forward:function(t){var e,n,i=t.x,r=t.y,a=Pu(i-this.long0);Math.abs(r)<=Dc&&(e=this.x0+this.R*a,n=this.y0);var s=bd(2*Math.abs(r/Math.PI));(Math.abs(a)<=Dc||Math.abs(Math.abs(r)-Nc)<=Dc)&&(e=this.x0,n=r>=0?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var o=.5*Math.abs(Math.PI/a-a/Math.PI),l=o*o,c=Math.sin(s),u=Math.cos(s),h=u/(c+u-1),d=h*h,f=h*(2/c-1),p=f*f,m=Math.PI*this.R*(o*(h-p)+Math.sqrt(l*(h-p)*(h-p)-(p+l)*(d-p)))/(p+l);a<0&&(m=-m),e=this.x0+m;var g=l+h;return m=Math.PI*this.R*(f*g-o*Math.sqrt((p+l)*(l+1)-g*g))/(p+l),n=r>=0?this.y0+m:this.y0-m,t.x=e,t.y=n,t},inverse:function(t){var e,n,i,r,a,s,o,l,c,u,h,d;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,a=(i=t.x/h)*i+(r=t.y/h)*r,h=3*(r*r/(l=-2*(s=-Math.abs(r)*(1+a))+1+2*r*r+a*a)+(2*(o=s-2*r*r+i*i)*o*o/l/l/l-9*s*o/l/l)/27)/(c=(s-o*o/3/l)/l)/(u=2*Math.sqrt(-c/3)),Math.abs(h)>1&&(h=h>=0?1:-1),d=Math.acos(h)/3,n=t.y>=0?(-u*Math.cos(d+Math.PI/3)-o/3/l)*Math.PI:-(-u*Math.cos(d+Math.PI/3)-o/3/l)*Math.PI,e=Math.abs(i)<Dc?this.long0:Pu(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(i*i-r*r)+a*a))/2/i),t.x=e,t.y=n,t},names:["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"]};const Ld={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))},forward:function(t){var e,n,i,r,a,s,o,l,c,u,h,d=t.x,f=t.y,p=Math.sin(t.y),m=Math.cos(t.y),g=Pu(d-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=Dc?(t.x=this.x0+this.a*(Nc-f)*Math.sin(g),t.y=this.y0-this.a*(Nc-f)*Math.cos(g),t):Math.abs(this.sin_p12+1)<=Dc?(t.x=this.x0+this.a*(Nc+f)*Math.sin(g),t.y=this.y0+this.a*(Nc+f)*Math.cos(g),t):(c=this.sin_p12*p+this.cos_p12*m*Math.cos(g),l=(o=Math.acos(c))?o/Math.sin(o):1,t.x=this.x0+this.a*l*m*Math.sin(g),t.y=this.y0+this.a*l*(this.cos_p12*p-this.sin_p12*m*Math.cos(g)),t):(e=rd(this.es),n=ad(this.es),i=sd(this.es),r=od(this.es),Math.abs(this.sin_p12-1)<=Dc?(a=this.a*id(e,n,i,r,Nc),s=this.a*id(e,n,i,r,f),t.x=this.x0+(a-s)*Math.sin(g),t.y=this.y0-(a-s)*Math.cos(g),t):Math.abs(this.sin_p12+1)<=Dc?(a=this.a*id(e,n,i,r,Nc),s=this.a*id(e,n,i,r,f),t.x=this.x0+(a+s)*Math.sin(g),t.y=this.y0+(a+s)*Math.cos(g),t):Math.abs(d)<Dc&&Math.abs(f-this.lat0)<Dc?(t.x=t.y=0,t):(u=function(t,e,n,i,r,a){const s=i-e,o=Math.atan((1-a)*Math.tan(t)),l=Math.atan((1-a)*Math.tan(n)),c=Math.sin(o),u=Math.cos(o),h=Math.sin(l),d=Math.cos(l);let f,p,m,g,_,y,v,b,x,w,S,P,M,A,k,E=s,T=100;do{if(p=Math.sin(E),m=Math.cos(E),g=Math.sqrt(d*p*(d*p)+(u*h-c*d*m)*(u*h-c*d*m)),0===g)return{azi1:0,s12:0};_=c*h+u*d*m,y=Math.atan2(g,_),v=u*d*p/g,b=1-v*v,x=0!==b?_-2*c*h/b:0,w=a/16*b*(4+a*(4-3*b)),f=E,E=s+(1-w)*a*v*(y+w*g*(x+w*_*(2*x*x-1)))}while(Math.abs(E-f)>1e-12&&--T>0);return 0===T?{azi1:NaN,s12:NaN}:(S=b*(r*r-r*(1-a)*(r*(1-a)))/(r*(1-a)*(r*(1-a))),P=1+S/16384*(4096+S*(S*(320-175*S)-768)),M=S/1024*(256+S*(S*(74-47*S)-128)),A=M*g*(x+M/4*(_*(2*x*x-1)-M/6*x*(4*g*g-3)*(4*x*x-3))),k=r*(1-a)*P*(y-A),{azi1:Math.atan2(d*p,u*h-c*d*m),s12:k})}(this.lat0,this.long0,f,d,this.a,this.f),h=u.azi1,t.x=u.s12*Math.sin(h),t.y=u.s12*Math.cos(h),t))},inverse:function(t){var e,n,i,r,a,s,o,l,c,u,h,d,f,p,m;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*Nc*this.a)return;return n=e/this.a,i=Math.sin(n),r=Math.cos(n),a=this.long0,Math.abs(e)<=Dc?s=this.lat0:(s=bd(r*this.sin_p12+t.y*i*this.cos_p12/e),o=Math.abs(this.lat0)-Nc,a=Math.abs(o)<=Dc?this.lat0>=0?Pu(this.long0+Math.atan2(t.x,-t.y)):Pu(this.long0-Math.atan2(-t.x,t.y)):Pu(this.long0+Math.atan2(t.x*i,e*this.cos_p12*r-t.y*this.sin_p12*i))),t.x=a,t.y=s,t}return l=rd(this.es),c=ad(this.es),u=sd(this.es),h=od(this.es),Math.abs(this.sin_p12-1)<=Dc?(s=ud(((d=this.a*id(l,c,u,h,Nc))-(e=Math.sqrt(t.x*t.x+t.y*t.y)))/this.a,l,c,u,h),a=Pu(this.long0+Math.atan2(t.x,-1*t.y)),t.x=a,t.y=s,t):Math.abs(this.sin_p12+1)<=Dc?(d=this.a*id(l,c,u,h,Nc),s=ud(((e=Math.sqrt(t.x*t.x+t.y*t.y))-d)/this.a,l,c,u,h),a=Pu(this.long0+Math.atan2(t.x,t.y)),t.x=a,t.y=s,t):(f=Math.atan2(t.x,t.y),p=Math.sqrt(t.x*t.x+t.y*t.y),m=function(t,e,n,i,r,a){const s=Math.atan((1-a)*Math.tan(t)),o=Math.sin(s),l=Math.cos(s),c=Math.sin(n),u=Math.cos(n),h=Math.atan2(o,l*u),d=l*c,f=1-d*d,p=f*(r*r-r*(1-a)*(r*(1-a)))/(r*(1-a)*(r*(1-a))),m=1+p/16384*(4096+p*(p*(320-175*p)-768)),g=p/1024*(256+p*(p*(74-47*p)-128));let _,y,v,b,x,w=i/(r*(1-a)*m),S=100;do{y=Math.cos(2*h+w),v=Math.sin(w),b=Math.cos(w),x=g*v*(y+g/4*(b*(2*y*y-1)-g/6*y*(4*v*v-3)*(4*y*y-3))),_=w,w=i/(r*(1-a)*m)+x}while(Math.abs(w-_)>1e-12&&--S>0);if(0===S)return{lat2:NaN,lon2:NaN};const P=o*v-l*b*u,M=a/16*f*(4+a*(4-3*f));return{lat2:Math.atan2(o*b+l*v*u,(1-a)*Math.sqrt(d*d+P*P)),lon2:e+(Math.atan2(v*c,l*b-o*v*u)-(1-M)*a*d*(w+M*v*(y+M*b*(2*y*y-1))))}}(this.lat0,this.long0,f,p,this.a,this.f),t.x=m.lon2,t.y=m.lat2,t)},names:["Azimuthal_Equidistant","aeqd"]};const zd={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(t){var e,n,i,r,a,s,o,l=t.x,c=t.y;return i=Pu(l-this.long0),e=Math.sin(c),n=Math.cos(c),r=Math.cos(i),((a=this.sin_p14*e+this.cos_p14*n*r)>0||Math.abs(a)<=Dc)&&(s=1*this.a*n*Math.sin(i),o=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)),t.x=s,t.y=o,t},inverse:function(t){var e,n,i,r,a,s,o;return t.x-=this.x0,t.y-=this.y0,n=bd((e=Math.sqrt(t.x*t.x+t.y*t.y))/this.a),i=Math.sin(n),r=Math.cos(n),s=this.long0,Math.abs(e)<=Dc?(o=this.lat0,t.x=s,t.y=o,t):(o=bd(r*this.sin_p14+t.y*i*this.cos_p14/e),a=Math.abs(this.lat0)-Nc,Math.abs(a)<=Dc?(s=this.lat0>=0?Pu(this.long0+Math.atan2(t.x,-t.y)):Pu(this.long0-Math.atan2(-t.x,t.y)),t.x=s,t.y=o,t):(s=Pu(this.long0+Math.atan2(t.x*i,e*this.cos_p14*r-t.y*this.sin_p14*i)),t.x=s,t.y=o,t))},names:["ortho"]};var Nd=1,Dd=2,Rd=3,Fd=4,Od=5,Bd=6,jd=1,Ud=2,Gd=3,qd=4;function Vd(t,e,n,i){var r;return t<Dc?(i.value=jd,r=0):(r=Math.atan2(e,n),Math.abs(r)<=Oc?i.value=jd:r>Oc&&r<=Nc+Oc?(i.value=Ud,r-=Nc):r>Nc+Oc||r<=-(Nc+Oc)?(i.value=Gd,r=r>=0?r-jc:r+jc):(i.value=qd,r+=Nc)),r}function Zd(t,e){var n=t+e;return n<-jc?n+=Bc:n>+jc&&(n-=Bc),n}const Wd={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Nc-Oc/2?this.face=Od:this.lat0<=-(Nc-Oc/2)?this.face=Bd:Math.abs(this.long0)<=Oc?this.face=Nd:Math.abs(this.long0)<=Nc+Oc?this.face=this.long0>0?Dd:Fd:this.face=Rd,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(t){var e,n,i,r,a,s,o={x:0,y:0},l={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,n=t.x,this.face===Od)r=Nc-e,n>=Oc&&n<=Nc+Oc?(l.value=jd,i=n-Nc):n>Nc+Oc||n<=-(Nc+Oc)?(l.value=Ud,i=n>0?n-jc:n+jc):n>-(Nc+Oc)&&n<=-Oc?(l.value=Gd,i=n+Nc):(l.value=qd,i=n);else if(this.face===Bd)r=Nc+e,n>=Oc&&n<=Nc+Oc?(l.value=jd,i=-n+Nc):n<Oc&&n>=-Oc?(l.value=Ud,i=-n):n<-Oc&&n>=-(Nc+Oc)?(l.value=Gd,i=-n-Nc):(l.value=qd,i=n>0?-n+jc:-n-jc);else{var c,u,h,d,f,p;this.face===Dd?n=Zd(n,+Nc):this.face===Rd?n=Zd(n,+jc):this.face===Fd&&(n=Zd(n,-Nc)),d=Math.sin(e),f=Math.cos(e),p=Math.sin(n),c=f*Math.cos(n),u=f*p,h=d,this.face===Nd?i=Vd(r=Math.acos(c),h,u,l):this.face===Dd?i=Vd(r=Math.acos(u),h,-c,l):this.face===Rd?i=Vd(r=Math.acos(-c),h,-u,l):this.face===Fd?i=Vd(r=Math.acos(-u),h,c,l):(r=i=0,l.value=jd)}return s=Math.atan(12/jc*(i+Math.acos(Math.sin(i)*Math.cos(Oc))-Nc)),a=Math.sqrt((1-Math.cos(r))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Ud?s+=Nc:l.value===Gd?s+=jc:l.value===qd&&(s+=1.5*jc),o.x=a*Math.cos(s),o.y=a*Math.sin(s),o.x=o.x*this.a+this.x0,o.y=o.y*this.a+this.y0,t.x=o.x,t.y=o.y,t},inverse:function(t){var e,n,i,r,a,s,o,l,c,u,h,d,f={lam:0,phi:0},p={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?p.value=jd:t.y>=0&&t.y>=Math.abs(t.x)?(p.value=Ud,e-=Nc):t.x<0&&-t.x>=Math.abs(t.y)?(p.value=Gd,e=e<0?e+jc:e-jc):(p.value=qd,e+=Nc),c=jc/12*Math.tan(e),a=Math.sin(c)/(Math.cos(c)-1/Math.sqrt(2)),s=Math.atan(a),(o=1-(i=Math.cos(e))*i*(r=Math.tan(n))*r*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?o=-1:o>1&&(o=1),this.face===Od)l=Math.acos(o),f.phi=Nc-l,p.value===jd?f.lam=s+Nc:p.value===Ud?f.lam=s<0?s+jc:s-jc:p.value===Gd?f.lam=s-Nc:f.lam=s;else if(this.face===Bd)l=Math.acos(o),f.phi=l-Nc,p.value===jd?f.lam=-s+Nc:p.value===Ud?f.lam=-s:p.value===Gd?f.lam=-s-Nc:f.lam=s<0?-s-jc:-s+jc;else{var m,g,_;c=(m=o)*m,g=(c+=(_=c>=1?0:Math.sqrt(1-c)*Math.sin(s))*_)>=1?0:Math.sqrt(1-c),p.value===Ud?(c=g,g=-_,_=c):p.value===Gd?(g=-g,_=-_):p.value===qd&&(c=g,g=_,_=-c),this.face===Dd?(c=m,m=-g,g=c):this.face===Rd?(m=-m,g=-g):this.face===Fd&&(c=m,m=g,g=-c),f.phi=Math.acos(-_)-Nc,f.lam=Math.atan2(g,m),this.face===Dd?f.lam=Zd(f.lam,-Nc):this.face===Rd?f.lam=Zd(f.lam,-jc):this.face===Fd&&(f.lam=Zd(f.lam,+Nc))}return 0!==this.es&&(u=f.phi<0?1:0,h=Math.tan(f.phi),d=this.b/Math.sqrt(h*h+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),u&&(f.phi=-f.phi)),f.lam+=this.long0,t.x=f.lam,t.y=f.phi,t},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var Hd=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Xd=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Yd=.8487,Kd=1.3523,Jd=Fc/5,$d=1/Jd,Qd=18,tf=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))};const ef={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(t){var e=Pu(t.x-this.long0),n=Math.abs(t.y),i=Math.floor(n*Jd);i<0?i=0:i>=Qd&&(i=17);var r={x:tf(Hd[i],n=Fc*(n-$d*i))*e,y:tf(Xd[i],n)};return t.y<0&&(r.y=-r.y),r.x=r.x*this.a*Yd+this.x0,r.y=r.y*this.a*Kd+this.y0,r},inverse:function(t){var e={x:(t.x-this.x0)/(this.a*Yd),y:Math.abs(t.y-this.y0)/(this.a*Kd)};if(e.y>=1)e.x/=Hd[18][0],e.y=t.y<0?-Nc:Nc;else{var n=Math.floor(e.y*Qd);for(n<0?n=0:n>=Qd&&(n=17);;)if(Xd[n][0]>e.y)--n;else{if(!(Xd[n+1][0]<=e.y))break;++n}var i=Xd[n],r=5*(e.y-i[0])/(Xd[n+1][0]-i[0]);r=function(t,e,n,i){for(var r=e;i;--i){var a=t(r);if(r-=a,Math.abs(a)<n)break}return r}(function(t){return(tf(i,t)-e.y)/function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])}(i,t)},r,Dc,100),e.x/=tf(Hd[n],r),e.y=(5*n+r)*Rc,t.y<0&&(e.y=-e.y)}return e.x=Pu(e.x+this.long0),e},names:["Robinson","robin"]};const nf={init:function(){this.name="geocent"},forward:function(t){return Qu(t,this.es,this.a)},inverse:function(t){return th(t,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var rf=0,af=1,sf=2,of=3,lf={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const cf={init:function(){if(Object.keys(lf).forEach(function(t){if("undefined"===typeof this[t])this[t]=lf[t].def;else{if(lf[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);lf[t].num&&(this[t]=parseFloat(this[t]))}lf[t].degrees&&(this[t]=this[t]*Rc)}.bind(this)),Math.abs(Math.abs(this.lat0)-Nc)<Dc?this.mode=this.lat0<0?af:rf:Math.abs(this.lat0)<Dc?this.mode=sf:(this.mode=of,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)},forward:function(t){t.x-=this.long0;var e,n,i,r,a=Math.sin(t.y),s=Math.cos(t.y),o=Math.cos(t.x);switch(this.mode){case of:n=this.sinph0*a+this.cosph0*s*o;break;case sf:n=s*o;break;case af:n=-a;break;case rf:n=a}switch(e=(n=this.pn1/(this.p-n))*s*Math.sin(t.x),this.mode){case of:n*=this.cosph0*a-this.sinph0*s*o;break;case sf:n*=a;break;case rf:n*=-s*o;break;case af:n*=s*o}return r=1/((i=n*this.cg+e*this.sg)*this.sw*this.h1+this.cw),e=(e*this.cg-n*this.sg)*this.cw*r,n=i*r,t.x=e*this.a,t.y=n*this.a,t},inverse:function(t){t.x/=this.a,t.y/=this.a;var e,n,i,r={x:t.x,y:t.y};i=1/(this.pn1-t.y*this.sw),e=this.pn1*t.x*i,n=this.pn1*t.y*this.cw*i,t.x=e*this.cg+n*this.sg,t.y=n*this.cg-e*this.sg;var a=Uh(t.x,t.y);if(Math.abs(a)<Dc)r.x=0,r.y=t.y;else{var s,o;switch(o=1-a*a*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/a+a/this.pn1),s=Math.sqrt(1-o*o),this.mode){case of:r.y=Math.asin(s*this.sinph0+t.y*o*this.cosph0/a),t.y=(s-this.sinph0*Math.sin(r.y))*a,t.x*=o*this.cosph0;break;case sf:r.y=Math.asin(t.y*o/a),t.y=s*a,t.x*=o;break;case rf:r.y=Math.asin(s),t.y=-t.y;break;case af:r.y=-Math.asin(s)}r.x=Math.atan2(t.x,t.y)}return t.x=r.x+this.long0,t.y=r.y,t},names:["Tilted_Perspective","tpers"]};const uf={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(t){var e,n,i,r,a=t.x,s=t.y;if(a-=this.long0,"ellipse"===this.shape){s=Math.atan(this.radius_p2*Math.tan(s));var o=this.radius_p/Uh(this.radius_p*Math.cos(s),Math.sin(s));if(n=o*Math.cos(a)*Math.cos(s),i=o*Math.sin(a)*Math.cos(s),r=o*Math.sin(s),(this.radius_g-n)*n-i*i-r*r*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;e=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/Uh(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(i/e),t.y=this.radius_g_1*Math.atan(r/Uh(i,e)))}else"sphere"===this.shape&&(e=Math.cos(s),n=Math.cos(a)*e,i=Math.sin(a)*e,r=Math.sin(s),e=this.radius_g-n,this.flip_axis?(t.x=this.radius_g_1*Math.atan(i/Uh(r,e)),t.y=this.radius_g_1*Math.atan(r/e)):(t.x=this.radius_g_1*Math.atan(i/e),t.y=this.radius_g_1*Math.atan(r/Uh(i,e))));return t.x=t.x*this.a,t.y=t.y*this.a,t},inverse:function(t){var e,n,i,r,a=-1,s=0,o=0;if(t.x=t.x/this.a,t.y=t.y/this.a,"ellipse"===this.shape){this.flip_axis?(o=Math.tan(t.y/this.radius_g_1),s=Math.tan(t.x/this.radius_g_1)*Uh(1,o)):(s=Math.tan(t.x/this.radius_g_1),o=Math.tan(t.y/this.radius_g_1)*Uh(1,s));var l=o/this.radius_p;if(e=s*s+l*l+a*a,(i=(n=2*this.radius_g*a)*n-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-n-Math.sqrt(i))/(2*e),a=this.radius_g+r*a,s*=r,o*=r,t.x=Math.atan2(s,a),t.y=Math.atan(o*Math.cos(t.x)/a),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if("sphere"===this.shape){if(this.flip_axis?(o=Math.tan(t.y/this.radius_g_1),s=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+o*o)):(s=Math.tan(t.x/this.radius_g_1),o=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+s*s)),e=s*s+o*o+a*a,(i=(n=2*this.radius_g*a)*n-4*e*this.C)<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=(-n-Math.sqrt(i))/(2*e),a=this.radius_g+r*a,s*=r,o*=r,t.x=Math.atan2(s,a),t.y=Math.atan(o*Math.cos(t.x)/a)}return t.x=t.x+this.long0,t},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var hf=1.340264,df=-.081106,ff=893e-6,pf=.003796,mf=Math.sqrt(3)/2;const gf={init:function(){this.es=0,this.long0=void 0!==this.long0?this.long0:0},forward:function(t){var e=Pu(t.x-this.long0),n=t.y,i=Math.asin(mf*Math.sin(n)),r=i*i,a=r*r*r;return t.x=e*Math.cos(i)/(mf*(hf+3*df*r+a*(7*ff+9*pf*r))),t.y=i*(hf+df*r+a*(ff+pf*r)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e,n,i,r,a=t.y;for(r=0;r<12&&(a-=i=(a*(hf+df*(e=a*a)+(n=e*e*e)*(ff+pf*e))-t.y)/(hf+3*df*e+n*(7*ff+9*pf*e)),!(Math.abs(i)<1e-9));++r);return n=(e=a*a)*e*e,t.x=mf*t.x*(hf+3*df*e+n*(7*ff+9*pf*e))/Math.cos(a),t.y=Math.asin(Math.sin(a)/mf),t.x=Pu(t.x+this.long0),t},names:["eqearth","Equal Earth","Equal_Earth"]};var _f=1e-10;function yf(t){var e,n,i,r=Pu(t.x-(this.long0||0)),a=t.y;return e=this.am1+this.m1-Fh(a,n=Math.sin(a),i=Math.cos(a),this.en),n=i*r/(e*Math.sqrt(1-this.es*n*n)),t.x=e*Math.sin(n),t.y=this.am1-e*Math.cos(n),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function vf(t){var e,n,i,r;if(t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a,n=Uh(t.x,t.y=this.am1-t.y),r=Oh(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(r))<Nc)e=Math.sin(r),i=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(r);else{if(!(Math.abs(e-Nc)<=_f))throw new Error;i=0}return t.x=Pu(i+(this.long0||0)),t.y=cd(r),t}function bf(t){var e,n,i=Pu(t.x-(this.long0||0)),r=t.y;return n=this.cphi1+this.phi1-r,Math.abs(n)>_f?(t.x=n*Math.sin(e=i*Math.cos(r)/n),t.y=this.cphi1-n*Math.cos(e)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function xf(t){var e,n;t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var i=Uh(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-i,Math.abs(n)>Nc)throw new Error;return e=Math.abs(Math.abs(n)-Nc)<=_f?0:i*Math.atan2(t.x,t.y)/Math.cos(n),t.x=Pu(e+(this.long0||0)),t.y=cd(n),t}const wf={init:function(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<_f)throw new Error;this.es?(this.en=Rh(this.es),this.m1=Fh(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=vf,this.forward=yf):(Math.abs(this.phi1)+_f>=Nc?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=xf,this.forward=bf)},names:["bonne","Bonne (Werner lat_1=90)"]};const Sf=Object.assign(fh,{defaultDatum:"WGS84",Proj:$u,WGS84:new $u("WGS84"),Point:Lh,toPoint:oh,defs:yu,nadgrid:function(t,e,n){return e instanceof ArrayBuffer?function(t,e,n){var i=!0;void 0!==n&&!1===n.includeErrorFields&&(i=!1);var r=new DataView(e),a=function(t){var e=t.getInt32(8,!1);if(11===e)return!1;e=t.getInt32(8,!0),11!==e&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");return!0}(r),s=function(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:Hu(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}(r,a),o=function(t,e,n,i){for(var r=176,a=[],s=0;s<e.nSubgrids;s++){var o=Yu(t,r,n),l=Ku(t,r,o,n,i),c=Math.round(1+(o.upperLongitude-o.lowerLongitude)/o.longitudeInterval),u=Math.round(1+(o.upperLatitude-o.lowerLatitude)/o.latitudeInterval);a.push({ll:[Wu(o.lowerLongitude),Wu(o.lowerLatitude)],del:[Wu(o.longitudeInterval),Wu(o.latitudeInterval)],lim:[c,u],count:o.gridNodeCount,cvs:Xu(l)});var h=16;!1===i&&(h=8),r+=176+o.gridNodeCount*h}return a}(r,s,a,i),l={header:s,subgrids:o};return Gu[t]=l,l}(t,e,n):{ready:qu(t,e)}},transform:ch,mgrs:xh,version:"__VERSION__"});!function(t){t.Proj.projections.add(Bh),t.Proj.projections.add(Zh),t.Proj.projections.add(Wh),t.Proj.projections.add(Yh),t.Proj.projections.add(Jh),t.Proj.projections.add($h),t.Proj.projections.add(td),t.Proj.projections.add(ed),t.Proj.projections.add(nd),t.Proj.projections.add(hd),t.Proj.projections.add(vd),t.Proj.projections.add(xd),t.Proj.projections.add(wd),t.Proj.projections.add(Sd),t.Proj.projections.add(Pd),t.Proj.projections.add(Md),t.Proj.projections.add(Ad),t.Proj.projections.add(kd),t.Proj.projections.add(Ed),t.Proj.projections.add(Td),t.Proj.projections.add(Cd),t.Proj.projections.add(Id),t.Proj.projections.add(Ld),t.Proj.projections.add(zd),t.Proj.projections.add(Wd),t.Proj.projections.add(ef),t.Proj.projections.add(nf),t.Proj.projections.add(cf),t.Proj.projections.add(uf),t.Proj.projections.add(gf),t.Proj.projections.add(wf)}(Sf);const Pf=Sf;const Mf=[13.375,52.515,13.405,52.525],Af=[{name:"Default Style",url:"https://tiles.stadiamaps.com/styles/osm_bright.json"}],kf=()=>{const[t,n]=(0,e.useState)(Mf),[i,a]=(0,e.useState)(["water","streets"]),[s,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(!1),[u,p]=(0,e.useState)(null),[m,g]=(0,e.useState)(!1);(0,e.useEffect)(()=>{m&&(c(!0),p(null),async function(t,e){const n="".concat(t[1],",").concat(t[0],",").concat(t[3],",").concat(t[2]),i=e.map(t=>"".concat(Ue[t],"(").concat(n,");")).join("\n"),r="[out:json][timeout:25];\n(\n".concat(i,"\n);\nout body;>;\nout skel qt;");return console.log("Overpass Query:",r),(await je.post("https://overpass.kumi.systems/api/interpreter",r,{headers:{"Content-Type":"text/plain"}})).data}(t,i).then(t=>o(t)).catch(()=>p("Failed to fetch OSM data")).finally(()=>c(!1)),g(!1))},[m,t,i]);const y=(0,e.useRef)(null),[v,b]=(0,e.useState)({scale:5e3,paperSize:"A4",orientation:"portrait"});const x={A4:[210,297],A3:[297,420]};(0,e.useEffect)(()=>{!function(e){let{scale:i,paperSize:r,orientation:a}=e,[s,o]=x[r]||[210,297];"landscape"===a&&([s,o]=[o,s]);const l=s/1e3*i,c=o/1e3*i,[u,h,d,f]=t,p=(u+d)/2,m=(h+f)/2,g=c/2/111320,_=l/2/(40075e3*Math.cos(m*Math.PI/180)/360);n([p-_,m-g,p+_,m+g])}(v)},[v.paperSize,v.orientation,v.scale]);return(0,r.jsxs)("div",{style:{position:"relative",height:"100vh",width:"100vw",fontFamily:"Inter, Helvetica Neue, Arial, sans-serif",background:"#f4f6fa",overflow:"hidden"},children:[(0,r.jsx)("div",{style:{position:"absolute",inset:0,zIndex:1},children:(0,r.jsx)(_,{ref:y,styleUrl:Af[0].url,bbox:t,onBboxChange:n,osmData:s,selectedTypes:i})}),(0,r.jsx)(h,{loading:l,error:u,selectedTypes:i,setSelectedTypes:a,exportOptions:v,setExportOptions:b,handleExport:async e=>{const n=new Fo({orientation:e.orientation,format:e.paperSize.toLowerCase()});if(s&&s.elements){const r={};for(const t of s.elements)"node"===t.type&&(r[t.id]=[t.lon,t.lat]);const a=[];for(const t of s.elements)if("way"===t.type&&t.nodes){const e=t.nodes.map(t=>r[t]).filter(Boolean);e.length>1&&a.push({type:"Feature",geometry:{type:"LineString",coordinates:e},properties:t.tags||{}})}const o=10,l=n.internal.pageSize.getWidth(),c=n.internal.pageSize.getHeight(),u=l-2*o,h=c-2*o,[d,f,p,m]=t,g="+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs",_=t=>Pf("EPSG:4326",g,t),y=[[d,f],[d,m],[p,m],[p,f]].map(_),v=y.map(t=>{let[e,n]=t;return e}),b=y.map(t=>{let[e,n]=t;return n}),w=Math.min(...v),S=Math.max(...v),P=Math.min(...b),M=Math.max(...b);let[A,k]=x[e.paperSize]||[210,297];"landscape"===e.orientation&&([A,k]=[k,A]);e.scale,e.scale;const E=w,T=S,C=P,I=M,L=t=>{let[e,n]=t;const[i,r]=_([e,n]);if(i<E||i>T||r<C||r>I)return[NaN,NaN];return[o+(i-E)/(T-E)*u,o+h-(r-C)/(I-C)*h]},z=a.filter(t=>i.includes("water")&&t.properties&&(t.properties.waterway||"water"===t.properties.natural)),N=a.filter(t=>i.includes("streets")&&t.properties&&t.properties.highway),D=a.filter(t=>i.includes("buildings")&&t.properties&&t.properties.building),R=(t,e)=>{n.setDrawColor(...e),n.setLineWidth(.7),t.forEach(t=>{if("LineString"===t.geometry.type){const e=t.geometry.coordinates.map(L);if(e.length>1&&e.some(t=>{let[e,n]=t;return!isNaN(e)&&!isNaN(n)})){let t=!1;e.forEach(e=>{let[i,r]=e;isNaN(i)||isNaN(r)||(t?n.lineTo(i,r):(n.moveTo(i,r),t=!0))}),t&&n.stroke()}}})};R(z,[51,153,255]),R(N,[255,102,0]),R(D,[136,136,136]);const F=[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4],O=T-E,B=O/u;let j=F[0];for(const t of F)t<O/4&&(j=t);const U=j/B,G=o+12,q=c-o-24;n.setDrawColor(0,0,0),n.setLineWidth(1),n.line(G,q,G+U,q),n.line(G,q-3,G,q+3),n.line(G+U,q-3,G+U,q+3),n.setFontSize(10),n.text("".concat(j," m"),G+U/2,q-4,{align:"center"});const V=o+24,Z=o+32,W=18;n.setDrawColor(0,0,0),n.setLineWidth(1.2),n.line(V,Z,V,Z-W),n.line(V,Z-W,V-4,Z-W+7),n.line(V,Z-W,V+4,Z-W+7),n.setFontSize(12),n.text("N",V,Z-W-4,{align:"center"})}n.save("siteplan-export.pdf")}}),(0,r.jsxs)("div",{style:{position:"absolute",bottom:40,right:40,display:"flex",flexDirection:"column",gap:28,zIndex:30},children:[(0,r.jsx)("button",{onClick:()=>g(!0),title:"Fetch OSM Data",style:{width:64,height:64,borderRadius:32,border:"1.5px solid rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.35)",boxShadow:"0 8px 32px rgba(0,0,0,0.18)",backdropFilter:"blur(18px)",display:"flex",alignItems:"center",justifyContent:"center",color:"#1976d2",cursor:"pointer",transition:"box-shadow 0.2s, background 0.2s",WebkitBackdropFilter:"blur(18px)",outline:"none"},onMouseOver:t=>t.currentTarget.style.background="rgba(255,255,255,0.55)",onMouseOut:t=>t.currentTarget.style.background="rgba(255,255,255,0.35)",children:(0,r.jsx)(d,{size:32})}),(0,r.jsx)("button",{onClick:()=>{if(y.current){const e=y.current.getCenter(),[i,r,a,s]=t,o=(a-i)/2,l=(s-r)/2;n([e.lng-o,e.lat-l,e.lng+o,e.lat+l])}},title:"Center BBox Here",style:{width:64,height:64,borderRadius:32,border:"1.5px solid rgba(255,255,255,0.5)",background:"rgba(255,255,255,0.35)",boxShadow:"0 8px 32px rgba(0,0,0,0.18)",backdropFilter:"blur(18px)",display:"flex",alignItems:"center",justifyContent:"center",color:"#1976d2",cursor:"pointer",transition:"box-shadow 0.2s, background 0.2s",WebkitBackdropFilter:"blur(18px)",outline:"none"},onMouseOver:t=>t.currentTarget.style.background="rgba(255,255,255,0.55)",onMouseOut:t=>t.currentTarget.style.background="rgba(255,255,255,0.35)",children:(0,r.jsx)(f,{size:32})})]})]})},Ef=t=>{t&&t instanceof Function&&n.e(453).then(n.bind(n,6453)).then(e=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:a,getTTFB:s}=e;n(t),i(t),r(t),a(t),s(t)})};i.createRoot(document.getElementById("root")).render((0,r.jsx)(e.StrictMode,{children:(0,r.jsx)(kf,{})})),Ef()})()})();
//# sourceMappingURL=main.42646a15.js.map